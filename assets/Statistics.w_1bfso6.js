import{c as T,r as c,u as ee,b as te,d as ae,N as se,W as re,f as le,j as e,L as ie,aM as ne}from"./index.BatHzcfy.js";import{C as ce}from"./chevron-left.tNmezBI8.js";import{F as oe}from"./funnel.CO7Q6EKO.js";import{g as de,h as xe,a as N,e as he,s as ue,R as g,C as S,X as A,Y as C,T as y,L as B,c as b,P as I,d as K,f as E,B as R,i as me}from"./PieChart.C3is2I2M.js";import{L as ge}from"./Line.DgDBc43t.js";import{i as ye}from"./isWithinInterval.B_oEtYqg.js";import"./index.TKEK1CsW.js";import"./tiny-invariant.XUtC9gpy.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],je=T("dollar-sign",fe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],be=T("target",pe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],H=T("trending-up",ve);var ke=["axis"],Ne=c.forwardRef((x,i)=>c.createElement(de,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:ke,tooltipPayloadSearcher:xe,categoricalChartProps:x,ref:i}));const v=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16"],D=({title:x,value:i,subValue:h,icon:M,color:u,trend:f})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:x}),e.jsx("p",{className:`text-2xl font-bold ${u}`,children:i}),h&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h})]}),e.jsx("div",{className:`p-3 rounded-full bg-opacity-10 ${u.replace("text-","bg-")}`,children:e.jsx(M,{className:u,size:24})})]}),f&&e.jsxs("div",{className:`flex items-center gap-1 mt-2 text-xs ${f>0?"text-green-500":"text-red-500"}`,children:[e.jsx(H,{size:12,className:f<0?"rotate-180":""}),e.jsxs("span",{children:[Math.abs(f),"% ì „ì›” ëŒ€ë¹„"]})]})]}),o=({title:x,children:i,className:h=""})=>e.jsxs("div",{className:`bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 ${h}`,children:[e.jsx("h3",{className:"text-base font-bold text-gray-800 dark:text-white mb-4",children:x}),i]});function $e(){const{theme:x}=ee(),i=x==="dark",[h,M]=c.useState([]),[u,f]=c.useState([]),[V,W]=c.useState([]),[Ce,q]=c.useState([]),[U,X]=c.useState(!0),[$,Y]=c.useState("6m"),[w,G]=c.useState("all"),[F,J]=c.useState("all");c.useEffect(()=>{Promise.all([te(),ae(),se(),re()]).then(([a,t,s,r])=>{M(a.filter(n=>n.status!=="íœ´ì§€í†µ")),f(t),W(s),q(r),X(!1)})},[]);const l=c.useMemo(()=>{const a=new Date;let t=null;switch($){case"1w":t=new Date(a.getTime()-10080*60*1e3);break;case"1m":t=N(a,1);break;case"3m":t=N(a,3);break;case"6m":t=N(a,6);break;case"1y":t=N(a,12);break;default:t=null}return h.filter(s=>!(t&&s.createdAt&&new Date(s.createdAt)<t||w!=="all"&&s.partnerId!==w||F!=="all"&&s.inboundPath!==F))},[h,$,w,F]),m=c.useMemo(()=>{const a=l.length,t=l.filter(p=>p.contractAt).length,s=a>0?(t/a*100).toFixed(1):"0",r=l.reduce((p,Z)=>p+(Z.contractFee||0),0),n=t>0?Math.round(r/t):0,d=l.filter(p=>p.depositHistory&&p.depositHistory.length>0).length,j=t>0?(d/t*100).toFixed(1):"0";return{total:a,contracted:t,contractRate:s,totalContractFee:r,avgContractFee:n,deposited:d,depositRate:j}},[l]),Q=c.useMemo(()=>{const a=Array.from({length:6},(t,s)=>{const r=N(new Date,5-s);return{name:le(r,"MMì›”"),start:ue(r),end:he(r),ì‹ ê·œ:0,ê³„ì•½:0,ê¸ˆì•¡:0}});return l.forEach(t=>{if(t.createdAt){const s=new Date(t.createdAt),r=a.find(n=>ye(s,{start:n.start,end:n.end}));r&&(r.ì‹ ê·œ++,t.contractAt&&(r.ê³„ì•½++,r.ê¸ˆì•¡+=t.contractFee||0))}}),a},[l]),k=c.useMemo(()=>{l.filter(n=>n.contractAt).map(()=>"contracted");const a=l.length,t=l.filter(n=>!["ì‹ ê·œì ‘ìˆ˜"].includes(n.status)).length,s=l.filter(n=>n.status==="ì‚¬ë¬´ì¥ ì ‘ìˆ˜"||n.contractAt).length,r=l.filter(n=>n.contractAt).length;return[{name:"ì‹ ê·œì ‘ìˆ˜",value:a,fill:"#3B82F6"},{name:"ìƒë‹´ì§„í–‰",value:t,fill:"#10B981"},{name:"ì‚¬ë¬´ì¥ì ‘ìˆ˜",value:s,fill:"#F59E0B"},{name:"ê³„ì•½ì™„ë£Œ",value:r,fill:"#8B5CF6"}]},[l]),z=c.useMemo(()=>{const a={};return l.forEach(t=>{const s=t.inboundPath||"ë¯¸ë¶„ë¥˜";a[s]||(a[s]={total:0,contracted:0,fee:0}),a[s].total++,t.contractAt&&(a[s].contracted++,a[s].fee+=t.contractFee||0)}),Object.entries(a).map(([t,s])=>({name:t,ê±´ìˆ˜:s.total,ê³„ì•½:s.contracted,ì „í™˜ìœ¨:s.total>0?Math.round(s.contracted/s.total*100):0,ê¸ˆì•¡:s.fee})).sort((t,s)=>s.ê±´ìˆ˜-t.ê±´ìˆ˜).slice(0,8)},[l]),_=c.useMemo(()=>{const a={};return l.forEach(t=>{const s=u.find(d=>d.partnerId===t.partnerId),r=t.partnerId||"unknown",n=(s==null?void 0:s.name)||"ë¯¸ì§€ì •";a[r]||(a[r]={name:n,total:0,contracted:0,fee:0}),a[r].total++,t.contractAt&&(a[r].contracted++,a[r].fee+=t.contractFee||0)}),Object.values(a).map(t=>({name:t.name,ê±´ìˆ˜:t.total,ê³„ì•½:t.contracted,ì „í™˜ìœ¨:t.total>0?Math.round(t.contracted/t.total*100):0,ê¸ˆì•¡:t.fee})).sort((t,s)=>s.ê±´ìˆ˜-t.ê±´ìˆ˜)},[l,u]),O=c.useMemo(()=>{const a={};return l.forEach(t=>{const s=t.status||"ë¯¸ë¶„ë¥˜";a[s]=(a[s]||0)+1}),Object.entries(a).map(([t,s])=>({name:t,value:s})).sort((t,s)=>s.value-t.value)},[l]),P=c.useMemo(()=>{const a=l.filter(s=>s.status==="ì‚¬ë¬´ì¥ ì ‘ìˆ˜"),t={};return a.forEach(s=>{const r=s.secondaryStatus||"ë¯¸ì§€ì •";t[r]=(t[r]||0)+1}),Object.entries(t).map(([s,r])=>({name:s,value:r})).sort((s,r)=>r.value-s.value)},[l]),L=c.useMemo(()=>{let a=0,t=0,s=0,r=0,n=0;return l.forEach(d=>{(d.reminders||[]).forEach(j=>{a++,j.resultStatus==="ì™„ë£Œ"?t++:j.resultStatus==="ë¯¸ì—°ê²°"?s++:j.resultStatus==="ì¬ì˜ˆì•½"?r++:j.resultStatus==="ì·¨ì†Œ"&&n++})}),[{name:"ì™„ë£Œ",value:t,fill:"#10B981"},{name:"ë¯¸ì—°ê²°",value:s,fill:"#EF4444"},{name:"ì¬ì˜ˆì•½",value:r,fill:"#3B82F6"},{name:"ì·¨ì†Œ",value:n,fill:"#6B7280"},{name:"ë¯¸ì²˜ë¦¬",value:a-t-s-r-n,fill:"#F59E0B"}].filter(d=>d.value>0)},[l]);return U?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"ë¡œë”©ì¤‘..."}):e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 pb-20",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ie,{to:"/",className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(ce,{size:24})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"ğŸ“Š ìƒì„¸ í†µê³„"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"í•„í„°:"})]}),e.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-700 p-1 rounded-lg",children:[{key:"1w",label:"1ì£¼"},{key:"1m",label:"1ê°œì›”"},{key:"3m",label:"3ê°œì›”"},{key:"6m",label:"6ê°œì›”"},{key:"1y",label:"1ë…„"},{key:"all",label:"ì „ì²´"}].map(a=>e.jsx("button",{onClick:()=>Y(a.key),className:`px-3 py-1 text-xs rounded-md transition-colors ${$===a.key?"bg-blue-600 text-white":"text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:a.label},a.key))}),e.jsxs("select",{value:w,onChange:a=>G(a.target.value),className:"text-sm border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-1.5 bg-white dark:bg-gray-700",children:[e.jsx("option",{value:"all",children:"ëª¨ë“  ê±°ë˜ì²˜"}),u.map(a=>e.jsx("option",{value:a.partnerId,children:a.name},a.partnerId))]}),e.jsxs("select",{value:F,onChange:a=>J(a.target.value),className:"text-sm border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-1.5 bg-white dark:bg-gray-700",children:[e.jsx("option",{value:"all",children:"ëª¨ë“  ìœ ì…ê²½ë¡œ"}),V.map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsxs("span",{className:"text-xs text-gray-400 ml-auto",children:["ì´ ",l.length,"ê±´ ì¡°íšŒë¨"]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(D,{title:"ì´ ì¼€ì´ìŠ¤",value:m.total,subValue:"í•„í„° ê¸°ê°„ ë‚´",icon:ne,color:"text-blue-600"}),e.jsx(D,{title:"ê³„ì•½ ê±´ìˆ˜",value:m.contracted,subValue:`ì „í™˜ìœ¨ ${m.contractRate}%`,icon:be,color:"text-green-600"}),e.jsx(D,{title:"ì´ ê³„ì•½ê¸ˆì•¡",value:`${m.totalContractFee.toLocaleString()}ë§Œì›`,subValue:`í‰ê·  ${m.avgContractFee.toLocaleString()}ë§Œì›`,icon:je,color:"text-purple-600"}),e.jsx(D,{title:"ì…ê¸ˆ ì™„ë£Œ",value:m.deposited,subValue:`ì…ê¸ˆë¥  ${m.depositRate}%`,icon:H,color:"text-orange-600"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(o,{title:"ğŸ“ˆ ì›”ë³„ ì‹ ê·œ ì ‘ìˆ˜ & ê³„ì•½ ì¶”ì´",children:e.jsx("div",{className:"h-[280px]",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(Ne,{data:Q,children:[e.jsx(S,{strokeDasharray:"3 3",stroke:i?"#374151":"#E5E7EB"}),e.jsx(A,{dataKey:"name",stroke:i?"#9CA3AF":"#6B7280",tick:{fontSize:11}}),e.jsx(C,{yAxisId:"left",stroke:i?"#9CA3AF":"#6B7280",tick:{fontSize:11}}),e.jsx(C,{yAxisId:"right",orientation:"right",stroke:i?"#9CA3AF":"#6B7280",tick:{fontSize:11}}),e.jsx(y,{contentStyle:{backgroundColor:i?"#1F2937":"#FFF",borderColor:i?"#374151":"#E5E7EB"}}),e.jsx(B,{wrapperStyle:{fontSize:"12px"}}),e.jsx(b,{yAxisId:"left",dataKey:"ì‹ ê·œ",fill:"#3B82F6",radius:[4,4,0,0]}),e.jsx(b,{yAxisId:"left",dataKey:"ê³„ì•½",fill:"#10B981",radius:[4,4,0,0]}),e.jsx(ge,{yAxisId:"right",type:"monotone",dataKey:"ê¸ˆì•¡",stroke:"#8B5CF6",strokeWidth:2,dot:{r:4}})]})})})}),e.jsx(o,{title:"ğŸ¯ ê³„ì•½ ì „í™˜ í¼ë„",children:e.jsx("div",{className:"h-[280px] flex items-center justify-center",children:e.jsx("div",{className:"w-full space-y-2",children:k.map((a,t)=>{const s=k[0].value>0?a.value/k[0].value*100:0,r=t>0&&k[t-1].value>0?(a.value/k[t-1].value*100).toFixed(0):"100";return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20 text-xs text-right text-gray-500",children:a.name}),e.jsxs("div",{className:"flex-1 h-8 bg-gray-100 dark:bg-gray-700 rounded relative overflow-hidden",children:[e.jsx("div",{className:"h-full rounded transition-all duration-500",style:{width:`${s}%`,backgroundColor:a.fill}}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-white mix-blend-difference",children:[a.value,"ê±´ (",r,"%)"]})]})]},a.name)})})})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(o,{title:"ğŸ“ ìœ ì…ê²½ë¡œë³„ ë¶„í¬",children:e.jsx("div",{className:"h-[280px]",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(I,{children:[e.jsx(K,{data:z,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,dataKey:"ê±´ìˆ˜",label:({name:a,percent:t})=>t>.05?`${a} ${(t*100).toFixed(0)}%`:"",labelLine:!1,children:z.map((a,t)=>e.jsx(E,{fill:v[t%v.length]},t))}),e.jsx(y,{})]})})})}),e.jsx(o,{title:"ğŸ“Š ìœ ì…ê²½ë¡œë³„ ê³„ì•½ ì „í™˜ìœ¨",children:e.jsx("div",{className:"h-[280px]",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(R,{data:z,layout:"vertical",children:[e.jsx(S,{strokeDasharray:"3 3",stroke:i?"#374151":"#E5E7EB"}),e.jsx(A,{type:"number",domain:[0,100],tick:{fontSize:11},stroke:i?"#9CA3AF":"#6B7280"}),e.jsx(C,{dataKey:"name",type:"category",width:80,tick:{fontSize:10},stroke:i?"#9CA3AF":"#6B7280"}),e.jsx(y,{formatter:a=>`${a}%`}),e.jsx(b,{dataKey:"ì „í™˜ìœ¨",fill:"#10B981",radius:[0,4,4,0],children:e.jsx(me,{dataKey:"ì „í™˜ìœ¨",position:"right",formatter:a=>`${a}%`,style:{fontSize:10}})})]})})})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(o,{title:"ğŸ¢ ê±°ë˜ì²˜ë³„ ì„±ê³¼",children:e.jsx("div",{className:"h-[280px]",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(R,{data:_,layout:"vertical",children:[e.jsx(S,{strokeDasharray:"3 3",stroke:i?"#374151":"#E5E7EB"}),e.jsx(A,{type:"number",tick:{fontSize:11},stroke:i?"#9CA3AF":"#6B7280"}),e.jsx(C,{dataKey:"name",type:"category",width:80,tick:{fontSize:10},stroke:i?"#9CA3AF":"#6B7280"}),e.jsx(y,{}),e.jsx(B,{wrapperStyle:{fontSize:"11px"}}),e.jsx(b,{dataKey:"ê±´ìˆ˜",fill:"#3B82F6",radius:[0,4,4,0]}),e.jsx(b,{dataKey:"ê³„ì•½",fill:"#10B981",radius:[0,4,4,0]})]})})})}),e.jsx(o,{title:"ğŸ“‹ í˜„ì¬ ìƒíƒœ ë¶„í¬",children:e.jsx("div",{className:"h-[280px]",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(R,{data:O,layout:"vertical",children:[e.jsx(S,{strokeDasharray:"3 3",stroke:i?"#374151":"#E5E7EB"}),e.jsx(A,{type:"number",tick:{fontSize:11},stroke:i?"#9CA3AF":"#6B7280"}),e.jsx(C,{dataKey:"name",type:"category",width:80,tick:{fontSize:10},stroke:i?"#9CA3AF":"#6B7280"}),e.jsx(y,{}),e.jsx(b,{dataKey:"value",fill:"#8B5CF6",radius:[0,4,4,0],children:O.map((a,t)=>e.jsx(E,{fill:v[t%v.length]},t))})]})})})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(o,{title:"ğŸ”„ 2ì°¨ ìƒíƒœ ë¶„í¬ (ì‚¬ë¬´ì¥ ì ‘ìˆ˜ ì¼€ì´ìŠ¤)",children:e.jsx("div",{className:"h-[280px]",children:P.length>0?e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(I,{children:[e.jsx(K,{data:P,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,dataKey:"value",label:({name:a,percent:t})=>t>.05?`${a}`:"",children:P.map((a,t)=>e.jsx(E,{fill:v[t%v.length]},t))}),e.jsx(y,{}),e.jsx(B,{layout:"vertical",align:"right",verticalAlign:"middle",wrapperStyle:{fontSize:"11px"}})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:"ì‚¬ë¬´ì¥ ì ‘ìˆ˜ ì¼€ì´ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤"})})}),e.jsx(o,{title:"ğŸ“ ë¦¬ë§ˆì¸ë” ê²°ê³¼ ë¶„ì„",children:e.jsx("div",{className:"h-[280px]",children:L.length>0?e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(I,{children:[e.jsx(K,{data:L,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,dataKey:"value",label:({name:a,percent:t})=>t>.05?`${a} ${(t*100).toFixed(0)}%`:"",children:L.map((a,t)=>e.jsx(E,{fill:a.fill},t))}),e.jsx(y,{}),e.jsx(B,{layout:"vertical",align:"right",verticalAlign:"middle",wrapperStyle:{fontSize:"11px"}})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:"ë¦¬ë§ˆì¸ë” ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"})})})]}),e.jsx(o,{title:"ğŸ† ê±°ë˜ì²˜ë³„ ëˆ„ì  ìˆ˜ì„ë£Œ ë­í‚¹",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"text-left py-2 px-3 text-gray-500",children:"ìˆœìœ„"}),e.jsx("th",{className:"text-left py-2 px-3 text-gray-500",children:"ê±°ë˜ì²˜"}),e.jsx("th",{className:"text-right py-2 px-3 text-gray-500",children:"ì¼€ì´ìŠ¤"}),e.jsx("th",{className:"text-right py-2 px-3 text-gray-500",children:"ê³„ì•½"}),e.jsx("th",{className:"text-right py-2 px-3 text-gray-500",children:"ì „í™˜ìœ¨"}),e.jsx("th",{className:"text-right py-2 px-3 text-gray-500",children:"ëˆ„ì  ìˆ˜ì„ë£Œ"})]})}),e.jsx("tbody",{children:_.slice(0,10).map((a,t)=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"py-2 px-3 font-bold text-gray-400",children:t+1}),e.jsx("td",{className:"py-2 px-3 font-medium",children:a.name}),e.jsx("td",{className:"py-2 px-3 text-right",children:a.ê±´ìˆ˜}),e.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:a.ê³„ì•½}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[a.ì „í™˜ìœ¨,"%"]}),e.jsxs("td",{className:"py-2 px-3 text-right font-bold text-purple-600",children:[a.ê¸ˆì•¡.toLocaleString(),"ë§Œì›"]})]},t))})]})})})]})}export{$e as default};
