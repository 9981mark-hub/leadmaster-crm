import{ae as j,a as _,n as Y,af as x,t as $,ag as v,ah as D,ai as w,aj as B,aa as q,ak as Z,al as C,am as E,f as A,an as y,p as G}from"./index-C9yNJTYo.js";function I(e,a,n){return j(e,a*7,n)}function K(e){return _(e,Date.now())}function J(e,a,n){const[t,o]=Y(n==null?void 0:n.in,e,a);return+x(t)==+x(o)}function ee(e,a){return $(e,a==null?void 0:a.in).getDay()}function te(e,a){return+$(e)<+$(a)}function ne(e){return+$(e)<Date.now()}function O(e,a){return J(_(e,e),K(e))}function ae(e,a,n){let t=a-ee(e,n);return t<=0&&(t+=7),j(e,t,n)}const oe={lessThanXSeconds:{one:"1초 미만",other:"{{count}}초 미만"},xSeconds:{one:"1초",other:"{{count}}초"},halfAMinute:"30초",lessThanXMinutes:{one:"1분 미만",other:"{{count}}분 미만"},xMinutes:{one:"1분",other:"{{count}}분"},aboutXHours:{one:"약 1시간",other:"약 {{count}}시간"},xHours:{one:"1시간",other:"{{count}}시간"},xDays:{one:"1일",other:"{{count}}일"},aboutXWeeks:{one:"약 1주",other:"약 {{count}}주"},xWeeks:{one:"1주",other:"{{count}}주"},aboutXMonths:{one:"약 1개월",other:"약 {{count}}개월"},xMonths:{one:"1개월",other:"{{count}}개월"},aboutXYears:{one:"약 1년",other:"약 {{count}}년"},xYears:{one:"1년",other:"{{count}}년"},overXYears:{one:"1년 이상",other:"{{count}}년 이상"},almostXYears:{one:"거의 1년",other:"거의 {{count}}년"}},re=(e,a,n)=>{let t;const o=oe[e];return typeof o=="string"?t=o:a===1?t=o.one:t=o.other.replace("{{count}}",a.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?t+" 후":t+" 전":t},se={full:"y년 M월 d일 EEEE",long:"y년 M월 d일",medium:"y.MM.dd",short:"y.MM.dd"},ie={full:"a H시 mm분 ss초 zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},ue={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},le={date:v({formats:se,defaultWidth:"full"}),time:v({formats:ie,defaultWidth:"full"}),dateTime:v({formats:ue,defaultWidth:"full"})},de={lastWeek:"'지난' eeee p",yesterday:"'어제' p",today:"'오늘' p",tomorrow:"'내일' p",nextWeek:"'다음' eeee p",other:"P"},me=(e,a,n,t)=>de[e],ce={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["기원전","서기"]},fe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1분기","2분기","3분기","4분기"]},he={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],wide:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},pe={narrow:["일","월","화","수","목","금","토"],short:["일","월","화","수","목","금","토"],abbreviated:["일","월","화","수","목","금","토"],wide:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},ye={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},ge={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},De=(e,a)=>{const n=Number(e);switch(String(a==null?void 0:a.unit)){case"minute":case"second":return String(n);case"date":return n+"일";default:return n+"번째"}},we={ordinalNumber:De,era:D({values:ce,defaultWidth:"wide"}),quarter:D({values:fe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:D({values:he,defaultWidth:"wide"}),day:D({values:pe,defaultWidth:"wide"}),dayPeriod:D({values:ye,defaultWidth:"wide",formattingValues:ge,defaultFormattingWidth:"wide"})},Pe=/^(\d+)(일|번째)?/i,be=/\d+/i,Me={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(기원전|서기)/i},$e={any:[/^(bc|기원전)/i,/^(ad|서기)/i]},Ae={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]사?분기/i},Te={any:[/1/i,/2/i,/3/i,/4/i]},Se={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])월/i,wide:/^(1[012]|[123456789])월/i},ve={any:[/^1월?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},Ce={narrow:/^[일월화수목금토]/,short:/^[일월화수목금토]/,abbreviated:/^[일월화수목금토]/,wide:/^[일월화수목금토]요일/},Le={any:[/^일/,/^월/,/^화/,/^수/,/^목/,/^금/,/^토/]},Fe={any:/^(am|pm|오전|오후|자정|정오|아침|저녁|밤)/i},We={any:{am:/^(am|오전)/i,pm:/^(pm|오후)/i,midnight:/^자정/i,noon:/^정오/i,morning:/^아침/i,afternoon:/^오후/i,evening:/^저녁/i,night:/^밤/i}},Re={ordinalNumber:B({matchPattern:Pe,parsePattern:be,valueCallback:e=>parseInt(e,10)}),era:w({matchPatterns:Me,defaultMatchWidth:"wide",parsePatterns:$e,defaultParseWidth:"any"}),quarter:w({matchPatterns:Ae,defaultMatchWidth:"wide",parsePatterns:Te,defaultParseWidth:"any",valueCallback:e=>e+1}),month:w({matchPatterns:Se,defaultMatchWidth:"wide",parsePatterns:ve,defaultParseWidth:"any"}),day:w({matchPatterns:Ce,defaultMatchWidth:"wide",parsePatterns:Le,defaultParseWidth:"any"}),dayPeriod:w({matchPatterns:Fe,defaultMatchWidth:"any",parsePatterns:We,defaultParseWidth:"any"})},Ne={code:"ko",formatDistance:re,formatLong:le,formatRelative:me,localize:we,match:Re,options:{weekStartsOn:0,firstWeekContainsDate:1}},W=(e,a)=>{const t=a.filter(o=>o.active).filter(o=>{const i=e>=o.minFee,m=!o.maxFee||e<=o.maxFee;return i&&m});if(t.length!==0)return t.sort((o,i)=>i.minFee!==o.minFee?i.minFee-o.minFee:i.priority!==o.priority?i.priority-o.priority:i.updatedAt!==o.updatedAt?i.updatedAt.localeCompare(o.updatedAt):i.ruleId.localeCompare(o.ruleId)),t[0]},z=(e,a)=>{if(!e)return 0;const n=W(e,a);return n?n.commission:0},U=(e,a,n)=>{if(!e.contractFee)return{payable:0,total:0,isPartial:!1};const t=W(e.contractFee,a);if(!t)return{payable:0,total:0,isPartial:!1};const o=(e.deposit1Amount||0)+(e.deposit2Amount||0),i=t.fullPayoutThreshold||0,m=n?n.downPaymentPercentage/100:.1,u=n?n.firstPayoutPercentage/100:.5;return i>0&&o>=i?{payable:t.commission,total:t.commission,isPartial:!1,rule:t}:o>=e.contractFee*m?{payable:t.commission*u,total:t.commission,isPartial:!0,rule:t}:{payable:0,total:t.commission,isPartial:!1,rule:t}},ke=(e,a)=>{const n=[];return Z.includes(e.status)&&(!e.reminders||e.reminders.length===0)&&n.push("리마인더 없음"),C.includes(e.status)&&!e.contractAt&&n.push("계약일 미입력"),C.includes(e.status)&&!e.contractFee&&n.push("수임료 미입력"),e.contractFee&&C.includes(e.status)&&a&&z(e.contractFee,a.commissionRules)===0&&n.push("수당 룰 없음"),n},He=e=>{const a=e.replace(/[^\d]/g,"");return a.length===2?parseInt(a,10)<=30?`20${a}`:`19${a}`:a},L=e=>e?String(e).replace(/[^0-9]/g,""):"",xe=(e,a)=>{if(!e)return;const n=L(e);if(!(n.length<9))return a.find(t=>t.phone&&L(t.phone)===n)},s=e=>{if(e==null||isNaN(e))return"";if(e===0)return"0원";const a=Math.floor(e/1e4),n=e%1e4;return a>0&&n>0?`${a.toLocaleString()}억 ${n.toLocaleString()}만원`:a>0&&n===0?`${a.toLocaleString()}억원`:a===0&&n>0?`${n.toLocaleString()}만원`:"0원"},Ee=(e,a=q)=>{var N,k,H;let n=a;e.maritalStatus==="미혼"&&(n=n.replace(/^\* 미성년 자녀 수 : .*\r?\n?/gm,"")),e.creditCardUse==="미사용"&&(n=n.replace(/^\* 신용카드 사용금액 : .*\r?\n?/gm,"")),e.jobTypes&&e.jobTypes.length===1&&e.jobTypes[0]==="무직"&&(n=n.replace(/^\* 4대보험 가입유무 : .*\r?\n?/gm,""));const t=[];e.housingType==="자가"?(e.ownHousePrice&&t.push(`집 시세 ${s(e.ownHousePrice)}`),e.ownHouseLoan&&t.push(`(집 담보대출 ${s(e.ownHouseLoan)})`),e.ownHouseOwner&&t.push(`[명의: ${e.ownHouseOwner}]`)):e.housingType==="무상거주"?(t.push("무상거주"),e.freeHousingOwner&&t.push(`[명의: ${e.freeHousingOwner}]`)):(e.deposit&&t.push(`보증금 ${s(e.deposit)}`),e.rent&&t.push(`월세 ${s(e.rent)}`),e.depositLoanAmount&&t.push(`(보증금 대출: ${s(e.depositLoanAmount)})`),e.rentContractor&&t.push(`[계약자: ${e.rentContractor}]`));const o=t.length>0?t.join(" "):"정보 없음",i=e.assets&&e.assets.length>0?e.assets.map(r=>{const g=r.desc?`(${r.desc})`:"",Q=r.rentDeposit?`/전세${s(r.rentDeposit)}`:"";return`(${r.owner}/${r.type}${g} 시세 ${s(r.amount)}${r.loanAmount?`/담보${s(r.loanAmount)}`:""}${Q})`}):[];let m=i.length>0?i.join(" "):"없음";const u=[];let d=0;e.housingType!=="자가"&&e.housingType!=="무상거주"&&e.depositLoanAmount&&(u.push(`보증금 대출(${s(e.depositLoanAmount)})`),d+=e.depositLoanAmount),e.housingType==="자가"&&e.ownHouseLoan&&(u.push(`집 담보 대출(${s(e.ownHouseLoan)})`),d+=e.ownHouseLoan),e.assets&&e.assets.filter(r=>r.loanAmount>0).forEach(r=>{u.push(`${r.type} 담보(${s(r.loanAmount)})`),d+=r.loanAmount}),e.collateralLoanMemo&&u.push(e.collateralLoanMemo);let c=u.length>0?u.join(", "):"없음";d>0&&(c+=` [총 합계: ${s(d)}]`);let l=0;const f=e.creditLoan&&e.creditLoan.length>0?e.creditLoan.map(r=>(l+=r.amount||0,`${r.desc} ${s(r.amount)}`)):[];e.creditCardUse==="사용"&&e.creditCardAmount&&(l+=e.creditCardAmount,f.push(`신용카드 ${s(e.creditCardAmount)}`));let h=f.length>0?f.join(", "):"없음";l>0&&(h+=` [총 합계: ${s(l)}]`);let P=e.historyType||"없음";e.historyType&&e.historyType!=="없음"&&e.historyMemo&&(P+=` (${e.historyMemo})`);const b=e.specialMemo?[...e.specialMemo].filter(r=>!r.content.startsWith("[상태변경]")).sort((r,g)=>g.createdAt.localeCompare(r.createdAt)):[],M=b.length>0?b.map(r=>`[${A(new Date(r.createdAt),"yyyy-MM-dd HH:mm",{locale:Ne})}]
${r.content}`).join(`

`):"없음",X=e.jobTypes&&e.jobTypes.length>0?e.jobTypes.join(", "):"정보 없음",p=[];(N=e.incomeDetails)!=null&&N.salary&&p.push(`직장인 ${s(e.incomeDetails.salary)}`),(k=e.incomeDetails)!=null&&k.business&&p.push(`사업자 ${s(e.incomeDetails.business)}`),(H=e.incomeDetails)!=null&&H.freelance&&p.push(`프리랜서 ${s(e.incomeDetails.freelance)}`);let T=p.join(" + ");p.length>1?T+=` (총 ${s(e.incomeNet)})`:p.length===0&&(T=s(e.incomeNet));const R={managerName:e.managerName,customerName:e.customerName,phone:e.phone,birth:e.birth?e.birth+"년생":"-",gender:e.gender,region:e.region,jobTypes:X,insurance4:e.insurance4,maritalStatus:e.maritalStatus,childrenCount:e.childrenCount!==void 0?e.childrenCount+"명":"-",incomeDetails:T,loanMonthlyPay:s(e.loanMonthlyPay),housingType:e.housingType,housingDetail:e.housingDetail,depositRentStr:o,assetsStr:m,creditLoanStr:h,collateralStr:c,creditCardUse:e.creditCardUse||"미사용",creditCardAmountStr:e.creditCardUse==="사용"&&e.creditCardAmount?s(e.creditCardAmount):"없음",historyStr:P,specialMemo:M};let S=n;for(const r in R){const g=new RegExp(`{{${r}}}`,"g");S=S.replace(g,R[r]||"")}return S.trim()},V=e=>{if(!e)return null;const a=G(e,"yyyy-MM-dd HH:mm",new Date);return y(a)?a:null},Ie=e=>{if(!e)return"none";const a=V(e);return a?O(a)?"today":ne(a)?"overdue":"future":"none"},je=e=>{if(!e)return null;const a=new Date(e);if(y(a)&&e.includes("-")&&!isNaN(a.getTime()))return a;const n=e.trim(),t=/(\d{4})[\.\-]\s*(\d{1,2})[\.\-]\s*(\d{1,2})[\.]?\s*(오전|오후)?\s*(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?/,o=n.match(t);if(o){const d=parseInt(o[1]),c=parseInt(o[2])-1,l=parseInt(o[3]),f=o[4];let h=parseInt(o[5]);const P=parseInt(o[6]),b=o[7]?parseInt(o[7]):0;f==="오후"&&h<12&&(h+=12),f==="오전"&&h===12&&(h=0);const M=new Date(d,c,l,h,P,b);if(y(M))return M}const i=/(\d{4})[\.\-]\s*(\d{1,2})[\.\-]\s*(\d{1,2})/,m=n.match(i);if(m){const d=parseInt(m[1]),c=parseInt(m[2])-1,l=parseInt(m[3]),f=new Date(d,c,l);if(y(f))return f}const u=new Date(e.replace(/\./g,"-"));return y(u)&&!isNaN(u.getTime())?u:null},F=e=>["일","월","화","수","목","금","토"][e]||"",_e=(e,a)=>{const n=a.commissionRules,t=a.settlementConfig,o=e.filter(l=>l.partnerId===a.partnerId&&["1차 입금완료","2차 입금완료","계약 완료"].includes(l.status)&&l.contractFee);let i=0,m=0;o.forEach(l=>{const f=(l.deposit1Amount||0)+(l.deposit2Amount||0);i+=f;const{payable:h}=U(l,n,t);m+=h});const u=new Date;let d=E(u,t.cutoffDay,{weekStartsOn:0});te(d,u)&&!O(d)&&(d=ae(u,t.cutoffDay));let c=E(d,t.payoutDay,{weekStartsOn:0});return t.payoutDay<=t.cutoffDay&&(c=I(c,1)),t.payoutWeekDelay>0&&(c=I(c,t.payoutWeekDelay)),{cutoffDate:A(d,"yyyy-MM-dd"),payoutDate:A(c,"yyyy-MM-dd"),currentTotalDeposit:i,expectedCommission:m,threshold:0,isEligible:m>0,cutoffDayName:F(t.cutoffDay),payoutDayName:F(t.payoutDay)}},Oe=e=>new Promise((a,n)=>{const t=new FileReader;t.readAsDataURL(e),t.onload=()=>{if(typeof t.result=="string"){const o=t.result.split(",")[1];a(o)}},t.onerror=o=>n(o)}),ze=e=>{if(!e)return"";if(!e.includes("drive.google.com"))return e;let a="";const n=e.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);if(n)a=n[1];else{const t=e.match(/[?&]id=([a-zA-Z0-9_-]+)/);t&&(a=t[1])}return a?`https://drive.google.com/uc?export=download&id=${a}`:e},Ue=(e,a)=>{if(!e)return"";let n=e;const t=a.managerName||localStorage.getItem("managerName")||"담당자 미정",o=/^[*]?\s*담당자\s*:.*/m;return o.test(n)?n=n.replace(o,`* 담당자 : ${t}`):n=`* 담당자 : ${t}
`+n,n},Ve=e=>{if(!e)return"";const a=[/(?:4\.|\[|#+)\s*특이사항[:\s]*([\s\S]*)/i,/(?:5\.|\[|#+)\s*향후\s*계획[:\s]*([\s\S]*)/i,/특이사항[:\s]*([\s\S]*)/i];for(const n of a){const t=e.match(n);if(t&&t[1])return t[1].trim()}return e},Xe=(e,a,n="-")=>{if(!e)return n;try{const t=new Date(e);return y(t)?A(t,a):n}catch(t){return console.warn("Date formatting error:",t),n}},Ye=Object.freeze(Object.defineProperty({__proto__:null,calculateCommission:z,calculateNextSettlement:_e,calculatePayableCommission:U,checkIsDuplicate:xe,convertToPlayableUrl:ze,extractSummarySpecifics:Ve,fileToBase64:Oe,formatKoreanMoney:s,generateSummary:Ee,getCaseWarnings:ke,getDayName:F,getMatchingRule:W,getReminderStatus:Ie,injectSummaryMetadata:Ue,normalizeBirthYear:He,normalizePhone:L,parseGenericDate:je,parseReminder:V,safeFormat:Xe},Symbol.toStringTag,{value:"Module"}));export{J as a,ke as b,_e as c,xe as d,V as e,Oe as f,Ie as g,Ue as h,O as i,z as j,ze as k,Ee as l,Ve as m,He as n,F as o,je as p,Xe as s,Ye as u};
