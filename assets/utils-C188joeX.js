import{al as _,a as O,n as Y,am as E,t as S,an as C,ao as w,ap as P,aq as q,ac as B,ar as Z,as as L,at as I,f as $,au as y,p as G}from"./index-DFG_svVS.js";function j(t,n,a){return _(t,n*7,a)}function K(t){return O(t,Date.now())}function J(t,n,a){const[e,o]=Y(a==null?void 0:a.in,t,n);return+E(e)==+E(o)}function tt(t,n){return S(t,n==null?void 0:n.in).getDay()}function et(t,n){return+S(t)<+S(n)}function nt(t){return+S(t)<Date.now()}function z(t,n){return J(O(t,t),K(t))}function at(t,n,a){let e=n-tt(t,a);return e<=0&&(e+=7),_(t,e,a)}const ot={lessThanXSeconds:{one:"1초 미만",other:"{{count}}초 미만"},xSeconds:{one:"1초",other:"{{count}}초"},halfAMinute:"30초",lessThanXMinutes:{one:"1분 미만",other:"{{count}}분 미만"},xMinutes:{one:"1분",other:"{{count}}분"},aboutXHours:{one:"약 1시간",other:"약 {{count}}시간"},xHours:{one:"1시간",other:"{{count}}시간"},xDays:{one:"1일",other:"{{count}}일"},aboutXWeeks:{one:"약 1주",other:"약 {{count}}주"},xWeeks:{one:"1주",other:"{{count}}주"},aboutXMonths:{one:"약 1개월",other:"약 {{count}}개월"},xMonths:{one:"1개월",other:"{{count}}개월"},aboutXYears:{one:"약 1년",other:"약 {{count}}년"},xYears:{one:"1년",other:"{{count}}년"},overXYears:{one:"1년 이상",other:"{{count}}년 이상"},almostXYears:{one:"거의 1년",other:"거의 {{count}}년"}},rt=(t,n,a)=>{let e;const o=ot[t];return typeof o=="string"?e=o:n===1?e=o.one:e=o.other.replace("{{count}}",n.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?e+" 후":e+" 전":e},st={full:"y년 M월 d일 EEEE",long:"y년 M월 d일",medium:"y.MM.dd",short:"y.MM.dd"},it={full:"a H시 mm분 ss초 zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},ut={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},lt={date:C({formats:st,defaultWidth:"full"}),time:C({formats:it,defaultWidth:"full"}),dateTime:C({formats:ut,defaultWidth:"full"})},dt={lastWeek:"'지난' eeee p",yesterday:"'어제' p",today:"'오늘' p",tomorrow:"'내일' p",nextWeek:"'다음' eeee p",other:"P"},mt=(t,n,a,e)=>dt[t],ct={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["기원전","서기"]},ft={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1분기","2분기","3분기","4분기"]},ht={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],wide:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},pt={narrow:["일","월","화","수","목","금","토"],short:["일","월","화","수","목","금","토"],abbreviated:["일","월","화","수","목","금","토"],wide:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},yt={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},gt={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},Dt=(t,n)=>{const a=Number(t);switch(String(n==null?void 0:n.unit)){case"minute":case"second":return String(a);case"date":return a+"일";default:return a+"번째"}},wt={ordinalNumber:Dt,era:w({values:ct,defaultWidth:"wide"}),quarter:w({values:ft,defaultWidth:"wide",argumentCallback:t=>t-1}),month:w({values:ht,defaultWidth:"wide"}),day:w({values:pt,defaultWidth:"wide"}),dayPeriod:w({values:yt,defaultWidth:"wide",formattingValues:gt,defaultFormattingWidth:"wide"})},Pt=/^(\d+)(일|번째)?/i,bt=/\d+/i,Mt={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(기원전|서기)/i},St={any:[/^(bc|기원전)/i,/^(ad|서기)/i]},$t={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]사?분기/i},At={any:[/1/i,/2/i,/3/i,/4/i]},Tt={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])월/i,wide:/^(1[012]|[123456789])월/i},vt={any:[/^1월?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},Ct={narrow:/^[일월화수목금토]/,short:/^[일월화수목금토]/,abbreviated:/^[일월화수목금토]/,wide:/^[일월화수목금토]요일/},Lt={any:[/^일/,/^월/,/^화/,/^수/,/^목/,/^금/,/^토/]},Ft={any:/^(am|pm|오전|오후|자정|정오|아침|저녁|밤)/i},Wt={any:{am:/^(am|오전)/i,pm:/^(pm|오후)/i,midnight:/^자정/i,noon:/^정오/i,morning:/^아침/i,afternoon:/^오후/i,evening:/^저녁/i,night:/^밤/i}},Rt={ordinalNumber:q({matchPattern:Pt,parsePattern:bt,valueCallback:t=>parseInt(t,10)}),era:P({matchPatterns:Mt,defaultMatchWidth:"wide",parsePatterns:St,defaultParseWidth:"any"}),quarter:P({matchPatterns:$t,defaultMatchWidth:"wide",parsePatterns:At,defaultParseWidth:"any",valueCallback:t=>t+1}),month:P({matchPatterns:Tt,defaultMatchWidth:"wide",parsePatterns:vt,defaultParseWidth:"any"}),day:P({matchPatterns:Ct,defaultMatchWidth:"wide",parsePatterns:Lt,defaultParseWidth:"any"}),dayPeriod:P({matchPatterns:Ft,defaultMatchWidth:"any",parsePatterns:Wt,defaultParseWidth:"any"})},Nt={code:"ko",formatDistance:rt,formatLong:lt,formatRelative:mt,localize:wt,match:Rt,options:{weekStartsOn:0,firstWeekContainsDate:1}},R=(t,n)=>{const e=n.filter(o=>o.active).filter(o=>{const s=t>=o.minFee,c=!o.maxFee||t<=o.maxFee;return s&&c});if(e.length!==0)return e.sort((o,s)=>s.minFee!==o.minFee?s.minFee-o.minFee:s.priority!==o.priority?s.priority-o.priority:s.updatedAt!==o.updatedAt?s.updatedAt.localeCompare(o.updatedAt):s.ruleId.localeCompare(o.ruleId)),e[0]},U=(t,n)=>{if(!t)return 0;const a=R(t,n);return a?a.commission:0},V=(t,n,a)=>{if(!t.contractFee)return{payable:0,total:0,isPartial:!1};const e=R(t.contractFee,n);if(!e)return{payable:0,total:0,isPartial:!1};const o=(t.deposit1Amount||0)+(t.deposit2Amount||0),s=e.fullPayoutThreshold||0,c=a?a.downPaymentPercentage/100:.1,u=a?a.firstPayoutPercentage/100:.5;return s>0&&o>=s?{payable:e.commission,total:e.commission,isPartial:!1,rule:e}:o>=t.contractFee*c?{payable:e.commission*u,total:e.commission,isPartial:!0,rule:e}:{payable:0,total:e.commission,isPartial:!1,rule:e}},kt=(t,n)=>{const a=[];return Z.includes(t.status)&&(!t.reminders||t.reminders.length===0)&&a.push("리마인더 없음"),L.includes(t.status)&&!t.contractAt&&a.push("계약일 미입력"),L.includes(t.status)&&!t.contractFee&&a.push("수임료 미입력"),t.contractFee&&L.includes(t.status)&&n&&U(t.contractFee,n.commissionRules)===0&&a.push("수당 룰 없음"),a},Ht=t=>{const n=t.replace(/[^\d]/g,"");return n.length===2?parseInt(n,10)<=30?`20${n}`:`19${n}`:n},F=t=>t?String(t).replace(/[^0-9]/g,""):"",xt=(t,n)=>{if(!t)return;const a=F(t);if(!(a.length<9))return n.find(e=>e.phone&&F(e.phone)===a)},i=t=>{if(t==null||isNaN(t))return"";if(t===0)return"0원";const n=Math.floor(t/1e4),a=t%1e4;return n>0&&a>0?`${n.toLocaleString()}억 ${a.toLocaleString()}만원`:n>0&&a===0?`${n.toLocaleString()}억원`:n===0&&a>0?`${a.toLocaleString()}만원`:"0원"},Et=(t,n=B)=>{var k,H,x;let a=n;t.maritalStatus==="미혼"&&(a=a.replace(/^\* 미성년 자녀 수 : .*\r?\n?/gm,"")),t.creditCardUse==="미사용"&&(a=a.replace(/^\* 신용카드 사용금액 : .*\r?\n?/gm,"")),t.jobTypes&&t.jobTypes.length===1&&t.jobTypes[0]==="무직"&&(a=a.replace(/^\* 4대보험 가입유무 : .*\r?\n?/gm,""));const e=[];t.housingType==="자가"?(t.ownHousePrice&&e.push(`집 시세 ${i(t.ownHousePrice)}`),t.ownHouseLoan&&e.push(`(집 담보대출 ${i(t.ownHouseLoan)})`),t.ownHouseOwner&&e.push(`[명의: ${t.ownHouseOwner}]`)):t.housingType==="무상거주"?(e.push("무상거주"),t.freeHousingOwner&&e.push(`[명의: ${t.freeHousingOwner}]`)):(t.deposit&&e.push(`보증금 ${i(t.deposit)}`),t.rent&&e.push(`월세 ${i(t.rent)}`),t.depositLoanAmount&&e.push(`(보증금 대출: ${i(t.depositLoanAmount)})`),t.rentContractor&&e.push(`[계약자: ${t.rentContractor}]`));const o=e.length>0?e.join(" "):"정보 없음",s=t.assets&&t.assets.length>0?t.assets.map(r=>{const D=r.desc?`(${r.desc})`:"",Q=r.rentDeposit?`/전세${i(r.rentDeposit)}`:"";return`(${r.owner}/${r.type}${D} 시세 ${i(r.amount)}${r.loanAmount?`/담보${i(r.loanAmount)}`:""}${Q})`}):[];let c=s.length>0?s.join(" "):"없음";const u=[];let d=0;t.housingType!=="자가"&&t.housingType!=="무상거주"&&t.depositLoanAmount&&(u.push(`보증금 대출(${i(t.depositLoanAmount)})`),d+=t.depositLoanAmount),t.housingType==="자가"&&t.ownHouseLoan&&(u.push(`집 담보 대출(${i(t.ownHouseLoan)})`),d+=t.ownHouseLoan),t.assets&&t.assets.filter(r=>r.loanAmount>0).forEach(r=>{u.push(`${r.type} 담보(${i(r.loanAmount)})`),d+=r.loanAmount}),t.collateralLoanMemo&&u.push(t.collateralLoanMemo);let m=u.length>0?u.join(", "):"없음";d>0&&(m+=` [총 합계: ${i(d)}]`);let l=0;const h=t.creditLoan&&t.creditLoan.length>0?t.creditLoan.map(r=>(l+=r.amount||0,`${r.desc} ${i(r.amount)}`)):[];t.creditCardUse==="사용"&&t.creditCardAmount&&(l+=t.creditCardAmount,h.push(`신용카드 ${i(t.creditCardAmount)}`));let f=h.length>0?h.join(", "):"없음";l>0&&(f+=` [총 합계: ${i(l)}]`);let p=t.historyType||"없음";t.historyType&&t.historyType!=="없음"&&t.historyMemo&&(p+=` (${t.historyMemo})`);const b=t.specialMemo?[...t.specialMemo].filter(r=>!r.content.startsWith("[상태변경]")).sort((r,D)=>D.createdAt.localeCompare(r.createdAt)):[],A=b.length>0?b.map(r=>`[${$(new Date(r.createdAt),"yyyy-MM-dd HH:mm",{locale:Nt})}]
${r.content}`).join(`

`):"없음",M=t.jobTypes&&t.jobTypes.length>0?t.jobTypes.join(", "):"정보 없음",g=[];(k=t.incomeDetails)!=null&&k.salary&&g.push(`직장인 ${i(t.incomeDetails.salary)}`),(H=t.incomeDetails)!=null&&H.business&&g.push(`사업자 ${i(t.incomeDetails.business)}`),(x=t.incomeDetails)!=null&&x.freelance&&g.push(`프리랜서 ${i(t.incomeDetails.freelance)}`);let T=g.join(" + ");g.length>1?T+=` (총 ${i(t.incomeNet)})`:g.length===0&&(T=i(t.incomeNet));const N={managerName:t.managerName,customerName:t.customerName,phone:t.phone,birth:t.birth?t.birth+"년생":"-",gender:t.gender,region:t.region,jobTypes:M,insurance4:t.insurance4,maritalStatus:t.maritalStatus,childrenCount:t.childrenCount!==void 0?t.childrenCount+"명":"-",incomeDetails:T,loanMonthlyPay:i(t.loanMonthlyPay),housingType:t.housingType,housingDetail:t.housingDetail,depositRentStr:o,assetsStr:c,creditLoanStr:f,collateralStr:m,creditCardUse:t.creditCardUse||"미사용",creditCardAmountStr:t.creditCardUse==="사용"&&t.creditCardAmount?i(t.creditCardAmount):"없음",historyStr:p,specialMemo:A};let v=a;for(const r in N){const D=new RegExp(`{{${r}}}`,"g");v=v.replace(D,N[r]||"")}return v.trim()},X=t=>{if(!t)return null;const n=G(t,"yyyy-MM-dd HH:mm",new Date);return y(n)?n:null},It=t=>{if(!t)return"none";const n=X(t);return n?z(n)?"today":nt(n)?"overdue":"future":"none"},jt=t=>{if(t==null)return null;if(t instanceof Date)return y(t)?t:null;const n=String(t);if(!n)return null;const a=new Date(n);if(y(a)&&n.includes("-")&&!isNaN(a.getTime()))return a;const e=n.trim(),o=/(\d{4})[\.\-]\s*(\d{1,2})[\.\-]\s*(\d{1,2})[\.]?\s*(오전|오후)?\s*(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?/,s=e.match(o);if(s){const m=parseInt(s[1]),l=parseInt(s[2])-1,h=parseInt(s[3]),f=s[4];let p=parseInt(s[5]);const b=parseInt(s[6]),A=s[7]?parseInt(s[7]):0;f==="오후"&&p<12&&(p+=12),f==="오전"&&p===12&&(p=0);const M=new Date(m,l,h,p,b,A);if(y(M))return M}const c=/(\d{4})[\.\-]\s*(\d{1,2})[\.\-]\s*(\d{1,2})/,u=e.match(c);if(u){const m=parseInt(u[1]),l=parseInt(u[2])-1,h=parseInt(u[3]),f=new Date(m,l,h);if(y(f))return f}const d=new Date(n.replace(/\./g,"-"));return y(d)&&!isNaN(d.getTime())?d:null},W=t=>["일","월","화","수","목","금","토"][t]||"",_t=(t,n)=>{const a=n.commissionRules,e=n.settlementConfig,o=t.filter(l=>l.partnerId===n.partnerId&&["1차 입금완료","2차 입금완료","계약 완료"].includes(l.status)&&l.contractFee);let s=0,c=0;o.forEach(l=>{const h=(l.deposit1Amount||0)+(l.deposit2Amount||0);s+=h;const{payable:f}=V(l,a,e);c+=f});const u=new Date;let d=I(u,e.cutoffDay,{weekStartsOn:0});et(d,u)&&!z(d)&&(d=at(u,e.cutoffDay));let m=I(d,e.payoutDay,{weekStartsOn:0});return e.payoutDay<=e.cutoffDay&&(m=j(m,1)),e.payoutWeekDelay>0&&(m=j(m,e.payoutWeekDelay)),{cutoffDate:$(d,"yyyy-MM-dd"),payoutDate:$(m,"yyyy-MM-dd"),currentTotalDeposit:s,expectedCommission:c,threshold:0,isEligible:c>0,cutoffDayName:W(e.cutoffDay),payoutDayName:W(e.payoutDay)}},Ot=t=>new Promise((n,a)=>{const e=new FileReader;e.readAsDataURL(t),e.onload=()=>{if(typeof e.result=="string"){const o=e.result.split(",")[1];n(o)}},e.onerror=o=>a(o)}),zt=t=>{if(!t)return"";if(!t.includes("drive.google.com"))return t;let n="";const a=t.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);if(a)n=a[1];else{const e=t.match(/[?&]id=([a-zA-Z0-9_-]+)/);e&&(n=e[1])}return n?`https://drive.google.com/uc?export=download&id=${n}`:t},Ut=(t,n)=>{if(!t)return"";let a=t;const e=n.managerName||localStorage.getItem("managerName")||"담당자 미정",o=/^[*]?\s*담당자\s*:.*/m;return o.test(a)?a=a.replace(o,`* 담당자 : ${e}`):a=`* 담당자 : ${e}
`+a,a},Vt=t=>{if(!t)return"";const n=[/(?:4\.|\[|#+)\s*특이사항[:\s]*([\s\S]*)/i,/(?:5\.|\[|#+)\s*향후\s*계획[:\s]*([\s\S]*)/i,/특이사항[:\s]*([\s\S]*)/i];for(const a of n){const e=t.match(a);if(e&&e[1])return e[1].trim()}return t},Xt=(t,n,a="-")=>{if(!t)return a;try{const e=new Date(t);return y(e)?$(e,n):a}catch(e){return console.warn("Date formatting error:",e),a}},Yt=Object.freeze(Object.defineProperty({__proto__:null,calculateCommission:U,calculateNextSettlement:_t,calculatePayableCommission:V,checkIsDuplicate:xt,convertToPlayableUrl:zt,extractSummarySpecifics:Vt,fileToBase64:Ot,formatKoreanMoney:i,generateSummary:Et,getCaseWarnings:kt,getDayName:W,getMatchingRule:R,getReminderStatus:It,injectSummaryMetadata:Ut,normalizeBirthYear:Ht,normalizePhone:F,parseGenericDate:jt,parseReminder:X,safeFormat:Xt},Symbol.toStringTag,{value:"Module"}));export{J as a,kt as b,_t as c,xt as d,X as e,Ot as f,It as g,Ut as h,z as i,U as j,zt as k,Et as l,Vt as m,Ht as n,W as o,jt as p,Xt as s,Yt as u};
