import{c as Et,R as Je,r as fe,e as El,j as g,X as ws,h as bl,b as kl,i as rs,S as ys,k as lo,l as ih,m as fo,o as oh,L as fi,q as uo,v as ch,w as lh,x as fh,y as uh,z as dh,A as hh,B as xh,f as ph,C as mh}from"./index-DT2Iwxpe.js";import{B as ho,M as xo,E as po,L as gh}from"./Skeleton-f5V2iCMo.js";import{R as vh,r as Tl}from"./index-DrJ8Fjx5.js";import{i as _h,c as Sl,b as mo,P as wh,a as yh,d as Eh,e as bh}from"./tiny-invariant-TVBB2fGA.js";import{m as Al,C as kh}from"./proxy-BnlieFxe.js";import{P as ia}from"./phone-BWQ7RLCg.js";import{C as _a}from"./check-1Skl5KBf.js";import{d as go,f as Th,b as vo,s as Jn,p as Sh,e as Zn}from"./utils-Bq0IW-D9.js";import{F as Ah}from"./file-text-enIjXjPN.js";import{P as Ch,T as oa}from"./trash-2-CK--i9Fk.js";import{S as Fh}from"./search-ZqvhnpK9.js";import{B as Ih}from"./building-J3v43KrA.js";import{F as Nh}from"./funnel-DOjAEUKU.js";import{C as Cl}from"./chevron-left-DmBTDCcC.js";import{C as Dh}from"./chevron-right-CobYfyeC.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oh=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],Fl=Et("arrow-up-down",Oh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ph=Et("chevron-down",Rh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Bh=Et("download",Lh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],jh=Et("eye-off",Mh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],_o=Et("image",Uh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wh=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Hh=Et("layout-grid",Wh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],Vh=Et("layout-list",Gh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],zh=Et("list",$h);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],wo=Et("message-square",Xh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kh=[["path",{d:"m16 2 6 6",key:"1gw87d"}],["path",{d:"m22 2-6 6",key:"6f0sa0"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Yh=Et("phone-missed",Kh);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Es=Et("upload",qh);var gt=function(r){var t=r.top,n=r.right,a=r.bottom,s=r.left,i=n-s,o=a-t,c={top:t,right:n,bottom:a,left:s,width:i,height:o,x:s,y:t,center:{x:(n+s)/2,y:(a+t)/2}};return c},Zi=function(r,t){return{top:r.top-t.top,left:r.left-t.left,bottom:r.bottom+t.bottom,right:r.right+t.right}},yo=function(r,t){return{top:r.top+t.top,left:r.left+t.left,bottom:r.bottom-t.bottom,right:r.right-t.right}},Jh=function(r,t){return{top:r.top+t.y,left:r.left+t.x,bottom:r.bottom+t.y,right:r.right+t.x}},ui={top:0,right:0,bottom:0,left:0},Qi=function(r){var t=r.borderBox,n=r.margin,a=n===void 0?ui:n,s=r.border,i=s===void 0?ui:s,o=r.padding,c=o===void 0?ui:o,l=gt(Zi(t,a)),f=gt(yo(t,i)),u=gt(yo(f,c));return{marginBox:l,borderBox:gt(t),paddingBox:f,contentBox:u,margin:a,border:i,padding:c}},nt=function(r){var t=r.slice(0,-2),n=r.slice(-2);if(n!=="px")return 0;var a=Number(t);return isNaN(a)&&_h(),a},Zh=function(){return{x:window.pageXOffset,y:window.pageYOffset}},bs=function(r,t){var n=r.borderBox,a=r.border,s=r.margin,i=r.padding,o=Jh(n,t);return Qi({borderBox:o,border:a,margin:s,padding:i})},ks=function(r,t){return t===void 0&&(t=Zh()),bs(r,t)},Il=function(r,t){var n={top:nt(t.marginTop),right:nt(t.marginRight),bottom:nt(t.marginBottom),left:nt(t.marginLeft)},a={top:nt(t.paddingTop),right:nt(t.paddingRight),bottom:nt(t.paddingBottom),left:nt(t.paddingLeft)},s={top:nt(t.borderTopWidth),right:nt(t.borderRightWidth),bottom:nt(t.borderBottomWidth),left:nt(t.borderLeftWidth)};return Qi({borderBox:r,margin:n,padding:a,border:s})},Nl=function(r){var t=r.getBoundingClientRect(),n=window.getComputedStyle(r);return Il(t,n)},wa=function(r){var t=[],n=null,a=function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];t=o,!n&&(n=requestAnimationFrame(function(){n=null,r.apply(void 0,t)}))};return a.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},a};function Ts(){return Ts=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Ts.apply(null,arguments)}function Dl(e,r){}Dl.bind(null,"warn");Dl.bind(null,"error");function Gt(){}function Qh(e,r){return{...e,...r}}function ft(e,r,t){const n=r.map(a=>{const s=Qh(t,a.options);return e.addEventListener(a.eventName,a.fn,s),function(){e.removeEventListener(a.eventName,a.fn,s)}});return function(){n.forEach(s=>{s()})}}const ex="Invariant failed";class Ss extends Error{}Ss.prototype.toString=function(){return this.message};function ce(e,r){throw new Ss(ex)}class rx extends Je.Component{constructor(...r){super(...r),this.callbacks=null,this.unbind=Gt,this.onWindowError=t=>{const n=this.getCallbacks();n.isDragging()&&n.tryAbort(),t.error instanceof Ss&&t.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=t=>{this.callbacks=t}}componentDidMount(){this.unbind=ft(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(r){if(r instanceof Ss){this.setState({});return}throw r}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const tx=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,As=e=>e+1,nx=e=>`
  You have lifted an item in position ${As(e.source.index)}
`,Ol=(e,r)=>{const t=e.droppableId===r.droppableId,n=As(e.index),a=As(r.index);return t?`
      You have moved the item from position ${n}
      to position ${a}
    `:`
    You have moved the item from position ${n}
    in list ${e.droppableId}
    to list ${r.droppableId}
    in position ${a}
  `},Rl=(e,r,t)=>r.droppableId===t.droppableId?`
      The item ${e}
      has been combined with ${t.draggableId}`:`
      The item ${e}
      in list ${r.droppableId}
      has been combined with ${t.draggableId}
      in list ${t.droppableId}
    `,ax=e=>{const r=e.destination;if(r)return Ol(e.source,r);const t=e.combine;return t?Rl(e.draggableId,e.source,t):"You are over an area that cannot be dropped on"},Eo=e=>`
  The item has returned to its starting position
  of ${As(e.index)}
`,sx=e=>{if(e.reason==="CANCEL")return`
      Movement cancelled.
      ${Eo(e.source)}
    `;const r=e.destination,t=e.combine;return r?`
      You have dropped the item.
      ${Ol(e.source,r)}
    `:t?`
      You have dropped the item.
      ${Rl(e.draggableId,e.source,t)}
    `:`
    The item has been dropped while not over a drop area.
    ${Eo(e.source)}
  `},vs={dragHandleUsageInstructions:tx,onDragStart:nx,onDragUpdate:ax,onDragEnd:sx};function ix(e,r){return!!(e===r||Number.isNaN(e)&&Number.isNaN(r))}function Pl(e,r){if(e.length!==r.length)return!1;for(let t=0;t<e.length;t++)if(!ix(e[t],r[t]))return!1;return!0}function Le(e,r){const t=fe.useState(()=>({inputs:r,result:e()}))[0],n=fe.useRef(!0),a=fe.useRef(t),i=n.current||!!(r&&a.current.inputs&&Pl(r,a.current.inputs))?a.current:{inputs:r,result:e()};return fe.useEffect(()=>{n.current=!1,a.current=i},[i]),i.result}function _e(e,r){return Le(()=>e,r)}const Er={x:0,y:0},Ar=(e,r)=>({x:e.x+r.x,y:e.y+r.y}),Qr=(e,r)=>({x:e.x-r.x,y:e.y-r.y}),Vt=(e,r)=>e.x===r.x&&e.y===r.y,Un=e=>({x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}),fn=(e,r,t=0)=>e==="x"?{x:r,y:t}:{x:t,y:r},ya=(e,r)=>Math.sqrt((r.x-e.x)**2+(r.y-e.y)**2),bo=(e,r)=>Math.min(...r.map(t=>ya(e,t))),Ll=e=>r=>({x:e(r.x),y:e(r.y)});var ox=(e,r)=>{const t=gt({top:Math.max(r.top,e.top),right:Math.min(r.right,e.right),bottom:Math.min(r.bottom,e.bottom),left:Math.max(r.left,e.left)});return t.width<=0||t.height<=0?null:t};const Ga=(e,r)=>({top:e.top+r.y,left:e.left+r.x,bottom:e.bottom+r.y,right:e.right+r.x}),ko=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],cx={top:0,right:0,bottom:0,left:0},lx=(e,r)=>r?Ga(e,r.scroll.diff.displacement):e,fx=(e,r,t)=>t&&t.increasedBy?{...e,[r.end]:e[r.end]+t.increasedBy[r.line]}:e,ux=(e,r)=>r&&r.shouldClipSubject?ox(r.pageMarginBox,e):gt(e);var Rn=({page:e,withPlaceholder:r,axis:t,frame:n})=>{const a=lx(e.marginBox,n),s=fx(a,t,r),i=ux(s,n);return{page:e,withPlaceholder:r,active:i}},e0=(e,r)=>{e.frame||ce();const t=e.frame,n=Qr(r,t.scroll.initial),a=Un(n),s={...t,scroll:{initial:t.scroll.initial,current:r,diff:{value:n,displacement:a},max:t.scroll.max}},i=Rn({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:s});return{...e,frame:s,subject:i}};function yr(e,r=Pl){let t=null;function n(...a){if(t&&t.lastThis===this&&r(a,t.lastArgs))return t.lastResult;const s=e.apply(this,a);return t={lastResult:s,lastArgs:a,lastThis:this},s}return n.clear=function(){t=null},n}const Bl=yr(e=>e.reduce((r,t)=>(r[t.descriptor.id]=t,r),{})),Ml=yr(e=>e.reduce((r,t)=>(r[t.descriptor.id]=t,r),{})),Vs=yr(e=>Object.values(e)),dx=yr(e=>Object.values(e));var Wn=yr((e,r)=>dx(r).filter(n=>e===n.descriptor.droppableId).sort((n,a)=>n.descriptor.index-a.descriptor.index));function r0(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function $s(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var zs=yr((e,r)=>r.filter(t=>t.descriptor.id!==e.descriptor.id)),hx=({isMovingForward:e,draggable:r,destination:t,insideDestination:n,previousImpact:a})=>{if(!t.isCombineEnabled||!r0(a))return null;function i(h){const p={type:"COMBINE",combine:{draggableId:h,droppableId:t.descriptor.id}};return{...a,at:p}}const o=a.displaced.all,c=o.length?o[0]:null;if(e)return c?i(c):null;const l=zs(r,n);if(!c){if(!l.length)return null;const h=l[l.length-1];return i(h.descriptor.id)}const f=l.findIndex(h=>h.descriptor.id===c);f===-1&&ce();const u=f-1;if(u<0)return null;const d=l[u];return i(d.descriptor.id)},Hn=(e,r)=>e.descriptor.droppableId===r.descriptor.id;const jl={point:Er,value:0},Ea={invisible:{},visible:{},all:[]},xx={displaced:Ea,displacedBy:jl,at:null};var ut=(e,r)=>t=>e<=t&&t<=r,Ul=e=>{const r=ut(e.top,e.bottom),t=ut(e.left,e.right);return n=>{if(r(n.top)&&r(n.bottom)&&t(n.left)&&t(n.right))return!0;const s=r(n.top)||r(n.bottom),i=t(n.left)||t(n.right);if(s&&i)return!0;const c=n.top<e.top&&n.bottom>e.bottom,l=n.left<e.left&&n.right>e.right;return c&&l?!0:c&&i||l&&s}},px=e=>{const r=ut(e.top,e.bottom),t=ut(e.left,e.right);return n=>r(n.top)&&r(n.bottom)&&t(n.left)&&t(n.right)};const t0={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Wl={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var mx=e=>r=>{const t=ut(r.top,r.bottom),n=ut(r.left,r.right);return a=>e===t0?t(a.top)&&t(a.bottom):n(a.left)&&n(a.right)};const gx=(e,r)=>{const t=r.frame?r.frame.scroll.diff.displacement:Er;return Ga(e,t)},vx=(e,r,t)=>r.subject.active?t(r.subject.active)(e):!1,_x=(e,r,t)=>t(r)(e),n0=({target:e,destination:r,viewport:t,withDroppableDisplacement:n,isVisibleThroughFrameFn:a})=>{const s=n?gx(e,r):e;return vx(s,r,a)&&_x(s,t,a)},wx=e=>n0({...e,isVisibleThroughFrameFn:Ul}),Hl=e=>n0({...e,isVisibleThroughFrameFn:px}),yx=e=>n0({...e,isVisibleThroughFrameFn:mx(e.destination.axis)}),Ex=(e,r,t)=>{if(typeof t=="boolean")return t;if(!r)return!0;const{invisible:n,visible:a}=r;if(n[e])return!1;const s=a[e];return s?s.shouldAnimate:!0};function bx(e,r){const t=e.page.marginBox,n={top:r.point.y,right:0,bottom:0,left:r.point.x};return gt(Zi(t,n))}function ba({afterDragging:e,destination:r,displacedBy:t,viewport:n,forceShouldAnimate:a,last:s}){return e.reduce(function(o,c){const l=bx(c,t),f=c.descriptor.id;if(o.all.push(f),!wx({target:l,destination:r,viewport:n,withDroppableDisplacement:!0}))return o.invisible[c.descriptor.id]=!0,o;const d=Ex(f,s,a),h={draggableId:f,shouldAnimate:d};return o.visible[f]=h,o},{all:[],visible:{},invisible:{}})}function kx(e,r){if(!e.length)return 0;const t=e[e.length-1].descriptor.index;return r.inHomeList?t:t+1}function To({insideDestination:e,inHomeList:r,displacedBy:t,destination:n}){const a=kx(e,{inHomeList:r});return{displaced:Ea,displacedBy:t,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:a}}}}function Cs({draggable:e,insideDestination:r,destination:t,viewport:n,displacedBy:a,last:s,index:i,forceShouldAnimate:o}){const c=Hn(e,t);if(i==null)return To({insideDestination:r,inHomeList:c,displacedBy:a,destination:t});const l=r.find(p=>p.descriptor.index===i);if(!l)return To({insideDestination:r,inHomeList:c,displacedBy:a,destination:t});const f=zs(e,r),u=r.indexOf(l),d=f.slice(u);return{displaced:ba({afterDragging:d,destination:t,displacedBy:a,last:s,viewport:n.frame,forceShouldAnimate:o}),displacedBy:a,at:{type:"REORDER",destination:{droppableId:t.descriptor.id,index:i}}}}function zt(e,r){return!!r.effected[e]}var Tx=({isMovingForward:e,destination:r,draggables:t,combine:n,afterCritical:a})=>{if(!r.isCombineEnabled)return null;const s=n.draggableId,o=t[s].descriptor.index;return zt(s,a)?e?o:o-1:e?o+1:o},Sx=({isMovingForward:e,isInHomeList:r,insideDestination:t,location:n})=>{if(!t.length)return null;const a=n.index,s=e?a+1:a-1,i=t[0].descriptor.index,o=t[t.length-1].descriptor.index,c=r?o:o+1;return s<i||s>c?null:s},Ax=({isMovingForward:e,isInHomeList:r,draggable:t,draggables:n,destination:a,insideDestination:s,previousImpact:i,viewport:o,afterCritical:c})=>{const l=i.at;if(l||ce(),l.type==="REORDER"){const u=Sx({isMovingForward:e,isInHomeList:r,location:l.destination,insideDestination:s});return u==null?null:Cs({draggable:t,insideDestination:s,destination:a,viewport:o,last:i.displaced,displacedBy:i.displacedBy,index:u})}const f=Tx({isMovingForward:e,destination:a,displaced:i.displaced,draggables:n,combine:l.combine,afterCritical:c});return f==null?null:Cs({draggable:t,insideDestination:s,destination:a,viewport:o,last:i.displaced,displacedBy:i.displacedBy,index:f})},Cx=({displaced:e,afterCritical:r,combineWith:t,displacedBy:n})=>{const a=!!(e.visible[t]||e.invisible[t]);return zt(t,r)?a?Er:Un(n.point):a?n.point:Er},Fx=({afterCritical:e,impact:r,draggables:t})=>{const n=$s(r);n||ce();const a=n.draggableId,s=t[a].page.borderBox.center,i=Cx({displaced:r.displaced,afterCritical:e,combineWith:a,displacedBy:r.displacedBy});return Ar(s,i)};const Gl=(e,r)=>r.margin[e.start]+r.borderBox[e.size]/2,Ix=(e,r)=>r.margin[e.end]+r.borderBox[e.size]/2,a0=(e,r,t)=>r[e.crossAxisStart]+t.margin[e.crossAxisStart]+t.borderBox[e.crossAxisSize]/2,So=({axis:e,moveRelativeTo:r,isMoving:t})=>fn(e.line,r.marginBox[e.end]+Gl(e,t),a0(e,r.marginBox,t)),Ao=({axis:e,moveRelativeTo:r,isMoving:t})=>fn(e.line,r.marginBox[e.start]-Ix(e,t),a0(e,r.marginBox,t)),Nx=({axis:e,moveInto:r,isMoving:t})=>fn(e.line,r.contentBox[e.start]+Gl(e,t),a0(e,r.contentBox,t));var Dx=({impact:e,draggable:r,draggables:t,droppable:n,afterCritical:a})=>{const s=Wn(n.descriptor.id,t),i=r.page,o=n.axis;if(!s.length)return Nx({axis:o,moveInto:n.page,isMoving:i});const{displaced:c,displacedBy:l}=e,f=c.all[0];if(f){const d=t[f];if(zt(f,a))return Ao({axis:o,moveRelativeTo:d.page,isMoving:i});const h=bs(d.page,l.point);return Ao({axis:o,moveRelativeTo:h,isMoving:i})}const u=s[s.length-1];if(u.descriptor.id===r.descriptor.id)return i.borderBox.center;if(zt(u.descriptor.id,a)){const d=bs(u.page,Un(a.displacedBy.point));return So({axis:o,moveRelativeTo:d,isMoving:i})}return So({axis:o,moveRelativeTo:u.page,isMoving:i})},Ri=(e,r)=>{const t=e.frame;return t?Ar(r,t.scroll.diff.displacement):r};const Ox=({impact:e,draggable:r,droppable:t,draggables:n,afterCritical:a})=>{const s=r.page.borderBox.center,i=e.at;return!t||!i?s:i.type==="REORDER"?Dx({impact:e,draggable:r,draggables:n,droppable:t,afterCritical:a}):Fx({impact:e,draggables:n,afterCritical:a})};var Xs=e=>{const r=Ox(e),t=e.droppable;return t?Ri(t,r):r},Vl=(e,r)=>{const t=Qr(r,e.scroll.initial),n=Un(t);return{frame:gt({top:r.y,bottom:r.y+e.frame.height,left:r.x,right:r.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:r,diff:{value:t,displacement:n}}}};function Co(e,r){return e.map(t=>r[t])}function Rx(e,r){for(let t=0;t<r.length;t++){const n=r[t].visible[e];if(n)return n}return null}var Px=({impact:e,viewport:r,destination:t,draggables:n,maxScrollChange:a})=>{const s=Vl(r,Ar(r.scroll.current,a)),i=t.frame?e0(t,Ar(t.frame.scroll.current,a)):t,o=e.displaced,c=ba({afterDragging:Co(o.all,n),destination:t,displacedBy:e.displacedBy,viewport:s.frame,last:o,forceShouldAnimate:!1}),l=ba({afterDragging:Co(o.all,n),destination:i,displacedBy:e.displacedBy,viewport:r.frame,last:o,forceShouldAnimate:!1}),f={},u={},d=[o,c,l];return o.all.forEach(p=>{const x=Rx(p,d);if(x){u[p]=x;return}f[p]=!0}),{...e,displaced:{all:o.all,invisible:f,visible:u}}},Lx=(e,r)=>Ar(e.scroll.diff.displacement,r),s0=({pageBorderBoxCenter:e,draggable:r,viewport:t})=>{const n=Lx(t,e),a=Qr(n,r.page.borderBox.center);return Ar(r.client.borderBox.center,a)},$l=({draggable:e,destination:r,newPageBorderBoxCenter:t,viewport:n,withDroppableDisplacement:a,onlyOnMainAxis:s=!1})=>{const i=Qr(t,e.page.borderBox.center),c={target:Ga(e.page.borderBox,i),destination:r,withDroppableDisplacement:a,viewport:n};return s?yx(c):Hl(c)},Bx=({isMovingForward:e,draggable:r,destination:t,draggables:n,previousImpact:a,viewport:s,previousPageBorderBoxCenter:i,previousClientSelection:o,afterCritical:c})=>{if(!t.isEnabled)return null;const l=Wn(t.descriptor.id,n),f=Hn(r,t),u=hx({isMovingForward:e,draggable:r,destination:t,insideDestination:l,previousImpact:a})||Ax({isMovingForward:e,isInHomeList:f,draggable:r,draggables:n,destination:t,insideDestination:l,previousImpact:a,viewport:s,afterCritical:c});if(!u)return null;const d=Xs({impact:u,draggable:r,droppable:t,draggables:n,afterCritical:c});if($l({draggable:r,destination:t,newPageBorderBoxCenter:d,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:s0({pageBorderBoxCenter:d,draggable:r,viewport:s}),impact:u,scrollJumpRequest:null};const p=Qr(d,i),x=Px({impact:u,viewport:s,destination:t,draggables:n,maxScrollChange:p});return{clientSelection:o,impact:x,scrollJumpRequest:p}};const Wr=e=>{const r=e.subject.active;return r||ce(),r};var Mx=({isMovingForward:e,pageBorderBoxCenter:r,source:t,droppables:n,viewport:a})=>{const s=t.subject.active;if(!s)return null;const i=t.axis,o=ut(s[i.start],s[i.end]),c=Vs(n).filter(f=>f!==t).filter(f=>f.isEnabled).filter(f=>!!f.subject.active).filter(f=>Ul(a.frame)(Wr(f))).filter(f=>{const u=Wr(f);return e?s[i.crossAxisEnd]<u[i.crossAxisEnd]:u[i.crossAxisStart]<s[i.crossAxisStart]}).filter(f=>{const u=Wr(f),d=ut(u[i.start],u[i.end]);return o(u[i.start])||o(u[i.end])||d(s[i.start])||d(s[i.end])}).sort((f,u)=>{const d=Wr(f)[i.crossAxisStart],h=Wr(u)[i.crossAxisStart];return e?d-h:h-d}).filter((f,u,d)=>Wr(f)[i.crossAxisStart]===Wr(d[0])[i.crossAxisStart]);if(!c.length)return null;if(c.length===1)return c[0];const l=c.filter(f=>ut(Wr(f)[i.start],Wr(f)[i.end])(r[i.line]));return l.length===1?l[0]:l.length>1?l.sort((f,u)=>Wr(f)[i.start]-Wr(u)[i.start])[0]:c.sort((f,u)=>{const d=bo(r,ko(Wr(f))),h=bo(r,ko(Wr(u)));return d!==h?d-h:Wr(f)[i.start]-Wr(u)[i.start]})[0]};const Fo=(e,r)=>{const t=e.page.borderBox.center;return zt(e.descriptor.id,r)?Qr(t,r.displacedBy.point):t},jx=(e,r)=>{const t=e.page.borderBox;return zt(e.descriptor.id,r)?Ga(t,Un(r.displacedBy.point)):t};var Ux=({pageBorderBoxCenter:e,viewport:r,destination:t,insideDestination:n,afterCritical:a})=>n.filter(i=>Hl({target:jx(i,a),destination:t,viewport:r.frame,withDroppableDisplacement:!0})).sort((i,o)=>{const c=ya(e,Ri(t,Fo(i,a))),l=ya(e,Ri(t,Fo(o,a)));return c<l?-1:l<c?1:i.descriptor.index-o.descriptor.index})[0]||null,Va=yr(function(r,t){const n=t[r.line];return{value:n,point:fn(r.line,n)}});const Wx=(e,r,t)=>{const n=e.axis;if(e.descriptor.mode==="virtual")return fn(n.line,r[n.line]);const a=e.subject.page.contentBox[n.size],c=Wn(e.descriptor.id,t).reduce((l,f)=>l+f.client.marginBox[n.size],0)+r[n.line]-a;return c<=0?null:fn(n.line,c)},zl=(e,r)=>({...e,scroll:{...e.scroll,max:r}}),Xl=(e,r,t)=>{const n=e.frame;Hn(r,e)&&ce(),e.subject.withPlaceholder&&ce();const a=Va(e.axis,r.displaceBy).point,s=Wx(e,a,t),i={placeholderSize:a,increasedBy:s,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!n){const f=Rn({page:e.subject.page,withPlaceholder:i,axis:e.axis,frame:e.frame});return{...e,subject:f}}const o=s?Ar(n.scroll.max,s):n.scroll.max,c=zl(n,o),l=Rn({page:e.subject.page,withPlaceholder:i,axis:e.axis,frame:c});return{...e,subject:l,frame:c}},Hx=e=>{const r=e.subject.withPlaceholder;r||ce();const t=e.frame;if(!t){const i=Rn({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:i}}const n=r.oldFrameMaxScroll;n||ce();const a=zl(t,n),s=Rn({page:e.subject.page,axis:e.axis,frame:a,withPlaceholder:null});return{...e,subject:s,frame:a}};var Gx=({previousPageBorderBoxCenter:e,moveRelativeTo:r,insideDestination:t,draggable:n,draggables:a,destination:s,viewport:i,afterCritical:o})=>{if(!r){if(t.length)return null;const u={displaced:Ea,displacedBy:jl,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:0}}},d=Xs({impact:u,draggable:n,droppable:s,draggables:a,afterCritical:o}),h=Hn(n,s)?s:Xl(s,n,a);return $l({draggable:n,destination:h,newPageBorderBoxCenter:d,viewport:i.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?u:null}const c=e[s.axis.line]<=r.page.borderBox.center[s.axis.line],l=(()=>{const u=r.descriptor.index;return r.descriptor.id===n.descriptor.id||c?u:u+1})(),f=Va(s.axis,n.displaceBy);return Cs({draggable:n,insideDestination:t,destination:s,viewport:i,displacedBy:f,last:Ea,index:l})},Vx=({isMovingForward:e,previousPageBorderBoxCenter:r,draggable:t,isOver:n,draggables:a,droppables:s,viewport:i,afterCritical:o})=>{const c=Mx({isMovingForward:e,pageBorderBoxCenter:r,source:n,droppables:s,viewport:i});if(!c)return null;const l=Wn(c.descriptor.id,a),f=Ux({pageBorderBoxCenter:r,viewport:i,destination:c,insideDestination:l,afterCritical:o}),u=Gx({previousPageBorderBoxCenter:r,destination:c,draggable:t,draggables:a,moveRelativeTo:f,insideDestination:l,viewport:i,afterCritical:o});if(!u)return null;const d=Xs({impact:u,draggable:t,droppable:c,draggables:a,afterCritical:o});return{clientSelection:s0({pageBorderBoxCenter:d,draggable:t,viewport:i}),impact:u,scrollJumpRequest:null}},et=e=>{const r=e.at;return r?r.type==="REORDER"?r.destination.droppableId:r.combine.droppableId:null};const $x=(e,r)=>{const t=et(e);return t?r[t]:null};var zx=({state:e,type:r})=>{const t=$x(e.impact,e.dimensions.droppables),n=!!t,a=e.dimensions.droppables[e.critical.droppable.id],s=t||a,i=s.axis.direction,o=i==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||i==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(o&&!n)return null;const c=r==="MOVE_DOWN"||r==="MOVE_RIGHT",l=e.dimensions.draggables[e.critical.draggable.id],f=e.current.page.borderBoxCenter,{draggables:u,droppables:d}=e.dimensions;return o?Bx({isMovingForward:c,previousPageBorderBoxCenter:f,draggable:l,destination:s,draggables:u,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):Vx({isMovingForward:c,previousPageBorderBoxCenter:f,draggable:l,isOver:s,draggables:u,droppables:d,viewport:e.viewport,afterCritical:e.afterCritical})};function tn(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function Kl(e){const r=ut(e.top,e.bottom),t=ut(e.left,e.right);return function(a){return r(a.y)&&t(a.x)}}function Xx(e,r){return e.left<r.right&&e.right>r.left&&e.top<r.bottom&&e.bottom>r.top}function Kx({pageBorderBox:e,draggable:r,candidates:t}){const n=r.page.borderBox.center,a=t.map(s=>{const i=s.axis,o=fn(s.axis.line,e.center[i.line],s.page.borderBox.center[i.crossAxisLine]);return{id:s.descriptor.id,distance:ya(n,o)}}).sort((s,i)=>i.distance-s.distance);return a[0]?a[0].id:null}function Yx({pageBorderBox:e,draggable:r,droppables:t}){const n=Vs(t).filter(a=>{if(!a.isEnabled)return!1;const s=a.subject.active;if(!s||!Xx(e,s))return!1;if(Kl(s)(e.center))return!0;const i=a.axis,o=s.center[i.crossAxisLine],c=e[i.crossAxisStart],l=e[i.crossAxisEnd],f=ut(s[i.crossAxisStart],s[i.crossAxisEnd]),u=f(c),d=f(l);return!u&&!d?!0:u?c<o:l>o});return n.length?n.length===1?n[0].descriptor.id:Kx({pageBorderBox:e,draggable:r,candidates:n}):null}const Yl=(e,r)=>gt(Ga(e,r));var qx=(e,r)=>{const t=e.frame;return t?Yl(r,t.scroll.diff.value):r};function ql({displaced:e,id:r}){return!!(e.visible[r]||e.invisible[r])}function Jx({draggable:e,closest:r,inHomeList:t}){return r?t&&r.descriptor.index>e.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var Zx=({pageBorderBoxWithDroppableScroll:e,draggable:r,destination:t,insideDestination:n,last:a,viewport:s,afterCritical:i})=>{const o=t.axis,c=Va(t.axis,r.displaceBy),l=c.value,f=e[o.start],u=e[o.end],h=zs(r,n).find(x=>{const m=x.descriptor.id,v=x.page.borderBox.center[o.line],E=zt(m,i),w=ql({displaced:a,id:m});return E?w?u<=v:f<v-l:w?u<=v+l:f<v})||null,p=Jx({draggable:r,closest:h,inHomeList:Hn(r,t)});return Cs({draggable:r,insideDestination:n,destination:t,viewport:s,last:a,displacedBy:c,index:p})};const Qx=4;var e1=({draggable:e,pageBorderBoxWithDroppableScroll:r,previousImpact:t,destination:n,insideDestination:a,afterCritical:s})=>{if(!n.isCombineEnabled)return null;const i=n.axis,o=Va(n.axis,e.displaceBy),c=o.value,l=r[i.start],f=r[i.end],d=zs(e,a).find(p=>{const x=p.descriptor.id,m=p.page.borderBox,E=m[i.size]/Qx,w=zt(x,s),A=ql({displaced:t.displaced,id:x});return w?A?f>m[i.start]+E&&f<m[i.end]-E:l>m[i.start]-c+E&&l<m[i.end]-c-E:A?f>m[i.start]+c+E&&f<m[i.end]+c-E:l>m[i.start]+E&&l<m[i.end]-E});return d?{displacedBy:o,displaced:t.displaced,at:{type:"COMBINE",combine:{draggableId:d.descriptor.id,droppableId:n.descriptor.id}}}:null},Jl=({pageOffset:e,draggable:r,draggables:t,droppables:n,previousImpact:a,viewport:s,afterCritical:i})=>{const o=Yl(r.page.borderBox,e),c=Yx({pageBorderBox:o,draggable:r,droppables:n});if(!c)return xx;const l=n[c],f=Wn(l.descriptor.id,t),u=qx(l,o);return e1({pageBorderBoxWithDroppableScroll:u,draggable:r,previousImpact:a,destination:l,insideDestination:f,afterCritical:i})||Zx({pageBorderBoxWithDroppableScroll:u,draggable:r,destination:l,insideDestination:f,last:a.displaced,viewport:s,afterCritical:i})},i0=(e,r)=>({...e,[r.descriptor.id]:r});const r1=({previousImpact:e,impact:r,droppables:t})=>{const n=et(e),a=et(r);if(!n||n===a)return t;const s=t[n];if(!s.subject.withPlaceholder)return t;const i=Hx(s);return i0(t,i)};var t1=({draggable:e,draggables:r,droppables:t,previousImpact:n,impact:a})=>{const s=r1({previousImpact:n,impact:a,droppables:t}),i=et(a);if(!i)return s;const o=t[i];if(Hn(e,o)||o.subject.withPlaceholder)return s;const c=Xl(o,e,r);return i0(s,c)},ca=({state:e,clientSelection:r,dimensions:t,viewport:n,impact:a,scrollJumpRequest:s})=>{const i=n||e.viewport,o=t||e.dimensions,c=r||e.current.client.selection,l=Qr(c,e.initial.client.selection),f={offset:l,selection:c,borderBoxCenter:Ar(e.initial.client.borderBoxCenter,l)},u={selection:Ar(f.selection,i.scroll.current),borderBoxCenter:Ar(f.borderBoxCenter,i.scroll.current),offset:Ar(f.offset,i.scroll.diff.value)},d={client:f,page:u};if(e.phase==="COLLECTING")return{...e,dimensions:o,viewport:i,current:d};const h=o.draggables[e.critical.draggable.id],p=a||Jl({pageOffset:u.offset,draggable:h,draggables:o.draggables,droppables:o.droppables,previousImpact:e.impact,viewport:i,afterCritical:e.afterCritical}),x=t1({draggable:h,impact:p,previousImpact:e.impact,draggables:o.draggables,droppables:o.droppables});return{...e,current:d,dimensions:{draggables:o.draggables,droppables:x},impact:p,viewport:i,scrollJumpRequest:s||null,forceShouldAnimate:s?!1:null}};function n1(e,r){return e.map(t=>r[t])}var Zl=({impact:e,viewport:r,draggables:t,destination:n,forceShouldAnimate:a})=>{const s=e.displaced,i=n1(s.all,t),o=ba({afterDragging:i,destination:n,displacedBy:e.displacedBy,viewport:r.frame,forceShouldAnimate:a,last:s});return{...e,displaced:o}},Ql=({impact:e,draggable:r,droppable:t,draggables:n,viewport:a,afterCritical:s})=>{const i=Xs({impact:e,draggable:r,draggables:n,droppable:t,afterCritical:s});return s0({pageBorderBoxCenter:i,draggable:r,viewport:a})},ef=({state:e,dimensions:r,viewport:t})=>{e.movementMode!=="SNAP"&&ce();const n=e.impact,a=t||e.viewport,s=r||e.dimensions,{draggables:i,droppables:o}=s,c=i[e.critical.draggable.id],l=et(n);l||ce();const f=o[l],u=Zl({impact:n,viewport:a,destination:f,draggables:i}),d=Ql({impact:u,draggable:c,droppable:f,draggables:i,viewport:a,afterCritical:e.afterCritical});return ca({impact:u,clientSelection:d,state:e,dimensions:s,viewport:a})},a1=e=>({index:e.index,droppableId:e.droppableId}),rf=({draggable:e,home:r,draggables:t,viewport:n})=>{const a=Va(r.axis,e.displaceBy),s=Wn(r.descriptor.id,t),i=s.indexOf(e);i===-1&&ce();const o=s.slice(i+1),c=o.reduce((d,h)=>(d[h.descriptor.id]=!0,d),{}),l={inVirtualList:r.descriptor.mode==="virtual",displacedBy:a,effected:c};return{impact:{displaced:ba({afterDragging:o,destination:r,displacedBy:a,last:null,viewport:n.frame,forceShouldAnimate:!1}),displacedBy:a,at:{type:"REORDER",destination:a1(e.descriptor)}},afterCritical:l}},s1=(e,r)=>({draggables:e.draggables,droppables:i0(e.droppables,r)}),i1=({draggable:e,offset:r,initialWindowScroll:t})=>{const n=bs(e.client,r),a=ks(n,t);return{...e,placeholder:{...e.placeholder,client:n},client:n,page:a}},o1=e=>{const r=e.frame;return r||ce(),r},c1=({additions:e,updatedDroppables:r,viewport:t})=>{const n=t.scroll.diff.value;return e.map(a=>{const s=a.descriptor.droppableId,i=r[s],c=o1(i).scroll.diff.value,l=Ar(n,c);return i1({draggable:a,offset:l,initialWindowScroll:t.scroll.initial})})},l1=({state:e,published:r})=>{const t=r.modified.map(v=>{const E=e.dimensions.droppables[v.droppableId];return e0(E,v.scroll)}),n={...e.dimensions.droppables,...Bl(t)},a=Ml(c1({additions:r.additions,updatedDroppables:n,viewport:e.viewport})),s={...e.dimensions.draggables,...a};r.removals.forEach(v=>{delete s[v]});const i={droppables:n,draggables:s},o=et(e.impact),c=o?i.droppables[o]:null,l=i.draggables[e.critical.draggable.id],f=i.droppables[e.critical.droppable.id],{impact:u,afterCritical:d}=rf({draggable:l,home:f,draggables:s,viewport:e.viewport}),h=c&&c.isCombineEnabled?e.impact:u,p=Jl({pageOffset:e.current.page.offset,draggable:i.draggables[e.critical.draggable.id],draggables:i.draggables,droppables:i.droppables,previousImpact:h,viewport:e.viewport,afterCritical:d}),x={...e,phase:"DRAGGING",impact:p,onLiftImpact:u,dimensions:i,afterCritical:d,forceShouldAnimate:!1};return e.phase==="COLLECTING"?x:{...x,phase:"DROP_PENDING",reason:e.reason,isWaiting:!1}};const Pi=e=>e.movementMode==="SNAP",di=(e,r,t)=>{const n=s1(e.dimensions,r);return!Pi(e)||t?ca({state:e,dimensions:n}):ef({state:e,dimensions:n})};function hi(e){return e.isDragging&&e.movementMode==="SNAP"?{...e,scrollJumpRequest:null}:e}const Io={phase:"IDLE",completed:null,shouldFlush:!1};var f1=(e=Io,r)=>{if(r.type==="FLUSH")return{...Io,shouldFlush:!0};if(r.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&ce();const{critical:t,clientSelection:n,viewport:a,dimensions:s,movementMode:i}=r.payload,o=s.draggables[t.draggable.id],c=s.droppables[t.droppable.id],l={selection:n,borderBoxCenter:o.client.borderBox.center,offset:Er},f={client:l,page:{selection:Ar(l.selection,a.scroll.initial),borderBoxCenter:Ar(l.selection,a.scroll.initial),offset:Ar(l.selection,a.scroll.diff.value)}},u=Vs(s.droppables).every(x=>!x.isFixedOnPage),{impact:d,afterCritical:h}=rf({draggable:o,home:c,draggables:s.draggables,viewport:a});return{phase:"DRAGGING",isDragging:!0,critical:t,movementMode:i,dimensions:s,initial:f,current:f,isWindowScrollAllowed:u,impact:d,afterCritical:h,onLiftImpact:d,viewport:a,scrollJumpRequest:null,forceShouldAnimate:null}}if(r.type==="COLLECTION_STARTING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"?e:(e.phase!=="DRAGGING"&&ce(),{...e,phase:"COLLECTING"});if(r.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||ce(),l1({state:e,published:r.payload});if(r.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;tn(e)||ce();const{client:t}=r.payload;return Vt(t,e.current.client.selection)?e:ca({state:e,clientSelection:t,impact:Pi(e)?e.impact:null})}if(r.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return hi(e);tn(e)||ce();const{id:t,newScroll:n}=r.payload,a=e.dimensions.droppables[t];if(!a)return e;const s=e0(a,n);return di(e,s,!1)}if(r.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;tn(e)||ce();const{id:t,isEnabled:n}=r.payload,a=e.dimensions.droppables[t];a||ce(),a.isEnabled===n&&ce();const s={...a,isEnabled:n};return di(e,s,!0)}if(r.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;tn(e)||ce();const{id:t,isCombineEnabled:n}=r.payload,a=e.dimensions.droppables[t];a||ce(),a.isCombineEnabled===n&&ce();const s={...a,isCombineEnabled:n};return di(e,s,!0)}if(r.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;tn(e)||ce(),e.isWindowScrollAllowed||ce();const t=r.payload.newScroll;if(Vt(e.viewport.scroll.current,t))return hi(e);const n=Vl(e.viewport,t);return Pi(e)?ef({state:e,viewport:n}):ca({state:e,viewport:n})}if(r.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!tn(e))return e;const t=r.payload.maxScroll;if(Vt(t,e.viewport.scroll.max))return e;const n={...e.viewport,scroll:{...e.viewport.scroll,max:t}};return{...e,viewport:n}}if(r.type==="MOVE_UP"||r.type==="MOVE_DOWN"||r.type==="MOVE_LEFT"||r.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&ce();const t=zx({state:e,type:r.type});return t?ca({state:e,impact:t.impact,clientSelection:t.clientSelection,scrollJumpRequest:t.scrollJumpRequest}):e}if(r.type==="DROP_PENDING"){const t=r.payload.reason;return e.phase!=="COLLECTING"&&ce(),{...e,phase:"DROP_PENDING",isWaiting:!0,reason:t}}if(r.type==="DROP_ANIMATE"){const{completed:t,dropDuration:n,newHomeClientOffset:a}=r.payload;return e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||ce(),{phase:"DROP_ANIMATING",completed:t,dropDuration:n,newHomeClientOffset:a,dimensions:e.dimensions}}if(r.type==="DROP_COMPLETE"){const{completed:t}=r.payload;return{phase:"IDLE",completed:t,shouldFlush:!1}}return e};function We(e,r){return e instanceof Object&&"type"in e&&e.type===r}const u1=e=>({type:"BEFORE_INITIAL_CAPTURE",payload:e}),d1=e=>({type:"LIFT",payload:e}),h1=e=>({type:"INITIAL_PUBLISH",payload:e}),x1=e=>({type:"PUBLISH_WHILE_DRAGGING",payload:e}),p1=()=>({type:"COLLECTION_STARTING",payload:null}),m1=e=>({type:"UPDATE_DROPPABLE_SCROLL",payload:e}),g1=e=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}),v1=e=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}),tf=e=>({type:"MOVE",payload:e}),_1=e=>({type:"MOVE_BY_WINDOW_SCROLL",payload:e}),w1=e=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}),y1=()=>({type:"MOVE_UP",payload:null}),E1=()=>({type:"MOVE_DOWN",payload:null}),b1=()=>({type:"MOVE_RIGHT",payload:null}),k1=()=>({type:"MOVE_LEFT",payload:null}),o0=()=>({type:"FLUSH",payload:null}),T1=e=>({type:"DROP_ANIMATE",payload:e}),c0=e=>({type:"DROP_COMPLETE",payload:e}),nf=e=>({type:"DROP",payload:e}),S1=e=>({type:"DROP_PENDING",payload:e}),af=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var A1=e=>({getState:r,dispatch:t})=>n=>a=>{if(!We(a,"LIFT")){n(a);return}const{id:s,clientSelection:i,movementMode:o}=a.payload,c=r();c.phase==="DROP_ANIMATING"&&t(c0({completed:c.completed})),r().phase!=="IDLE"&&ce(),t(o0()),t(u1({draggableId:s,movementMode:o}));const f={draggableId:s,scrollOptions:{shouldPublishImmediately:o==="SNAP"}},{critical:u,dimensions:d,viewport:h}=e.startPublishing(f);t(h1({critical:u,dimensions:d,clientSelection:i,movementMode:o,viewport:h}))},C1=e=>()=>r=>t=>{We(t,"INITIAL_PUBLISH")&&e.dragging(),We(t,"DROP_ANIMATE")&&e.dropping(t.payload.completed.result.reason),(We(t,"FLUSH")||We(t,"DROP_COMPLETE"))&&e.resting(),r(t)};const l0={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},ka={opacity:{drop:0,combining:.7},scale:{drop:.75}},sf={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},rn=`${sf.outOfTheWay}s ${l0.outOfTheWay}`,la={fluid:`opacity ${rn}`,snap:`transform ${rn}, opacity ${rn}`,drop:e=>{const r=`${e}s ${l0.drop}`;return`transform ${r}, opacity ${r}`},outOfTheWay:`transform ${rn}`,placeholder:`height ${rn}, width ${rn}, margin ${rn}`},No=e=>Vt(e,Er)?void 0:`translate(${e.x}px, ${e.y}px)`,Li={moveTo:No,drop:(e,r)=>{const t=No(e);if(t)return r?`${t} scale(${ka.scale.drop})`:t}},{minDropTime:Bi,maxDropTime:of}=sf,F1=of-Bi,Do=1500,I1=.6;var N1=({current:e,destination:r,reason:t})=>{const n=ya(e,r);if(n<=0)return Bi;if(n>=Do)return of;const a=n/Do,s=Bi+F1*a,i=t==="CANCEL"?s*I1:s;return Number(i.toFixed(2))},D1=({impact:e,draggable:r,dimensions:t,viewport:n,afterCritical:a})=>{const{draggables:s,droppables:i}=t,o=et(e),c=o?i[o]:null,l=i[r.descriptor.droppableId],f=Ql({impact:e,draggable:r,draggables:s,afterCritical:a,droppable:c||l,viewport:n});return Qr(f,r.client.borderBox.center)},O1=({draggables:e,reason:r,lastImpact:t,home:n,viewport:a,onLiftImpact:s})=>!t.at||r!=="DROP"?{impact:Zl({draggables:e,impact:s,destination:n,viewport:a,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:t.at.type==="REORDER"?{impact:t,didDropInsideDroppable:!0}:{impact:{...t,displaced:Ea},didDropInsideDroppable:!0};const R1=({getState:e,dispatch:r})=>t=>n=>{if(!We(n,"DROP")){t(n);return}const a=e(),s=n.payload.reason;if(a.phase==="COLLECTING"){r(S1({reason:s}));return}if(a.phase==="IDLE")return;a.phase==="DROP_PENDING"&&a.isWaiting&&ce(),a.phase==="DRAGGING"||a.phase==="DROP_PENDING"||ce();const o=a.critical,c=a.dimensions,l=c.draggables[a.critical.draggable.id],{impact:f,didDropInsideDroppable:u}=O1({reason:s,lastImpact:a.impact,afterCritical:a.afterCritical,onLiftImpact:a.onLiftImpact,home:a.dimensions.droppables[a.critical.droppable.id],viewport:a.viewport,draggables:a.dimensions.draggables}),d=u?r0(f):null,h=u?$s(f):null,p={index:o.draggable.index,droppableId:o.droppable.id},x={draggableId:l.descriptor.id,type:l.descriptor.type,source:p,reason:s,mode:a.movementMode,destination:d,combine:h},m=D1({impact:f,draggable:l,dimensions:c,viewport:a.viewport,afterCritical:a.afterCritical}),v={critical:a.critical,afterCritical:a.afterCritical,result:x,impact:f};if(!(!Vt(a.current.client.offset,m)||!!x.combine)){r(c0({completed:v}));return}const w=N1({current:a.current.client.offset,destination:m,reason:s});r(T1({newHomeClientOffset:m,dropDuration:w,completed:v}))};var cf=()=>({x:window.pageXOffset,y:window.pageYOffset});function P1(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:r=>{r.target!==window&&r.target!==window.document||e()}}}function L1({onWindowScroll:e}){function r(){e(cf())}const t=wa(r),n=P1(t);let a=Gt;function s(){return a!==Gt}function i(){s()&&ce(),a=ft(window,[n])}function o(){s()||ce(),t.cancel(),a(),a=Gt}return{start:i,stop:o,isActive:s}}const B1=e=>We(e,"DROP_COMPLETE")||We(e,"DROP_ANIMATE")||We(e,"FLUSH"),M1=e=>{const r=L1({onWindowScroll:t=>{e.dispatch(_1({newScroll:t}))}});return t=>n=>{!r.isActive()&&We(n,"INITIAL_PUBLISH")&&r.start(),r.isActive()&&B1(n)&&r.stop(),t(n)}};var j1=e=>{let r=!1,t=!1;const n=setTimeout(()=>{t=!0}),a=s=>{r||t||(r=!0,e(s),clearTimeout(n))};return a.wasCalled=()=>r,a},U1=()=>{const e=[],r=a=>{const s=e.findIndex(o=>o.timerId===a);s===-1&&ce();const[i]=e.splice(s,1);i.callback()};return{add:a=>{const s=setTimeout(()=>r(s)),i={timerId:s,callback:a};e.push(i)},flush:()=>{if(!e.length)return;const a=[...e];e.length=0,a.forEach(s=>{clearTimeout(s.timerId),s.callback()})}}};const W1=(e,r)=>e==null&&r==null?!0:e==null||r==null?!1:e.droppableId===r.droppableId&&e.index===r.index,H1=(e,r)=>e==null&&r==null?!0:e==null||r==null?!1:e.draggableId===r.draggableId&&e.droppableId===r.droppableId,G1=(e,r)=>{if(e===r)return!0;const t=e.draggable.id===r.draggable.id&&e.draggable.droppableId===r.draggable.droppableId&&e.draggable.type===r.draggable.type&&e.draggable.index===r.draggable.index,n=e.droppable.id===r.droppable.id&&e.droppable.type===r.droppable.type;return t&&n},Qn=(e,r)=>{r()},ts=(e,r)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:r});function xi(e,r,t,n){if(!e){t(n(r));return}const a=j1(t);e(r,{announce:a}),a.wasCalled()||t(n(r))}var V1=(e,r)=>{const t=U1();let n=null;const a=(u,d)=>{n&&ce(),Qn("onBeforeCapture",()=>{const h=e().onBeforeCapture;h&&h({draggableId:u,mode:d})})},s=(u,d)=>{n&&ce(),Qn("onBeforeDragStart",()=>{const h=e().onBeforeDragStart;h&&h(ts(u,d))})},i=(u,d)=>{n&&ce();const h=ts(u,d);n={mode:d,lastCritical:u,lastLocation:h.source,lastCombine:null},t.add(()=>{Qn("onDragStart",()=>xi(e().onDragStart,h,r,vs.onDragStart))})},o=(u,d)=>{const h=r0(d),p=$s(d);n||ce();const x=!G1(u,n.lastCritical);x&&(n.lastCritical=u);const m=!W1(n.lastLocation,h);m&&(n.lastLocation=h);const v=!H1(n.lastCombine,p);if(v&&(n.lastCombine=p),!x&&!m&&!v)return;const E={...ts(u,n.mode),combine:p,destination:h};t.add(()=>{Qn("onDragUpdate",()=>xi(e().onDragUpdate,E,r,vs.onDragUpdate))})},c=()=>{n||ce(),t.flush()},l=u=>{n||ce(),n=null,Qn("onDragEnd",()=>xi(e().onDragEnd,u,r,vs.onDragEnd))};return{beforeCapture:a,beforeStart:s,start:i,update:o,flush:c,drop:l,abort:()=>{if(!n)return;const u={...ts(n.lastCritical,n.mode),combine:null,destination:null,reason:"CANCEL"};l(u)}}},$1=(e,r)=>{const t=V1(e,r);return n=>a=>s=>{if(We(s,"BEFORE_INITIAL_CAPTURE")){t.beforeCapture(s.payload.draggableId,s.payload.movementMode);return}if(We(s,"INITIAL_PUBLISH")){const o=s.payload.critical;t.beforeStart(o,s.payload.movementMode),a(s),t.start(o,s.payload.movementMode);return}if(We(s,"DROP_COMPLETE")){const o=s.payload.completed.result;t.flush(),a(s),t.drop(o);return}if(a(s),We(s,"FLUSH")){t.abort();return}const i=n.getState();i.phase==="DRAGGING"&&t.update(i.critical,i.impact)}};const z1=e=>r=>t=>{if(!We(t,"DROP_ANIMATION_FINISHED")){r(t);return}const n=e.getState();n.phase!=="DROP_ANIMATING"&&ce(),e.dispatch(c0({completed:n.completed}))},X1=e=>{let r=null,t=null;function n(){t&&(cancelAnimationFrame(t),t=null),r&&(r(),r=null)}return a=>s=>{if((We(s,"FLUSH")||We(s,"DROP_COMPLETE")||We(s,"DROP_ANIMATION_FINISHED"))&&n(),a(s),!We(s,"DROP_ANIMATE"))return;const i={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){e.getState().phase==="DROP_ANIMATING"&&e.dispatch(af())}};t=requestAnimationFrame(()=>{t=null,r=ft(window,[i])})}};var K1=e=>()=>r=>t=>{(We(t,"DROP_COMPLETE")||We(t,"FLUSH")||We(t,"DROP_ANIMATE"))&&e.stopPublishing(),r(t)},Y1=e=>{let r=!1;return()=>t=>n=>{if(We(n,"INITIAL_PUBLISH")){r=!0,e.tryRecordFocus(n.payload.critical.draggable.id),t(n),e.tryRestoreFocusRecorded();return}if(t(n),!!r){if(We(n,"FLUSH")){r=!1,e.tryRestoreFocusRecorded();return}if(We(n,"DROP_COMPLETE")){r=!1;const a=n.payload.completed.result;a.combine&&e.tryShiftRecord(a.draggableId,a.combine.draggableId),e.tryRestoreFocusRecorded()}}}};const q1=e=>We(e,"DROP_COMPLETE")||We(e,"DROP_ANIMATE")||We(e,"FLUSH");var J1=e=>r=>t=>n=>{if(q1(n)){e.stop(),t(n);return}if(We(n,"INITIAL_PUBLISH")){t(n);const a=r.getState();a.phase!=="DRAGGING"&&ce(),e.start(a);return}t(n),e.scroll(r.getState())};const Z1=e=>r=>t=>{if(r(t),!We(t,"PUBLISH_WHILE_DRAGGING"))return;const n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(nf({reason:n.reason})))},Q1=Eh;var ep=({dimensionMarshal:e,focusMarshal:r,styleMarshal:t,getResponders:n,announce:a,autoScroller:s})=>yh(f1,Q1(bh(C1(t),K1(e),A1(e),R1,z1,X1,Z1,J1(s),M1,Y1(r),$1(n,a))));const pi=()=>({additions:{},removals:{},modified:{}});function rp({registry:e,callbacks:r}){let t=pi(),n=null;const a=()=>{n||(r.collectionStarting(),n=requestAnimationFrame(()=>{n=null;const{additions:c,removals:l,modified:f}=t,u=Object.keys(c).map(p=>e.draggable.getById(p).getDimension(Er)).sort((p,x)=>p.descriptor.index-x.descriptor.index),d=Object.keys(f).map(p=>{const m=e.droppable.getById(p).callbacks.getScrollWhileDragging();return{droppableId:p,scroll:m}}),h={additions:u,removals:Object.keys(l),modified:d};t=pi(),r.publish(h)}))};return{add:c=>{const l=c.descriptor.id;t.additions[l]=c,t.modified[c.descriptor.droppableId]=!0,t.removals[l]&&delete t.removals[l],a()},remove:c=>{const l=c.descriptor;t.removals[l.id]=!0,t.modified[l.droppableId]=!0,t.additions[l.id]&&delete t.additions[l.id],a()},stop:()=>{n&&(cancelAnimationFrame(n),n=null,t=pi())}}}var lf=({scrollHeight:e,scrollWidth:r,height:t,width:n})=>{const a=Qr({x:r,y:e},{x:n,y:t});return{x:Math.max(0,a.x),y:Math.max(0,a.y)}},ff=()=>{const e=document.documentElement;return e||ce(),e},uf=()=>{const e=ff();return lf({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},tp=()=>{const e=cf(),r=uf(),t=e.y,n=e.x,a=ff(),s=a.clientWidth,i=a.clientHeight,o=n+s,c=t+i;return{frame:gt({top:t,left:n,right:o,bottom:c}),scroll:{initial:e,current:e,max:r,diff:{value:Er,displacement:Er}}}},np=({critical:e,scrollOptions:r,registry:t})=>{const n=tp(),a=n.scroll.current,s=e.droppable,i=t.droppable.getAllByType(s.type).map(f=>f.callbacks.getDimensionAndWatchScroll(a,r)),o=t.draggable.getAllByType(e.draggable.type).map(f=>f.getDimension(a));return{dimensions:{draggables:Ml(o),droppables:Bl(i)},critical:e,viewport:n}};function Oo(e,r,t){return!(t.descriptor.id===r.id||t.descriptor.type!==r.type||e.droppable.getById(t.descriptor.droppableId).descriptor.mode!=="virtual")}var ap=(e,r)=>{let t=null;const n=rp({callbacks:{publish:r.publishWhileDragging,collectionStarting:r.collectionStarting},registry:e}),a=(d,h)=>{e.droppable.exists(d)||ce(),t&&r.updateDroppableIsEnabled({id:d,isEnabled:h})},s=(d,h)=>{t&&(e.droppable.exists(d)||ce(),r.updateDroppableIsCombineEnabled({id:d,isCombineEnabled:h}))},i=(d,h)=>{t&&(e.droppable.exists(d)||ce(),r.updateDroppableScroll({id:d,newScroll:h}))},o=(d,h)=>{t&&e.droppable.getById(d).callbacks.scroll(h)},c=()=>{if(!t)return;n.stop();const d=t.critical.droppable;e.droppable.getAllByType(d.type).forEach(h=>h.callbacks.dragStopped()),t.unsubscribe(),t=null},l=d=>{t||ce();const h=t.critical.draggable;d.type==="ADDITION"&&Oo(e,h,d.value)&&n.add(d.value),d.type==="REMOVAL"&&Oo(e,h,d.value)&&n.remove(d.value)};return{updateDroppableIsEnabled:a,updateDroppableIsCombineEnabled:s,scrollDroppable:o,updateDroppableScroll:i,startPublishing:d=>{t&&ce();const h=e.draggable.getById(d.draggableId),p=e.droppable.getById(h.descriptor.droppableId),x={draggable:h.descriptor,droppable:p.descriptor},m=e.subscribe(l);return t={critical:x,unsubscribe:m},np({critical:x,registry:e,scrollOptions:d.scrollOptions})},stopPublishing:c}},df=(e,r)=>e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===r?!1:e.completed.result.reason==="DROP",sp=e=>{window.scrollBy(e.x,e.y)};const ip=yr(e=>Vs(e).filter(r=>!(!r.isEnabled||!r.frame))),op=(e,r)=>ip(r).find(n=>(n.frame||ce(),Kl(n.frame.pageMarginBox)(e)))||null;var cp=({center:e,destination:r,droppables:t})=>{if(r){const a=t[r];return a.frame?a:null}return op(e,t)};const Ta={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var lp=(e,r,t=()=>Ta)=>{const n=t(),a=e[r.size]*n.startFromPercentage,s=e[r.size]*n.maxScrollAtPercentage;return{startScrollingFrom:a,maxScrollValueAt:s}},hf=({startOfRange:e,endOfRange:r,current:t})=>{const n=r-e;return n===0?0:(t-e)/n},f0=1,fp=(e,r,t=()=>Ta)=>{const n=t();if(e>r.startScrollingFrom)return 0;if(e<=r.maxScrollValueAt)return n.maxPixelScroll;if(e===r.startScrollingFrom)return f0;const s=1-hf({startOfRange:r.maxScrollValueAt,endOfRange:r.startScrollingFrom,current:e}),i=n.maxPixelScroll*n.ease(s);return Math.ceil(i)},up=(e,r,t)=>{const n=t(),a=n.durationDampening.accelerateAt,s=n.durationDampening.stopDampeningAt,i=r,o=s,l=Date.now()-i;if(l>=s)return e;if(l<a)return f0;const f=hf({startOfRange:a,endOfRange:o,current:l}),u=e*n.ease(f);return Math.ceil(u)},Ro=({distanceToEdge:e,thresholds:r,dragStartTime:t,shouldUseTimeDampening:n,getAutoScrollerOptions:a})=>{const s=fp(e,r,a);return s===0?0:n?Math.max(up(s,t,a),f0):s},Po=({container:e,distanceToEdges:r,dragStartTime:t,axis:n,shouldUseTimeDampening:a,getAutoScrollerOptions:s})=>{const i=lp(e,n,s);return r[n.end]<r[n.start]?Ro({distanceToEdge:r[n.end],thresholds:i,dragStartTime:t,shouldUseTimeDampening:a,getAutoScrollerOptions:s}):-1*Ro({distanceToEdge:r[n.start],thresholds:i,dragStartTime:t,shouldUseTimeDampening:a,getAutoScrollerOptions:s})},dp=({container:e,subject:r,proposedScroll:t})=>{const n=r.height>e.height,a=r.width>e.width;return!a&&!n?t:a&&n?null:{x:a?0:t.x,y:n?0:t.y}};const hp=Ll(e=>e===0?0:e);var xf=({dragStartTime:e,container:r,subject:t,center:n,shouldUseTimeDampening:a,getAutoScrollerOptions:s})=>{const i={top:n.y-r.top,right:r.right-n.x,bottom:r.bottom-n.y,left:n.x-r.left},o=Po({container:r,distanceToEdges:i,dragStartTime:e,axis:t0,shouldUseTimeDampening:a,getAutoScrollerOptions:s}),c=Po({container:r,distanceToEdges:i,dragStartTime:e,axis:Wl,shouldUseTimeDampening:a,getAutoScrollerOptions:s}),l=hp({x:c,y:o});if(Vt(l,Er))return null;const f=dp({container:r,subject:t,proposedScroll:l});return f?Vt(f,Er)?null:f:null};const xp=Ll(e=>e===0?0:e>0?1:-1),u0=(()=>{const e=(r,t)=>r<0?r:r>t?r-t:0;return({current:r,max:t,change:n})=>{const a=Ar(r,n),s={x:e(a.x,t.x),y:e(a.y,t.y)};return Vt(s,Er)?null:s}})(),pf=({max:e,current:r,change:t})=>{const n={x:Math.max(r.x,e.x),y:Math.max(r.y,e.y)},a=xp(t),s=u0({max:n,current:r,change:a});return!s||a.x!==0&&s.x===0||a.y!==0&&s.y===0},d0=(e,r)=>pf({current:e.scroll.current,max:e.scroll.max,change:r}),pp=(e,r)=>{if(!d0(e,r))return null;const t=e.scroll.max,n=e.scroll.current;return u0({current:n,max:t,change:r})},h0=(e,r)=>{const t=e.frame;return t?pf({current:t.scroll.current,max:t.scroll.max,change:r}):!1},mp=(e,r)=>{const t=e.frame;return!t||!h0(e,r)?null:u0({current:t.scroll.current,max:t.scroll.max,change:r})};var gp=({viewport:e,subject:r,center:t,dragStartTime:n,shouldUseTimeDampening:a,getAutoScrollerOptions:s})=>{const i=xf({dragStartTime:n,container:e.frame,subject:r,center:t,shouldUseTimeDampening:a,getAutoScrollerOptions:s});return i&&d0(e,i)?i:null},vp=({droppable:e,subject:r,center:t,dragStartTime:n,shouldUseTimeDampening:a,getAutoScrollerOptions:s})=>{const i=e.frame;if(!i)return null;const o=xf({dragStartTime:n,container:i.pageMarginBox,subject:r,center:t,shouldUseTimeDampening:a,getAutoScrollerOptions:s});return o&&h0(e,o)?o:null},Lo=({state:e,dragStartTime:r,shouldUseTimeDampening:t,scrollWindow:n,scrollDroppable:a,getAutoScrollerOptions:s})=>{const i=e.current.page.borderBoxCenter,c=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){const u=e.viewport,d=gp({dragStartTime:r,viewport:u,subject:c,center:i,shouldUseTimeDampening:t,getAutoScrollerOptions:s});if(d){n(d);return}}const l=cp({center:i,destination:et(e.impact),droppables:e.dimensions.droppables});if(!l)return;const f=vp({dragStartTime:r,droppable:l,subject:c,center:i,shouldUseTimeDampening:t,getAutoScrollerOptions:s});f&&a(l.descriptor.id,f)},_p=({scrollWindow:e,scrollDroppable:r,getAutoScrollerOptions:t=()=>Ta})=>{const n=wa(e),a=wa(r);let s=null;const i=l=>{s||ce();const{shouldUseTimeDampening:f,dragStartTime:u}=s;Lo({state:l,scrollWindow:n,scrollDroppable:a,dragStartTime:u,shouldUseTimeDampening:f,getAutoScrollerOptions:t})};return{start:l=>{s&&ce();const f=Date.now();let u=!1;const d=()=>{u=!0};Lo({state:l,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:d,scrollDroppable:d,getAutoScrollerOptions:t}),s={dragStartTime:f,shouldUseTimeDampening:u},u&&i(l)},stop:()=>{s&&(n.cancel(),a.cancel(),s=null)},scroll:i}},wp=({move:e,scrollDroppable:r,scrollWindow:t})=>{const n=(o,c)=>{const l=Ar(o.current.client.selection,c);e({client:l})},a=(o,c)=>{if(!h0(o,c))return c;const l=mp(o,c);if(!l)return r(o.descriptor.id,c),null;const f=Qr(c,l);return r(o.descriptor.id,f),Qr(c,f)},s=(o,c,l)=>{if(!o||!d0(c,l))return l;const f=pp(c,l);if(!f)return t(l),null;const u=Qr(l,f);return t(u),Qr(l,u)};return o=>{const c=o.scrollJumpRequest;if(!c)return;const l=et(o.impact);l||ce();const f=a(o.dimensions.droppables[l],c);if(!f)return;const u=o.viewport,d=s(o.isWindowScrollAllowed,u,f);d&&n(o,d)}},yp=({scrollDroppable:e,scrollWindow:r,move:t,getAutoScrollerOptions:n})=>{const a=_p({scrollWindow:r,scrollDroppable:e,getAutoScrollerOptions:n}),s=wp({move:t,scrollWindow:r,scrollDroppable:e});return{scroll:c=>{if(!(n().disabled||c.phase!=="DRAGGING")){if(c.movementMode==="FLUID"){a.scroll(c);return}c.scrollJumpRequest&&s(c)}},start:a.start,stop:a.stop}};const Pn="data-rfd",Ln=(()=>{const e=`${Pn}-drag-handle`;return{base:e,draggableId:`${e}-draggable-id`,contextId:`${e}-context-id`}})(),Mi=(()=>{const e=`${Pn}-draggable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),Ep=(()=>{const e=`${Pn}-droppable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),Bo={contextId:`${Pn}-scroll-container-context-id`},bp=e=>r=>`[${r}="${e}"]`,ea=(e,r)=>e.map(t=>{const n=t.styles[r];return n?`${t.selector} { ${n} }`:""}).join(" "),kp="pointer-events: none;";var Tp=e=>{const r=bp(e),t=(()=>{const o=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:r(Ln.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:o,dragging:kp,dropAnimating:o}}})(),n=(()=>{const o=`
      transition: ${la.outOfTheWay};
    `;return{selector:r(Mi.contextId),styles:{dragging:o,dropAnimating:o,userCancel:o}}})(),a={selector:r(Ep.contextId),styles:{always:"overflow-anchor: none;"}},i=[n,t,a,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:ea(i,"always"),resting:ea(i,"resting"),dragging:ea(i,"dragging"),dropAnimating:ea(i,"dropAnimating"),userCancel:ea(i,"userCancel")}};const rt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?fe.useLayoutEffect:fe.useEffect,mi=()=>{const e=document.querySelector("head");return e||ce(),e},Mo=e=>{const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.type="text/css",r};function Sp(e,r){const t=Le(()=>Tp(e),[e]),n=fe.useRef(null),a=fe.useRef(null),s=_e(yr(u=>{const d=a.current;d||ce(),d.textContent=u}),[]),i=_e(u=>{const d=n.current;d||ce(),d.textContent=u},[]);rt(()=>{!n.current&&!a.current||ce();const u=Mo(r),d=Mo(r);return n.current=u,a.current=d,u.setAttribute(`${Pn}-always`,e),d.setAttribute(`${Pn}-dynamic`,e),mi().appendChild(u),mi().appendChild(d),i(t.always),s(t.resting),()=>{const h=p=>{const x=p.current;x||ce(),mi().removeChild(x),p.current=null};h(n),h(a)}},[r,i,s,t.always,t.resting,e]);const o=_e(()=>s(t.dragging),[s,t.dragging]),c=_e(u=>{if(u==="DROP"){s(t.dropAnimating);return}s(t.userCancel)},[s,t.dropAnimating,t.userCancel]),l=_e(()=>{a.current&&s(t.resting)},[s,t.resting]);return Le(()=>({dragging:o,dropping:c,resting:l}),[o,c,l])}function mf(e,r){return Array.from(e.querySelectorAll(r))}var gf=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function Ks(e){return e instanceof gf(e).HTMLElement}function Ap(e,r){const t=`[${Ln.contextId}="${e}"]`,n=mf(document,t);if(!n.length)return null;const a=n.find(s=>s.getAttribute(Ln.draggableId)===r);return!a||!Ks(a)?null:a}function Cp(e){const r=fe.useRef({}),t=fe.useRef(null),n=fe.useRef(null),a=fe.useRef(!1),s=_e(function(d,h){const p={id:d,focus:h};return r.current[d]=p,function(){const m=r.current;m[d]!==p&&delete m[d]}},[]),i=_e(function(d){const h=Ap(e,d);h&&h!==document.activeElement&&h.focus()},[e]),o=_e(function(d,h){t.current===d&&(t.current=h)},[]),c=_e(function(){n.current||a.current&&(n.current=requestAnimationFrame(()=>{n.current=null;const d=t.current;d&&i(d)}))},[i]),l=_e(function(d){t.current=null;const h=document.activeElement;h&&h.getAttribute(Ln.draggableId)===d&&(t.current=d)},[]);return rt(()=>(a.current=!0,function(){a.current=!1;const d=n.current;d&&cancelAnimationFrame(d)}),[]),Le(()=>({register:s,tryRecordFocus:l,tryRestoreFocusRecorded:c,tryShiftRecord:o}),[s,l,c,o])}function Fp(){const e={draggables:{},droppables:{}},r=[];function t(u){return r.push(u),function(){const h=r.indexOf(u);h!==-1&&r.splice(h,1)}}function n(u){r.length&&r.forEach(d=>d(u))}function a(u){return e.draggables[u]||null}function s(u){const d=a(u);return d||ce(),d}const i={register:u=>{e.draggables[u.descriptor.id]=u,n({type:"ADDITION",value:u})},update:(u,d)=>{const h=e.draggables[d.descriptor.id];h&&h.uniqueId===u.uniqueId&&(delete e.draggables[d.descriptor.id],e.draggables[u.descriptor.id]=u)},unregister:u=>{const d=u.descriptor.id,h=a(d);h&&u.uniqueId===h.uniqueId&&(delete e.draggables[d],e.droppables[u.descriptor.droppableId]&&n({type:"REMOVAL",value:u}))},getById:s,findById:a,exists:u=>!!a(u),getAllByType:u=>Object.values(e.draggables).filter(d=>d.descriptor.type===u)};function o(u){return e.droppables[u]||null}function c(u){const d=o(u);return d||ce(),d}const l={register:u=>{e.droppables[u.descriptor.id]=u},unregister:u=>{const d=o(u.descriptor.id);d&&u.uniqueId===d.uniqueId&&delete e.droppables[u.descriptor.id]},getById:c,findById:o,exists:u=>!!o(u),getAllByType:u=>Object.values(e.droppables).filter(d=>d.descriptor.type===u)};function f(){e.draggables={},e.droppables={},r.length=0}return{draggable:i,droppable:l,subscribe:t,clean:f}}function Ip(){const e=Le(Fp,[]);return fe.useEffect(()=>function(){e.clean()},[e]),e}var x0=Je.createContext(null),Fs=()=>{const e=document.body;return e||ce(),e};const Np={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},Dp=e=>`rfd-announcement-${e}`;function Op(e){const r=Le(()=>Dp(e),[e]),t=fe.useRef(null);return fe.useEffect(function(){const s=document.createElement("div");return t.current=s,s.id=r,s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true"),Ts(s.style,Np),Fs().appendChild(s),function(){setTimeout(function(){const c=Fs();c.contains(s)&&c.removeChild(s),s===t.current&&(t.current=null)})}},[r]),_e(a=>{const s=t.current;if(s){s.textContent=a;return}},[])}const Rp={separator:"::"};function p0(e,r=Rp){const t=Je.useId();return Le(()=>`${e}${r.separator}${t}`,[r.separator,e,t])}function Pp({contextId:e,uniqueId:r}){return`rfd-hidden-text-${e}-${r}`}function Lp({contextId:e,text:r}){const t=p0("hidden-text",{separator:"-"}),n=Le(()=>Pp({contextId:e,uniqueId:t}),[t,e]);return fe.useEffect(function(){const s=document.createElement("div");return s.id=n,s.textContent=r,s.style.display="none",Fs().appendChild(s),function(){const o=Fs();o.contains(s)&&o.removeChild(s)}},[n,r]),n}var Ys=Je.createContext(null);function vf(e){const r=fe.useRef(e);return fe.useEffect(()=>{r.current=e}),r}function Bp(){let e=null;function r(){return!!e}function t(i){return i===e}function n(i){e&&ce();const o={abandon:i};return e=o,o}function a(){e||ce(),e=null}function s(){e&&(e.abandon(),a())}return{isClaimed:r,isActive:t,claim:n,release:a,tryAbandon:s}}function Sa(e){return e.phase==="IDLE"||e.phase==="DROP_ANIMATING"?!1:e.isDragging}const Mp=9,jp=13,m0=27,_f=32,Up=33,Wp=34,Hp=35,Gp=36,Vp=37,$p=38,zp=39,Xp=40,Kp={[jp]:!0,[Mp]:!0};var wf=e=>{Kp[e.keyCode]&&e.preventDefault()};const qs=(()=>{const e="visibilitychange";return typeof document>"u"?e:[e,`ms${e}`,`webkit${e}`,`moz${e}`,`o${e}`].find(n=>`on${n}`in document)||e})(),yf=0,jo=5;function Yp(e,r){return Math.abs(r.x-e.x)>=jo||Math.abs(r.y-e.y)>=jo}const Uo={type:"IDLE"};function qp({cancel:e,completed:r,getPhase:t,setPhase:n}){return[{eventName:"mousemove",fn:a=>{const{button:s,clientX:i,clientY:o}=a;if(s!==yf)return;const c={x:i,y:o},l=t();if(l.type==="DRAGGING"){a.preventDefault(),l.actions.move(c);return}l.type!=="PENDING"&&ce();const f=l.point;if(!Yp(f,c))return;a.preventDefault();const u=l.actions.fluidLift(c);n({type:"DRAGGING",actions:u})}},{eventName:"mouseup",fn:a=>{const s=t();if(s.type!=="DRAGGING"){e();return}a.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:a=>{t().type==="DRAGGING"&&a.preventDefault(),e()}},{eventName:"keydown",fn:a=>{if(t().type==="PENDING"){e();return}if(a.keyCode===m0){a.preventDefault(),e();return}wf(a)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{t().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:a=>{const s=t();if(s.type==="IDLE"&&ce(),s.actions.shouldRespectForcePress()){e();return}a.preventDefault()}},{eventName:qs,fn:e}]}function Jp(e){const r=fe.useRef(Uo),t=fe.useRef(Gt),n=Le(()=>({eventName:"mousedown",fn:function(u){if(u.defaultPrevented||u.button!==yf||u.ctrlKey||u.metaKey||u.shiftKey||u.altKey)return;const d=e.findClosestDraggableId(u);if(!d)return;const h=e.tryGetLock(d,i,{sourceEvent:u});if(!h)return;u.preventDefault();const p={x:u.clientX,y:u.clientY};t.current(),l(h,p)}}),[e]),a=Le(()=>({eventName:"webkitmouseforcewillbegin",fn:f=>{if(f.defaultPrevented)return;const u=e.findClosestDraggableId(f);if(!u)return;const d=e.findOptionsForDraggable(u);d&&(d.shouldRespectForcePress||e.canGetLock(u)&&f.preventDefault())}}),[e]),s=_e(function(){const u={passive:!1,capture:!0};t.current=ft(window,[a,n],u)},[a,n]),i=_e(()=>{r.current.type!=="IDLE"&&(r.current=Uo,t.current(),s())},[s]),o=_e(()=>{const f=r.current;i(),f.type==="DRAGGING"&&f.actions.cancel({shouldBlockNextClick:!0}),f.type==="PENDING"&&f.actions.abort()},[i]),c=_e(function(){const u={capture:!0,passive:!1},d=qp({cancel:o,completed:i,getPhase:()=>r.current,setPhase:h=>{r.current=h}});t.current=ft(window,d,u)},[o,i]),l=_e(function(u,d){r.current.type!=="IDLE"&&ce(),r.current={type:"PENDING",point:d,actions:u},c()},[c]);rt(function(){return s(),function(){t.current()}},[s])}function Zp(){}const Qp={[Wp]:!0,[Up]:!0,[Gp]:!0,[Hp]:!0};function em(e,r){function t(){r(),e.cancel()}function n(){r(),e.drop()}return[{eventName:"keydown",fn:a=>{if(a.keyCode===m0){a.preventDefault(),t();return}if(a.keyCode===_f){a.preventDefault(),n();return}if(a.keyCode===Xp){a.preventDefault(),e.moveDown();return}if(a.keyCode===$p){a.preventDefault(),e.moveUp();return}if(a.keyCode===zp){a.preventDefault(),e.moveRight();return}if(a.keyCode===Vp){a.preventDefault(),e.moveLeft();return}if(Qp[a.keyCode]){a.preventDefault();return}wf(a)}},{eventName:"mousedown",fn:t},{eventName:"mouseup",fn:t},{eventName:"click",fn:t},{eventName:"touchstart",fn:t},{eventName:"resize",fn:t},{eventName:"wheel",fn:t,options:{passive:!0}},{eventName:qs,fn:t}]}function rm(e){const r=fe.useRef(Zp),t=Le(()=>({eventName:"keydown",fn:function(s){if(s.defaultPrevented||s.keyCode!==_f)return;const i=e.findClosestDraggableId(s);if(!i)return;const o=e.tryGetLock(i,f,{sourceEvent:s});if(!o)return;s.preventDefault();let c=!0;const l=o.snapLift();r.current();function f(){c||ce(),c=!1,r.current(),n()}r.current=ft(window,em(l,f),{capture:!0,passive:!1})}}),[e]),n=_e(function(){const s={passive:!1,capture:!0};r.current=ft(window,[t],s)},[t]);rt(function(){return n(),function(){r.current()}},[n])}const gi={type:"IDLE"},tm=120,nm=.15;function am({cancel:e,getPhase:r}){return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:t=>{t.preventDefault()}},{eventName:"keydown",fn:t=>{if(r().type!=="DRAGGING"){e();return}t.keyCode===m0&&t.preventDefault(),e()}},{eventName:qs,fn:e}]}function sm({cancel:e,completed:r,getPhase:t}){return[{eventName:"touchmove",options:{capture:!1},fn:n=>{const a=t();if(a.type!=="DRAGGING"){e();return}a.hasMoved=!0;const{clientX:s,clientY:i}=n.touches[0],o={x:s,y:i};n.preventDefault(),a.actions.move(o)}},{eventName:"touchend",fn:n=>{const a=t();if(a.type!=="DRAGGING"){e();return}n.preventDefault(),a.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:n=>{if(t().type!=="DRAGGING"){e();return}n.preventDefault(),e()}},{eventName:"touchforcechange",fn:n=>{const a=t();a.type==="IDLE"&&ce();const s=n.touches[0];if(!s||!(s.force>=nm))return;const o=a.actions.shouldRespectForcePress();if(a.type==="PENDING"){o&&e();return}if(o){if(a.hasMoved){n.preventDefault();return}e();return}n.preventDefault()}},{eventName:qs,fn:e}]}function im(e){const r=fe.useRef(gi),t=fe.useRef(Gt),n=_e(function(){return r.current},[]),a=_e(function(h){r.current=h},[]),s=Le(()=>({eventName:"touchstart",fn:function(h){if(h.defaultPrevented)return;const p=e.findClosestDraggableId(h);if(!p)return;const x=e.tryGetLock(p,o,{sourceEvent:h});if(!x)return;const m=h.touches[0],{clientX:v,clientY:E}=m,w={x:v,y:E};t.current(),u(x,w)}}),[e]),i=_e(function(){const h={capture:!0,passive:!1};t.current=ft(window,[s],h)},[s]),o=_e(()=>{const d=r.current;d.type!=="IDLE"&&(d.type==="PENDING"&&clearTimeout(d.longPressTimerId),a(gi),t.current(),i())},[i,a]),c=_e(()=>{const d=r.current;o(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[o]),l=_e(function(){const h={capture:!0,passive:!1},p={cancel:c,completed:o,getPhase:n},x=ft(window,sm(p),h),m=ft(window,am(p),h);t.current=function(){x(),m()}},[c,n,o]),f=_e(function(){const h=n();h.type!=="PENDING"&&ce();const p=h.actions.fluidLift(h.point);a({type:"DRAGGING",actions:p,hasMoved:!1})},[n,a]),u=_e(function(h,p){n().type!=="IDLE"&&ce();const x=setTimeout(f,tm);a({type:"PENDING",point:p,actions:h,longPressTimerId:x}),l()},[l,n,a,f]);rt(function(){return i(),function(){t.current();const p=n();p.type==="PENDING"&&(clearTimeout(p.longPressTimerId),a(gi))}},[n,i,a]),rt(function(){return ft(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const om=["input","button","textarea","select","option","optgroup","video","audio"];function Ef(e,r){if(r==null)return!1;if(om.includes(r.tagName.toLowerCase()))return!0;const n=r.getAttribute("contenteditable");return n==="true"||n===""?!0:r===e?!1:Ef(e,r.parentElement)}function cm(e,r){const t=r.target;return Ks(t)?Ef(e,t):!1}var lm=e=>gt(e.getBoundingClientRect()).center;function fm(e){return e instanceof gf(e).Element}const um=(()=>{const e="matches";return typeof document>"u"?e:[e,"msMatchesSelector","webkitMatchesSelector"].find(n=>n in Element.prototype)||e})();function bf(e,r){return e==null?null:e[um](r)?e:bf(e.parentElement,r)}function dm(e,r){return e.closest?e.closest(r):bf(e,r)}function hm(e){return`[${Ln.contextId}="${e}"]`}function xm(e,r){const t=r.target;if(!fm(t))return null;const n=hm(e),a=dm(t,n);return!a||!Ks(a)?null:a}function pm(e,r){const t=xm(e,r);return t?t.getAttribute(Ln.draggableId):null}function mm(e,r){const t=`[${Mi.contextId}="${e}"]`,a=mf(document,t).find(s=>s.getAttribute(Mi.id)===r);return!a||!Ks(a)?null:a}function gm(e){e.preventDefault()}function ns({expected:e,phase:r,isLockActive:t,shouldWarn:n}){return!(!t()||e!==r)}function kf({lockAPI:e,store:r,registry:t,draggableId:n}){if(e.isClaimed())return!1;const a=t.draggable.findById(n);return!(!a||!a.options.isEnabled||!df(r.getState(),n))}function vm({lockAPI:e,contextId:r,store:t,registry:n,draggableId:a,forceSensorStop:s,sourceEvent:i}){if(!kf({lockAPI:e,store:t,registry:n,draggableId:a}))return null;const c=n.draggable.getById(a),l=mm(r,c.descriptor.id);if(!l||i&&!c.options.canDragInteractiveElements&&cm(l,i))return null;const f=e.claim(s||Gt);let u="PRE_DRAG";function d(){return c.options.shouldRespectForcePress}function h(){return e.isActive(f)}function p(D,N){ns({expected:D,phase:u,isLockActive:h,shouldWarn:!0})&&t.dispatch(N())}const x=p.bind(null,"DRAGGING");function m(D){function N(){e.release(),u="COMPLETED"}u!=="PRE_DRAG"&&(N(),ce()),t.dispatch(d1(D.liftActionArgs)),u="DRAGGING";function k(L,O={shouldBlockNextClick:!1}){if(D.cleanup(),O.shouldBlockNextClick){const W=ft(window,[{eventName:"click",fn:gm,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(W)}N(),t.dispatch(nf({reason:L}))}return{isActive:()=>ns({expected:"DRAGGING",phase:u,isLockActive:h,shouldWarn:!1}),shouldRespectForcePress:d,drop:L=>k("DROP",L),cancel:L=>k("CANCEL",L),...D.actions}}function v(D){const N=wa(L=>{x(()=>tf({client:L}))});return{...m({liftActionArgs:{id:a,clientSelection:D,movementMode:"FLUID"},cleanup:()=>N.cancel(),actions:{move:N}}),move:N}}function E(){const D={moveUp:()=>x(y1),moveRight:()=>x(b1),moveDown:()=>x(E1),moveLeft:()=>x(k1)};return m({liftActionArgs:{id:a,clientSelection:lm(l),movementMode:"SNAP"},cleanup:Gt,actions:D})}function w(){ns({expected:"PRE_DRAG",phase:u,isLockActive:h,shouldWarn:!0})&&e.release()}return{isActive:()=>ns({expected:"PRE_DRAG",phase:u,isLockActive:h,shouldWarn:!1}),shouldRespectForcePress:d,fluidLift:v,snapLift:E,abort:w}}const _m=[Jp,rm,im];function wm({contextId:e,store:r,registry:t,customSensors:n,enableDefaultSensors:a}){const s=[...a?_m:[],...n||[]],i=fe.useState(()=>Bp())[0],o=_e(function(m,v){Sa(m)&&!Sa(v)&&i.tryAbandon()},[i]);rt(function(){let m=r.getState();return r.subscribe(()=>{const E=r.getState();o(m,E),m=E})},[i,r,o]),rt(()=>i.tryAbandon,[i.tryAbandon]);const c=_e(x=>kf({lockAPI:i,registry:t,store:r,draggableId:x}),[i,t,r]),l=_e((x,m,v)=>vm({lockAPI:i,registry:t,contextId:e,store:r,draggableId:x,forceSensorStop:m||null,sourceEvent:v&&v.sourceEvent?v.sourceEvent:null}),[e,i,t,r]),f=_e(x=>pm(e,x),[e]),u=_e(x=>{const m=t.draggable.findById(x);return m?m.options:null},[t.draggable]),d=_e(function(){i.isClaimed()&&(i.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(o0()))},[i,r]),h=_e(()=>i.isClaimed(),[i]),p=Le(()=>({canGetLock:c,tryGetLock:l,findClosestDraggableId:f,findOptionsForDraggable:u,tryReleaseLock:d,isLockClaimed:h}),[c,l,f,u,d,h]);for(let x=0;x<s.length;x++)s[x](p)}const ym=e=>({onBeforeCapture:r=>{const t=()=>{e.onBeforeCapture&&e.onBeforeCapture(r)};Tl.flushSync(t)},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),Em=e=>({...Ta,...e.autoScrollerOptions,durationDampening:{...Ta.durationDampening,...e.autoScrollerOptions}});function ra(e){return e.current||ce(),e.current}function bm(e){const{contextId:r,setCallbacks:t,sensors:n,nonce:a,dragHandleUsageInstructions:s}=e,i=fe.useRef(null),o=vf(e),c=_e(()=>ym(o.current),[o]),l=_e(()=>Em(o.current),[o]),f=Op(r),u=Lp({contextId:r,text:s}),d=Sp(r,a),h=_e(W=>{ra(i).dispatch(W)},[]),p=Le(()=>mo({publishWhileDragging:x1,updateDroppableScroll:m1,updateDroppableIsEnabled:g1,updateDroppableIsCombineEnabled:v1,collectionStarting:p1},h),[h]),x=Ip(),m=Le(()=>ap(x,p),[x,p]),v=Le(()=>yp({scrollWindow:sp,scrollDroppable:m.scrollDroppable,getAutoScrollerOptions:l,...mo({move:tf},h)}),[m.scrollDroppable,h,l]),E=Cp(r),w=Le(()=>ep({announce:f,autoScroller:v,dimensionMarshal:m,focusMarshal:E,getResponders:c,styleMarshal:d}),[f,v,m,E,c,d]);i.current=w;const A=_e(()=>{const W=ra(i);W.getState().phase!=="IDLE"&&W.dispatch(o0())},[]),D=_e(()=>{const W=ra(i).getState();return W.phase==="DROP_ANIMATING"?!0:W.phase==="IDLE"?!1:W.isDragging},[]),N=Le(()=>({isDragging:D,tryAbort:A}),[D,A]);t(N);const k=_e(W=>df(ra(i).getState(),W),[]),L=_e(()=>tn(ra(i).getState()),[]),O=Le(()=>({marshal:m,focus:E,contextId:r,canLift:k,isMovementAllowed:L,dragHandleUsageInstructionsId:u,registry:x}),[r,m,u,E,k,L,x]);return wm({contextId:r,store:w,registry:x,customSensors:n||null,enableDefaultSensors:e.enableDefaultSensors!==!1}),fe.useEffect(()=>A,[A]),Je.createElement(Ys.Provider,{value:O},Je.createElement(wh,{context:x0,store:w},e.children))}function km(){return Je.useId()}function Tm(e){const r=km(),t=e.dragHandleUsageInstructions||vs.dragHandleUsageInstructions;return Je.createElement(rx,null,n=>Je.createElement(bm,{nonce:e.nonce,contextId:r,setCallbacks:n,dragHandleUsageInstructions:t,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children))}const Wo={dragging:5e3,dropAnimating:4500},Sm=(e,r)=>r?la.drop(r.duration):e?la.snap:la.fluid,Am=(e,r)=>{if(e)return r?ka.opacity.drop:ka.opacity.combining},Cm=e=>e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP";function Fm(e){const t=e.dimension.client,{offset:n,combineWith:a,dropping:s}=e,i=!!a,o=Cm(e),c=!!s,l=c?Li.drop(n,i):Li.moveTo(n);return{position:"fixed",top:t.marginBox.top,left:t.marginBox.left,boxSizing:"border-box",width:t.borderBox.width,height:t.borderBox.height,transition:Sm(o,s),transform:l,opacity:Am(i,c),zIndex:c?Wo.dropAnimating:Wo.dragging,pointerEvents:"none"}}function Im(e){return{transform:Li.moveTo(e.offset),transition:e.shouldAnimateDisplacement?void 0:"none"}}function Nm(e){return e.type==="DRAGGING"?Fm(e):Im(e)}function Dm(e,r,t=Er){const n=window.getComputedStyle(r),a=r.getBoundingClientRect(),s=Il(a,n),i=ks(s,t),o={client:s,tagName:r.tagName.toLowerCase(),display:n.display},c={x:s.marginBox.width,y:s.marginBox.height};return{descriptor:e,placeholder:o,displaceBy:c,client:s,page:i}}function Om(e){const r=p0("draggable"),{descriptor:t,registry:n,getDraggableRef:a,canDragInteractiveElements:s,shouldRespectForcePress:i,isEnabled:o}=e,c=Le(()=>({canDragInteractiveElements:s,shouldRespectForcePress:i,isEnabled:o}),[s,o,i]),l=_e(h=>{const p=a();return p||ce(),Dm(t,p,h)},[t,a]),f=Le(()=>({uniqueId:r,descriptor:t,options:c,getDimension:l}),[t,l,c,r]),u=fe.useRef(f),d=fe.useRef(!0);rt(()=>(n.draggable.register(u.current),()=>n.draggable.unregister(u.current)),[n.draggable]),rt(()=>{if(d.current){d.current=!1;return}const h=u.current;u.current=f,n.draggable.update(f,h)},[f,n.draggable])}var g0=Je.createContext(null);function Is(e){const r=fe.useContext(e);return r||ce(),r}function Rm(e){e.preventDefault()}const Pm=e=>{const r=fe.useRef(null),t=_e((N=null)=>{r.current=N},[]),n=_e(()=>r.current,[]),{contextId:a,dragHandleUsageInstructionsId:s,registry:i}=Is(Ys),{type:o,droppableId:c}=Is(g0),l=Le(()=>({id:e.draggableId,index:e.index,type:o,droppableId:c}),[e.draggableId,e.index,o,c]),{children:f,draggableId:u,isEnabled:d,shouldRespectForcePress:h,canDragInteractiveElements:p,isClone:x,mapped:m,dropAnimationFinished:v}=e;if(!x){const N=Le(()=>({descriptor:l,registry:i,getDraggableRef:n,canDragInteractiveElements:p,shouldRespectForcePress:h,isEnabled:d}),[l,i,n,p,h,d]);Om(N)}const E=Le(()=>d?{tabIndex:0,role:"button","aria-describedby":s,"data-rfd-drag-handle-draggable-id":u,"data-rfd-drag-handle-context-id":a,draggable:!1,onDragStart:Rm}:null,[a,s,u,d]),w=_e(N=>{m.type==="DRAGGING"&&m.dropping&&N.propertyName==="transform"&&Tl.flushSync(v)},[v,m]),A=Le(()=>{const N=Nm(m),k=m.type==="DRAGGING"&&m.dropping?w:void 0;return{innerRef:t,draggableProps:{"data-rfd-draggable-context-id":a,"data-rfd-draggable-id":u,style:N,onTransitionEnd:k},dragHandleProps:E}},[a,E,u,m,w,t]),D=Le(()=>({draggableId:l.id,type:l.type,source:{index:l.index,droppableId:l.droppableId}}),[l.droppableId,l.id,l.index,l.type]);return Je.createElement(Je.Fragment,null,f(A,m.snapshot,D))};var Tf=(e,r)=>e===r,Sf=e=>{const{combine:r,destination:t}=e;return t?t.droppableId:r?r.droppableId:null};const Lm=e=>e.combine?e.combine.draggableId:null,Bm=e=>e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null;function Mm(){const e=yr((a,s)=>({x:a,y:s})),r=yr((a,s,i=null,o=null,c=null)=>({isDragging:!0,isClone:s,isDropAnimating:!!c,dropAnimation:c,mode:a,draggingOver:i,combineWith:o,combineTargetFor:null})),t=yr((a,s,i,o,c=null,l=null,f=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:l,mode:s,offset:a,dimension:i,forceShouldAnimate:f,snapshot:r(s,o,c,l,null)}}));return(a,s)=>{if(Sa(a)){if(a.critical.draggable.id!==s.draggableId)return null;const i=a.current.client.offset,o=a.dimensions.draggables[s.draggableId],c=et(a.impact),l=Bm(a.impact),f=a.forceShouldAnimate;return t(e(i.x,i.y),a.movementMode,o,s.isClone,c,l,f)}if(a.phase==="DROP_ANIMATING"){const i=a.completed;if(i.result.draggableId!==s.draggableId)return null;const o=s.isClone,c=a.dimensions.draggables[s.draggableId],l=i.result,f=l.mode,u=Sf(l),d=Lm(l),p={duration:a.dropDuration,curve:l0.drop,moveTo:a.newHomeClientOffset,opacity:d?ka.opacity.drop:null,scale:d?ka.scale.drop:null};return{mapped:{type:"DRAGGING",offset:a.newHomeClientOffset,dimension:c,dropping:p,draggingOver:u,combineWith:d,mode:f,forceShouldAnimate:null,snapshot:r(f,o,u,d,p)}}}return null}}function Af(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}const jm={mapped:{type:"SECONDARY",offset:Er,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Af(null)}};function Um(){const e=yr((i,o)=>({x:i,y:o})),r=yr(Af),t=yr((i,o=null,c)=>({mapped:{type:"SECONDARY",offset:i,combineTargetFor:o,shouldAnimateDisplacement:c,snapshot:r(o)}})),n=i=>i?t(Er,i,!0):null,a=(i,o,c,l)=>{const f=c.displaced.visible[i],u=!!(l.inVirtualList&&l.effected[i]),d=$s(c),h=d&&d.draggableId===i?o:null;if(!f){if(!u)return n(h);if(c.displaced.invisible[i])return null;const m=Un(l.displacedBy.point),v=e(m.x,m.y);return t(v,h,!0)}if(u)return n(h);const p=c.displacedBy.point,x=e(p.x,p.y);return t(x,h,f.shouldAnimate)};return(i,o)=>{if(Sa(i))return i.critical.draggable.id===o.draggableId?null:a(o.draggableId,i.critical.draggable.id,i.impact,i.afterCritical);if(i.phase==="DROP_ANIMATING"){const c=i.completed;return c.result.draggableId===o.draggableId?null:a(o.draggableId,c.result.draggableId,c.impact,c.afterCritical)}return null}}const Wm=()=>{const e=Mm(),r=Um();return(n,a)=>e(n,a)||r(n,a)||jm},Hm={dropAnimationFinished:af},Gm=Sl(Wm,Hm,null,{context:x0,areStatePropsEqual:Tf})(Pm);function Cf(e){return Is(g0).isUsingCloneFor===e.draggableId&&!e.isClone?null:Je.createElement(Gm,e)}function Vm(e){const r=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,t=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return Je.createElement(Cf,Ts({},e,{isClone:!1,isEnabled:r,canDragInteractiveElements:t,shouldRespectForcePress:n}))}const Ff=e=>r=>e===r,$m=Ff("scroll"),zm=Ff("auto"),Ho=(e,r)=>r(e.overflowX)||r(e.overflowY),Xm=e=>{const r=window.getComputedStyle(e),t={overflowX:r.overflowX,overflowY:r.overflowY};return Ho(t,$m)||Ho(t,zm)},Km=()=>!1,If=e=>e==null?null:e===document.body?Km()?e:null:e===document.documentElement?null:Xm(e)?e:If(e.parentElement);var ji=e=>({x:e.scrollLeft,y:e.scrollTop});const Nf=e=>e?window.getComputedStyle(e).position==="fixed"?!0:Nf(e.parentElement):!1;var Ym=e=>{const r=If(e),t=Nf(e);return{closestScrollable:r,isFixedOnPage:t}},qm=({descriptor:e,isEnabled:r,isCombineEnabled:t,isFixedOnPage:n,direction:a,client:s,page:i,closest:o})=>{const c=(()=>{if(!o)return null;const{scrollSize:d,client:h}=o,p=lf({scrollHeight:d.scrollHeight,scrollWidth:d.scrollWidth,height:h.paddingBox.height,width:h.paddingBox.width});return{pageMarginBox:o.page.marginBox,frameClient:h,scrollSize:d,shouldClipSubject:o.shouldClipSubject,scroll:{initial:o.scroll,current:o.scroll,max:p,diff:{value:Er,displacement:Er}}}})(),l=a==="vertical"?t0:Wl,f=Rn({page:i,withPlaceholder:null,axis:l,frame:c});return{descriptor:e,isCombineEnabled:t,isFixedOnPage:n,axis:l,isEnabled:r,client:s,page:i,frame:c,subject:f}};const Jm=(e,r)=>{const t=Nl(e);if(!r||e!==r)return t;const n=t.paddingBox.top-r.scrollTop,a=t.paddingBox.left-r.scrollLeft,s=n+r.scrollHeight,i=a+r.scrollWidth,c=Zi({top:n,right:i,bottom:s,left:a},t.border);return Qi({borderBox:c,margin:t.margin,border:t.border,padding:t.padding})};var Zm=({ref:e,descriptor:r,env:t,windowScroll:n,direction:a,isDropDisabled:s,isCombineEnabled:i,shouldClipSubject:o})=>{const c=t.closestScrollable,l=Jm(e,c),f=ks(l,n),u=(()=>{if(!c)return null;const h=Nl(c),p={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:h,page:ks(h,n),scroll:ji(c),scrollSize:p,shouldClipSubject:o}})();return qm({descriptor:r,isEnabled:!s,isCombineEnabled:i,isFixedOnPage:t.isFixedOnPage,direction:a,client:l,page:f,closest:u})};const Qm={passive:!1},eg={passive:!0};var Go=e=>e.shouldPublishImmediately?Qm:eg;const as=e=>e&&e.env.closestScrollable||null;function rg(e){const r=fe.useRef(null),t=Is(Ys),n=p0("droppable"),{registry:a,marshal:s}=t,i=vf(e),o=Le(()=>({id:e.droppableId,type:e.type,mode:e.mode}),[e.droppableId,e.mode,e.type]),c=fe.useRef(o),l=Le(()=>yr((A,D)=>{r.current||ce();const N={x:A,y:D};s.updateDroppableScroll(o.id,N)}),[o.id,s]),f=_e(()=>{const A=r.current;return!A||!A.env.closestScrollable?Er:ji(A.env.closestScrollable)},[]),u=_e(()=>{const A=f();l(A.x,A.y)},[f,l]),d=Le(()=>wa(u),[u]),h=_e(()=>{const A=r.current,D=as(A);if(A&&D||ce(),A.scrollOptions.shouldPublishImmediately){u();return}d()},[d,u]),p=_e((A,D)=>{r.current&&ce();const N=i.current,k=N.getDroppableRef();k||ce();const L=Ym(k),O={ref:k,descriptor:o,env:L,scrollOptions:D};r.current=O;const W=Zm({ref:k,descriptor:o,env:L,windowScroll:A,direction:N.direction,isDropDisabled:N.isDropDisabled,isCombineEnabled:N.isCombineEnabled,shouldClipSubject:!N.ignoreContainerClipping}),B=L.closestScrollable;return B&&(B.setAttribute(Bo.contextId,t.contextId),B.addEventListener("scroll",h,Go(O.scrollOptions))),W},[t.contextId,o,h,i]),x=_e(()=>{const A=r.current,D=as(A);return A&&D||ce(),ji(D)},[]),m=_e(()=>{const A=r.current;A||ce();const D=as(A);r.current=null,D&&(d.cancel(),D.removeAttribute(Bo.contextId),D.removeEventListener("scroll",h,Go(A.scrollOptions)))},[h,d]),v=_e(A=>{const D=r.current;D||ce();const N=as(D);N||ce(),N.scrollTop+=A.y,N.scrollLeft+=A.x},[]),E=Le(()=>({getDimensionAndWatchScroll:p,getScrollWhileDragging:x,dragStopped:m,scroll:v}),[m,p,x,v]),w=Le(()=>({uniqueId:n,descriptor:o,callbacks:E}),[E,o,n]);rt(()=>(c.current=w.descriptor,a.droppable.register(w),()=>{r.current&&m(),a.droppable.unregister(w)}),[E,o,m,w,s,a.droppable]),rt(()=>{r.current&&s.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,s]),rt(()=>{r.current&&s.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,s])}function vi(){}const Vo={width:0,height:0,margin:cx},tg=({isAnimatingOpenOnMount:e,placeholder:r,animate:t})=>e||t==="close"?Vo:{height:r.client.borderBox.height,width:r.client.borderBox.width,margin:r.client.margin},ng=({isAnimatingOpenOnMount:e,placeholder:r,animate:t})=>{const n=tg({isAnimatingOpenOnMount:e,placeholder:r,animate:t});return{display:r.display,boxSizing:"border-box",width:n.width,height:n.height,marginTop:n.margin.top,marginRight:n.margin.right,marginBottom:n.margin.bottom,marginLeft:n.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:t!=="none"?la.placeholder:null}},ag=e=>{const r=fe.useRef(null),t=_e(()=>{r.current&&(clearTimeout(r.current),r.current=null)},[]),{animate:n,onTransitionEnd:a,onClose:s,contextId:i}=e,[o,c]=fe.useState(e.animate==="open");fe.useEffect(()=>o?n!=="open"?(t(),c(!1),vi):r.current?vi:(r.current=setTimeout(()=>{r.current=null,c(!1)}),t):vi,[n,o,t]);const l=_e(u=>{u.propertyName==="height"&&(a(),n==="close"&&s())},[n,s,a]),f=ng({isAnimatingOpenOnMount:o,animate:e.animate,placeholder:e.placeholder});return Je.createElement(e.placeholder.tagName,{style:f,"data-rfd-placeholder-context-id":i,onTransitionEnd:l,ref:e.innerRef})};var sg=Je.memo(ag);class ig extends Je.PureComponent{constructor(...r){super(...r),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(r,t){return r.shouldAnimate?r.on?{isVisible:!0,data:r.on,animate:"open"}:t.isVisible?{isVisible:!0,data:t.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!r.on,data:r.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const r={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(r)}}const og=e=>{const r=fe.useContext(Ys);r||ce();const{contextId:t,isMovementAllowed:n}=r,a=fe.useRef(null),s=fe.useRef(null),{children:i,droppableId:o,type:c,mode:l,direction:f,ignoreContainerClipping:u,isDropDisabled:d,isCombineEnabled:h,snapshot:p,useClone:x,updateViewportMaxScroll:m,getContainerForClone:v}=e,E=_e(()=>a.current,[]),w=_e((B=null)=>{a.current=B},[]);_e(()=>s.current,[]);const A=_e((B=null)=>{s.current=B},[]),D=_e(()=>{n()&&m({maxScroll:uf()})},[n,m]);rg({droppableId:o,type:c,mode:l,direction:f,isDropDisabled:d,isCombineEnabled:h,ignoreContainerClipping:u,getDroppableRef:E});const N=Le(()=>Je.createElement(ig,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},({onClose:B,data:M,animate:Z})=>Je.createElement(sg,{placeholder:M,onClose:B,innerRef:A,animate:Z,contextId:t,onTransitionEnd:D})),[t,D,e.placeholder,e.shouldAnimatePlaceholder,A]),k=Le(()=>({innerRef:w,placeholder:N,droppableProps:{"data-rfd-droppable-id":o,"data-rfd-droppable-context-id":t}}),[t,o,N,w]),L=x?x.dragging.draggableId:null,O=Le(()=>({droppableId:o,type:c,isUsingCloneFor:L}),[o,L,c]);function W(){if(!x)return null;const{dragging:B,render:M}=x,Z=Je.createElement(Cf,{draggableId:B.draggableId,index:B.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(le,se)=>M(le,se,B));return vh.createPortal(Z,v())}return Je.createElement(g0.Provider,{value:O},i(k,p),W())};function cg(){return document.body||ce(),document.body}const $o={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:cg},Df=e=>{let r={...e},t;for(t in $o)e[t]===void 0&&(r={...r,[t]:$o[t]});return r},_i=(e,r)=>e===r.droppable.type,zo=(e,r)=>r.draggables[e.draggable.id],lg=()=>{const e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r={...e,shouldAnimatePlaceholder:!1},t=yr(s=>({draggableId:s.id,type:s.type,source:{index:s.index,droppableId:s.droppableId}})),n=yr((s,i,o,c,l,f)=>{const u=l.descriptor.id;if(l.descriptor.droppableId===s){const p=f?{render:f,dragging:t(l.descriptor)}:null,x={isDraggingOver:o,draggingOverWith:o?u:null,draggingFromThisWith:u,isUsingPlaceholder:!0};return{placeholder:l.placeholder,shouldAnimatePlaceholder:!1,snapshot:x,useClone:p}}if(!i)return r;if(!c)return e;const h={isDraggingOver:o,draggingOverWith:u,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:l.placeholder,shouldAnimatePlaceholder:!0,snapshot:h,useClone:null}});return(s,i)=>{const o=Df(i),c=o.droppableId,l=o.type,f=!o.isDropDisabled,u=o.renderClone;if(Sa(s)){const d=s.critical;if(!_i(l,d))return r;const h=zo(d,s.dimensions),p=et(s.impact)===c;return n(c,f,p,p,h,u)}if(s.phase==="DROP_ANIMATING"){const d=s.completed;if(!_i(l,d.critical))return r;const h=zo(d.critical,s.dimensions);return n(c,f,Sf(d.result)===c,et(d.impact)===c,h,u)}if(s.phase==="IDLE"&&s.completed&&!s.shouldFlush){const d=s.completed;if(!_i(l,d.critical))return r;const h=et(d.impact)===c,p=!!(d.impact.at&&d.impact.at.type==="COMBINE"),x=d.critical.droppable.id===c;return h?p?e:r:x?e:r}return r}},fg={updateViewportMaxScroll:w1},ug=Sl(lg,fg,(e,r,t)=>({...Df(t),...e,...r}),{context:x0,areStatePropsEqual:Tf})(og),dg=({cases:e,statuses:r,onUpdateStatus:t})=>{const n=El(),a=i=>{const{destination:o,source:c,draggableId:l}=i;if(!o||o.droppableId===c.droppableId&&o.index===c.index)return;const f=o.droppableId;console.log(`Moving ${l} to ${f}`),t(l,f)},s=r.reduce((i,o)=>(i[o]=e.filter(c=>c.status===o),i),{});return g.jsx(Tm,{onDragEnd:a,children:g.jsx("div",{className:"flex overflow-x-auto pb-4 gap-4 h-[calc(100vh-200px)] items-start",children:r.map(i=>{var o;return g.jsxs("div",{className:"min-w-[280px] w-[300px] flex flex-col h-full bg-gray-50/50 dark:bg-gray-800/50 rounded-xl border border-gray-100 dark:border-gray-700 backdrop-blur-sm",children:[g.jsxs("div",{className:"p-3 font-bold text-gray-700 dark:text-gray-200 flex justify-between items-center bg-white/50 dark:bg-gray-900/50 rounded-t-xl border-b border-gray-100 dark:border-gray-700 sticky top-0 z-10",children:[g.jsx("span",{children:i}),g.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-xs px-2 py-0.5 rounded-full text-gray-600 dark:text-gray-300",children:((o=s[i])==null?void 0:o.length)||0})]}),g.jsx(ug,{droppableId:i,children:(c,l)=>{var f;return g.jsxs("div",{...c.droppableProps,ref:c.innerRef,className:`flex-1 p-2 overflow-y-auto scrollbar-hide transition-colors ${l.isDraggingOver?"bg-blue-50/50 dark:bg-blue-900/10":""}`,children:[(f=s[i])==null?void 0:f.map((u,d)=>g.jsx(Vm,{draggableId:u.caseId,index:d,children:(h,p)=>g.jsx("div",{ref:h.innerRef,...h.draggableProps,...h.dragHandleProps,style:{...h.draggableProps.style},className:"mb-3",onClick:()=>n(`/case/${u.caseId}`),children:g.jsxs(Al.div,{initial:!1,animate:p.isDragging?{scale:1.05,rotate:2,boxShadow:"0px 10px 20px rgba(0,0,0,0.1)"}:{scale:1,rotate:0,boxShadow:"0px 2px 5px rgba(0,0,0,0.05)"},className:`bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-100 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-500 transition-colors group cursor-grab active:cursor-grabbing ${u.isNew?"ring-2 ring-red-500/20":""}`,children:[g.jsxs("div",{className:"flex justify-between items-start mb-2",children:[g.jsx("span",{className:"font-bold text-gray-800 dark:text-gray-100",children:u.customerName}),u.isNew&&g.jsx("span",{className:"text-[10px] bg-red-100 text-red-600 px-1.5 rounded",children:"NEW"})]}),g.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400 mb-1",children:[g.jsx(ia,{size:12,className:"mr-1"})," ",u.phone]}),g.jsxs("div",{className:"flex items-center text-xs text-gray-400 dark:text-gray-500 justify-between mt-2 pt-2 border-t border-gray-50 dark:border-gray-700",children:[g.jsx("span",{children:u.caseType}),g.jsx("span",{children:u.managerName||"-"})]}),u.secondaryStatus&&g.jsx("div",{className:"mt-2 text-[10px] bg-gray-50 dark:bg-gray-900 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-center truncate",children:u.secondaryStatus})]})})},u.caseId)),c.placeholder]})}})]},i)})})})};function hg({isOpen:e,onClose:r,allStatuses:t,hiddenStatuses:n,onToggleStatus:a}){if(!e)return null;const s=()=>{t.forEach(o=>{n.includes(o)&&a(o)})},i=()=>{t.forEach(o=>{n.includes(o)||a(o)})};return g.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-fade-in",children:g.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-md rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 overflow-hidden flex flex-col max-h-[90vh]",children:[g.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-900/50",children:[g.jsxs("h3",{className:"font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[g.jsx(jh,{className:"text-gray-500",size:20})," "]}),g.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",children:g.jsx(ws,{size:20,className:"text-gray-500"})})]}),g.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 text-xs text-blue-800 dark:text-blue-300",children:[g.jsxs("p",{children:["    ",g.jsx("b",{children:"' '"}),"  ."]}),g.jsx("p",{className:"mt-1 opacity-75",children:"(,       .)"})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[g.jsxs("div",{className:"flex gap-2 mb-4",children:[g.jsx("button",{onClick:s,className:"flex-1 py-2 text-xs font-bold bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors",children:" "}),g.jsx("button",{onClick:i,className:"flex-1 py-2 text-xs font-bold bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors",children:" "})]}),g.jsx("div",{className:"grid grid-cols-1 gap-2",children:t.map(o=>{const c=n.includes(o),l=!c;return g.jsxs("label",{className:`flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all ${l?"bg-white border-blue-200 shadow-sm ring-1 ring-blue-100 dark:bg-gray-700 dark:border-blue-500/50":"bg-gray-50 border-gray-100 text-gray-400 dark:bg-gray-800 dark:border-gray-700"}`,children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center border transition-colors ${l?"bg-blue-500 border-blue-600 text-white":"bg-white border-gray-300 dark:bg-gray-800 dark:border-gray-600"}`,children:l&&g.jsx(_a,{size:14,strokeWidth:3})}),g.jsx("span",{className:`font-medium ${l?"text-gray-800 dark:text-white":"text-gray-400"}`,children:o})]}),g.jsx("input",{type:"checkbox",className:"hidden",checked:l,onChange:()=>a(o)}),c&&g.jsx("span",{className:"text-xs text-red-400 font-bold",children:""})]},o)})})]}),g.jsx("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-900/50 flex justify-end",children:g.jsx("button",{onClick:r,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg shadow-blue-500/20 transition-all active:scale-95",children:""})})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ns={};Ns.version="0.18.5";var Of=1252,xg=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],v0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_0=function(e){xg.indexOf(e)!=-1&&(Of=v0[0]=e)};function pg(){_0(1252)}var vt=function(e){_0(e)};function w0(){vt(1200),pg()}function Xo(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function mg(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Rf(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var na=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?mg(e.slice(2)):r==254&&t==255?Rf(e.slice(2)):r==65279?e.slice(1):e},ss=function(r){return String.fromCharCode(r)},Ko=function(r){return String.fromCharCode(r)},Aa,Wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ca(e){for(var r="",t=0,n=0,a=0,s=0,i=0,o=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),s=t>>2,n=e.charCodeAt(l++),i=(t&3)<<4|n>>4,a=e.charCodeAt(l++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),r+=Wt.charAt(s)+Wt.charAt(i)+Wt.charAt(o)+Wt.charAt(c);return r}function tt(e){var r="",t=0,n=0,a=0,s=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=Wt.indexOf(e.charAt(l++)),i=Wt.indexOf(e.charAt(l++)),t=s<<2|i>>4,r+=String.fromCharCode(t),o=Wt.indexOf(e.charAt(l++)),n=(i&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),c=Wt.indexOf(e.charAt(l++)),a=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var Oe=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Pt=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Xt(e){return Oe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Yo(e){return Oe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Jr=function(r){return Oe?Pt(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Js(e){if(typeof ArrayBuffer>"u")return Jr(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Jt(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function gg(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function y0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return y0(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var _r=Oe?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Pt(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function vg(e){for(var r=[],t=0,n=e.length+250,a=Xt(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[t++]=i;else if(i<2048)a[t++]=192|i>>6&31,a[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[t++]=240|i>>8&7,a[t++]=128|i>>2&63,a[t++]=128|o>>6&15|(i&3)<<4,a[t++]=128|o&63}else a[t++]=224|i>>12&15,a[t++]=128|i>>6&63,a[t++]=128|i&63;t>n&&(r.push(a.slice(0,t)),t=0,a=Xt(65535),n=65530)}return r.push(a.slice(0,t)),_r(r)}var Vr=/\u0000/g,aa=/[\u0001-\u0006]/g;function In(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function _t(e,r){var t=""+e;return t.length>=r?t:ar("0",r-t.length)+t}function E0(e,r){var t=""+e;return t.length>=r?t:ar(" ",r-t.length)+t}function Ds(e,r){var t=""+e;return t.length>=r?t:t+ar(" ",r-t.length)}function _g(e,r){var t=""+Math.round(e);return t.length>=r?t:ar("0",r-t.length)+t}function wg(e,r){var t=""+e;return t.length>=r?t:ar("0",r-t.length)+t}var qo=Math.pow(2,32);function kn(e,r){if(e>qo||e<-qo)return _g(e,r);var t=Math.round(e);return wg(t,r)}function Os(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Jo=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],wi=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function yg(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var be={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Zo={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Eg={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Rs(e,r,t){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,c=1,l=0,f=0,u=Math.floor(a);l<r&&(u=Math.floor(a),o=u*i+s,f=u*l+c,!(a-u<5e-8));)a=1/(a-u),s=i,i=o,c=l,l=f;if(f>r&&(l>r?(f=c,o=s):(f=l,o=i)),!t)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function an(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),t&&(s=Cg(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Pf=new Date(1899,11,31,0,0,0),bg=Pf.getTime(),kg=new Date(1900,2,1,0,0,0);function Lf(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=kg&&(t+=1440*60*1e3),(t-(bg+(e.getTimezoneOffset()-Pf.getTimezoneOffset())*6e4))/(1440*60*1e3)}function b0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Tg(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Sg(e){var r=e<0?12:11,t=b0(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Ag(e){var r=b0(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Fa(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Sg(e):r===10?t=e.toFixed(10).substr(0,12):t=Ag(e),b0(Tg(t.toUpperCase()))}function un(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Fa(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ht(14,Lf(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Cg(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Fg(e,r,t,n){var a="",s=0,i=0,o=t.y,c,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,l=r.length;break;case 3:return wi[t.m-1][1];case 5:return wi[t.m-1][0];default:return wi[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,l=r.length;break;case 3:return Jo[t.q][0];default:return Jo[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?_t(t.S,r.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(t.S+t.u)),s>=60*i&&(s=0),r==="s"?s===0?"0":""+s/i:(a=_t(s,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?_t(c,l):"";return f}function Ht(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Bf=/%/g;function Ig(e,r,t){var n=r.replace(Bf,""),a=r.length-n.length;return Nt(e,n,t*Math.pow(10,2*a))+ar("%",a)}function Ng(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Nt(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Mf(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Mf(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var i=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var jf=/# (\?+)( ?)\/( ?)(\d+)/;function Dg(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),s=Math.floor(a/n),i=a-s*n,o=n;return t+(s===0?"":""+s)+" "+(i===0?ar(" ",e[1].length+1+e[4].length):E0(i,e[1].length)+e[2]+"/"+e[3]+_t(o,e[4].length))}function Og(e,r,t){return t+(r===0?"":""+r)+ar(" ",e[1].length+2+e[4].length)}var Uf=/^#*0*\.([0#]+)/,Wf=/\).*[0#]/,Hf=/\(###\) ###\\?-####/;function Hr(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Qo(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function ec(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function Rg(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Pg(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function st(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Wf)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?st("n",n,t):"("+st("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Ng(e,r,t);if(r.indexOf("%")!==-1)return Ig(e,r,t);if(r.indexOf("E")!==-1)return Mf(r,t);if(r.charCodeAt(0)===36)return"$"+st(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,i,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+kn(c,r.length);if(r.match(/^[#?]+$/))return a=kn(t,0),a==="0"&&(a=""),a.length>r.length?a:Hr(r.substr(0,r.length-a.length))+a;if(s=r.match(jf))return Dg(s,c,l);if(r.match(/^#+0+$/))return l+kn(c,r.length-r.indexOf("0"));if(s=r.match(Uf))return a=Qo(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Hr(s[1])).replace(/\.$/,"."+Hr(s[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+ar("0",Hr(s[1]).length-x.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return l+Qo(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return l+Ht(kn(c,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+st(e,r,-t):Ht(""+(Math.floor(t)+Rg(t,s[1].length)))+"."+_t(ec(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return st(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=In(st(e,r.replace(/[\\-]/g,""),t)),i=0,In(In(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(r.match(Hf))return a=st(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Rs(c,Math.pow(10,i)-1,!1),a=""+l,f=Nt("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=Ds(o[2],i),f.length<s[4].length&&(f=Hr(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Rs(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?E0(o[1],i)+s[2]+"/"+s[3]+Ds(o[2],i):ar(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=kn(t,0),r.length<=a.length?a:Hr(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=r.indexOf(".")-i,d=r.length-a.length-u;return Hr(r.substr(0,u)+a+r.substr(r.length-d))}if(s=r.match(/^00,000\.([#0]*0)$/))return i=ec(t,s[1].length),t<0?"-"+st(e,r,-t):Ht(Pg(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?_t(0,3-p.length):"")+p})+"."+_t(i,s[1].length);switch(r){case"###,##0.00":return st(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Ht(kn(c,0));return h!=="0"?l+h:"";case"###,###.00":return st(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return st(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Lg(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Nt(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Bg(e,r,t){var n=r.replace(Bf,""),a=r.length-n.length;return Nt(e,n,t*Math.pow(10,2*a))+ar("%",a)}function Gf(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Gf(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var i=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function kt(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Wf)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?kt("n",n,t):"("+kt("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Lg(e,r,t);if(r.indexOf("%")!==-1)return Bg(e,r,t);if(r.indexOf("E")!==-1)return Gf(r,t);if(r.charCodeAt(0)===36)return"$"+kt(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,i,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+_t(c,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:Hr(r.substr(0,r.length-a.length))+a;if(s=r.match(jf))return Og(s,c,l);if(r.match(/^#+0+$/))return l+_t(c,r.length-r.indexOf("0"));if(s=r.match(Uf))return a=(""+t).replace(/^([^\.]+)$/,"$1."+Hr(s[1])).replace(/\.$/,"."+Hr(s[1])),a=a.replace(/\.(\d*)$/,function(p,x){return"."+x+ar("0",Hr(s[1]).length-x.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return l+Ht(""+c);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+kt(e,r,-t):Ht(""+t)+"."+ar("0",s[1].length);if(s=r.match(/^#,#*,#0/))return kt(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=In(kt(e,r.replace(/[\\-]/g,""),t)),i=0,In(In(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(r.match(Hf))return a=kt(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Rs(c,Math.pow(10,i)-1,!1),a=""+l,f=Nt("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=Ds(o[2],i),f.length<s[4].length&&(f=Hr(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Rs(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?E0(o[1],i)+s[2]+"/"+s[3]+Ds(o[2],i):ar(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:Hr(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=r.indexOf(".")-i,d=r.length-a.length-u;return Hr(r.substr(0,u)+a+r.substr(r.length-d))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+kt(e,r,-t):Ht(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?_t(0,3-p.length):"")+p})+"."+_t(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Ht(""+c);return h!=="0"?l+h:"";default:if(r.match(/\.[0#?]*$/))return kt(e,r.slice(0,r.lastIndexOf(".")),t)+Hr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Nt(e,r,t){return(t|0)===t?kt(e,r,t):st(e,r,t)}function Mg(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Vf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Gn(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Os(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Vf))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function jg(e,r,t,n){for(var a=[],s="",i=0,o="",c="t",l,f,u,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Os(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(u=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(u);a[a.length]={t:"t",v:s},++i;break;case"\\":var h=e.charAt(++i),p=h==="("||h===")"?h:"t";a[a.length]={t:p,v:h},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:r},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(l==null&&(l=an(r,t,e.charAt(i+1)==="2"),l==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=an(r,t),l==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(l==null&&(l=an(r,t)),e.substr(i,3).toUpperCase()==="A/P"?(l!=null&&(x.v=l.H>=12?"P":"A"),x.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(l!=null&&(x.v=l.H>=12?"PM":"AM"),x.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="/"?(l!=null&&(x.v=l.H>=12?"":""),x.t="T",i+=5,d="h"):(x.t="t",++i),l==null&&x.t==="T")return"";a[a.length]=x,c=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Vf)){if(l==null&&(l=an(r,t),l==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Gn(e)||(a[a.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var m=0,v=0,E;for(i=a.length-1,c="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=d,c="h",m<1&&(m=1);break;case"s":(E=a[i].v.match(/\.0+$/))&&(v=Math.max(v,E[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":c=a[i].t;break;case"m":c==="s"&&(a[i].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&a[i].v.match(/[Hh]/)&&(m=1),m<2&&a[i].v.match(/[Mm]/)&&(m=2),m<3&&a[i].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var w="",A;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=Fg(a[i].t.charCodeAt(0),a[i].v,l,v),a[i].t="t";break;case"n":case"?":for(A=i+1;a[A]!=null&&((o=a[A].t)==="?"||o==="D"||(o===" "||o==="t")&&a[A+1]!=null&&(a[A+1].t==="?"||a[A+1].t==="t"&&a[A+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[A].v==="/"||a[A].v===" "&&a[A+1]!=null&&a[A+1].t=="?"));)a[i].v+=a[A].v,a[A]={v:"",t:";"},++A;w+=a[i].v,i=A-1;break;case"G":a[i].t="t",a[i].v=un(r,t);break}var D="",N,k;if(w.length>0){w.charCodeAt(0)==40?(N=r<0&&w.charCodeAt(0)===45?-r:r,k=Nt("n",w,N)):(N=r<0&&n>1?-r:r,k=Nt("n",w,N),N<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),A=k.length-1;var L=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){L=i;break}var O=a.length;if(L===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(A>=a[i].v.length-1?(A-=a[i].v.length,a[i].v=k.substr(A+1,a[i].v.length)):A<0?a[i].v="":(a[i].v=k.substr(0,A+1),A=-1),a[i].t="t",O=i);A>=0&&O<a.length&&(a[O].v=k.substr(0,A+1)+a[O].v)}else if(L!==a.length&&k.indexOf("E")===-1){for(A=k.indexOf(".")-1,i=L;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===L?a[i].v.indexOf(".")-1:a[i].v.length-1,D=a[i].v.substr(f+1);f>=0;--f)A>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(D=k.charAt(A--)+D);a[i].v=D,a[i].t="t",O=i}for(A>=0&&O<a.length&&(a[O].v=k.substr(0,A+1)+a[O].v),A=k.indexOf(".")+1,i=L;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==L)){for(f=a[i].v.indexOf(".")>-1&&i===L?a[i].v.indexOf(".")+1:0,D=a[i].v.substr(0,f);f<a[i].v.length;++f)A<k.length&&(D+=k.charAt(A++));a[i].v=D,a[i].t="t",O=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(N=n>1&&r<0&&i>0&&a[i-1].v==="-"?-r:r,a[i].v=Nt(a[i].t,a[i].v,N),a[i].t="t");var W="";for(i=0;i!==a.length;++i)a[i]!=null&&(W+=a[i].v);return W}var rc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tc(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Ug(e,r){var t=Mg(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match(rc),o=t[1].match(rc);return tc(r,i)?[n,t[0]]:tc(r,o)?[n,t[1]]:[n,t[i!=null&&o!=null?2:1]]}return[n,s]}function ht(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:be)[e],n==null&&(n=t.table&&t.table[Zo[e]]||be[Zo[e]]),n==null&&(n=Eg[e]||"General");break}if(Os(n,0))return un(r,t);r instanceof Date&&(r=Lf(r,t.date1904));var a=Ug(n,r);if(Os(a[1]))return un(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return jg(a[1],r,t,a[0])}function Dt(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(be[t]==null){r<0&&(r=t);continue}if(be[t]==e){r=t;break}}r<0&&(r=391)}return be[r]=e,r}function Zs(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Dt(e[r],r)}function Vn(){be=yg()}var Wg={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},$f=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Hg(e){var r=typeof e=="number"?be[e]:e;return r=r.replace($f,"(\\d+)"),new RegExp("^"+r+"$")}function Gg(e,r,t){var n=-1,a=-1,s=-1,i=-1,o=-1,c=-1;(r.match($f)||[]).forEach(function(u,d){var h=parseInt(t[d+1],10);switch(u.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":i=h;break;case"s":c=h;break;case"m":i>=0?o=h:a=h;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?l:n==-1&&a==-1&&s==-1?f:l+"T"+f}var Vg=(function(){var e={};e.version="1.2.0";function r(){for(var k=0,L=new Array(256),O=0;O!=256;++O)k=O,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,L[O]=k;return typeof Int32Array<"u"?new Int32Array(L):L}var t=r();function n(k){var L=0,O=0,W=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)B[W]=k[W];for(W=0;W!=256;++W)for(O=k[W],L=256+W;L<4096;L+=256)O=B[L]=O>>>8^k[O&255];var M=[];for(W=1;W!=16;++W)M[W-1]=typeof Int32Array<"u"?B.subarray(W*256,W*256+256):B.slice(W*256,W*256+256);return M}var a=n(t),s=a[0],i=a[1],o=a[2],c=a[3],l=a[4],f=a[5],u=a[6],d=a[7],h=a[8],p=a[9],x=a[10],m=a[11],v=a[12],E=a[13],w=a[14];function A(k,L){for(var O=L^-1,W=0,B=k.length;W<B;)O=O>>>8^t[(O^k.charCodeAt(W++))&255];return~O}function D(k,L){for(var O=L^-1,W=k.length-15,B=0;B<W;)O=w[k[B++]^O&255]^E[k[B++]^O>>8&255]^v[k[B++]^O>>16&255]^m[k[B++]^O>>>24]^x[k[B++]]^p[k[B++]]^h[k[B++]]^d[k[B++]]^u[k[B++]]^f[k[B++]]^l[k[B++]]^c[k[B++]]^o[k[B++]]^i[k[B++]]^s[k[B++]]^t[k[B++]];for(W+=15;B<W;)O=O>>>8^t[(O^k[B++])&255];return~O}function N(k,L){for(var O=L^-1,W=0,B=k.length,M=0,Z=0;W<B;)M=k.charCodeAt(W++),M<128?O=O>>>8^t[(O^M)&255]:M<2048?(O=O>>>8^t[(O^(192|M>>6&31))&255],O=O>>>8^t[(O^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,Z=k.charCodeAt(W++)&1023,O=O>>>8^t[(O^(240|M>>8&7))&255],O=O>>>8^t[(O^(128|M>>2&63))&255],O=O>>>8^t[(O^(128|Z>>6&15|(M&3)<<4))&255],O=O>>>8^t[(O^(128|Z&63))&255]):(O=O>>>8^t[(O^(224|M>>12&15))&255],O=O>>>8^t[(O^(128|M>>6&63))&255],O=O>>>8^t[(O^(128|M&63))&255]);return~O}return e.table=t,e.bstr=A,e.buf=D,e.str=N,e})(),we=(function(){var r={};r.version="1.2.1";function t(_,T){for(var y=_.split("/"),b=T.split("/"),S=0,F=0,G=Math.min(y.length,b.length);S<G;++S){if(F=y[S].length-b[S].length)return F;if(y[S]!=b[S])return y[S]<b[S]?-1:1}return y.length-b.length}function n(_){if(_.charAt(_.length-1)=="/")return _.slice(0,-1).indexOf("/")===-1?_:n(_.slice(0,-1));var T=_.lastIndexOf("/");return T===-1?_:_.slice(0,T+1)}function a(_){if(_.charAt(_.length-1)=="/")return a(_.slice(0,-1));var T=_.lastIndexOf("/");return T===-1?_:_.slice(T+1)}function s(_,T){typeof T=="string"&&(T=new Date(T));var y=T.getHours();y=y<<6|T.getMinutes(),y=y<<5|T.getSeconds()>>>1,_.write_shift(2,y);var b=T.getFullYear()-1980;b=b<<4|T.getMonth()+1,b=b<<5|T.getDate(),_.write_shift(2,b)}function i(_){var T=_.read_shift(2)&65535,y=_.read_shift(2)&65535,b=new Date,S=y&31;y>>>=5;var F=y&15;y>>>=4,b.setMilliseconds(0),b.setFullYear(y+1980),b.setMonth(F-1),b.setDate(S);var G=T&31;T>>>=5;var q=T&63;return T>>>=6,b.setHours(T),b.setMinutes(q),b.setSeconds(G<<1),b}function o(_){Tr(_,0);for(var T={},y=0;_.l<=_.length-4;){var b=_.read_shift(2),S=_.read_shift(2),F=_.l+S,G={};switch(b){case 21589:y=_.read_shift(1),y&1&&(G.mtime=_.read_shift(4)),S>5&&(y&2&&(G.atime=_.read_shift(4)),y&4&&(G.ctime=_.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}_.l=F,T[b]=G}return T}var c;function l(){return c||(c={})}function f(_,T){if(_[0]==80&&_[1]==75)return co(_,T);if((_[0]|32)==109&&(_[1]|32)==105)return eh(_,T);if(_.length<512)throw new Error("CFB file size "+_.length+" < 512");var y=3,b=512,S=0,F=0,G=0,q=0,H=0,V=[],z=_.slice(0,512);Tr(z,0);var ne=u(z);switch(y=ne[0],y){case 3:b=512;break;case 4:b=4096;break;case 0:if(ne[1]==0)return co(_,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+y)}b!==512&&(z=_.slice(0,b),Tr(z,28));var de=_.slice(0,b);d(z,y);var ge=z.read_shift(4,"i");if(y===3&&ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ge);z.l+=4,G=z.read_shift(4,"i"),z.l+=4,z.chk("00100000","Mini Stream Cutoff Size: "),q=z.read_shift(4,"i"),S=z.read_shift(4,"i"),H=z.read_shift(4,"i"),F=z.read_shift(4,"i");for(var ae=-1,xe=0;xe<109&&(ae=z.read_shift(4,"i"),!(ae<0));++xe)V[xe]=ae;var Ce=h(_,b);m(H,F,Ce,b,V);var er=E(Ce,G,V,b);er[G].name="!Directory",S>0&&q!==Z&&(er[q].name="!MiniFAT"),er[V[0]].name="!FAT",er.fat_addrs=V,er.ssz=b;var rr={},Nr=[],Kn=[],Yn=[];w(G,er,Ce,Nr,S,rr,Kn,q),p(Kn,Yn,Nr),Nr.shift();var qn={FileIndex:Kn,FullPaths:Yn};return T&&T.raw&&(qn.raw={header:de,sectors:Ce}),qn}function u(_){if(_[_.l]==80&&_[_.l+1]==75)return[0,0];_.chk(le,"Header Signature: "),_.l+=16;var T=_.read_shift(2,"u");return[_.read_shift(2,"u"),T]}function d(_,T){var y=9;switch(_.l+=2,y=_.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+y);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+y)}_.chk("0600","Mini Sector Shift: "),_.chk("000000000000","Reserved: ")}function h(_,T){for(var y=Math.ceil(_.length/T)-1,b=[],S=1;S<y;++S)b[S-1]=_.slice(S*T,(S+1)*T);return b[y-1]=_.slice(y*T),b}function p(_,T,y){for(var b=0,S=0,F=0,G=0,q=0,H=y.length,V=[],z=[];b<H;++b)V[b]=z[b]=b,T[b]=y[b];for(;q<z.length;++q)b=z[q],S=_[b].L,F=_[b].R,G=_[b].C,V[b]===b&&(S!==-1&&V[S]!==S&&(V[b]=V[S]),F!==-1&&V[F]!==F&&(V[b]=V[F])),G!==-1&&(V[G]=b),S!==-1&&b!=V[b]&&(V[S]=V[b],z.lastIndexOf(S)<q&&z.push(S)),F!==-1&&b!=V[b]&&(V[F]=V[b],z.lastIndexOf(F)<q&&z.push(F));for(b=1;b<H;++b)V[b]===b&&(F!==-1&&V[F]!==F?V[b]=V[F]:S!==-1&&V[S]!==S&&(V[b]=V[S]));for(b=1;b<H;++b)if(_[b].type!==0){if(q=b,q!=V[q])do q=V[q],T[b]=T[q]+"/"+T[b];while(q!==0&&V[q]!==-1&&q!=V[q]);V[b]=-1}for(T[0]+="/",b=1;b<H;++b)_[b].type!==2&&(T[b]+="/")}function x(_,T,y){for(var b=_.start,S=_.size,F=[],G=b;y&&S>0&&G>=0;)F.push(T.slice(G*M,G*M+M)),S-=M,G=nn(y,G*4);return F.length===0?Y(0):_r(F).slice(0,_.size)}function m(_,T,y,b,S){var F=Z;if(_===Z){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(_!==-1){var G=y[_],q=(b>>>2)-1;if(!G)return;for(var H=0;H<q&&(F=nn(G,H*4))!==Z;++H)S.push(F);m(nn(G,b-4),T-1,y,b,S)}}function v(_,T,y,b,S){var F=[],G=[];S||(S=[]);var q=b-1,H=0,V=0;for(H=T;H>=0;){S[H]=!0,F[F.length]=H,G.push(_[H]);var z=y[Math.floor(H*4/b)];if(V=H*4&q,b<4+V)throw new Error("FAT boundary crossed: "+H+" 4 "+b);if(!_[z])break;H=nn(_[z],V)}return{nodes:F,data:xc([G])}}function E(_,T,y,b){var S=_.length,F=[],G=[],q=[],H=[],V=b-1,z=0,ne=0,de=0,ge=0;for(z=0;z<S;++z)if(q=[],de=z+T,de>=S&&(de-=S),!G[de]){H=[];var ae=[];for(ne=de;ne>=0;){ae[ne]=!0,G[ne]=!0,q[q.length]=ne,H.push(_[ne]);var xe=y[Math.floor(ne*4/b)];if(ge=ne*4&V,b<4+ge)throw new Error("FAT boundary crossed: "+ne+" 4 "+b);if(!_[xe]||(ne=nn(_[xe],ge),ae[ne]))break}F[de]={nodes:q,data:xc([H])}}return F}function w(_,T,y,b,S,F,G,q){for(var H=0,V=b.length?2:0,z=T[_].data,ne=0,de=0,ge;ne<z.length;ne+=128){var ae=z.slice(ne,ne+128);Tr(ae,64),de=ae.read_shift(2),ge=I0(ae,0,de-V),b.push(ge);var xe={name:ge,type:ae.read_shift(1),color:ae.read_shift(1),L:ae.read_shift(4,"i"),R:ae.read_shift(4,"i"),C:ae.read_shift(4,"i"),clsid:ae.read_shift(16),state:ae.read_shift(4,"i"),start:0,size:0},Ce=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Ce!==0&&(xe.ct=A(ae,ae.l-8));var er=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);er!==0&&(xe.mt=A(ae,ae.l-8)),xe.start=ae.read_shift(4,"i"),xe.size=ae.read_shift(4,"i"),xe.size<0&&xe.start<0&&(xe.size=xe.type=0,xe.start=Z,xe.name=""),xe.type===5?(H=xe.start,S>0&&H!==Z&&(T[H].name="!StreamData")):xe.size>=4096?(xe.storage="fat",T[xe.start]===void 0&&(T[xe.start]=v(y,xe.start,T.fat_addrs,T.ssz)),T[xe.start].name=xe.name,xe.content=T[xe.start].data.slice(0,xe.size)):(xe.storage="minifat",xe.size<0?xe.size=0:H!==Z&&xe.start!==Z&&T[H]&&(xe.content=x(xe,T[H].data,(T[q]||{}).data))),xe.content&&Tr(xe.content,0),F[ge]=xe,G.push(xe)}}function A(_,T){return new Date((qr(_,T+4)/1e7*Math.pow(2,32)+qr(_,T)/1e7-11644473600)*1e3)}function D(_,T){return l(),f(c.readFileSync(_),T)}function N(_,T){var y=T&&T.type;switch(y||Oe&&Buffer.isBuffer(_)&&(y="buffer"),y||"base64"){case"file":return D(_,T);case"base64":return f(Jr(tt(_)),T);case"binary":return f(Jr(_),T)}return f(_,T)}function k(_,T){var y=T||{},b=y.root||"Root Entry";if(_.FullPaths||(_.FullPaths=[]),_.FileIndex||(_.FileIndex=[]),_.FullPaths.length!==_.FileIndex.length)throw new Error("inconsistent CFB structure");_.FullPaths.length===0&&(_.FullPaths[0]=b+"/",_.FileIndex[0]={name:b,type:5}),y.CLSID&&(_.FileIndex[0].clsid=y.CLSID),L(_)}function L(_){var T="Sh33tJ5";if(!we.find(_,"/"+T)){var y=Y(4);y[0]=55,y[1]=y[3]=50,y[2]=54,_.FileIndex.push({name:T,type:2,content:y,size:4,L:69,R:69,C:69}),_.FullPaths.push(_.FullPaths[0]+T),O(_)}}function O(_,T){k(_);for(var y=!1,b=!1,S=_.FullPaths.length-1;S>=0;--S){var F=_.FileIndex[S];switch(F.type){case 0:b?y=!0:(_.FileIndex.pop(),_.FullPaths.pop());break;case 1:case 2:case 5:b=!0,isNaN(F.R*F.L*F.C)&&(y=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(y=!0);break;default:y=!0;break}}if(!(!y&&!T)){var G=new Date(1987,1,19),q=0,H=Object.create?Object.create(null):{},V=[];for(S=0;S<_.FullPaths.length;++S)H[_.FullPaths[S]]=!0,_.FileIndex[S].type!==0&&V.push([_.FullPaths[S],_.FileIndex[S]]);for(S=0;S<V.length;++S){var z=n(V[S][0]);b=H[z],b||(V.push([z,{name:a(z).replace("/",""),type:1,clsid:he,ct:G,mt:G,content:null}]),H[z]=!0)}for(V.sort(function(ge,ae){return t(ge[0],ae[0])}),_.FullPaths=[],_.FileIndex=[],S=0;S<V.length;++S)_.FullPaths[S]=V[S][0],_.FileIndex[S]=V[S][1];for(S=0;S<V.length;++S){var ne=_.FileIndex[S],de=_.FullPaths[S];if(ne.name=a(de).replace("/",""),ne.L=ne.R=ne.C=-(ne.color=1),ne.size=ne.content?ne.content.length:0,ne.start=0,ne.clsid=ne.clsid||he,S===0)ne.C=V.length>1?1:-1,ne.size=0,ne.type=5;else if(de.slice(-1)=="/"){for(q=S+1;q<V.length&&n(_.FullPaths[q])!=de;++q);for(ne.C=q>=V.length?-1:q,q=S+1;q<V.length&&n(_.FullPaths[q])!=n(de);++q);ne.R=q>=V.length?-1:q,ne.type=1}else n(_.FullPaths[S+1]||"")==n(de)&&(ne.R=S+1),ne.type=2}}}function W(_,T){var y=T||{};if(y.fileType=="mad")return rh(_,y);switch(O(_),y.fileType){case"zip":return Kd(_,y)}var b=(function(ge){for(var ae=0,xe=0,Ce=0;Ce<ge.FileIndex.length;++Ce){var er=ge.FileIndex[Ce];if(er.content){var rr=er.content.length;rr>0&&(rr<4096?ae+=rr+63>>6:xe+=rr+511>>9)}}for(var Nr=ge.FullPaths.length+3>>2,Kn=ae+7>>3,Yn=ae+127>>7,qn=Kn+xe+Nr+Yn,en=qn+127>>7,li=en<=109?0:Math.ceil((en-109)/127);qn+en+li+127>>7>en;)li=++en<=109?0:Math.ceil((en-109)/127);var Ft=[1,li,en,Yn,Nr,xe,ae,0];return ge.FileIndex[0].size=ae<<6,Ft[7]=(ge.FileIndex[0].start=Ft[0]+Ft[1]+Ft[2]+Ft[3]+Ft[4]+Ft[5])+(Ft[6]+7>>3),Ft})(_),S=Y(b[7]<<9),F=0,G=0;{for(F=0;F<8;++F)S.write_shift(1,se[F]);for(F=0;F<8;++F)S.write_shift(2,0);for(S.write_shift(2,62),S.write_shift(2,3),S.write_shift(2,65534),S.write_shift(2,9),S.write_shift(2,6),F=0;F<3;++F)S.write_shift(2,0);for(S.write_shift(4,0),S.write_shift(4,b[2]),S.write_shift(4,b[0]+b[1]+b[2]+b[3]-1),S.write_shift(4,0),S.write_shift(4,4096),S.write_shift(4,b[3]?b[0]+b[1]+b[2]-1:Z),S.write_shift(4,b[3]),S.write_shift(-4,b[1]?b[0]-1:Z),S.write_shift(4,b[1]),F=0;F<109;++F)S.write_shift(-4,F<b[2]?b[1]+F:-1)}if(b[1])for(G=0;G<b[1];++G){for(;F<236+G*127;++F)S.write_shift(-4,F<b[2]?b[1]+F:-1);S.write_shift(-4,G===b[1]-1?Z:G+1)}var q=function(ge){for(G+=ge;F<G-1;++F)S.write_shift(-4,F+1);ge&&(++F,S.write_shift(-4,Z))};for(G=F=0,G+=b[1];F<G;++F)S.write_shift(-4,X.DIFSECT);for(G+=b[2];F<G;++F)S.write_shift(-4,X.FATSECT);q(b[3]),q(b[4]);for(var H=0,V=0,z=_.FileIndex[0];H<_.FileIndex.length;++H)z=_.FileIndex[H],z.content&&(V=z.content.length,!(V<4096)&&(z.start=G,q(V+511>>9)));for(q(b[6]+7>>3);S.l&511;)S.write_shift(-4,X.ENDOFCHAIN);for(G=F=0,H=0;H<_.FileIndex.length;++H)z=_.FileIndex[H],z.content&&(V=z.content.length,!(!V||V>=4096)&&(z.start=G,q(V+63>>6)));for(;S.l&511;)S.write_shift(-4,X.ENDOFCHAIN);for(F=0;F<b[4]<<2;++F){var ne=_.FullPaths[F];if(!ne||ne.length===0){for(H=0;H<17;++H)S.write_shift(4,0);for(H=0;H<3;++H)S.write_shift(4,-1);for(H=0;H<12;++H)S.write_shift(4,0);continue}z=_.FileIndex[F],F===0&&(z.start=z.size?z.start-1:Z);var de=F===0&&y.root||z.name;if(V=2*(de.length+1),S.write_shift(64,de,"utf16le"),S.write_shift(2,V),S.write_shift(1,z.type),S.write_shift(1,z.color),S.write_shift(-4,z.L),S.write_shift(-4,z.R),S.write_shift(-4,z.C),z.clsid)S.write_shift(16,z.clsid,"hex");else for(H=0;H<4;++H)S.write_shift(4,0);S.write_shift(4,z.state||0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,z.start),S.write_shift(4,z.size),S.write_shift(4,0)}for(F=1;F<_.FileIndex.length;++F)if(z=_.FileIndex[F],z.size>=4096)if(S.l=z.start+1<<9,Oe&&Buffer.isBuffer(z.content))z.content.copy(S,S.l,0,z.size),S.l+=z.size+511&-512;else{for(H=0;H<z.size;++H)S.write_shift(1,z.content[H]);for(;H&511;++H)S.write_shift(1,0)}for(F=1;F<_.FileIndex.length;++F)if(z=_.FileIndex[F],z.size>0&&z.size<4096)if(Oe&&Buffer.isBuffer(z.content))z.content.copy(S,S.l,0,z.size),S.l+=z.size+63&-64;else{for(H=0;H<z.size;++H)S.write_shift(1,z.content[H]);for(;H&63;++H)S.write_shift(1,0)}if(Oe)S.l=S.length;else for(;S.l<S.length;)S.write_shift(1,0);return S}function B(_,T){var y=_.FullPaths.map(function(H){return H.toUpperCase()}),b=y.map(function(H){var V=H.split("/");return V[V.length-(H.slice(-1)=="/"?2:1)]}),S=!1;T.charCodeAt(0)===47?(S=!0,T=y[0].slice(0,-1)+T):S=T.indexOf("/")!==-1;var F=T.toUpperCase(),G=S===!0?y.indexOf(F):b.indexOf(F);if(G!==-1)return _.FileIndex[G];var q=!F.match(aa);for(F=F.replace(Vr,""),q&&(F=F.replace(aa,"!")),G=0;G<y.length;++G)if((q?y[G].replace(aa,"!"):y[G]).replace(Vr,"")==F||(q?b[G].replace(aa,"!"):b[G]).replace(Vr,"")==F)return _.FileIndex[G];return null}var M=64,Z=-2,le="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(_,T,y){l();var b=W(_,y);c.writeFileSync(T,b)}function U(_){for(var T=new Array(_.length),y=0;y<_.length;++y)T[y]=String.fromCharCode(_[y]);return T.join("")}function me(_,T){var y=W(_,T);switch(T&&T.type||"buffer"){case"file":return l(),c.writeFileSync(T.filename,y),y;case"binary":return typeof y=="string"?y:U(y);case"base64":return Ca(typeof y=="string"?y:U(y));case"buffer":if(Oe)return Buffer.isBuffer(y)?y:Pt(y);case"array":return typeof y=="string"?Jr(y):y}return y}var ye;function I(_){try{var T=_.InflateRaw,y=new T;if(y._processChunk(new Uint8Array([3,0]),y._finishFlushFlag),y.bytesRead)ye=_;else throw new Error("zlib does not expose bytesRead")}catch(b){console.error("cannot use native zlib: "+(b.message||b))}}function j(_,T){if(!ye)return io(_,T);var y=ye.InflateRaw,b=new y,S=b._processChunk(_.slice(_.l),b._finishFlushFlag);return _.l+=b.bytesRead,S}function R(_){return ye?ye.deflateRawSync(_):Ae(_)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function te(_){var T=(_<<1|_<<11)&139536|(_<<5|_<<15)&558144;return(T>>16|T>>8|T)&255}for(var J=typeof Uint8Array<"u",ee=J?new Uint8Array(256):[],ke=0;ke<256;++ke)ee[ke]=te(ke);function C(_,T){var y=ee[_&255];return T<=8?y>>>8-T:(y=y<<8|ee[_>>8&255],T<=16?y>>>16-T:(y=y<<8|ee[_>>16&255],y>>>24-T))}function je(_,T){var y=T&7,b=T>>>3;return(_[b]|(y<=6?0:_[b+1]<<8))>>>y&3}function Fe(_,T){var y=T&7,b=T>>>3;return(_[b]|(y<=5?0:_[b+1]<<8))>>>y&7}function Pe(_,T){var y=T&7,b=T>>>3;return(_[b]|(y<=4?0:_[b+1]<<8))>>>y&15}function Ne(_,T){var y=T&7,b=T>>>3;return(_[b]|(y<=3?0:_[b+1]<<8))>>>y&31}function ue(_,T){var y=T&7,b=T>>>3;return(_[b]|(y<=1?0:_[b+1]<<8))>>>y&127}function Ye(_,T,y){var b=T&7,S=T>>>3,F=(1<<y)-1,G=_[S]>>>b;return y<8-b||(G|=_[S+1]<<8-b,y<16-b)||(G|=_[S+2]<<16-b,y<24-b)||(G|=_[S+3]<<24-b),G&F}function xr(_,T,y){var b=T&7,S=T>>>3;return b<=5?_[S]|=(y&7)<<b:(_[S]|=y<<b&255,_[S+1]=(y&7)>>8-b),T+3}function Cr(_,T,y){var b=T&7,S=T>>>3;return y=(y&1)<<b,_[S]|=y,T+1}function pt(_,T,y){var b=T&7,S=T>>>3;return y<<=b,_[S]|=y&255,y>>>=8,_[S+1]=y,T+8}function pe(_,T,y){var b=T&7,S=T>>>3;return y<<=b,_[S]|=y&255,y>>>=8,_[S+1]=y&255,_[S+2]=y>>>8,T+16}function Ee(_,T){var y=_.length,b=2*y>T?2*y:T+5,S=0;if(y>=T)return _;if(Oe){var F=Yo(b);if(_.copy)_.copy(F);else for(;S<_.length;++S)F[S]=_[S];return F}else if(J){var G=new Uint8Array(b);if(G.set)G.set(_);else for(;S<y;++S)G[S]=_[S];return G}return _.length=b,_}function Xe(_){for(var T=new Array(_),y=0;y<_;++y)T[y]=0;return T}function Fr(_,T,y){var b=1,S=0,F=0,G=0,q=0,H=_.length,V=J?new Uint16Array(32):Xe(32);for(F=0;F<32;++F)V[F]=0;for(F=H;F<y;++F)_[F]=0;H=_.length;var z=J?new Uint16Array(H):Xe(H);for(F=0;F<H;++F)V[S=_[F]]++,b<S&&(b=S),z[F]=0;for(V[0]=0,F=1;F<=b;++F)V[F+16]=q=q+V[F-1]<<1;for(F=0;F<H;++F)q=_[F],q!=0&&(z[F]=V[q+16]++);var ne=0;for(F=0;F<H;++F)if(ne=_[F],ne!=0)for(q=C(z[F],b)>>b-ne,G=(1<<b+4-ne)-1;G>=0;--G)T[q|G<<ne]=ne&15|F<<4;return b}var br=J?new Uint16Array(512):Xe(512),$r=J?new Uint16Array(32):Xe(32);if(!J){for(var fr=0;fr<512;++fr)br[fr]=0;for(fr=0;fr<32;++fr)$r[fr]=0}(function(){for(var _=[],T=0;T<32;T++)_.push(5);Fr(_,$r,32);var y=[];for(T=0;T<=143;T++)y.push(8);for(;T<=255;T++)y.push(9);for(;T<=279;T++)y.push(7);for(;T<=287;T++)y.push(8);Fr(y,br,288)})();var Ir=(function(){for(var T=J?new Uint8Array(32768):[],y=0,b=0;y<re.length-1;++y)for(;b<re[y+1];++b)T[b]=y;for(;b<32768;++b)T[b]=29;var S=J?new Uint8Array(259):[];for(y=0,b=0;y<K.length-1;++y)for(;b<K[y+1];++b)S[b]=y;function F(q,H){for(var V=0;V<q.length;){var z=Math.min(65535,q.length-V),ne=V+z==q.length;for(H.write_shift(1,+ne),H.write_shift(2,z),H.write_shift(2,~z&65535);z-- >0;)H[H.l++]=q[V++]}return H.l}function G(q,H){for(var V=0,z=0,ne=J?new Uint16Array(32768):[];z<q.length;){var de=Math.min(65535,q.length-z);if(de<10){for(V=xr(H,V,+(z+de==q.length)),V&7&&(V+=8-(V&7)),H.l=V/8|0,H.write_shift(2,de),H.write_shift(2,~de&65535);de-- >0;)H[H.l++]=q[z++];V=H.l*8;continue}V=xr(H,V,+(z+de==q.length)+2);for(var ge=0;de-- >0;){var ae=q[z];ge=(ge<<5^ae)&32767;var xe=-1,Ce=0;if((xe=ne[ge])&&(xe|=z&-32768,xe>z&&(xe-=32768),xe<z))for(;q[xe+Ce]==q[z+Ce]&&Ce<250;)++Ce;if(Ce>2){ae=S[Ce],ae<=22?V=pt(H,V,ee[ae+1]>>1)-1:(pt(H,V,3),V+=5,pt(H,V,ee[ae-23]>>5),V+=3);var er=ae<8?0:ae-4>>2;er>0&&(pe(H,V,Ce-K[ae]),V+=er),ae=T[z-xe],V=pt(H,V,ee[ae]>>3),V-=3;var rr=ae<4?0:ae-2>>1;rr>0&&(pe(H,V,z-xe-re[ae]),V+=rr);for(var Nr=0;Nr<Ce;++Nr)ne[ge]=z&32767,ge=(ge<<5^q[z])&32767,++z;de-=Ce-1}else ae<=143?ae=ae+48:V=Cr(H,V,1),V=pt(H,V,ee[ae]),ne[ge]=z&32767,++z}V=pt(H,V,0)-1}return H.l=(V+7)/8|0,H.l}return function(H,V){return H.length<8?F(H,V):G(H,V)}})();function Ae(_){var T=Y(50+Math.floor(_.length*1.1)),y=Ir(_,T);return T.slice(0,y)}var He=J?new Uint16Array(32768):Xe(32768),pr=J?new Uint16Array(32768):Xe(32768),Ke=J?new Uint16Array(128):Xe(128),Mt=1,Xn=1;function ii(_,T){var y=Ne(_,T)+257;T+=5;var b=Ne(_,T)+1;T+=5;var S=Pe(_,T)+4;T+=4;for(var F=0,G=J?new Uint8Array(19):Xe(19),q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=1,V=J?new Uint8Array(8):Xe(8),z=J?new Uint8Array(8):Xe(8),ne=G.length,de=0;de<S;++de)G[P[de]]=F=Fe(_,T),H<F&&(H=F),V[F]++,T+=3;var ge=0;for(V[0]=0,de=1;de<=H;++de)z[de]=ge=ge+V[de-1]<<1;for(de=0;de<ne;++de)(ge=G[de])!=0&&(q[de]=z[ge]++);var ae=0;for(de=0;de<ne;++de)if(ae=G[de],ae!=0){ge=ee[q[de]]>>8-ae;for(var xe=(1<<7-ae)-1;xe>=0;--xe)Ke[ge|xe<<ae]=ae&7|de<<3}var Ce=[];for(H=1;Ce.length<y+b;)switch(ge=Ke[ue(_,T)],T+=ge&7,ge>>>=3){case 16:for(F=3+je(_,T),T+=2,ge=Ce[Ce.length-1];F-- >0;)Ce.push(ge);break;case 17:for(F=3+Fe(_,T),T+=3;F-- >0;)Ce.push(0);break;case 18:for(F=11+ue(_,T),T+=7;F-- >0;)Ce.push(0);break;default:Ce.push(ge),H<ge&&(H=ge);break}var er=Ce.slice(0,y),rr=Ce.slice(y);for(de=y;de<286;++de)er[de]=0;for(de=b;de<30;++de)rr[de]=0;return Mt=Fr(er,He,286),Xn=Fr(rr,pr,30),T}function oi(_,T){if(_[0]==3&&!(_[1]&3))return[Xt(T),2];for(var y=0,b=0,S=Yo(T||1<<18),F=0,G=S.length>>>0,q=0,H=0;(b&1)==0;){if(b=Fe(_,y),y+=3,b>>>1)b>>1==1?(q=9,H=5):(y=ii(_,y),q=Mt,H=Xn);else{y&7&&(y+=8-(y&7));var V=_[y>>>3]|_[(y>>>3)+1]<<8;if(y+=32,V>0)for(!T&&G<F+V&&(S=Ee(S,F+V),G=S.length);V-- >0;)S[F++]=_[y>>>3],y+=8;continue}for(;;){!T&&G<F+32767&&(S=Ee(S,F+32767),G=S.length);var z=Ye(_,y,q),ne=b>>>1==1?br[z]:He[z];if(y+=ne&15,ne>>>=4,(ne>>>8&255)===0)S[F++]=ne;else{if(ne==256)break;ne-=257;var de=ne<8?0:ne-4>>2;de>5&&(de=0);var ge=F+K[ne];de>0&&(ge+=Ye(_,y,de),y+=de),z=Ye(_,y,H),ne=b>>>1==1?$r[z]:pr[z],y+=ne&15,ne>>>=4;var ae=ne<4?0:ne-2>>1,xe=re[ne];for(ae>0&&(xe+=Ye(_,y,ae),y+=ae),!T&&G<ge&&(S=Ee(S,ge+100),G=S.length);F<ge;)S[F]=S[F-xe],++F}}}return T?[S,y+7>>>3]:[S.slice(0,F),y+7>>>3]}function io(_,T){var y=_.slice(_.l||0),b=oi(y,T);return _.l+=b[1],b[0]}function oo(_,T){if(_)typeof console<"u"&&console.error(T);else throw new Error(T)}function co(_,T){var y=_;Tr(y,0);var b=[],S=[],F={FileIndex:b,FullPaths:S};k(F,{root:T.root});for(var G=y.length-4;(y[G]!=80||y[G+1]!=75||y[G+2]!=5||y[G+3]!=6)&&G>=0;)--G;y.l=G+4,y.l+=4;var q=y.read_shift(2);y.l+=6;var H=y.read_shift(4);for(y.l=H,G=0;G<q;++G){y.l+=20;var V=y.read_shift(4),z=y.read_shift(4),ne=y.read_shift(2),de=y.read_shift(2),ge=y.read_shift(2);y.l+=8;var ae=y.read_shift(4),xe=o(y.slice(y.l+ne,y.l+ne+de));y.l+=ne+de+ge;var Ce=y.l;y.l=ae+4,Xd(y,V,z,F,xe),y.l=Ce}return F}function Xd(_,T,y,b,S){_.l+=2;var F=_.read_shift(2),G=_.read_shift(2),q=i(_);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var H=_.read_shift(4),V=_.read_shift(4),z=_.read_shift(4),ne=_.read_shift(2),de=_.read_shift(2),ge="",ae=0;ae<ne;++ae)ge+=String.fromCharCode(_[_.l++]);if(de){var xe=o(_.slice(_.l,_.l+de));(xe[21589]||{}).mt&&(q=xe[21589].mt),((S||{})[21589]||{}).mt&&(q=S[21589].mt)}_.l+=de;var Ce=_.slice(_.l,_.l+V);switch(G){case 8:Ce=j(_,z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var er=!1;F&8&&(H=_.read_shift(4),H==134695760&&(H=_.read_shift(4),er=!0),V=_.read_shift(4),z=_.read_shift(4)),V!=T&&oo(er,"Bad compressed size: "+T+" != "+V),z!=y&&oo(er,"Bad uncompressed size: "+y+" != "+z),ci(b,ge,Ce,{unsafe:!0,mt:q})}function Kd(_,T){var y=T||{},b=[],S=[],F=Y(1),G=y.compression?8:0,q=0,H=0,V=0,z=0,ne=0,de=_.FullPaths[0],ge=de,ae=_.FileIndex[0],xe=[],Ce=0;for(H=1;H<_.FullPaths.length;++H)if(ge=_.FullPaths[H].slice(de.length),ae=_.FileIndex[H],!(!ae.size||!ae.content||ge=="Sh33tJ5")){var er=z,rr=Y(ge.length);for(V=0;V<ge.length;++V)rr.write_shift(1,ge.charCodeAt(V)&127);rr=rr.slice(0,rr.l),xe[ne]=Vg.buf(ae.content,0);var Nr=ae.content;G==8&&(Nr=R(Nr)),F=Y(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,q),F.write_shift(2,G),ae.mt?s(F,ae.mt):F.write_shift(4,0),F.write_shift(-4,xe[ne]),F.write_shift(4,Nr.length),F.write_shift(4,ae.content.length),F.write_shift(2,rr.length),F.write_shift(2,0),z+=F.length,b.push(F),z+=rr.length,b.push(rr),z+=Nr.length,b.push(Nr),F=Y(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,q),F.write_shift(2,G),F.write_shift(4,0),F.write_shift(-4,xe[ne]),F.write_shift(4,Nr.length),F.write_shift(4,ae.content.length),F.write_shift(2,rr.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,er),Ce+=F.l,S.push(F),Ce+=rr.length,S.push(rr),++ne}return F=Y(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,ne),F.write_shift(2,ne),F.write_shift(4,Ce),F.write_shift(4,z),F.write_shift(2,0),_r([_r(b),_r(S),F])}var es={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Yd(_,T){if(_.ctype)return _.ctype;var y=_.name||"",b=y.match(/\.([^\.]+)$/);return b&&es[b[1]]||T&&(b=(y=T).match(/[\.\\]([^\.\\])+$/),b&&es[b[1]])?es[b[1]]:"application/octet-stream"}function qd(_){for(var T=Ca(_),y=[],b=0;b<T.length;b+=76)y.push(T.slice(b,b+76));return y.join(`\r
`)+`\r
`}function Jd(_){var T=_.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(V){var z=V.charCodeAt(0).toString(16).toUpperCase();return"="+(z.length==1?"0"+z:z)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var y=[],b=T.split(`\r
`),S=0;S<b.length;++S){var F=b[S];if(F.length==0){y.push("");continue}for(var G=0;G<F.length;){var q=76,H=F.slice(G,G+q);H.charAt(q-1)=="="?q--:H.charAt(q-2)=="="?q-=2:H.charAt(q-3)=="="&&(q-=3),H=F.slice(G,G+q),G+=q,G<F.length&&(H+="="),y.push(H)}}return y.join(`\r
`)}function Zd(_){for(var T=[],y=0;y<_.length;++y){for(var b=_[y];y<=_.length&&b.charAt(b.length-1)=="=";)b=b.slice(0,b.length-1)+_[++y];T.push(b)}for(var S=0;S<T.length;++S)T[S]=T[S].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return Jr(T.join(`\r
`))}function Qd(_,T,y){for(var b="",S="",F="",G,q=0;q<10;++q){var H=T[q];if(!H||H.match(/^\s*$/))break;var V=H.match(/^(.*?):\s*([^\s].*)$/);if(V)switch(V[1].toLowerCase()){case"content-location":b=V[2].trim();break;case"content-type":F=V[2].trim();break;case"content-transfer-encoding":S=V[2].trim();break}}switch(++q,S.toLowerCase()){case"base64":G=Jr(tt(T.slice(q).join("")));break;case"quoted-printable":G=Zd(T.slice(q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+S)}var z=ci(_,b.slice(y.length),G,{unsafe:!0});F&&(z.ctype=F)}function eh(_,T){if(U(_.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var y=T&&T.root||"",b=(Oe&&Buffer.isBuffer(_)?_.toString("binary"):U(_)).split(`\r
`),S=0,F="";for(S=0;S<b.length;++S)if(F=b[S],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),y||(y=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,y.length)!=y))for(;y.length>0&&(y=y.slice(0,y.length-1),y=y.slice(0,y.lastIndexOf("/")+1),F.slice(0,y.length)!=y););var G=(b[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var q="--"+(G[1]||""),H=[],V=[],z={FileIndex:H,FullPaths:V};k(z);var ne,de=0;for(S=0;S<b.length;++S){var ge=b[S];ge!==q&&ge!==q+"--"||(de++&&Qd(z,b.slice(ne,S),y),ne=S)}return z}function rh(_,T){var y=T||{},b=y.boundary||"SheetJS";b="------="+b;for(var S=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+b.slice(2)+'"',"","",""],F=_.FullPaths[0],G=F,q=_.FileIndex[0],H=1;H<_.FullPaths.length;++H)if(G=_.FullPaths[H].slice(F.length),q=_.FileIndex[H],!(!q.size||!q.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ce){return"_x"+Ce.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ce){return"_u"+Ce.charCodeAt(0).toString(16)+"_"});for(var V=q.content,z=Oe&&Buffer.isBuffer(V)?V.toString("binary"):U(V),ne=0,de=Math.min(1024,z.length),ge=0,ae=0;ae<=de;++ae)(ge=z.charCodeAt(ae))>=32&&ge<128&&++ne;var xe=ne>=de*4/5;S.push(b),S.push("Content-Location: "+(y.root||"file:///C:/SheetJS/")+G),S.push("Content-Transfer-Encoding: "+(xe?"quoted-printable":"base64")),S.push("Content-Type: "+Yd(q,G)),S.push(""),S.push(xe?Jd(z):qd(z))}return S.push(b+`--\r
`),S.join(`\r
`)}function th(_){var T={};return k(T,_),T}function ci(_,T,y,b){var S=b&&b.unsafe;S||k(_);var F=!S&&we.find(_,T);if(!F){var G=_.FullPaths[0];T.slice(0,G.length)==G?G=T:(G.slice(-1)!="/"&&(G+="/"),G=(G+T).replace("//","/")),F={name:a(T),type:2},_.FileIndex.push(F),_.FullPaths.push(G),S||we.utils.cfb_gc(_)}return F.content=y,F.size=y?y.length:0,b&&(b.CLSID&&(F.clsid=b.CLSID),b.mt&&(F.mt=b.mt),b.ct&&(F.ct=b.ct)),F}function nh(_,T){k(_);var y=we.find(_,T);if(y){for(var b=0;b<_.FileIndex.length;++b)if(_.FileIndex[b]==y)return _.FileIndex.splice(b,1),_.FullPaths.splice(b,1),!0}return!1}function ah(_,T,y){k(_);var b=we.find(_,T);if(b){for(var S=0;S<_.FileIndex.length;++S)if(_.FileIndex[S]==b)return _.FileIndex[S].name=a(y),_.FullPaths[S]=y,!0}return!1}function sh(_){O(_,!0)}return r.find=B,r.read=N,r.parse=f,r.write=me,r.writeFile=ve,r.utils={cfb_new:th,cfb_add:ci,cfb_del:nh,cfb_mov:ah,cfb_gc:sh,ReadShift:fa,CheckField:hu,prep_blob:Tr,bconcat:_r,use_zlib:I,_deflateRaw:Ae,_inflateRaw:io,consts:X},r})();function $g(e){return typeof e=="string"?Js(e):Array.isArray(e)?gg(e):e}function $a(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Js(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?St(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([$g(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=Jt(r)),o.write(r),o.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function zg(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ir(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function nc(e,r){for(var t=[],n=ir(e),a=0;a!==n.length;++a)t[e[n[a]][r]]==null&&(t[e[n[a]][r]]=n[a]);return t}function Qs(e){for(var r=[],t=ir(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function ei(e){for(var r=[],t=ir(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function Xg(e){for(var r=[],t=ir(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var Ps=new Date(1899,11,30,0,0,0);function gr(e,r){var t=e.getTime(),n=Ps.getTime()+(e.getTimezoneOffset()-Ps.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var zf=new Date,Kg=Ps.getTime()+(zf.getTimezoneOffset()-Ps.getTimezoneOffset())*6e4,ac=zf.getTimezoneOffset();function ri(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Kg),r.getTimezoneOffset()!==ac&&r.setTime(r.getTime()+(r.getTimezoneOffset()-ac)*6e4),r}function Yg(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[s],10)}return r}var sc=new Date("2017-02-19T19:06:09.000Z"),Xf=isNaN(sc.getFullYear())?new Date("2/19/17"):sc,qg=Xf.getFullYear()==2017;function Ze(e,r){var t=new Date(e);if(qg)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Xf.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function dn(e,r){if(Oe&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return St(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return St(Rf(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return St(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return St(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Qe(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Qe(e[t]));return r}function ar(e,r){for(var t="";t.length<r;)t+=e;return t}function wt(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(r=Number(n)))?r/t:r}var Jg=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bn(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Jg.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Zg=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var s=t.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}})();function Kf(e){return e?e.content&&e.type?dn(e.content,!0):e.data?na(e.data):e.asNodeBuffer&&Oe?na(e.asNodeBuffer().toString("binary")):e.asBinary?na(e.asBinary()):e._data&&e._data.getContent?na(dn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Yf(e){if(!e)return null;if(e.data)return Xo(e.data);if(e.asNodeBuffer&&Oe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Xo(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Qg(e){return e&&e.name.slice(-4)===".bin"?Yf(e):Kf(e)}function ct(e,r){for(var t=e.FullPaths||ir(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var i=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function k0(e,r){var t=ct(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function dr(e,r,t){if(!t)return Qg(k0(e,r));if(!r)return null;try{return dr(e,r)}catch{return null}}function Zr(e,r,t){if(!t)return Kf(k0(e,r));if(!r)return null;try{return Zr(e,r)}catch{return null}}function ev(e,r,t){return Yf(k0(e,r))}function ic(e){for(var r=e.FullPaths||ir(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function De(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Oe?n=Pt(t):n=vg(t),we.utils.cfb_add(e,r,n)}we.utils.cfb_add(e,r,t)}else e.file(r,t)}function T0(){return we.utils.cfb_new()}function qf(e,r){switch(r.type){case"base64":return we.read(e,{type:"base64"});case"binary":return we.read(e,{type:"binary"});case"buffer":case"array":return we.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function sa(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,rv=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,oc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tv=/<[^>]*>/g,Ur=lr.match(oc)?oc:tv,nv=/<\w*:/,av=/<(\/?)\w+:/;function Se(e,r,t){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(rv),o=0,c="",l=0,f="",u="",d=1;if(i)for(l=0;l!=i.length;++l){for(u=i[l],s=0;s!=u.length&&u.charCodeAt(s)!==61;++s);for(f=u.slice(0,s).trim();u.charCodeAt(s+1)==32;)++s;for(d=(a=u.charCodeAt(s+1))==34||a==39?1:0,c=u.slice(s+1+d,u.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var h=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[h]&&f.slice(o-3,o)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function At(e){return e.replace(av,"<$1")}var Jf={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},S0=Qs(Jf),Be=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,c){return Jf[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,i)+t(a.slice(i+3))}})(),A0=/[&<>'"]/g,sv=/[\u0000-\u0008\u000b-\u001f]/g;function $e(e){var r=e+"";return r.replace(A0,function(t){return S0[t]}).replace(sv,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function cc(e){return $e(e).replace(/ /g,"_x0020_")}var Zf=/[\u0000-\u001f]/g;function C0(e){var r=e+"";return r.replace(A0,function(t){return S0[t]}).replace(/\n/g,"<br/>").replace(Zf,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function iv(e){var r=e+"";return r.replace(A0,function(t){return S0[t]}).replace(Zf,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var lc=(function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}})();function ov(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function qe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yi(e){for(var r="",t=0,n=0,a=0,s=0,i=0,o=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){i=(n&31)<<6,i|=a&63,r+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(t++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function fc(e){var r=Xt(2*e.length),t,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(t=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(r[s++]=i&255,r[s++]=i>>>8,i=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function uc(e){return Pt(e,"binary").toString("utf8")}var is="foo bar baz",ze=Oe&&(uc(is)==yi(is)&&uc||fc(is)==yi(is)&&fc)||yi,St=Oe?function(e){return Pt(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Ia=(function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),Qf=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),cv=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),lv=/<\/?(?:vt:)?variant>/g,fv=/<(?:vt:)([^>]*)>([\s\S]*)</;function dc(e,r){var t=Se(e),n=e.match(cv(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(s){var i=s.replace(lv,"").match(fv);i&&a.push({v:ze(i[2]),t:i[1]})}),a}var eu=/(^\s|\s$|\n)/;function Sr(e,r){return"<"+e+(r.match(eu)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Na(e){return ir(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function ie(e,r,t){return"<"+e+(t!=null?Na(t):"")+(r!=null?(r.match(eu)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Ui(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function uv(e,r){switch(typeof e){case"string":var t=ie("vt:lpwstr",$e(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return ie((e|0)==e?"vt:i4":"vt:r8",$e(String(e)));case"boolean":return ie("vt:bool",e?"true":"false")}if(e instanceof Date)return ie("vt:filetime",Ui(e));throw new Error("Unable to serialize "+e)}function F0(e){if(Oe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ze(Jt(y0(e)));throw new Error("Bad input format: expected Buffer or string")}var Da=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,mr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function dv(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,s=5;s>=0;--s)a=a*256+e[r+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function hv(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,s=0,i=n?-r:r;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(r)?26985:0);for(var o=0;o<=5;++o,s/=256)e[t+o]=s&255;e[t+6]=(a&15)<<4|s&15,e[t+7]=a>>4|n}var hc=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},xc=Oe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Pt(r)})):hc(e)}:hc,pc=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(It(e,a)));return n.join("").replace(Vr,"")},I0=Oe?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Vr,""):pc(e,r,t)}:pc,mc=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},ru=Oe?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):mc(e,r,t)}:mc,gc=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(Cn(e,a)));return n.join("")},za=Oe?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):gc(r,t,n)}:gc,tu=function(e,r){var t=qr(e,r);return t>0?za(e,r+4,r+4+t-1):""},nu=tu,au=function(e,r){var t=qr(e,r);return t>0?za(e,r+4,r+4+t-1):""},su=au,iu=function(e,r){var t=2*qr(e,r);return t>0?za(e,r+4,r+4+t-1):""},ou=iu,cu=function(r,t){var n=qr(r,t);return n>0?I0(r,t+4,t+4+n):""},lu=cu,fu=function(e,r){var t=qr(e,r);return t>0?za(e,r+4,r+4+t):""},uu=fu,du=function(e,r){return dv(e,r)},Ls=du,N0=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Oe&&(nu=function(r,t){if(!Buffer.isBuffer(r))return tu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},su=function(r,t){if(!Buffer.isBuffer(r))return au(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},ou=function(r,t){if(!Buffer.isBuffer(r))return iu(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},lu=function(r,t){if(!Buffer.isBuffer(r))return cu(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},uu=function(r,t){if(!Buffer.isBuffer(r))return fu(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Ls=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):du(r,t)},N0=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Cn=function(e,r){return e[r]},It=function(e,r){return e[r+1]*256+e[r]},xv=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},qr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},nn=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},pv=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function fa(e,r){var t="",n,a,s=[],i,o,c,l;switch(r){case"dbcs":if(l=this.l,Oe&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(It(this,l)),l+=2;e*=2;break;case"utf8":t=za(this,this.l,this.l+e);break;case"utf16le":e*=2,t=I0(this,this.l,this.l+e);break;case"wstr":return fa.call(this,e,"dbcs");case"lpstr-ansi":t=nu(this,this.l),e=4+qr(this,this.l);break;case"lpstr-cp":t=su(this,this.l),e=4+qr(this,this.l);break;case"lpwstr":t=ou(this,this.l),e=4+2*qr(this,this.l);break;case"lpp4":e=4+qr(this,this.l),t=lu(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qr(this,this.l),t=uu(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(i=Cn(this,this.l+e++))!==0;)s.push(ss(i));t=s.join("");break;case"_wstr":for(e=0,t="";(i=It(this,this.l+e))!==0;)s.push(ss(i)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=Cn(this,l),this.l=l+1,o=fa.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ss(It(this,l))),l+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=Cn(this,l),this.l=l+1,o=fa.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ss(Cn(this,l))),l+=1}t=s.join("");break;default:switch(e){case 1:return n=Cn(this,this.l),this.l++,n;case 2:return n=(r==="i"?xv:It)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?nn:pv)(this,this.l),this.l+=4,n):(a=qr(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Ls(this,this.l):a=Ls([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=ru(this,this.l,e);break}}return this.l+=e,t}var mv=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},gv=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},vv=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function _v(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)vv(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var i=r.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,mv(this,r,this.l);break;case 8:if(n=8,t==="f"){hv(this,r,this.l);break}case 16:break;case-4:n=4,gv(this,r,this.l);break}return this.l+=n,this}function hu(e,r){var t=ru(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Tr(e,r){e.l=r,e.read_shift=fa,e.chk=hu,e.write_shift=_v}function jr(e,r){e.l+=r}function Y(e){var r=Xt(e);return Tr(r,0),r}function Lt(e,r,t){if(e){var n,a,s;Tr(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=Ma[o]||Ma[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;c=e.l+s;var f=l.f&&l.f(e,s,t);if(e.l=c,r(f,l,o))return}}}function Xr(){var e=[],r=Oe?256:2048,t=function(l){var f=Y(l);return Tr(f,0),f},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(a(),n=t(Math.max(l+1,r)))},i=function(){return a(),_r(e)},o=function(l){a(),n=l,n.l==null&&(n.l=n.length),s(r)};return{next:s,push:o,end:i,_bufs:e}}function Q(e,r,t,n){var a=+r,s;if(!isNaN(a)){n||(n=Ma[a].p||(t||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&N0(t)&&e.push(t)}}function ua(e,r,t){var n=Qe(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vc(e,r,t){var n=Qe(e);return n.s=ua(n.s,r.s,t),n.e=ua(n.e,r.s,t),n}function da(e,r){if(e.cRel&&e.c<0)for(e=Qe(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Qe(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Te(e);return!e.cRel&&e.cRel!=null&&(t=Ev(t)),!e.rRel&&e.rRel!=null&&(t=wv(t)),t}function Ei(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+tr(e.s.c)+":"+(e.e.cRel?"":"$")+tr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+cr(e.s.r)+":"+(e.e.rRel?"":"$")+cr(e.e.r):da(e.s,r.biff)+":"+da(e.e,r.biff)}function D0(e){return parseInt(yv(e),10)-1}function cr(e){return""+(e+1)}function wv(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yv(e){return e.replace(/\$(\d+)$/,"$1")}function O0(e){for(var r=bv(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function tr(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Ev(e){return e.replace(/^([A-Z])/,"$$$1")}function bv(e){return e.replace(/^\$([A-Z])/,"$1")}function kv(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function nr(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function Te(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Kr(e){var r=e.indexOf(":");return r==-1?{s:nr(e),e:nr(e)}:{s:nr(e.slice(0,r)),e:nr(e.slice(r+1))}}function Ie(e,r){return typeof r>"u"||typeof r=="number"?Ie(e.s,e.e):(typeof e!="string"&&(e=Te(e)),typeof r!="string"&&(r=Te(r)),e==r?e:e+":"+r)}function Me(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=e.length;for(t=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===s||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function _c(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=ht(e.z,t?gr(r):r)}catch{}try{return e.w=ht((e.XF||{}).numFmtId||(t?14:0),t?gr(r):r)}catch{return""+r}}function Rt(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Bt[e.v]||e.v:r==null?_c(e,e.v):_c(e,r))}function Zt(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function xu(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?nr(n.origin):n.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Me(s["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),i==-1&&(l.e.r=i=f.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=r[u].length;++d)if(!(typeof r[u][d]>"u")){var h={v:r[u][d]},p=i+u,x=o+d;if(l.s.r>p&&(l.s.r=p),l.s.c>x&&(l.s.c=x),l.e.r<p&&(l.e.r=p),l.e.c<x&&(l.e.c=x),r[u][d]&&typeof r[u][d]=="object"&&!Array.isArray(r[u][d])&&!(r[u][d]instanceof Date))h=r[u][d];else if(Array.isArray(h.v)&&(h.f=r[u][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||be[14],n.cellDates?(h.t="d",h.w=ht(h.z,gr(h.v))):(h.t="n",h.v=gr(h.v),h.w=ht(h.z,h.v))):h.t="s";if(a)s[p]||(s[p]=[]),s[p][x]&&s[p][x].z&&(h.z=s[p][x].z),s[p][x]=h;else{var m=Te({c:x,r:p});s[m]&&s[m].z&&(h.z=s[m].z),s[m]=h}}}return l.s.c<1e7&&(s["!ref"]=Ie(l)),s}function $n(e,r){return xu(null,e,r)}function Tv(e){return e.read_shift(4,"i")}function yt(e,r){return r||(r=Y(4)),r.write_shift(4,e),r}function Mr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function wr(e,r){var t=!1;return r==null&&(t=!0,r=Y(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Sv(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Av(e,r){return r||(r=Y(4)),r.write_shift(2,0),r.write_shift(2,0),r}function R0(e,r){var t=e.l,n=e.read_shift(1),a=Mr(e),s=[],i={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(Sv(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=t+r,i}function Cv(e,r){var t=!1;return r==null&&(t=!0,r=Y(15+4*e.t.length)),r.write_shift(1,0),wr(e.t,r),t?r.slice(0,r.l):r}var Fv=R0;function Iv(e,r){var t=!1;return r==null&&(t=!0,r=Y(23+4*e.t.length)),r.write_shift(1,1),wr(e.t,r),r.write_shift(4,1),Av({},r),t?r.slice(0,r.l):r}function xt(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function _n(e,r){return r==null&&(r=Y(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function wn(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function yn(e,r){return r==null&&(r=Y(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Nv=Mr,pu=wr;function P0(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Bs(e,r){var t=!1;return r==null&&(t=!0,r=Y(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Dv=Mr,Wi=P0,L0=Bs;function B0(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?Ls([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):nn(r,0)>>2;return t?a/100:a}function mu(e,r){r==null&&(r=Y(4));var t=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?a:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function gu(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function Ov(e,r){return r||(r=Y(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var En=gu,zn=Ov;function Lr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hn(e,r){return(r||Y(8)).write_shift(8,e,"f")}function Rv(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var l=sn[a];l&&(r.rgb=Ra(l));break;case 2:r.rgb=Ra([i,o,c]);break;case 3:r.theme=a;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function Ms(e,r){if(r||(r=Y(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function Pv(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Lv(e,r){r||(r=Y(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function vu(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Bv(e){return vu(e,1)}function Mv(e){return vu(e,2)}var M0=2,zr=3,os=11,wc=12,js=19,cs=64,jv=65,Uv=71,Wv=4108,Hv=4126,vr=80,_u=81,Gv=[vr,_u],Hi={1:{n:"CodePage",t:M0},2:{n:"Category",t:vr},3:{n:"PresentationFormat",t:vr},4:{n:"ByteCount",t:zr},5:{n:"LineCount",t:zr},6:{n:"ParagraphCount",t:zr},7:{n:"SlideCount",t:zr},8:{n:"NoteCount",t:zr},9:{n:"HiddenCount",t:zr},10:{n:"MultimediaClipCount",t:zr},11:{n:"ScaleCrop",t:os},12:{n:"HeadingPairs",t:Wv},13:{n:"TitlesOfParts",t:Hv},14:{n:"Manager",t:vr},15:{n:"Company",t:vr},16:{n:"LinksUpToDate",t:os},17:{n:"CharacterCount",t:zr},19:{n:"SharedDoc",t:os},22:{n:"HyperlinksChanged",t:os},23:{n:"AppVersion",t:zr,p:"version"},24:{n:"DigSig",t:jv},26:{n:"ContentType",t:vr},27:{n:"ContentStatus",t:vr},28:{n:"Language",t:vr},29:{n:"Version",t:vr},255:{},2147483648:{n:"Locale",t:js},2147483651:{n:"Behavior",t:js},1919054434:{}},Gi={1:{n:"CodePage",t:M0},2:{n:"Title",t:vr},3:{n:"Subject",t:vr},4:{n:"Author",t:vr},5:{n:"Keywords",t:vr},6:{n:"Comments",t:vr},7:{n:"Template",t:vr},8:{n:"LastAuthor",t:vr},9:{n:"RevNumber",t:vr},10:{n:"EditTime",t:cs},11:{n:"LastPrinted",t:cs},12:{n:"CreatedDate",t:cs},13:{n:"ModifiedDate",t:cs},14:{n:"PageCount",t:zr},15:{n:"WordCount",t:zr},16:{n:"CharCount",t:zr},17:{n:"Thumbnail",t:Uv},18:{n:"Application",t:vr},19:{n:"DocSecurity",t:zr},255:{},2147483648:{n:"Locale",t:js},2147483651:{n:"Behavior",t:js},1919054434:{}},yc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Vv=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $v(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var zv=$v([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),sn=Qe(zv),Bt={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},wu={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Vi={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ls={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function j0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Xv(e){var r=j0();if(!e||!e.match)return r;var t={};if((e.match(Ur)||[]).forEach(function(n){var a=Se(n);switch(a[0].replace(nv,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[Vi[a.ContentType]]!==void 0&&r[Vi[a.ContentType]].push(a.PartName);break}}),r.xmlns!==mr.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function yu(e,r){var t=Xg(Vi),n=[],a;n[n.length]=lr,n[n.length]=ie("Types",null,{xmlns:mr.CT,"xmlns:xsd":mr.xsd,"xmlns:xsi":mr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ie("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=ie("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:ls[c][r.bookType]||ls[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(l){n[n.length]=ie("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:ls[c][r.bookType]||ls[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(l){n[n.length]=ie("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[c][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Re={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Oa(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function ha(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(Ur)||[]).forEach(function(a){var s=Se(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:sa(s.Target,r);t[o]=i,n[s.Id]=i}}),t["!id"]=n,t}function Nn(e){var r=[lr,ie("Relationships",null,{xmlns:mr.RELS})];return ir(e["!id"]).forEach(function(t){r[r.length]=ie("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Ve(e,r,t,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,a.Id="rId"+r,a.Type=n,a.Target=t,[Re.HLINK,Re.XPATH,Re.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,r}var Kv="application/vnd.oasis.opendocument.spreadsheet";function Yv(e,r){for(var t=F0(e),n,a;n=Da.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Se(n[0],!1),a.path=="/"&&a.type!==Kv)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}function qv(e){var r=[lr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Ec(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Jv(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Zv(e){var r=[lr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Ec(e[t][0],e[t][1])),r.push(Jv("",e[t][0]));return r.push(Ec("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function Eu(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ns.version+"</meta:generator></office:meta></office:document-meta>"}var dt=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Qv=(function(){for(var e=new Array(dt.length),r=0;r<dt.length;++r){var t=dt[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function bu(e){var r={};e=ze(e);for(var t=0;t<dt.length;++t){var n=dt[t],a=e.match(Qv[t]);a!=null&&a.length>0&&(r[n[1]]=Be(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Ze(r[n[1]]))}return r}function bi(e,r,t,n,a){a[e]!=null||r==null||r===""||(a[e]=r,r=$e(r),n[n.length]=t?ie(e,r,t):Sr(e,r))}function ku(e,r){var t=r||{},n=[lr,ie("cp:coreProperties",null,{"xmlns:cp":mr.CORE_PROPS,"xmlns:dc":mr.dc,"xmlns:dcterms":mr.dcterms,"xmlns:dcmitype":mr.dcmitype,"xmlns:xsi":mr.xsi})],a={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&bi("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ui(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&bi("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ui(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=dt.length;++s){var i=dt[s],o=t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&bi(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var on=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Tu=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Su(e,r,t,n){var a=[];if(typeof e=="string")a=dc(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof r=="string"?dc(r,n).map(function(f){return f.v}):r,o=0,c=0;if(i.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=c,t.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=i.slice(o,o+c);break}o+=c}}function e2(e,r,t){var n={};return r||(r={}),e=ze(e),on.forEach(function(a){var s=(e.match(Ia(a[0]))||[])[1];switch(a[2]){case"string":s&&(r[a[1]]=Be(s));break;case"bool":r[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Su(n.HeadingPairs,n.TitlesOfParts,r,t),r}function Au(e){var r=[],t=ie;return e||(e={}),e.Application="SheetJS",r[r.length]=lr,r[r.length]=ie("Properties",null,{xmlns:mr.EXT_PROPS,"xmlns:vt":mr.vt}),on.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=$e(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(r[r.length]=t(n[0],a))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+$e(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var r2=/<[^>]+>[^<]*/g;function t2(e,r){var t={},n="",a=e.match(r2);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Se(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Be(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[n]=Be(f);break;case"bool":t[n]=qe(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(f);break;case"filetime":case"date":t[n]=Ze(f);break;case"cy":case"error":t[n]=Be(f);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",i,l,c)}}else if(i.slice(0,2)!=="</"){if(r.WTF)throw new Error(i)}}}return t}function Cu(e){var r=[lr,ie("Properties",null,{xmlns:mr.CUST_PROPS,"xmlns:vt":mr.vt})];if(!e)return r.join("");var t=1;return ir(e).forEach(function(a){++t,r[r.length]=ie("property",uv(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:$e(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var $i={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ki;function n2(e,r,t){ki||(ki=Qs($i)),r=ki[r]||r,e[r]=t}function a2(e,r){var t=[];return ir($i).map(function(n){for(var a=0;a<dt.length;++a)if(dt[a][1]==n)return dt[a];for(a=0;a<on.length;++a)if(on[a][1]==n)return on[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(Sr($i[n[1]]||n[1],a))}}),ie("DocumentProperties",t.join(""),{xmlns:Yr.o})}function s2(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&ir(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<dt.length;++i)if(s==dt[i][1])return;for(i=0;i<on.length;++i)if(s==on[i][1])return;for(i=0;i<t.length;++i)if(s==t[i])return;var o=e[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(ie(cc(s),o,{"dt:dt":c}))}}),r&&ir(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=r[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(ie(cc(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Yr.o+'">'+a.join("")+"</"+n+">"}function U0(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function i2(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),a=(t-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=Y(8);return i.write_shift(4,n),i.write_shift(4,a),i}function Fu(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function Iu(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function Nu(e,r,t){return r===31?Iu(e):Fu(e,r,t)}function zi(e,r,t){return Nu(e,r,t===!1?0:4)}function o2(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Nu(e,r,0)}function c2(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Vr,""),e.l-a&2&&(e.l+=2)}return t}function l2(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Vr,"");return t}function f2(e){var r=e.l,t=Us(e,_u);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Us(e,zr);return[t,n]}function u2(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(f2(e));return t}function bc(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,r===1200?"utf16le":"utf8").replace(Vr,"").replace(aa,"!"),r===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Du(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function d2(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Us(e,r,t){var n=e.read_shift(2),a,s=t||{};if(e.l+=2,r!==wc&&n!==r&&Gv.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===wc?n:r){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Fu(e,n,4).replace(Vr,"");case 31:return Iu(e);case 64:return U0(e);case 65:return Du(e);case 71:return d2(e);case 80:return zi(e,n,!s.raw).replace(Vr,"");case 81:return o2(e,n).replace(Vr,"");case 4108:return u2(e);case 4126:case 4127:return n==4127?c2(e):l2(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function kc(e,r){var t=Y(4),n=Y(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=Y(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=i2(r);break;case 31:case 80:for(n=Y(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return _r([t,n])}function Tc(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,c=-1,l={};for(i=0;i!=a;++i){var f=e.read_shift(4),u=e.read_shift(4);s[i]=[f,u+t]}s.sort(function(E,w){return E[1]-w[1]});var d={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&r)switch(r[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break}if((!r||i==0)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(r){var p=r[s[i][0]];if(d[p.n]=Us(e,p.t,{raw:!0}),p.p==="version"&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(d[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:vt(o=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(s[i][0]===1){if(o=d.CodePage=Us(e,M0),vt(o),c!==-1){var x=e.l;e.l=s[c][1],l=bc(e,o),e.l=x}}else if(s[i][0]===0){if(o===0){c=i,e.l=s[i+1][1];continue}l=bc(e,o)}else{var m=l[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=Du(e);break;case 30:e.l+=4,v=zi(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=zi(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=or(e,4);break;case 64:e.l+=4,v=Ze(U0(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[m]=v}}return e.l=t+n,d}var Ou=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function h2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Sc(e,r,t){var n=Y(8),a=[],s=[],i=8,o=0,c=Y(8),l=Y(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),a.push(l),i+=8+c.length,!r){l=Y(8),l.write_shift(4,0),a.unshift(l);var f=[Y(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for(c=Y(8+2*(u.length+1)+(u.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,u.length+1),c.write_shift(0,u,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=_r(f),s.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(r&&!r[e[o][0]])&&!(Ou.indexOf(e[o][0])>-1||Tu.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],h=0;if(r){h=+r[e[o][0]];var p=t[h];if(p.p=="version"&&typeof d=="string"){var x=d.split(".");d=(+x[0]<<16)+(+x[1]||0)}c=kc(p.t,d)}else{var m=h2(d);m==-1&&(m=31,d=String(d)),c=kc(m,d)}s.push(c),l=Y(8),l.write_shift(4,r?h:2+o),a.push(l),i+=8+c.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),_r([n].concat(a).concat(s))}function Ac(e,r,t){var n=e.content;if(!n)return{};Tr(n,0);var a,s,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),f=n.read_shift(16);if(f!==we.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),c=n.read_shift(4));var u=Tc(n,r),d={SystemIdentifier:l};for(var h in u)d[h]=u[h];if(d.FMTID=s,a===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var p;try{p=Tc(n,null)}catch{}for(h in p)d[h]=p[h];return d.FMTID=[s,i],d}function Cc(e,r,t,n,a,s){var i=Y(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,we.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,r,"hex"),i.write_shift(4,a?68:48);var c=Sc(e,t,n);if(o.push(c),a){var l=Sc(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+c.length),o.push(l)}return _r(o)}function jt(e,r){return e.read_shift(r),null}function x2(e,r){r||(r=Y(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function p2(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function or(e,r){return e.read_shift(r)===1}function Gr(e,r){return r||(r=Y(2)),r.write_shift(2,+!!e),r}function hr(e){return e.read_shift(2,"u")}function lt(e,r){return r||(r=Y(2)),r.write_shift(2,e),r}function Ru(e,r){return p2(e,r,hr)}function m2(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Pu(e,r,t){return t||(t=Y(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function Xa(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function g2(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,s=1+(t&1),i=0,o,c={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,l);return a&&(e.l+=4*i),n&&(e.l+=o),c.t=f,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function v2(e){var r=e.t||"",t=Y(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=Y(2*r.length);n.write_shift(2*r.length,r,"utf16le");var a=[t,n];return _r(a)}function xn(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Ka(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):xn(e,n,t)}function bn(e,r,t){if(t.biff>5)return Ka(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Lu(e,r,t){return t||(t=Y(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function _2(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function w2(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Vr,"");return n&&(e.l+=24),a}function y2(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Vr,"");return t+i}function E2(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return w2(e);case"0303000000000000c000000000000046":return y2(e);default:throw new Error("Unsupported Moniker "+t)}}function fs(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Vr,""):"";return t}function Fc(e,r){r||(r=Y(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function b2(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,c,l="",f,u;a&16&&(s=fs(e,t-e.l)),a&128&&(i=fs(e,t-e.l)),(a&257)===257&&(o=fs(e,t-e.l)),(a&257)===1&&(c=E2(e,t-e.l)),a&8&&(l=fs(e,t-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(u=U0(e)),e.l=t;var d=i||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return f&&(h.guid=f),u&&(h.time=u),s&&(h.Tooltip=s),h}function k2(e){var r=Y(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}r.write_shift(4,2),r.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(t=0;t<i.length;++t)r.write_shift(4,i[t]);if(s==28)n=n.slice(1),Fc(n,r);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<i.length;++t)r.write_shift(1,parseInt(i[t],16));var o=a>-1?n.slice(0,a):n;for(r.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)r.write_shift(2,o.charCodeAt(t));r.write_shift(2,0),s&8&&Fc(a>-1?n.slice(a+1):"",r)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<i.length;++t)r.write_shift(1,parseInt(i[t],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,n.length-3*c+1),t=0;t<n.length-3*c;++t)r.write_shift(1,n.charCodeAt(t+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function Bu(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function Mu(e,r){var t=Bu(e);return t[3]=0,t}function Ct(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function pn(e,r,t,n){return n||(n=Y(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function T2(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function S2(e,r,t){return r===0?"":bn(e,r,t)}function A2(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function ju(e){var r=e.read_shift(2),t=B0(e);return[r,t]}function C2(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=Xa(e,r,t),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function ti(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function Uu(e,r){return r||(r=Y(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function Wu(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var F2=Wu;function Hu(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function I2(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function N2(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Dr(e){e.l+=2,e.l+=e.read_shift(2)}var D2={0:Dr,4:Dr,5:Dr,6:Dr,7:N2,8:Dr,9:Dr,10:Dr,11:Dr,12:Dr,13:I2,14:Dr,15:Dr,16:Dr,17:Dr,18:Dr,19:Dr,20:Dr,21:Hu};function O2(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(D2[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function us(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function W0(e,r,t){var n=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Y(a);return s.write_shift(2,n),s.write_shift(2,r),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function R2(e,r){return r===0||e.read_shift(2),1200}function P2(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=bn(e,0,t);return e.read_shift(r+n-e.l),a}function L2(e,r){var t=!r||r.biff==8,n=Y(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function B2(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function M2(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Xa(e,0,t);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function j2(e,r){var t=!r||r.biff>=8?2:1,n=Y(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function U2(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<t;++i)s.push(g2(e));return s.Count=n,s.Unique=a,s}function W2(e,r){var t=Y(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=v2(e[a]);var s=_r([t].concat(n));return s.parts=[t.length].concat(n.map(function(i){return i.length})),s}function H2(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function G2(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function V2(e){var r=T2(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function $2(e){return e.read_shift(2),e.read_shift(4)}function Ic(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function z2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:c,TabRatio:l}}function X2(){var e=Y(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function K2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Y2(e){var r=Y(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function q2(){}function J2(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Xa(e,0,t),n}function Z2(e,r){var t=e.name||"Arial",n=r&&r.biff==5,a=n?15+t.length:16+2*t.length,s=Y(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function Q2(e){var r=Ct(e);return r.isst=e.read_shift(4),r}function e_(e,r,t,n){var a=Y(10);return pn(e,r,n,a),a.write_shift(4,t),a}function r_(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=Ct(e);t.biff==2&&e.l++;var s=Ka(e,n-e.l,t);return a.val=s,a}function t_(e,r,t,n,a){var s=!a||a.biff==8,i=Y(8+ +s+(1+s)*t.length);return pn(e,r,n,i),i.write_shift(2,t.length),s&&i.write_shift(1,1),i.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),i}function n_(e,r,t){var n=e.read_shift(2),a=bn(e,0,t);return[n,a]}function a_(e,r,t,n){var a=t&&t.biff==5;n||(n=Y(a?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(a?1:2,r.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var s_=bn;function Nc(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c}}}function i_(e,r){var t=r.biff==8||!r.biff?4:2,n=Y(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function o_(e){var r=e.read_shift(2),t=e.read_shift(2),n=ju(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function c_(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(ju(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function l_(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function f_(e,r,t,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=Vv[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function u_(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=f_(e,r,n.fStyle,t),n}function Dc(e,r,t,n){var a=t&&t.biff==5;n||(n=Y(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function d_(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function h_(e){var r=Y(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Oc(e,r,t){var n=Ct(e);(t.biff==2||r==9)&&++e.l;var a=m2(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function x_(e,r,t,n,a,s){var i=Y(8);return pn(e,r,n,i),Pu(t,s,i),i}function p_(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Ct(e),a=Lr(e);return n.val=a,n}function m_(e,r,t,n){var a=Y(14);return pn(e,r,n,a),hn(t,a),a}var Rc=S2;function g_(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=xn(e,s),o=[];n>e.l;)o.push(Ka(e));return[s,a,i,o]}function Pc(e,r,t){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=C2(e,r-2,t)),s.body=a||e.read_shift(r-2),typeof a=="string"&&(s.Name=a),s}var v_=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Lc(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=xn(e,i,t);a&32&&(l=v_[l.charCodeAt(0)]);var f=n-e.l;t&&t.biff==2&&--f;var u=n==e.l||o===0||!(f>0)?[]:Ob(e,f,t,o);return{chKey:s,Name:l,itab:c,rgce:u}}function Gu(e,r,t){if(t.biff<8)return __(e,r,t);for(var n=[],a=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)n.push(A2(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function __(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Xa(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function w_(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),s=xn(e,n,t),i=xn(e,a,t);return[s,i]}function y_(e,r,t){var n=Wu(e);e.l++;var a=e.read_shift(1);return r-=8,[Rb(e,r,t),a,n]}function Bc(e,r,t){var n=F2(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,Nb(e,r,t)]}function E_(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function b_(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=bn(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function k_(e,r,t){return b_(e,r,t)}function T_(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(ti(e));return t}function S_(e){var r=Y(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)Uu(e[t],r);return r}function A_(e,r,t){if(t&&t.biff<8)return F_(e,r,t);var n=Hu(e),a=O2(e,r-22,n[1]);return{cmo:n,ft:a}}var C_={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function F_(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var i=[];return i.push((C_[n]||jr)(e,r,t)),{cmo:[a,n,s],ft:i}}function I_(e,r,t){var n=e.l,a="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=_2(e,6,t);var o=e.read_shift(2);e.read_shift(2),hr(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],u=xn(e,e.lens[l+1]-e.lens[l]-1);if(a+=u,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function N_(e,r){var t=ti(e);e.l+=16;var n=b2(e,r-24);return[t,n]}function D_(e){var r=Y(24),t=nr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(n[a],16));return _r([r,k2(e[1])])}function O_(e,r){e.read_shift(2);var t=ti(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Vr,""),[t,n]}function R_(e){var r=e[1].Tooltip,t=Y(10+2*(r.length+1));t.write_shift(2,2048);var n=nr(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a=0;a<r.length;++a)t.write_shift(2,r.charCodeAt(a));return t.write_shift(2,0),t}function P_(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=yc[t]||t,t=e.read_shift(2),r[1]=yc[t]||t,r}function L_(e){return e||(e=Y(4)),e.write_shift(2,1),e.write_shift(2,1),e}function B_(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Mu(e));return t}function M_(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Mu(e));return t}function j_(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Vu(e,r,t){if(!t.cellStyles)return jr(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var l={s:a,e:s,w:i,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function U_(e,r){var t=Y(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function W_(e,r){var t={};return r<32||(e.l+=16,t.header=Lr(e),t.footer=Lr(e),e.l+=2),t}function H_(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function G_(e){for(var r=Y(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var V_=Ct,$_=Ru,z_=Ka;function X_(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function K_(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Ct(e);++e.l;var a=bn(e,r-7,t);return n.t="str",n.val=a,n}function Y_(e){var r=Ct(e);++e.l;var t=Lr(e);return r.t="n",r.val=t,r}function q_(e,r,t){var n=Y(15);return Za(n,e,r),n.write_shift(8,t,"f"),n}function J_(e){var r=Ct(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function Z_(e,r,t){var n=Y(9);return Za(n,e,r),n.write_shift(2,t),n}function Q_(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function ew(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function rw(e,r,t){var n=e.l+r,a=Ct(e),s=e.read_shift(2),i=xn(e,s,t);return e.l=n,a.t="str",a.val=i,a}var tw=[2,3,48,49,131,139,140,245],Xi=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Qs({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],f=Xt(1);switch(c.type){case"base64":f=Jr(tt(o));break;case"binary":f=Jr(o);break;case"buffer":case"array":f=o;break}Tr(f,0);var u=f.read_shift(1),d=!!(u&136),h=!1,p=!1;switch(u){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var x=0,m=521;u==2&&(x=f.read_shift(2)),f.l+=3,u!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),u!=2&&(m=f.read_shift(2));var v=f.read_shift(2),E=c.codepage||1252;u!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=e[f[f.l]]),f.l+=1,f.l+=2),p&&(f.l+=36);for(var w=[],A={},D=Math.min(f.length,u==2?521:m-10-(h?264:0)),N=p?32:11;f.l<D&&f[f.l]!=13;)switch(A={},A.name=Aa.utils.decode(E,f.slice(f.l,f.l+N)).replace(/[\u0000\r\n].*$/g,""),f.l+=N,A.type=String.fromCharCode(f.read_shift(1)),u!=2&&!p&&(A.offset=f.read_shift(4)),A.len=f.read_shift(1),u==2&&(A.offset=f.read_shift(2)),A.dec=f.read_shift(1),A.name.length&&w.push(A),u!=2&&(f.l+=p?13:14),A.type){case"B":(!h||A.len!=8)&&c.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(f[f.l]!==13&&(f.l=m-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=m;var k=0,L=0;for(l[0]=[],L=0;L!=w.length;++L)l[0][L]=w[L].name;for(;x-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,l[++k]=[],L=0,L=0;L!=w.length;++L){var O=f.slice(f.l,f.l+w[L].len);f.l+=w[L].len,Tr(O,0);var W=Aa.utils.decode(E,O);switch(w[L].type){case"C":W.trim().length&&(l[k][L]=W.replace(/\s+$/,""));break;case"D":W.length===8?l[k][L]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):l[k][L]=W;break;case"F":l[k][L]=parseFloat(W.trim());break;case"+":case"I":l[k][L]=p?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":l[k][L]=!0;break;case"N":case"F":l[k][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));l[k][L]="##MEMO##"+(p?parseInt(W.trim(),10):O.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(l[k][L]=+W||0);break;case"@":l[k][L]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":l[k][L]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":l[k][L]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[k][L]=-O.read_shift(-8,"f");break;case"B":if(h&&w[L].len==8){l[k][L]=O.read_shift(8,"f");break}case"G":case"P":O.l+=w[L].len;break;case"0":if(w[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[L].type)}}}if(u!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=w,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=$n(t(o,l),l);return f["!cols"]=l.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete l.DBF,f}function a(o,c){try{return Zt(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var l=c||{};if(+l.codepage>=0&&vt(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Xr(),u=Gs(o,{header:1,raw:!0,cellDates:!0}),d=u[0],h=u.slice(1),p=o["!cols"]||[],x=0,m=0,v=0,E=1;for(x=0;x<d.length;++x){if(((p[x]||{}).DBF||{}).name){d[x]=p[x].DBF.name,++v;continue}if(d[x]!=null){if(++v,typeof d[x]=="number"&&(d[x]=d[x].toString(10)),typeof d[x]!="string")throw new Error("DBF Invalid column name "+d[x]+" |"+typeof d[x]+"|");if(d.indexOf(d[x])!==x){for(m=0;m<1024;++m)if(d.indexOf(d[x]+"_"+m)==-1){d[x]+="_"+m;break}}}}var w=Me(o["!ref"]),A=[],D=[],N=[];for(x=0;x<=w.e.c-w.s.c;++x){var k="",L="",O=0,W=[];for(m=0;m<h.length;++m)h[m][x]!=null&&W.push(h[m][x]);if(W.length==0||d[x]==null){A[x]="?";continue}for(m=0;m<W.length;++m){switch(typeof W[m]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=W[m]instanceof Date?"D":"C";break;default:L="C"}O=Math.max(O,String(W[m]).length),k=k&&k!=L?"C":L}O>250&&(O=250),L=((p[x]||{}).DBF||{}).type,L=="C"&&p[x].DBF.len>O&&(O=p[x].DBF.len),k=="B"&&L=="N"&&(k="N",N[x]=p[x].DBF.dec,O=p[x].DBF.len),D[x]=k=="C"||L=="N"?O:s[k]||0,E+=D[x],A[x]=k}var B=f.next(32);for(B.write_shift(4,318902576),B.write_shift(4,h.length),B.write_shift(2,296+32*v),B.write_shift(2,E),x=0;x<4;++x)B.write_shift(4,0);for(B.write_shift(4,0|(+r[Of]||3)<<8),x=0,m=0;x<d.length;++x)if(d[x]!=null){var M=f.next(32),Z=(d[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,Z,"sbcs"),M.write_shift(1,A[x]=="?"?"C":A[x],"sbcs"),M.write_shift(4,m),M.write_shift(1,D[x]||s[A[x]]||0),M.write_shift(1,N[x]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),m+=D[x]||s[A[x]]||0}var le=f.next(264);for(le.write_shift(4,13),x=0;x<65;++x)le.write_shift(4,0);for(x=0;x<h.length;++x){var se=f.next(E);for(se.write_shift(1,0),m=0;m<d.length;++m)if(d[m]!=null)switch(A[m]){case"L":se.write_shift(1,h[x][m]==null?63:h[x][m]?84:70);break;case"B":se.write_shift(8,h[x][m]||0,"f");break;case"N":var he="0";for(typeof h[x][m]=="number"&&(he=h[x][m].toFixed(N[m]||0)),v=0;v<D[m]-he.length;++v)se.write_shift(1,32);se.write_shift(1,he,"sbcs");break;case"D":h[x][m]?(se.write_shift(4,("0000"+h[x][m].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(h[x][m].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+h[x][m].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var X=String(h[x][m]!=null?h[x][m]:"").slice(0,D[m]);for(se.write_shift(1,X,"sbcs"),v=0;v<D[m]-X.length;++v)se.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}})(),$u=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+ir(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,h){var p=e[h];return typeof p=="number"?Ko(p):p},n=function(d,h,p){var x=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?d:Ko(x)};e["|"]=254;function a(d,h){switch(h.type){case"base64":return s(tt(d),h);case"binary":return s(d,h);case"buffer":return s(Oe&&Buffer.isBuffer(d)?d.toString("binary"):Jt(d),h);case"array":return s(dn(d),h)}throw new Error("Unrecognized type "+h.type)}function s(d,h){var p=d.split(/[\n\r]+/),x=-1,m=-1,v=0,E=0,w=[],A=[],D=null,N={},k=[],L=[],O=[],W=0,B;for(+h.codepage>=0&&vt(+h.codepage);v!==p.length;++v){W=0;var M=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),Z=M.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),le=Z[0],se;if(M.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&A.push(M.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,X=!1,ve=!1,U=!1,me=-1,ye=-1;for(E=1;E<Z.length;++E)switch(Z[E].charAt(0)){case"A":break;case"X":m=parseInt(Z[E].slice(1))-1,X=!0;break;case"Y":for(x=parseInt(Z[E].slice(1))-1,X||(m=0),B=w.length;B<=x;++B)w[B]=[];break;case"K":se=Z[E].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(wt(se))?isNaN(Bn(se).getDate())||(se=Ze(se)):(se=wt(se),D!==null&&Gn(D)&&(se=ri(se))),he=!0;break;case"E":U=!0;var I=Dn(Z[E].slice(1),{r:x,c:m});w[x][m]=[w[x][m],I];break;case"S":ve=!0,w[x][m]=[w[x][m],"S5S"];break;case"G":break;case"R":me=parseInt(Z[E].slice(1))-1;break;case"C":ye=parseInt(Z[E].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+M)}if(he&&(w[x][m]&&w[x][m].length==2?w[x][m][0]=se:w[x][m]=se,D=null),ve){if(U)throw new Error("SYLK shared formula cannot have own formula");var j=me>-1&&w[me][ye];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");w[x][m][1]=ld(j[1],{r:x-me,c:m-ye})}break;case"F":var R=0;for(E=1;E<Z.length;++E)switch(Z[E].charAt(0)){case"X":m=parseInt(Z[E].slice(1))-1,++R;break;case"Y":for(x=parseInt(Z[E].slice(1))-1,B=w.length;B<=x;++B)w[B]=[];break;case"M":W=parseInt(Z[E].slice(1))/20;break;case"F":break;case"G":break;case"P":D=A[parseInt(Z[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=Z[E].slice(1).split(" "),B=parseInt(O[0],10);B<=parseInt(O[1],10);++B)W=parseInt(O[2],10),L[B-1]=W===0?{hidden:!0}:{wch:W},Kt(L[B-1]);break;case"C":m=parseInt(Z[E].slice(1))-1,L[m]||(L[m]={});break;case"R":x=parseInt(Z[E].slice(1))-1,k[x]||(k[x]={}),W>0?(k[x].hpt=W,k[x].hpx=jn(W)):W===0&&(k[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+M)}R<1&&(D=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+M)}}return k.length>0&&(N["!rows"]=k),L.length>0&&(N["!cols"]=L),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,N]}function i(d,h){var p=a(d,h),x=p[0],m=p[1],v=$n(x,h);return ir(m).forEach(function(E){v[E]=m[E]}),v}function o(d,h){return Zt(i(d,h),h)}function c(d,h,p,x){var m="C;Y"+(p+1)+";X"+(x+1)+";K";switch(d.t){case"n":m+=d.v||0,d.f&&!d.F&&(m+=";E"+X0(d.f,{r:p,c:x}));break;case"b":m+=d.v?"TRUE":"FALSE";break;case"e":m+=d.w||d.v;break;case"d":m+='"'+(d.w||d.v)+'"';break;case"s":m+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function l(d,h){h.forEach(function(p,x){var m="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?m+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Pa(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=La(p.wpx)),typeof p.wch=="number"&&(m+=Math.round(p.wch))),m.charAt(m.length-1)!=" "&&d.push(m)})}function f(d,h){h.forEach(function(p,x){var m="F;";p.hidden?m+="M0;":p.hpt?m+="M"+20*p.hpt+";":p.hpx&&(m+="M"+20*Ba(p.hpx)+";"),m.length>2&&d.push(m+"R"+(x+1))})}function u(d,h){var p=["ID;PWXL;N;E"],x=[],m=Me(d["!ref"]),v,E=Array.isArray(d),w=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),d["!cols"]&&l(p,d["!cols"]),d["!rows"]&&f(p,d["!rows"]),p.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var A=m.s.r;A<=m.e.r;++A)for(var D=m.s.c;D<=m.e.c;++D){var N=Te({r:A,c:D});v=E?(d[A]||[])[D]:d[N],!(!v||v.v==null&&(!v.f||v.F))&&x.push(c(v,d,A,D))}return p.join(w)+w+x.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:u}})(),zu=(function(){function e(s,i){switch(i.type){case"base64":return r(tt(s),i);case"binary":return r(s,i);case"buffer":return r(Oe&&Buffer.isBuffer(s)?s.toString("binary"):Jt(s),i);case"array":return r(dn(s),i)}throw new Error("Unrecognized type "+i.type)}function r(s,i){for(var o=s.split(`
`),c=-1,l=-1,f=0,u=[];f!==o.length;++f){if(o[f].trim()==="BOT"){u[++c]=[],l=0;continue}if(!(c<0)){var d=o[f].trim().split(","),h=d[0],p=d[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+h){case-1:if(x==="BOT"){u[++c]=[],l=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?u[c][l]=!0:x==="FALSE"?u[c][l]=!1:isNaN(wt(p))?isNaN(Bn(p).getDate())?u[c][l]=p:u[c][l]=Ze(p):u[c][l]=wt(p),++l;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),u[c][l++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(u=u.slice(0,i.sheetRows)),u}function t(s,i){return $n(e(s,i),i)}function n(s,i){return Zt(t(s,i),i)}var a=(function(){var s=function(c,l,f,u,d){c.push(l),c.push(f+","+u),c.push('"'+d.replace(/"/g,'""')+'"')},i=function(c,l,f,u){c.push(l+","+f),c.push(l==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var l=[],f=Me(c["!ref"]),u,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,f.e.r-f.s.r+1,""),s(l,"TUPLES",0,f.e.c-f.s.c+1,""),s(l,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){i(l,-1,0,"BOT");for(var p=f.s.c;p<=f.e.c;++p){var x=Te({r:h,c:p});if(u=d?(c[h]||[])[p]:c[x],!u){i(l,1,0,"");continue}switch(u.t){case"n":var m=u.w;!m&&u.v!=null&&(m=u.v),m==null?u.f&&!u.F?i(l,1,0,"="+u.f):i(l,1,0,""):i(l,0,m,"V");break;case"b":i(l,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":i(l,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=ht(u.z||be[14],gr(Ze(u.v)))),i(l,0,u.w,"V");break;default:i(l,1,0,"")}}}i(l,-1,0,"EOD");var v=`\r
`,E=l.join(v);return E}})();return{to_workbook:n,to_sheet:t,from_sheet:a}})(),Xu=(function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(u,d){for(var h=u.split(`
`),p=-1,x=-1,m=0,v=[];m!==h.length;++m){var E=h[m].trim().split(":");if(E[0]==="cell"){var w=nr(E[1]);if(v.length<=w.r)for(p=v.length;p<=w.r;++p)v[p]||(v[p]=[]);switch(p=w.r,x=w.c,E[2]){case"t":v[p][x]=e(E[3]);break;case"v":v[p][x]=+E[3];break;case"vtf":var A=E[E.length-1];case"vtc":switch(E[3]){case"nl":v[p][x]=!!+E[4];break;default:v[p][x]=+E[4];break}E[2]=="vtf"&&(v[p][x]=[v[p][x],A])}}}return d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),v}function n(u,d){return $n(t(u,d),d)}function a(u,d){return Zt(n(u,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(u){if(!u||!u["!ref"])return"";for(var d=[],h=[],p,x="",m=Kr(u["!ref"]),v=Array.isArray(u),E=m.s.r;E<=m.e.r;++E)for(var w=m.s.c;w<=m.e.c;++w)if(x=Te({r:E,c:w}),p=v?(u[E]||[])[w]:u[x],!(!p||p.v==null||p.t==="z")){switch(h=["cell",x,"t"],p.t){case"s":case"str":h.push(r(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=r(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=r(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var A=gr(Ze(p.v));h[2]="vtc",h[3]="nd",h[4]=""+A,h[5]=p.w||ht(p.z||be[14],A);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(u){return[s,i,o,i,l(u),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}})(),Mn=(function(){function e(f,u,d,h,p){p.raw?u[d][h]=f:f===""||(f==="TRUE"?u[d][h]=!0:f==="FALSE"?u[d][h]=!1:isNaN(wt(f))?isNaN(Bn(f).getDate())?u[d][h]=f:u[d][h]=Ze(f):u[d][h]=wt(f))}function r(f,u){var d=u||{},h=[];if(!f||f.length===0)return h;for(var p=f.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var m=10,v=0,E=0;E<=x;++E)v=p[E].indexOf(" "),v==-1?v=p[E].length:v++,m=Math.max(m,v);for(E=0;E<=x;++E){h[E]=[];var w=0;for(e(p[E].slice(0,m).trim(),h,E,w,d),w=1;w<=(p[E].length-m)/10+1;++w)e(p[E].slice(m+(w-1)*10,m+w*10).trim(),h,E,w,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var u={},d=!1,h=0,p=0;h<f.length;++h)(p=f.charCodeAt(h))==34?d=!d:!d&&p in t&&(u[p]=(u[p]||0)+1);p=[];for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&p.push([u[h],h]);if(!p.length){u=n;for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&p.push([u[h],h])}return p.sort(function(x,m){return x[0]-m[0]||n[x[1]]-n[m[1]]}),t[p.pop()[1]]||44}function s(f,u){var d=u||{},h="",p=d.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=a(f.slice(0,1024)):d&&d.FS?h=d.FS:h=a(f.slice(0,1024));var m=0,v=0,E=0,w=0,A=0,D=h.charCodeAt(0),N=!1,k=0,L=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var O=d.dateNF!=null?Hg(d.dateNF):null;function W(){var B=f.slice(w,A),M={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)M.t="z";else if(d.raw)M.t="s",M.v=B;else if(B.trim().length===0)M.t="s",M.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(M.t="s",M.v=B.slice(2,-1).replace(/""/g,'"')):gE(B)?(M.t="n",M.f=B.slice(1)):(M.t="s",M.v=B);else if(B=="TRUE")M.t="b",M.v=!0;else if(B=="FALSE")M.t="b",M.v=!1;else if(!isNaN(E=wt(B)))M.t="n",d.cellText!==!1&&(M.w=B),M.v=E;else if(!isNaN(Bn(B).getDate())||O&&B.match(O)){M.z=d.dateNF||be[14];var Z=0;O&&B.match(O)&&(B=Gg(B,d.dateNF,B.match(O)||[]),Z=1),d.cellDates?(M.t="d",M.v=Ze(B,Z)):(M.t="n",M.v=gr(Ze(B,Z))),d.cellText!==!1&&(M.w=ht(M.z,M.v instanceof Date?gr(M.v):M.v)),d.cellNF||delete M.z}else M.t="s",M.v=B;if(M.t=="z"||(d.dense?(p[m]||(p[m]=[]),p[m][v]=M):p[Te({c:v,r:m})]=M),w=A+1,L=f.charCodeAt(w),x.e.c<v&&(x.e.c=v),x.e.r<m&&(x.e.r=m),k==D)++v;else if(v=0,++m,d.sheetRows&&d.sheetRows<=m)return!0}e:for(;A<f.length;++A)switch(k=f.charCodeAt(A)){case 34:L===34&&(N=!N);break;case D:case 10:case 13:if(!N&&W())break e;break}return A-w>0&&W(),p["!ref"]=Ie(x),p}function i(f,u){return!(u&&u.PRN)||u.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,u):$n(r(f,u),u)}function o(f,u){var d="",h=u.type=="string"?[0,0,0,0]:ro(f,u);switch(u.type){case"base64":d=tt(f);break;case"binary":d=f;break;case"buffer":u.codepage==65001?d=f.toString("utf8"):u.codepage&&typeof Aa<"u"||(d=Oe&&Buffer.isBuffer(f)?f.toString("binary"):Jt(f));break;case"array":d=dn(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+u.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=ze(d.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?d=ze(d):u.type=="binary"&&typeof Aa<"u",d.slice(0,19)=="socialcalc:version:"?Xu.to_sheet(u.type=="string"?d:ze(d),u):i(d,u)}function c(f,u){return Zt(o(f,u),u)}function l(f){for(var u=[],d=Me(f["!ref"]),h,p=Array.isArray(f),x=d.s.r;x<=d.e.r;++x){for(var m=[],v=d.s.c;v<=d.e.c;++v){var E=Te({r:x,c:v});if(h=p?(f[x]||[])[v]:f[E],!h||h.v==null){m.push("          ");continue}for(var w=(h.w||(Rt(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";m.push(w+(v===0?" ":""))}u.push(m.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}})();function nw(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=$u.to_workbook(e,t);return t.WTF=n,a}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Mn.to_workbook(e,r)}}var cn=(function(){function e(I,j,R){if(I){Tr(I,I.l||0);for(var P=R.Enum||me;I.l<I.length;){var K=I.read_shift(2),re=P[K]||P[65535],te=I.read_shift(2),J=I.l+te,ee=re.f&&re.f(I,te,R);if(I.l=J,j(ee,re,K))return}}}function r(I,j){switch(j.type){case"base64":return t(Jr(tt(I)),j);case"binary":return t(Jr(I),j);case"buffer":case"array":return t(I,j)}throw"Unsupported type "+j.type}function t(I,j){if(!I)return I;var R=j||{},P=R.dense?[]:{},K="Sheet1",re="",te=0,J={},ee=[],ke=[],C={s:{r:0,c:0},e:{r:0,c:0}},je=R.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)R.Enum=me,e(I,function(ue,Ye,xr){switch(xr){case 0:R.vers=ue,ue>=4096&&(R.qpro=!0);break;case 6:C=ue;break;case 204:ue&&(re=ue);break;case 222:re=ue;break;case 15:case 51:R.qpro||(ue[1].v=ue[1].v.slice(1));case 13:case 14:case 16:xr==14&&(ue[2]&112)==112&&(ue[2]&15)>1&&(ue[2]&15)<15&&(ue[1].z=R.dateNF||be[14],R.cellDates&&(ue[1].t="d",ue[1].v=ri(ue[1].v))),R.qpro&&ue[3]>te&&(P["!ref"]=Ie(C),J[K]=P,ee.push(K),P=R.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},te=ue[3],K=re||"Sheet"+(te+1),re="");var Cr=R.dense?(P[ue[0].r]||[])[ue[0].c]:P[Te(ue[0])];if(Cr){Cr.t=ue[1].t,Cr.v=ue[1].v,ue[1].z!=null&&(Cr.z=ue[1].z),ue[1].f!=null&&(Cr.f=ue[1].f);break}R.dense?(P[ue[0].r]||(P[ue[0].r]=[]),P[ue[0].r][ue[0].c]=ue[1]):P[Te(ue[0])]=ue[1];break}},R);else if(I[2]==26||I[2]==14)R.Enum=ye,I[2]==14&&(R.qpro=!0,I.l=0),e(I,function(ue,Ye,xr){switch(xr){case 204:K=ue;break;case 22:ue[1].v=ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ue[3]>te&&(P["!ref"]=Ie(C),J[K]=P,ee.push(K),P=R.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},te=ue[3],K="Sheet"+(te+1)),je>0&&ue[0].r>=je)break;R.dense?(P[ue[0].r]||(P[ue[0].r]=[]),P[ue[0].r][ue[0].c]=ue[1]):P[Te(ue[0])]=ue[1],C.e.c<ue[0].c&&(C.e.c=ue[0].c),C.e.r<ue[0].r&&(C.e.r=ue[0].r);break;case 27:ue[14e3]&&(ke[ue[14e3][0]]=ue[14e3][1]);break;case 1537:ke[ue[0]]=ue[1],ue[0]==te&&(K=ue[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(P["!ref"]=Ie(C),J[re||K]=P,ee.push(re||K),!ke.length)return{SheetNames:ee,Sheets:J};for(var Fe={},Pe=[],Ne=0;Ne<ke.length;++Ne)J[ee[Ne]]?(Pe.push(ke[Ne]||ee[Ne]),Fe[ke[Ne]]=J[ke[Ne]]||J[ee[Ne]]):(Pe.push(ke[Ne]),Fe[ke[Ne]]={"!ref":"A1"});return{SheetNames:Pe,Sheets:Fe}}function n(I,j){var R=j||{};if(+R.codepage>=0&&vt(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Xr(),K=Me(I["!ref"]),re=Array.isArray(I),te=[];oe(P,0,s(1030)),oe(P,6,c(K));for(var J=Math.min(K.e.r,8191),ee=K.s.r;ee<=J;++ee)for(var ke=cr(ee),C=K.s.c;C<=K.e.c;++C){ee===K.s.r&&(te[C]=tr(C));var je=te[C]+ke,Fe=re?(I[ee]||[])[C]:I[je];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?oe(P,13,h(ee,C,Fe.v)):oe(P,14,x(ee,C,Fe.v));else{var Pe=Rt(Fe);oe(P,15,u(ee,C,Pe.slice(0,239)))}}return oe(P,1),P.end()}function a(I,j){var R=j||{};if(+R.codepage>=0&&vt(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Xr();oe(P,0,i(I));for(var K=0,re=0;K<I.SheetNames.length;++K)(I.Sheets[I.SheetNames[K]]||{})["!ref"]&&oe(P,27,U(I.SheetNames[K],re++));var te=0;for(K=0;K<I.SheetNames.length;++K){var J=I.Sheets[I.SheetNames[K]];if(!(!J||!J["!ref"])){for(var ee=Me(J["!ref"]),ke=Array.isArray(J),C=[],je=Math.min(ee.e.r,8191),Fe=ee.s.r;Fe<=je;++Fe)for(var Pe=cr(Fe),Ne=ee.s.c;Ne<=ee.e.c;++Ne){Fe===ee.s.r&&(C[Ne]=tr(Ne));var ue=C[Ne]+Pe,Ye=ke?(J[Fe]||[])[Ne]:J[ue];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")oe(P,23,W(Fe,Ne,te,Ye.v));else{var xr=Rt(Ye);oe(P,22,k(Fe,Ne,te,xr.slice(0,239)))}}++te}}return oe(P,1),P.end()}function s(I){var j=Y(2);return j.write_shift(2,I),j}function i(I){var j=Y(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var R=0,P=0,K=0,re=0;re<I.SheetNames.length;++re){var te=I.SheetNames[re],J=I.Sheets[te];if(!(!J||!J["!ref"])){++K;var ee=Kr(J["!ref"]);R<ee.e.r&&(R=ee.e.r),P<ee.e.c&&(P=ee.e.c)}}return R>8191&&(R=8191),j.write_shift(2,R),j.write_shift(1,K),j.write_shift(1,P),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function o(I,j,R){var P={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&R.qpro?(P.s.c=I.read_shift(1),I.l++,P.s.r=I.read_shift(2),P.e.c=I.read_shift(1),I.l++,P.e.r=I.read_shift(2),P):(P.s.c=I.read_shift(2),P.s.r=I.read_shift(2),j==12&&R.qpro&&(I.l+=2),P.e.c=I.read_shift(2),P.e.r=I.read_shift(2),j==12&&R.qpro&&(I.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function c(I){var j=Y(8);return j.write_shift(2,I.s.c),j.write_shift(2,I.s.r),j.write_shift(2,I.e.c),j.write_shift(2,I.e.r),j}function l(I,j,R){var P=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(P[0].c=I.read_shift(1),P[3]=I.read_shift(1),P[0].r=I.read_shift(2),I.l+=2):(P[2]=I.read_shift(1),P[0].c=I.read_shift(2),P[0].r=I.read_shift(2)),P}function f(I,j,R){var P=I.l+j,K=l(I,j,R);if(K[1].t="s",R.vers==20768){I.l++;var re=I.read_shift(1);return K[1].v=I.read_shift(re,"utf8"),K}return R.qpro&&I.l++,K[1].v=I.read_shift(P-I.l,"cstr"),K}function u(I,j,R){var P=Y(7+R.length);P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,I),P.write_shift(1,39);for(var K=0;K<P.length;++K){var re=R.charCodeAt(K);P.write_shift(1,re>=128?95:re)}return P.write_shift(1,0),P}function d(I,j,R){var P=l(I,j,R);return P[1].v=I.read_shift(2,"i"),P}function h(I,j,R){var P=Y(7);return P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,I),P.write_shift(2,R,"i"),P}function p(I,j,R){var P=l(I,j,R);return P[1].v=I.read_shift(8,"f"),P}function x(I,j,R){var P=Y(13);return P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,I),P.write_shift(8,R,"f"),P}function m(I,j,R){var P=I.l+j,K=l(I,j,R);if(K[1].v=I.read_shift(8,"f"),R.qpro)I.l=P;else{var re=I.read_shift(2);A(I.slice(I.l,I.l+re),K),I.l+=re}return K}function v(I,j,R){var P=j&32768;return j&=-32769,j=(P?I:0)+(j>=8192?j-16384:j),(P?"":"$")+(R?tr(j):cr(j))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(I,j){Tr(I,0);for(var R=[],P=0,K="",re="",te="",J="";I.l<I.length;){var ee=I[I.l++];switch(ee){case 0:R.push(I.read_shift(8,"f"));break;case 1:re=v(j[0].c,I.read_shift(2),!0),K=v(j[0].r,I.read_shift(2),!1),R.push(re+K);break;case 2:{var ke=v(j[0].c,I.read_shift(2),!0),C=v(j[0].r,I.read_shift(2),!1);re=v(j[0].c,I.read_shift(2),!0),K=v(j[0].r,I.read_shift(2),!1),R.push(ke+C+":"+re+K)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(I.read_shift(2));break;case 6:{for(var je="";ee=I[I.l++];)je+=String.fromCharCode(ee);R.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:J=R.pop(),te=R.pop(),R.push(["AND","OR"][ee-20]+"("+te+","+J+")");break;default:if(ee<32&&w[ee])J=R.pop(),te=R.pop(),R.push(te+w[ee]+J);else if(E[ee]){if(P=E[ee][1],P==69&&(P=I[I.l++]),P>R.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+R.join("|")+"|");return}var Fe=R.slice(-P);R.length-=P,R.push(E[ee][0]+"("+Fe.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}R.length==1?j[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function D(I){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=I.read_shift(2),j[3]=I[I.l++],j[0].c=I[I.l++],j}function N(I,j){var R=D(I);return R[1].t="s",R[1].v=I.read_shift(j-4,"cstr"),R}function k(I,j,R,P){var K=Y(6+P.length);K.write_shift(2,I),K.write_shift(1,R),K.write_shift(1,j),K.write_shift(1,39);for(var re=0;re<P.length;++re){var te=P.charCodeAt(re);K.write_shift(1,te>=128?95:te)}return K.write_shift(1,0),K}function L(I,j){var R=D(I);R[1].v=I.read_shift(2);var P=R[1].v>>1;if(R[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return R[1].v=P,R}function O(I,j){var R=D(I),P=I.read_shift(4),K=I.read_shift(4),re=I.read_shift(2);if(re==65535)return P===0&&K===3221225472?(R[1].t="e",R[1].v=15):P===0&&K===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var te=re&32768;return re=(re&32767)-16446,R[1].v=(1-te*2)*(K*Math.pow(2,re+32)+P*Math.pow(2,re)),R}function W(I,j,R,P){var K=Y(14);if(K.write_shift(2,I),K.write_shift(1,R),K.write_shift(1,j),P==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var re=0,te=0,J=0,ee=0;return P<0&&(re=1,P=-P),te=Math.log2(P)|0,P/=Math.pow(2,te-31),ee=P>>>0,(ee&2147483648)==0&&(P/=2,++te,ee=P>>>0),P-=ee,ee|=2147483648,ee>>>=0,P*=Math.pow(2,32),J=P>>>0,K.write_shift(4,J),K.write_shift(4,ee),te+=16383+(re?32768:0),K.write_shift(2,te),K}function B(I,j){var R=O(I);return I.l+=j-14,R}function M(I,j){var R=D(I),P=I.read_shift(4);return R[1].v=P>>6,R}function Z(I,j){var R=D(I),P=I.read_shift(8,"f");return R[1].v=P,R}function le(I,j){var R=Z(I);return I.l+=j-10,R}function se(I,j){return I[I.l+j-1]==0?I.read_shift(j,"cstr"):""}function he(I,j){var R=I[I.l++];R>j-1&&(R=j-1);for(var P="";P.length<R;)P+=String.fromCharCode(I[I.l++]);return P}function X(I,j,R){if(!(!R.qpro||j<21)){var P=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var K=I.read_shift(j-21,"cstr");return[P,K]}}function ve(I,j){for(var R={},P=I.l+j;I.l<P;){var K=I.read_shift(2);if(K==14e3){for(R[K]=[0,""],R[K][0]=I.read_shift(2);I[I.l];)R[K][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return R}function U(I,j){var R=Y(5+I.length);R.write_shift(2,14e3),R.write_shift(2,j);for(var P=0;P<I.length;++P){var K=I.charCodeAt(P);R[R.l++]=K>127?95:K}return R[R.l++]=0,R}var me={0:{n:"BOF",f:hr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:p},15:{n:"LABEL",f},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}})();function aw(e){var r={},t=e.match(Ur),n=0,a=!1;if(t)for(;n!=t.length;++n){var s=Se(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;r.cp=v0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return r}var sw=(function(){var e=Ia("t"),r=Ia("rPr");function t(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Be(i[1])},c=s.match(r);return c&&(o.s=aw(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(t).filter(function(o){return o.v})}})(),iw=(function(){var r=/(\r\n|\n)/g;function t(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),ow=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cw=/<(?:\w+:)?r>/,lw=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function H0(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Be(ze(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ze(e),t&&(n.h=C0(n.t))):e.match(cw)&&(n.r=ze(e),n.t=Be(ze((e.replace(lw,"").match(ow)||[]).join("").replace(Ur,""))),t&&(n.h=iw(sw(n.r)))),n):{t:""}}var fw=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,uw=/<(?:\w+:)?(?:si|sstItem)>/g,dw=/<\/(?:\w+:)?(?:si|sstItem)>/;function hw(e,r){var t=[],n="";if(!e)return t;var a=e.match(fw);if(a){n=a[2].replace(uw,"").split(dw);for(var s=0;s!=n.length;++s){var i=H0(n[s].trim(),r);i!=null&&(t[t.length]=i)}a=Se(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}var xw=/^\s|\s$|[\t\n\r]/;function Ku(e,r){if(!r.bookSST)return"";var t=[lr];t[t.length]=ie("sst",null,{xmlns:vn[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(xw)&&(s+=' xml:space="preserve"'),s+=">"+$e(a.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function pw(e){return[e.read_shift(4),e.read_shift(4)]}function mw(e,r){var t=[],n=!1;return Lt(e,function(s,i,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function gw(e,r){return r||(r=Y(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var vw=Cv;function _w(e){var r=Xr();Q(r,159,gw(e));for(var t=0;t<e.length;++t)Q(r,19,vw(e[t]));return Q(r,160),r.end()}function Yu(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Ot(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function ww(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Ot(e,4),r.U=Ot(e,4),r.W=Ot(e,4),r}function yw(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function Ew(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(yw(e));return r}function bw(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function kw(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Ot(e,4),r.U=Ot(e,4),r.W=Ot(e,4),r}function Tw(e){var r=kw(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function qu(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function Ju(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function Sw(e){var r=Ot(e);switch(r.Minor){case 2:return[r.Minor,Aw(e)];case 3:return[r.Minor,Cw()];case 4:return[r.Minor,Fw(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Aw(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=qu(e,t),a=Ju(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Cw(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Fw(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(Ur,function(s){var i=Se(s);switch(At(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Iw(e,r){var t={},n=t.EncryptionVersionInfo=Ot(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=qu(e,a),r-=a,t.EncryptionVerifier=Ju(e,r),t}function Nw(e){var r={},t=r.EncryptionVersionInfo=Ot(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function G0(e){var r=0,t,n=Yu(e),a=n.length+1,s,i,o,c,l;for(t=Xt(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)i=t[s],o=(r&16384)===0?0:1,c=r<<1&32767,l=o|c,r=l^i;return r^52811}var Zu=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=r[i.length-1],c=104,l=i.length-1;l>=0;--l)for(var f=i[l],u=0;u!=7;++u)f&64&&(o^=t[c]),f*=2,--c;return o};return function(i){for(var o=Yu(i),c=s(o),l=o.length,f=Xt(16),u=0;u!=16;++u)f[u]=0;var d,h,p;for((l&1)===1&&(d=c>>8,f[l]=a(e[0],d),--l,d=c&255,h=o[o.length-1],f[l]=a(h,d));l>0;)--l,d=c>>8,f[l]=a(o[l],d),--l,d=c&255,f[l]=a(o[l],d);for(l=15,p=15-o.length;p>0;)d=c>>8,f[l]=a(e[p],d),--l,--p,d=c&255,f[l]=a(o[l],d),--l,--p;return f}})(),Dw=function(e,r,t,n,a){a||(a=r),n||(n=Zu(e));var s,i;for(s=0;s!=r.length;++s)i=r[s],i^=n[t],i=(i>>5|i<<3)&255,a[s]=i,++t;return[a,t,n]},Ow=function(e){var r=0,t=Zu(e);return function(n){var a=Dw("",n,r,t);return r=a[1],a[0]}};function Rw(e,r,t,n){var a={key:hr(e),verificationBytes:hr(e)};return t.password&&(a.verifier=G0(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Ow(t.password)),a}function Pw(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Nw(e):n.Data=Iw(e,r),n}function Lw(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?Pw(e,r-2,n):Rw(e,t.biff>=8?r:r-2,t,n),n}var Qu=(function(){function e(a,s){switch(s.type){case"base64":return r(tt(a),s);case"binary":return r(a,s);case"buffer":return r(Oe&&Buffer.isBuffer(a)?a.toString("binary"):Jt(a),s);case"array":return r(dn(a),s)}throw new Error("Unrecognized type "+s.type)}function r(a,s){var i=s||{},o=i.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,u){Array.isArray(o)&&(o[u]=[]);for(var d=/\\\w+\b/g,h=0,p,x=-1;p=d.exec(f);){switch(p[0]){case"\\cell":var m=f.slice(h,d.lastIndex-p[0].length);if(m[0]==" "&&(m=m.slice(1)),++x,m.length){var v={v:m,t:"s"};Array.isArray(o)?o[u][x]=v:o[Te({r:u,c:x})]=v}break}h=d.lastIndex}x>l.e.c&&(l.e.c=x)}),o["!ref"]=Ie(l),o}function t(a,s){return Zt(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Me(a["!ref"]),o,c=Array.isArray(a),l=i.s.r;l<=i.e.r;++l){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var u=Te({r:l,c:f});o=c?(a[l]||[])[f]:a[u],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Rt(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}})();function Bw(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Ra(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Mw(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),s=Math.min(r,t,n),i=a-s;if(i===0)return[0,0,r];var o=0,c=0,l=a+s;switch(c=i/(l>1?2-l:l),a){case r:o=((t-n)/i+6)%6;break;case t:o=(n-r)/i+2;break;case n:o=(r-t)/i+4;break}return[o/6,c,l/2]}function jw(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=a*o,i[0]+=a,i[1]+=c;break;case 1:c=a*(2-o),i[0]+=c,i[1]+=a;break;case 2:c=a*(o-2),i[1]+=a,i[2]+=c;break;case 3:c=a*(4-o),i[1]+=c,i[2]+=a;break;case 4:c=a*(o-4),i[2]+=a,i[0]+=c;break;case 5:c=a*(6-o),i[2]+=c,i[0]+=a;break}for(var l=0;l!=3;++l)i[l]=Math.round(i[l]*255);return i}function Ws(e,r){if(r===0)return e;var t=Mw(Bw(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Ra(jw(t))}var ed=6,Uw=15,Ww=1,Pr=ed;function Pa(e){return Math.floor((e+Math.round(128/Pr)/256)*Pr)}function La(e){return Math.floor((e-5)/Pr*100+.5)/100}function Hs(e){return Math.round((e*Pr+5)/Pr*256)/256}function Ti(e){return Hs(La(Pa(e)))}function V0(e){var r=Math.abs(e-Ti(e)),t=Pr;if(r>.005)for(Pr=Ww;Pr<Uw;++Pr)Math.abs(e-Ti(e))<=r&&(r=Math.abs(e-Ti(e)),t=Pr);Pr=t}function Kt(e){e.width?(e.wpx=Pa(e.width),e.wch=La(e.wpx),e.MDW=Pr):e.wpx?(e.wch=La(e.wpx),e.width=Hs(e.wch),e.MDW=Pr):typeof e.wch=="number"&&(e.width=Hs(e.wch),e.wpx=Pa(e.width),e.MDW=Pr),e.customWidth&&delete e.customWidth}var Hw=96,rd=Hw;function Ba(e){return e*96/rd}function jn(e){return e*rd/96}var Gw={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Vw(e,r,t,n){r.Borders=[];var a={},s=!1;(e[0].match(Ur)||[]).forEach(function(i){var o=Se(i);switch(At(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=qe(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=qe(o.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function $w(e,r,t,n){r.Fills=[];var a={},s=!1;(e[0].match(Ur)||[]).forEach(function(i){var o=Se(i);switch(At(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function zw(e,r,t,n){r.Fonts=[];var a={},s=!1;(e[0].match(Ur)||[]).forEach(function(i){var o=Se(i);switch(At(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=ze(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?qe(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?qe(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?qe(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?qe(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?qe(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?qe(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?qe(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=v0[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=qe(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=sn[a.color.index];a.color.index==81&&(c=sn[1]),c||(c=sn[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Ws(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Xw(e,r,t){r.NumberFmt=[];for(var n=ir(be),a=0;a<n.length;++a)r.NumberFmt[n[a]]=be[n[a]];var s=e[0].match(Ur);if(s)for(a=0;a<s.length;++a){var i=Se(s[a]);switch(At(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Be(ze(i.formatCode)),c=parseInt(i.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}Dt(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Kw(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=ie("numFmt",null,{numFmtId:n,formatCode:$e(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=ie("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var ds=["numFmtId","fillId","fontId","borderId","xfId"],hs=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Yw(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(Ur)||[]).forEach(function(s){var i=Se(s),o=0;switch(At(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<ds.length;++o)n[ds[o]]&&(n[ds[o]]=parseInt(n[ds[o]],10));for(o=0;o<hs.length;++o)n[hs[o]]&&(n[hs[o]]=qe(n[hs[o]]));if(r.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[o]){n.numFmtId=o;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=qe(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function qw(e){var r=[];return r[r.length]=ie("cellXfs",null),e.forEach(function(t){r[r.length]=ie("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=ie("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Jw=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(r))&&Xw(u,f,l),(u=o.match(a))&&zw(u,f,c,l),(u=o.match(n))&&$w(u,f,c,l),(u=o.match(s))&&Vw(u,f,c,l),(u=o.match(t))&&Yw(u,f,l),f}})();function td(e,r){var t=[lr,ie("styleSheet",null,{xmlns:vn[0],"xmlns:vt":mr.vt})],n;return e.SSF&&(n=Kw(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=qw(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Zw(e,r){var t=e.read_shift(2),n=Mr(e);return[t,n]}function Qw(e,r,t){t||(t=Y(6+4*r.length)),t.write_shift(2,e),wr(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function ey(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=Pv(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Rv(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Mr(e),n}function ry(e,r){r||(r=Y(153)),r.write_shift(2,e.sz*20),Lv(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),Ms(e.color,r);var n=0;return n=2,r.write_shift(1,n),wr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var ty=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Si,ny=jr;function Mc(e,r){r||(r=Y(84)),Si||(Si=Qs(ty));var t=Si[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(Ms({auto:1},r),Ms({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function ay(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}function nd(e,r,t){t||(t=Y(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function ta(e,r){return r||(r=Y(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var sy=jr;function iy(e,r){return r||(r=Y(51)),r.write_shift(1,0),ta(null,r),ta(null,r),ta(null,r),ta(null,r),ta(null,r),r.length>r.l?r.slice(0,r.l):r}function oy(e,r){return r||(r=Y(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),Bs(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function cy(e,r,t){var n=Y(2052);return n.write_shift(4,e),Bs(r,n),Bs(t,n),n.length>n.l?n.slice(0,n.l):n}function ly(e,r,t){var n={};n.NumberFmt=[];for(var a in be)n.NumberFmt[a]=be[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Lt(e,function(c,l,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],Dt(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Ws(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(l.T>0)s.push(f);else if(l.T<0)s.pop();else if(!i||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function fy(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&++t}),t!=0&&(Q(e,615,yt(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&Q(e,44,Qw(a,r[a]))}),Q(e,616))}}function uy(e){var r=1;Q(e,611,yt(r)),Q(e,43,ry({sz:12,color:{theme:1},name:"Calibri",family:2})),Q(e,612)}function dy(e){var r=2;Q(e,603,yt(r)),Q(e,45,Mc({patternType:"none"})),Q(e,45,Mc({patternType:"gray125"})),Q(e,604)}function hy(e){var r=1;Q(e,613,yt(r)),Q(e,46,iy()),Q(e,614)}function xy(e){var r=1;Q(e,626,yt(r)),Q(e,47,nd({numFmtId:0},65535)),Q(e,627)}function py(e,r){Q(e,617,yt(r.length)),r.forEach(function(t){Q(e,47,nd(t,0))}),Q(e,618)}function my(e){var r=1;Q(e,619,yt(r)),Q(e,48,oy({xfId:0,name:"Normal"})),Q(e,620)}function gy(e){var r=0;Q(e,505,yt(r)),Q(e,506)}function vy(e){var r=0;Q(e,508,cy(r,"TableStyleMedium9","PivotStyleMedium4")),Q(e,509)}function _y(e,r){var t=Xr();return Q(t,278),fy(t,e.SSF),uy(t),dy(t),hy(t),xy(t),py(t,r.cellXfs),my(t),gy(t),vy(t),Q(t,279),t.end()}var wy=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function yy(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(Ur)||[]).forEach(function(a){var s=Se(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(r.themeElements.clrScheme[wy.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Ey(){}function by(){}var ky=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ty=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Sy=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ay(e,r,t){r.themeElements={};var n;[["clrScheme",ky,yy],["fontScheme",Ty,Ey],["fmtScheme",Sy,by]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var Cy=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ad(e,r){(!e||e.length===0)&&(e=$0());var t,n={};if(!(t=e.match(Cy)))throw new Error("themeElements not found in theme");return Ay(t[0],n,r),n.raw=e,n}function $0(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[lr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Fy(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=qf(s,{type:"array"})}catch{return}var o=Zr(i,"theme/theme/theme1.xml",!0);if(o)return ad(o,t)}}function Iy(e){return e.read_shift(4)}function Ny(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Dy(e,4);break;case 2:r.xclrValue=Bu(e);break;case 3:r.xclrValue=Iy(e);break;case 4:e.l+=4;break}return e.l+=8,r}function Dy(e,r){return jr(e,r)}function Oy(e,r){return jr(e,r)}function Ry(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Ny(e);break;case 6:n[1]=Oy(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function Py(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(Ry(e,t-e.l));return{ixfe:n,ext:s}}function Ly(e,r){r.forEach(function(t){t[0]})}function By(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Mr(e)}}function My(e){var r=Y(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),wr(e.name,r),r.slice(0,r.l)}function jy(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Uy(e){var r=Y(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Wy(e,r){var t=Y(8+2*r.length);return t.write_shift(4,e),wr(r,t),t.slice(0,t.l)}function Hy(e){return e.l+=4,e.read_shift(4)!=0}function Gy(e,r){var t=Y(8);return t.write_shift(4,e),t.write_shift(4,1),t}function Vy(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},s=[],i=!1,o=2;return Lt(e,function(c,l,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?n.Cell.push({type:n.Types[u[0]-1].name,index:u[1]}):o==0&&n.Value.push({type:n.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!l.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function $y(){var e=Xr();return Q(e,332),Q(e,334,yt(1)),Q(e,335,My({name:"XLDAPR",version:12e4,flags:3496657072})),Q(e,336),Q(e,339,Wy(1,"XLDAPR")),Q(e,52),Q(e,35,yt(514)),Q(e,4096,yt(0)),Q(e,4097,lt(1)),Q(e,36),Q(e,53),Q(e,340),Q(e,337,Gy(1)),Q(e,51,Uy([[1,0]])),Q(e,338),Q(e,333),e.end()}function zy(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Ur,function(o){var c=Se(o);switch(At(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(i=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function sd(){var e=[lr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Xy(e){var r=[];if(!e)return r;var t=1;return(e.match(Ur)||[]).forEach(function(n){var a=Se(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function Ky(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Te(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function Yy(e,r,t){var n=[];return Lt(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function qy(e,r,t,n){if(!e)return e;var a=n||{},s=!1;Lt(e,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},a)}function Jy(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var Fn=1024;function id(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[ie("xml",null,{"xmlns:v":Yr.v,"xmlns:o":Yr.o,"xmlns:x":Yr.x,"xmlns:mv":Yr.mv}).replace(/\/>/,">"),ie("o:shapelayout",ie("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ie("v:shapetype",[ie("v:stroke",null,{joinstyle:"miter"}),ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Fn<e*1e3;)Fn+=1e3;return r.forEach(function(s){var i=nr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ie("v:fill",c,o),f={on:"t",obscured:"t"};++Fn,a=a.concat(["<v:shape"+Na({id:"_x0000_s"+Fn,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ie("v:shadow",null,f),ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Sr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Sr("x:AutoFill","False"),Sr("x:Row",String(i.r)),Sr("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function jc(e,r,t,n){var a=Array.isArray(e),s;r.forEach(function(i){var o=nr(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var c=Me(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ie(c);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:t};i.h&&(f.h=i.h);for(var u=s.c.length-1;u>=0;--u){if(!t&&s.c[u].T)return;t&&!s.c[u].T&&s.c.splice(u,1)}if(t&&n){for(u=0;u<n.length;++u)if(f.a==n[u].id){f.a=n[u].name||f.a;break}}s.c.push(f)})}function Zy(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Se(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=nr(c.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var u=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!u&&!!u[1]&&H0(u[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function od(e){var r=[lr,ie("comments",null,{xmlns:vn[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=$e(a.a);t.indexOf(s)==-1&&(t.push(s),r.push("<author>"+s+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=t.indexOf($e(c.a))),s.push(c.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)r.push(Sr("t",$e(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;r.push(Sr("t",$e(i)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Qy(e,r){var t=[],n=!1,a={},s=0;return e.replace(Ur,function(o,c){var l=Se(o);switch(At(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":a.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function eE(e,r,t){var n=[lr,ie("ThreadedComments",null,{xmlns:mr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&r.indexOf(i.a)==-1&&r.push(i.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(i.a)).slice(-12)+"}"),n.push(ie("threadedComment",Sr("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function rE(e,r){var t=[],n=!1;return e.replace(Ur,function(s){var i=Se(s);switch(At(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),t}function tE(e){var r=[lr,ie("personList",null,{xmlns:mr.TCMNT,"xmlns:x":vn[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(ie("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function nE(e){var r={};r.iauthor=e.read_shift(4);var t=En(e);return r.rfx=t.s,r.ref=Te(t.s),e.l+=16,r}function aE(e,r){return r==null&&(r=Y(36)),r.write_shift(4,e[1].iauthor),zn(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var sE=Mr;function iE(e){return wr(e.slice(0,54))}function oE(e,r){var t=[],n=[],a={},s=!1;return Lt(e,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}function cE(e){var r=Xr(),t=[];return Q(r,628),Q(r,630),e.forEach(function(n){n[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),Q(r,632,iE(a.a)))})}),Q(r,631),Q(r,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var s={s:nr(n[0]),e:nr(n[0])};Q(r,635,aE([s,a])),a.t&&a.t.length>0&&Q(r,637,Iv(a)),Q(r,636),delete a.iauthor})}),Q(r,634),Q(r,629),r.end()}var lE="application/vnd.ms-office.vbaProject";function fE(e){var r=we.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");we.utils.cfb_add(r,a,e.FileIndex[n].content)}}),we.write(r)}function uE(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&we.utils.cfb_add(e,a,r.FileIndex[n].content)}})}var cd=["xlsb","xlsm","xlam","biff8","xla"];function dE(){return{"!type":"dialog"}}function hE(){return{"!type":"dialog"}}function xE(){return{"!type":"macro"}}function pE(){return{"!type":"macro"}}var Dn=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,s,i){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=r.c:--f,c?l+=r.r:--l,a+(o?"":"$")+tr(f)+(c?"":"$")+cr(l)}return function(a,s){return r=s,a.replace(e,t)}})(),z0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,X0=(function(){return function(r,t){return r.replace(z0,function(n,a,s,i,o,c){var l=O0(i)-(s?0:t.c),f=D0(c)-(o?0:t.r),u=f==0?"":o?f+1:"["+f+"]",d=l==0?"":s?l+1:"["+l+"]";return a+"R"+u+"C"+d})}})();function ld(e,r){return e.replace(z0,function(t,n,a,s,i,o){return n+(a=="$"?a+s:tr(O0(s)+r.c))+(i=="$"?i+o:cr(D0(o)+r.r))})}function mE(e,r,t){var n=Kr(r),a=n.s,s=nr(t),i={r:s.r-a.r,c:s.c-a.c};return ld(e,i)}function gE(e){return e.length!=1}function Uc(e){return e.replace(/_xlfn\./g,"")}function ur(e){e.l+=1}function Yt(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function fd(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return ud(e);t.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Yt(e),o=Yt(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ud(e){var r=Yt(e),t=Yt(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function vE(e,r,t){if(t.biff<8)return ud(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),s=Yt(e),i=Yt(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function dd(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return _E(e);var n=e.read_shift(t&&t.biff==12?4:2),a=Yt(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function _E(e){var r=Yt(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function wE(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function yE(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return EE(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function EE(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function bE(e,r,t){var n=(e[e.l++]&96)>>5,a=fd(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function kE(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=fd(e,s,t);return[n,a,i]}function TE(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function SE(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function AE(e,r,t){var n=(e[e.l++]&96)>>5,a=vE(e,r-1,t);return[n,a]}function CE(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Wc(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function FE(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function IE(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function NE(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function DE(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function OE(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function hd(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function RE(e){return e.read_shift(2),hd(e)}function PE(e){return e.read_shift(2),hd(e)}function LE(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=dd(e,0,t);return[n,a]}function BE(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=yE(e,0,t);return[n,a]}function ME(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=dd(e,0,t);return[n,a,s]}function jE(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[Hb[a],md[a],n]}function UE(e,r,t){var n=e[e.l++],a=e.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:WE(e);return[a,(s[0]===0?md:Wb)[s[1]]]}function WE(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function HE(e,r,t){e.l+=t&&t.biff==2?3:4}function GE(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function VE(e){return e.l++,Bt[e.read_shift(1)]}function $E(e){return e.l++,e.read_shift(2)}function zE(e){return e.l++,e.read_shift(1)!==0}function XE(e){return e.l++,Lr(e)}function KE(e,r,t){return e.l++,Xa(e,r-1,t)}function YE(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=or(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Bt[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Lr(e);break;case 2:t[1]=bn(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function qE(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?En:ti)(e));return a}function JE(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=YE(e,t.biff);return i}function ZE(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function QE(e,r,t){if(t.biff==5)return eb(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function eb(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function rb(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function tb(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function nb(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function ab(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var sb=jr,ib=jr,ob=jr;function Ya(e,r,t){return e.l+=2,[wE(e)]}function K0(e){return e.l+=6,[]}var cb=Ya,lb=K0,fb=K0,ub=Ya;function xd(e){return e.l+=2,[hr(e),e.read_shift(2)&1]}var db=Ya,hb=xd,xb=K0,pb=Ya,mb=Ya,gb=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vb(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=gb[t>>2&31];return{ixti:r,coltype:t&3,rt:i,idx:n,c:a,C:s}}function _b(e){return e.l+=2,[e.read_shift(4)]}function wb(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function yb(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Eb(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function bb(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function kb(e){return e.l+=4,[0,0]}var Hc={1:{n:"PtgExp",f:GE},2:{n:"PtgTbl",f:ob},3:{n:"PtgAdd",f:ur},4:{n:"PtgSub",f:ur},5:{n:"PtgMul",f:ur},6:{n:"PtgDiv",f:ur},7:{n:"PtgPower",f:ur},8:{n:"PtgConcat",f:ur},9:{n:"PtgLt",f:ur},10:{n:"PtgLe",f:ur},11:{n:"PtgEq",f:ur},12:{n:"PtgGe",f:ur},13:{n:"PtgGt",f:ur},14:{n:"PtgNe",f:ur},15:{n:"PtgIsect",f:ur},16:{n:"PtgUnion",f:ur},17:{n:"PtgRange",f:ur},18:{n:"PtgUplus",f:ur},19:{n:"PtgUminus",f:ur},20:{n:"PtgPercent",f:ur},21:{n:"PtgParen",f:ur},22:{n:"PtgMissArg",f:ur},23:{n:"PtgStr",f:KE},26:{n:"PtgSheet",f:wb},27:{n:"PtgEndSheet",f:yb},28:{n:"PtgErr",f:VE},29:{n:"PtgBool",f:zE},30:{n:"PtgInt",f:$E},31:{n:"PtgNum",f:XE},32:{n:"PtgArray",f:CE},33:{n:"PtgFunc",f:jE},34:{n:"PtgFuncVar",f:UE},35:{n:"PtgName",f:ZE},36:{n:"PtgRef",f:LE},37:{n:"PtgArea",f:bE},38:{n:"PtgMemArea",f:rb},39:{n:"PtgMemErr",f:sb},40:{n:"PtgMemNoMem",f:ib},41:{n:"PtgMemFunc",f:tb},42:{n:"PtgRefErr",f:nb},43:{n:"PtgAreaErr",f:TE},44:{n:"PtgRefN",f:BE},45:{n:"PtgAreaN",f:AE},46:{n:"PtgMemAreaN",f:Eb},47:{n:"PtgMemNoMemN",f:bb},57:{n:"PtgNameX",f:QE},58:{n:"PtgRef3d",f:ME},59:{n:"PtgArea3d",f:kE},60:{n:"PtgRefErr3d",f:ab},61:{n:"PtgAreaErr3d",f:SE},255:{}},Tb={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Sb={1:{n:"PtgElfLel",f:xd},2:{n:"PtgElfRw",f:pb},3:{n:"PtgElfCol",f:cb},6:{n:"PtgElfRwV",f:mb},7:{n:"PtgElfColV",f:ub},10:{n:"PtgElfRadical",f:db},11:{n:"PtgElfRadicalS",f:xb},13:{n:"PtgElfColS",f:lb},15:{n:"PtgElfColSV",f:fb},16:{n:"PtgElfRadicalLel",f:hb},25:{n:"PtgList",f:vb},29:{n:"PtgSxName",f:_b},255:{}},Ab={0:{n:"PtgAttrNoop",f:kb},1:{n:"PtgAttrSemi",f:OE},2:{n:"PtgAttrIf",f:NE},4:{n:"PtgAttrChoose",f:FE},8:{n:"PtgAttrGoto",f:IE},16:{n:"PtgAttrSum",f:HE},32:{n:"PtgAttrBaxcel",f:Wc},33:{n:"PtgAttrBaxcel",f:Wc},64:{n:"PtgAttrSpace",f:RE},65:{n:"PtgAttrSpaceSemi",f:PE},128:{n:"PtgAttrIfError",f:DE},255:{}};function qa(e,r,t,n){if(n.biff<8)return jr(e,r);for(var a=e.l+r,s=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=JE(e,0,n),s.push(t[i][1]);break;case"PtgMemArea":t[i][2]=qE(e,t[i][1],n),s.push(t[i][2]);break;case"PtgExp":n&&n.biff==12&&(t[i][1][1]=e.read_shift(4),s.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return r=a-e.l,r!==0&&s.push(jr(e,r)),s}function Ja(e,r,t){for(var n=e.l+r,a,s,i=[];n!=e.l;)r=n-e.l,s=e[e.l],a=Hc[s]||Hc[Tb[s]],(s===24||s===25)&&(a=(s===24?Sb:Ab)[e[e.l+1]]),!a||!a.f?jr(e,r):i.push([a.n,a.f(e,r,t)]);return i}function Cb(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var Fb={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ib(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function pd(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Gc(e,r,t){var n=pd(e,r,t);return n=="#REF"?n:Ib(n,t)}function Rr(e,r,t,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],c,l,f,u=0,d=0,h,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,m="",v=0,E=e[0].length;v<E;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:m=ar(" ",e[0][x][1][1]);break;case 1:m=ar("\r",e[0][x][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}l=l+m,x=-1}o.push(l+Fb[w[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=ua(w[1][1],i,a),o.push(da(f,s));break;case"PtgRefN":f=t?ua(w[1][1],t,a):w[1][1],o.push(da(f,s));break;case"PtgRef3d":u=w[1][1],f=ua(w[1][2],i,a),p=Gc(n,u,a),o.push(p+"!"+da(f,s));break;case"PtgFunc":case"PtgFuncVar":var A=w[1][0],D=w[1][1];A||(A=0),A&=127;var N=A==0?[]:o.slice(-A);o.length-=A,D==="User"&&(D=N.shift()),o.push(D+"("+N.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":h=vc(w[1][1],t?{s:t}:i,a),o.push(Ei(h,a));break;case"PtgArea":h=vc(w[1][1],i,a),o.push(Ei(h,a));break;case"PtgArea3d":u=w[1][1],h=w[1][2],p=Gc(n,u,a),o.push(p+"!"+Ei(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var k=(n.names||[])[d-1]||(n[0]||[])[d],L=k?k.Name:"SH33TJSNAME"+String(d);L&&L.slice(0,6)=="_xlfn."&&!a.xlfn&&(L=L.slice(6)),o.push(L);break;case"PtgNameX":var O=w[1][1];d=w[1][2];var W;if(a.biff<=5)O<0&&(O=-O),n[O]&&(W=n[O][d]);else{var B="";if(((n[O]||[])[0]||[])[0]==14849||(((n[O]||[])[0]||[])[0]==1025?n[O][d]&&n[O][d].itab>0&&(B=n.SheetNames[n[O][d].itab-1]+"!"):B=n.SheetNames[d-1]+"!"),n[O]&&n[O][d])B+=n[O][d].Name;else if(n[0]&&n[0][d])B+=n[0][d].Name;else{var M=(pd(n,O,a)||"").split(";;");M[d-1]?B=M[d-1]:B+="SH33TJSERRX"}o.push(B);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var Z="(",le=")";if(x>=0){switch(m="",e[0][x][1][0]){case 2:Z=ar(" ",e[0][x][1][1])+Z;break;case 3:Z=ar("\r",e[0][x][1][1])+Z;break;case 4:le=ar(" ",e[0][x][1][1])+le;break;case 5:le=ar("\r",e[0][x][1][1])+le;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(Z+o.pop()+le);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var se={c:t.c,r:t.r};if(n.sharedf[Te(f)]){var he=n.sharedf[Te(f)];o.push(Rr(he,i,se,n,a))}else{var X=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(Rr(l[1],i,se,n,a)),X=!0;break}X||o.push(w[1])}break;case"PtgArray":o.push("{"+Cb(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&ve.indexOf(e[0][v][0])==-1){w=e[0][x];var U=!0;switch(w[1][0]){case 4:U=!1;case 0:m=ar(" ",w[1][1]);break;case 5:U=!1;case 1:m=ar("\r",w[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((U?m:"")+o.pop()+(U?"":m)),x=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Nb(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],jr(e,r-2)];var o=Ja(e,i,t);return r!==i+a&&(s=qa(e,r-i-a,o,t)),e.l=n,[o,s]}function Db(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],jr(e,r-2)];var o=Ja(e,i,t);return r!==i+a&&(s=qa(e,r-i-a,o,t)),e.l=n,[o,s]}function Ob(e,r,t,n){var a=e.l+r,s=Ja(e,n,t),i;return a!==e.l&&(i=qa(e,a-e.l,s,t)),[s,i]}function Rb(e,r,t){var n=e.l+r,a,s=e.read_shift(2),i=Ja(e,s,t);return s==65535?[[],jr(e,r-2)]:(r!==s+2&&(a=qa(e,n-s-2,i,t)),[i,a])}function Pb(e){var r;if(It(e,e.l+6)!==65535)return[Lr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Lb(e){if(e==null){var r=Y(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return hn(e);return hn(0)}function Ai(e,r,t){var n=e.l+r,a=Ct(e);t.biff==2&&++e.l;var s=Pb(e),i=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=Db(e,n-e.l,t);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function Bb(e,r,t,n,a){var s=pn(r,t,a),i=Lb(e.v),o=Y(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=Y(e.bf.length),f=0;f<e.bf.length;++f)l[f]=e.bf[f];var u=_r([s,i,o,l]);return u}function ni(e,r,t){var n=e.read_shift(4),a=Ja(e,n,t),s=e.read_shift(4),i=s>0?qa(e,s,a,t):null;return[a,i]}var Mb=ni,ai=ni,jb=ni,Ub=ni,Wb={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},md={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hb={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Vc(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Gb(e){var r="of:="+e.replace(z0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Ci(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function Vb(e){return e.replace(/\./,"!")}var xa={},On={},pa=typeof Map<"u";function Y0(e,r,t){var n=0,a=e.length;if(t){if(pa?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var s=pa?t.get(r):t[r];n<s.length;++n)if(e[s[n]].t===r)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===r)return e.Count++,n;return e[a]={t:r},e.Count++,e.Unique++,t&&(pa?(t.has(r)||t.set(r,[]),t.get(r).push(a)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(a))),a}function si(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(Pr=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=La(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=Hs(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function ln(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Qt(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],a=60,s=e.length;if(n==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){Dt(r.z,a),t.ssf[a]=r.z,t.revssf[r.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function gd(e,r,t,n,a,s){try{n.cellNF&&(e.z=be[r])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ze(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(be[r]==null&&Dt(Wg[r]||"General",r),e.t==="e")e.w=e.w||Bt[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fa(e.v);else if(e.t==="d"){var i=gr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Fa(i)}else{if(e.v===void 0)return"";e.w=un(e.v,On)}else e.t==="d"?e.w=ht(r,gr(e.v),On):e.w=ht(r,e.v,On)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ws(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ws(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function $b(e,r,t){if(e&&e["!ref"]){var n=Me(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function zb(e,r){var t=Me(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Ie(t))}var Xb=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Kb=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Yb=/<(?:\w:)?hyperlink [^>]*>/mg,qb=/"(\w*:\w*)"/,Jb=/<(?:\w:)?col\b[^>]*[\/]?>/g,Zb=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Qb=/<(?:\w:)?pageMargins[^>]*\/>/g,vd=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ek=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,rk=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tk(e,r,t,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",u=e.match(Kb);u?(l=e.slice(0,u.index),f=e.slice(u.index+u[0].length)):l=f=e;var d=l.match(vd);d?q0(d[0],o,a,t):(d=l.match(ek))&&ak(d[0],d[1]||"",o,a,t);var h=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=l.slice(h,h+50).match(qb);p&&zb(o,p[1])}var x=l.match(rk);x&&x[1]&&gk(x[1],a);var m=[];if(r.cellStyles){var v=l.match(Jb);v&&dk(m,v)}u&&wk(u[1],o,r,c,s,i);var E=f.match(Zb);E&&(o["!autofilter"]=xk(E[0]));var w=[],A=f.match(Xb);if(A)for(h=0;h!=A.length;++h)w[h]=Me(A[h].slice(A[h].indexOf('"')+1));var D=f.match(Yb);D&&lk(o,D,n);var N=f.match(Qb);if(N&&(o["!margins"]=fk(Se(N[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ie(c)),r.sheetRows>0&&o["!ref"]){var k=Me(o["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ie(k))}return m.length>0&&(o["!cols"]=m),w.length>0&&(o["!merges"]=w),o}function nk(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Ie(e[t])+'"/>';return r+"</mergeCells>"}function q0(e,r,t,n){var a=Se(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=Be(ze(a.codeName)))}function ak(e,r,t,n,a){q0(e.slice(0,e.indexOf(">")),t,n,a)}function sk(e,r,t,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[t];try{r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}s=!0,i.codeName=St($e(c))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+ie("outlinePr",null,l)}!s&&!o||(a[a.length]=ie("sheetPr",o,i))}var ik=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ok=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ck(e){var r={sheet:1};return ik.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),ok.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=G0(e.password).toString(16).toUpperCase()),ie("sheetProtection",null,r)}function lk(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var s=Se(ze(r[a]),!0);if(!s.ref)return;var i=((t||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Be(s.location))):(s.Target="#"+Be(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Me(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=Te({c:l,r:c});n?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function fk(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function uk(e){return ln(e),ie("pageMargins",null,e)}function dk(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=Se(r[n],!0);a.hidden&&(a.hidden=qe(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,V0(a.width)),Kt(a);s<=i;)e[s++]=Qe(a)}}function hk(e,r){for(var t=["<cols>"],n,a=0;a!=r.length;++a)(n=r[a])&&(t[t.length]=ie("col",null,si(a,n)));return t[t.length]="</cols>",t.join("")}function xk(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function pk(e,r,t,n){var a=typeof e.ref=="string"?e.ref:Ie(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,i=Kr(a);i.s.r==i.e.r&&(i.e.r=Kr(r["!ref"]).e.r,a=Ie(i));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+t.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),ie("autoFilter",null,{ref:a})}var mk=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function gk(e,r){r.Views||(r.Views=[{}]),(e.match(mk)||[]).forEach(function(t,n){var a=Se(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),qe(a.rightToLeft)&&(r.Views[n].RTL=!0)})}function vk(e,r,t,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ie("sheetViews",ie("sheetView",null,a),{})}function _k(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Bt[e.v];break;case"d":n&&n.cellDates?a=Ze(e.v,-1).toISOString():(e=Qe(e),e.t="n",a=""+(e.v=gr(Ze(e.v)))),typeof e.z>"u"&&(e.z=be[14]);break;default:a=e.v;break}var o=Sr("v",$e(a)),c={r},l=Qt(n.cellXfs,e,n);switch(l!==0&&(c.s=l),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Sr("v",""+Y0(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;o=ie("f",$e(e.f),f)+(e.v!=null?o:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(c.cm=1),ie("c",o,c)}var wk=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Ia("v"),i=Ia("f");return function(c,l,f,u,d,h){for(var p=0,x="",m=[],v=[],E=0,w=0,A=0,D="",N,k,L=0,O=0,W,B,M=0,Z=0,le=Array.isArray(h.CellXf),se,he=[],X=[],ve=Array.isArray(l),U=[],me={},ye=!1,I=!!f.sheetStubs,j=c.split(r),R=0,P=j.length;R!=P;++R){x=j[R].trim();var K=x.length;if(K!==0){var re=0;e:for(p=0;p<K;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(f&&f.cellStyles){if(k=Se(x.slice(re,p),!0),L=k.r!=null?parseInt(k.r,10):L+1,O=-1,f.sheetRows&&f.sheetRows<L)continue;me={},ye=!1,k.ht&&(ye=!0,me.hpt=parseFloat(k.ht),me.hpx=jn(me.hpt)),k.hidden=="1"&&(ye=!0,me.hidden=!0),k.outlineLevel!=null&&(ye=!0,me.level=+k.outlineLevel),ye&&(U[L-1]=me)}break;case"<":re=p;break}if(re>=p)break;if(k=Se(x.slice(re,p),!0),L=k.r!=null?parseInt(k.r,10):L+1,O=-1,!(f.sheetRows&&f.sheetRows<L)){u.s.r>L-1&&(u.s.r=L-1),u.e.r<L-1&&(u.e.r=L-1),f&&f.cellStyles&&(me={},ye=!1,k.ht&&(ye=!0,me.hpt=parseFloat(k.ht),me.hpx=jn(me.hpt)),k.hidden=="1"&&(ye=!0,me.hidden=!0),k.outlineLevel!=null&&(ye=!0,me.level=+k.outlineLevel),ye&&(U[L-1]=me)),m=x.slice(p).split(e);for(var te=0;te!=m.length&&m[te].trim().charAt(0)=="<";++te);for(m=m.slice(te),p=0;p!=m.length;++p)if(x=m[p].trim(),x.length!==0){if(v=x.match(t),E=p,w=0,A=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,v!=null&&v.length===2){for(E=0,D=v[1],w=0;w!=D.length&&!((A=D.charCodeAt(w)-64)<1||A>26);++w)E=26*E+A;--E,O=E}else++O;for(w=0;w!=x.length&&x.charCodeAt(w)!==62;++w);if(++w,k=Se(x.slice(0,w),!0),k.r||(k.r=Te({r:L-1,c:O})),D=x.slice(w),N={t:""},(v=D.match(s))!=null&&v[1]!==""&&(N.v=Be(v[1])),f.cellFormula){if((v=D.match(i))!=null&&v[1]!==""){if(N.f=Be(ze(v[1])).replace(/\r\n/g,`
`),f.xlfn||(N.f=Uc(N.f)),v[0].indexOf('t="array"')>-1)N.F=(D.match(a)||[])[1],N.F.indexOf(":")>-1&&he.push([Me(N.F),N.F]);else if(v[0].indexOf('t="shared"')>-1){B=Se(v[0]);var J=Be(ze(v[1]));f.xlfn||(J=Uc(J)),X[parseInt(B.si,10)]=[B,J,k.r]}}else(v=D.match(/<f[^>]*\/>/))&&(B=Se(v[0]),X[B.si]&&(N.f=mE(X[B.si][1],X[B.si][2],k.r)));var ee=nr(k.r);for(w=0;w<he.length;++w)ee.r>=he[w][0].s.r&&ee.r<=he[w][0].e.r&&ee.c>=he[w][0].s.c&&ee.c<=he[w][0].e.c&&(N.F=he[w][1])}if(k.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(I)N.t="z";else continue;else N.t=k.t||"n";switch(u.s.c>O&&(u.s.c=O),u.e.c<O&&(u.e.c=O),N.t){case"n":if(N.v==""||N.v==null){if(!I)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!I)continue;N.t="z"}else W=xa[parseInt(N.v,10)],N.v=W.t,N.r=W.r,f.cellHTML&&(N.h=W.h);break;case"str":N.t="s",N.v=N.v!=null?ze(N.v):"",f.cellHTML&&(N.h=C0(N.v));break;case"inlineStr":v=D.match(n),N.t="s",v!=null&&(W=H0(v[1]))?(N.v=W.t,f.cellHTML&&(N.h=W.h)):N.v="";break;case"b":N.v=qe(N.v);break;case"d":f.cellDates?N.v=Ze(N.v,1):(N.v=gr(Ze(N.v,1)),N.t="n");break;case"e":(!f||f.cellText!==!1)&&(N.w=N.v),N.v=wu[N.v];break}if(M=Z=0,se=null,le&&k.s!==void 0&&(se=h.CellXf[k.s],se!=null&&(se.numFmtId!=null&&(M=se.numFmtId),f.cellStyles&&se.fillId!=null&&(Z=se.fillId))),gd(N,M,Z,f,d,h),f.cellDates&&le&&N.t=="n"&&Gn(be[M])&&(N.t="d",N.v=ri(N.v)),k.cm&&f.xlmeta){var ke=(f.xlmeta.Cell||[])[+k.cm-1];ke&&ke.type=="XLDAPR"&&(N.D=!0)}if(ve){var C=nr(k.r);l[C.r]||(l[C.r]=[]),l[C.r][C.c]=N}else l[k.r]=N}}}}U.length>0&&(l["!rows"]=U)}})();function yk(e,r,t,n){var a=[],s=[],i=Me(e["!ref"]),o="",c,l="",f=[],u=0,d=0,h=e["!rows"],p=Array.isArray(e),x={r:l},m,v=-1;for(d=i.s.c;d<=i.e.c;++d)f[d]=tr(d);for(u=i.s.r;u<=i.e.r;++u){for(s=[],l=cr(u),d=i.s.c;d<=i.e.c;++d){c=f[d]+l;var E=p?(e[u]||[])[d]:e[c];E!==void 0&&(o=_k(E,c,e,r))!=null&&s.push(o)}(s.length>0||h&&h[u])&&(x={r:l},h&&h[u]&&(m=h[u],m.hidden&&(x.hidden=1),v=-1,m.hpx?v=Ba(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(x.ht=v,x.customHeight=1),m.level&&(x.outlineLevel=m.level)),a[a.length]=ie("row",s.join(""),x))}if(h)for(;u<h.length;++u)h&&h[u]&&(x={r:u+1},m=h[u],m.hidden&&(x.hidden=1),v=-1,m.hpx?v=Ba(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(x.ht=v,x.customHeight=1),m.level&&(x.outlineLevel=m.level),a[a.length]=ie("row","",x));return a.join("")}function _d(e,r,t,n){var a=[lr,ie("worksheet",null,{xmlns:vn[0],"xmlns:r":mr.r})],s=t.SheetNames[e],i=0,o="",c=t.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",f=Me(l);if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),l=Ie(f)}n||(n={}),c["!comments"]=[];var u=[];sk(c,t,e,r,a),a[a.length]=ie("dimension",null,{ref:l}),a[a.length]=vk(c,r,e,t),r.sheetFormat&&(a[a.length]=ie("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=hk(c,c["!cols"])),a[i=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=yk(c,r),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),c["!protect"]&&(a[a.length]=ck(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=pk(c["!autofilter"],c,t,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=nk(c["!merges"]));var d=-1,h,p=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(h={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=Ve(n,-1,$e(x[1].Target).replace(/#.*$/,""),Re.HLINK),h["r:id"]="rId"+p),(d=x[1].Target.indexOf("#"))>-1&&(h.location=$e(x[1].Target.slice(d+1))),x[1].Tooltip&&(h.tooltip=$e(x[1].Tooltip)),a[a.length]=ie("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=uk(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=Sr("ignoredErrors",ie("ignoredError",null,{numberStoredAsText:1,sqref:l}))),u.length>0&&(p=Ve(n,-1,"../drawings/drawing"+(e+1)+".xml",Re.DRAW),a[a.length]=ie("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=u),c["!comments"].length>0&&(p=Ve(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Re.VML),a[a.length]=ie("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Ek(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}function bk(e,r,t){var n=Y(145),a=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Ba(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r:e,c:0},f=0;f<16;++f)if(!(r.s.c>f+1<<10||r.e.c<f<<10)){for(var u=-1,d=-1,h=f<<10;h<f+1<<10;++h){l.c=h;var p=Array.isArray(t)?(t[l.r]||[])[l.c]:t[Te(l)];p&&(u<0&&(u=h),d=h)}u<0||(++o,n.write_shift(4,u),n.write_shift(4,d))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function kk(e,r,t,n){var a=bk(n,t,r);(a.length>17||(r["!rows"]||[])[n])&&Q(e,0,a)}var Tk=En,Sk=zn;function Ak(){}function Ck(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=Nv(e),t}function Fk(e,r,t){t==null&&(t=Y(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var a=1;a<3;++a)t.write_shift(1,0);return Ms({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),pu(e,t),t.slice(0,t.l)}function Ik(e){var r=xt(e);return[r]}function Nk(e,r,t){return t==null&&(t=Y(8)),_n(r,t)}function Dk(e){var r=wn(e);return[r]}function Ok(e,r,t){return t==null&&(t=Y(4)),yn(r,t)}function Rk(e){var r=xt(e),t=e.read_shift(1);return[r,t,"b"]}function Pk(e,r,t){return t==null&&(t=Y(9)),_n(r,t),t.write_shift(1,e.v?1:0),t}function Lk(e){var r=wn(e),t=e.read_shift(1);return[r,t,"b"]}function Bk(e,r,t){return t==null&&(t=Y(5)),yn(r,t),t.write_shift(1,e.v?1:0),t}function Mk(e){var r=xt(e),t=e.read_shift(1);return[r,t,"e"]}function jk(e,r,t){return t==null&&(t=Y(9)),_n(r,t),t.write_shift(1,e.v),t}function Uk(e){var r=wn(e),t=e.read_shift(1);return[r,t,"e"]}function Wk(e,r,t){return t==null&&(t=Y(8)),yn(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function Hk(e){var r=xt(e),t=e.read_shift(4);return[r,t,"s"]}function Gk(e,r,t){return t==null&&(t=Y(12)),_n(r,t),t.write_shift(4,r.v),t}function Vk(e){var r=wn(e),t=e.read_shift(4);return[r,t,"s"]}function $k(e,r,t){return t==null&&(t=Y(8)),yn(r,t),t.write_shift(4,r.v),t}function zk(e){var r=xt(e),t=Lr(e);return[r,t,"n"]}function Xk(e,r,t){return t==null&&(t=Y(16)),_n(r,t),hn(e.v,t),t}function wd(e){var r=wn(e),t=Lr(e);return[r,t,"n"]}function Kk(e,r,t){return t==null&&(t=Y(12)),yn(r,t),hn(e.v,t),t}function Yk(e){var r=xt(e),t=B0(e);return[r,t,"n"]}function qk(e,r,t){return t==null&&(t=Y(12)),_n(r,t),mu(e.v,t),t}function Jk(e){var r=wn(e),t=B0(e);return[r,t,"n"]}function Zk(e,r,t){return t==null&&(t=Y(8)),yn(r,t),mu(e.v,t),t}function Qk(e){var r=xt(e),t=R0(e);return[r,t,"is"]}function eT(e){var r=xt(e),t=Mr(e);return[r,t,"str"]}function rT(e,r,t){return t==null&&(t=Y(12+4*e.v.length)),_n(r,t),wr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function tT(e){var r=wn(e),t=Mr(e);return[r,t,"str"]}function nT(e,r,t){return t==null&&(t=Y(8+4*e.v.length)),yn(r,t),wr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function aT(e,r,t){var n=e.l+r,a=xt(e);a.r=t["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(t.cellFormula){e.l+=2;var o=ai(e,n-e.l,t);i[3]=Rr(o,null,a,t.supbooks,t)}else e.l=n;return i}function sT(e,r,t){var n=e.l+r,a=xt(e);a.r=t["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(t.cellFormula){e.l+=2;var o=ai(e,n-e.l,t);i[3]=Rr(o,null,a,t.supbooks,t)}else e.l=n;return i}function iT(e,r,t){var n=e.l+r,a=xt(e);a.r=t["!row"];var s=Lr(e),i=[a,s,"n"];if(t.cellFormula){e.l+=2;var o=ai(e,n-e.l,t);i[3]=Rr(o,null,a,t.supbooks,t)}else e.l=n;return i}function oT(e,r,t){var n=e.l+r,a=xt(e);a.r=t["!row"];var s=Mr(e),i=[a,s,"str"];if(t.cellFormula){e.l+=2;var o=ai(e,n-e.l,t);i[3]=Rr(o,null,a,t.supbooks,t)}else e.l=n;return i}var cT=En,lT=zn;function fT(e,r){return r==null&&(r=Y(4)),r.write_shift(4,e),r}function uT(e,r){var t=e.l+r,n=En(e),a=P0(e),s=Mr(e),i=Mr(e),o=Mr(e);e.l=t;var c={rfx:n,relId:a,loc:s,display:o};return i&&(c.Tooltip=i),c}function dT(e,r){var t=Y(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));zn({s:nr(e[0]),e:nr(e[0])},t),L0("rId"+r,t);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return wr(a||"",t),wr(e[1].Tooltip||"",t),wr("",t),t.slice(0,t.l)}function hT(){}function xT(e,r,t){var n=e.l+r,a=gu(e),s=e.read_shift(1),i=[a];if(i[2]=s,t.cellFormula){var o=Mb(e,n-e.l,t);i[1]=o}else e.l=n;return i}function pT(e,r,t){var n=e.l+r,a=En(e),s=[a];if(t.cellFormula){var i=Ub(e,n-e.l,t);s[1]=i,e.l=n}else e.l=n;return s}function mT(e,r,t){t==null&&(t=Y(18));var n=si(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),t.write_shift(2,a),t}var yd=["left","right","top","bottom","header","footer"];function gT(e){var r={};return yd.forEach(function(t){r[t]=Lr(e)}),r}function vT(e,r){return r==null&&(r=Y(48)),ln(e),yd.forEach(function(t){hn(e[t],r)}),r}function _T(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function wT(e,r,t){t==null&&(t=Y(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function yT(e){var r=Y(24);return r.write_shift(4,4),r.write_shift(4,1),zn(e,r),r}function ET(e,r){return r==null&&(r=Y(66)),r.write_shift(2,e.password?G0(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function bT(){}function kT(){}function TT(e,r,t,n,a,s,i){if(!e)return e;var o=r||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,d=!1,h,p,x,m,v,E,w,A,D,N=[];o.biff=12,o["!row"]=0;var k=0,L=!1,O=[],W={},B=o.supbooks||a.supbooks||[[]];if(B.sharedf=W,B.arrayf=O,B.SheetNames=a.SheetNames||a.Sheets.map(function(ve){return ve.name}),!o.supbooks&&(o.supbooks=B,a.Names))for(var M=0;M<a.Names.length;++M)B[0][M+1]=a.Names[M];var Z=[],le=[],se=!1;Ma[16]={n:"BrtShortReal",f:wd};var he;if(Lt(e,function(U,me,ye){if(!d)switch(ye){case 148:l=U;break;case 0:h=U,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),A=cr(m=h.r),o["!row"]=h.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=jn(U.hpt)),le[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:U[2]},U[2]){case"n":p.v=U[1];break;case"s":w=xa[U[1]],p.v=w.t,p.r=w.r;break;case"b":p.v=!!U[1];break;case"e":p.v=U[1],o.cellText!==!1&&(p.w=Bt[p.v]);break;case"str":p.t="s",p.v=U[1];break;case"is":p.t="s",p.v=U[1].t;break}if((x=i.CellXf[U[0].iStyleRef])&&gd(p,x.numFmtId,null,o,s,i),v=U[0].c==-1?v+1:U[0].c,o.dense?(c[m]||(c[m]=[]),c[m][v]=p):c[tr(v)+A]=p,o.cellFormula){for(L=!1,k=0;k<O.length;++k){var I=O[k];h.r>=I[0].s.r&&h.r<=I[0].e.r&&v>=I[0].s.c&&v<=I[0].e.c&&(p.F=Ie(I[0]),L=!0)}!L&&U.length>3&&(p.f=U[3])}if(f.s.r>h.r&&(f.s.r=h.r),f.s.c>v&&(f.s.c=v),f.e.r<h.r&&(f.e.r=h.r),f.e.c<v&&(f.e.c=v),o.cellDates&&x&&p.t=="n"&&Gn(be[x.numFmtId])){var j=an(p.v);j&&(p.t="d",p.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}he&&(he.type=="XLDAPR"&&(p.D=!0),he=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;p={t:"z",v:void 0},v=U[0].c==-1?v+1:U[0].c,o.dense?(c[m]||(c[m]=[]),c[m][v]=p):c[tr(v)+A]=p,f.s.r>h.r&&(f.s.r=h.r),f.s.c>v&&(f.s.c=v),f.e.r<h.r&&(f.e.r=h.r),f.e.c<v&&(f.e.c=v),he&&(he.type=="XLDAPR"&&(p.D=!0),he=void 0);break;case 176:N.push(U);break;case 49:he=((o.xlmeta||{}).Cell||[])[U-1];break;case 494:var R=n["!id"][U.relId];for(R?(U.Target=R.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=R):U.relId==""&&(U.Target="#"+U.loc),m=U.rfx.s.r;m<=U.rfx.e.r;++m)for(v=U.rfx.s.c;v<=U.rfx.e.c;++v)o.dense?(c[m]||(c[m]=[]),c[m][v]||(c[m][v]={t:"z",v:void 0}),c[m][v].l=U):(E=Te({c:v,r:m}),c[E]||(c[E]={t:"z",v:void 0}),c[E].l=U);break;case 426:if(!o.cellFormula)break;O.push(U),D=o.dense?c[m][v]:c[tr(v)+A],D.f=Rr(U[1],f,{r:h.r,c:v},B,o),D.F=Ie(U[0]);break;case 427:if(!o.cellFormula)break;W[Te(U[0].s)]=U[1],D=o.dense?c[m][v]:c[tr(v)+A],D.f=Rr(U[1],f,{r:h.r,c:v},B,o);break;case 60:if(!o.cellStyles)break;for(;U.e>=U.s;)Z[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},se||(se=!0,V0(U.w/256)),Kt(Z[U.e+1]);break;case 161:c["!autofilter"]={ref:Ie(U)};break;case 476:c["!margins"]=U;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),U.name&&(a.Sheets[t].CodeName=U.name),(U.above||U.left)&&(c["!outline"]={above:U.above,left:U.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),U.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!me.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+ye.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ie(l||f)),o.sheetRows&&c["!ref"]){var X=Me(c["!ref"]);o.sheetRows<=+X.e.r&&(X.e.r=o.sheetRows-1,X.e.r>f.e.r&&(X.e.r=f.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>f.e.c&&(X.e.c=f.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ie(X))}return N.length>0&&(c["!merges"]=N),Z.length>0&&(c["!cols"]=Z),le.length>0&&(c["!rows"]=le),c}function ST(e,r,t,n,a,s,i){if(r.v===void 0)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":r=Qe(r),r.z=r.z||be[14],r.v=gr(Ze(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v;break}var c={r:t,c:n};switch(c.s=Qt(a.cellXfs,r,a),r.l&&s["!links"].push([Te(c),r.l]),r.c&&s["!comments"].push([Te(c),r.c]),r.t){case"s":case"str":return a.bookSST?(o=Y0(a.Strings,r.v,a.revStrings),c.t="s",c.v=o,i?Q(e,18,$k(r,c)):Q(e,7,Gk(r,c))):(c.t="str",i?Q(e,17,nT(r,c)):Q(e,6,rT(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?i?Q(e,13,Zk(r,c)):Q(e,2,qk(r,c)):i?Q(e,16,Kk(r,c)):Q(e,5,Xk(r,c)),!0;case"b":return c.t="b",i?Q(e,15,Bk(r,c)):Q(e,4,Pk(r,c)),!0;case"e":return c.t="e",i?Q(e,14,Wk(r,c)):Q(e,3,jk(r,c)),!0}return i?Q(e,12,Ok(r,c)):Q(e,1,Nk(r,c)),!0}function AT(e,r,t,n){var a=Me(r["!ref"]||"A1"),s,i="",o=[];Q(e,145);var c=Array.isArray(r),l=a.e.r;r["!rows"]&&(l=Math.max(a.e.r,r["!rows"].length-1));for(var f=a.s.r;f<=l;++f){i=cr(f),kk(e,r,a,f);var u=!1;if(f<=a.e.r)for(var d=a.s.c;d<=a.e.c;++d){f===a.s.r&&(o[d]=tr(d)),s=o[d]+i;var h=c?(r[f]||[])[d]:r[s];if(!h){u=!1;continue}u=ST(e,h,f,d,n,r,u)}}Q(e,146)}function CT(e,r){!r||!r["!merges"]||(Q(e,177,fT(r["!merges"].length)),r["!merges"].forEach(function(t){Q(e,176,lT(t))}),Q(e,178))}function FT(e,r){!r||!r["!cols"]||(Q(e,390),r["!cols"].forEach(function(t,n){t&&Q(e,60,mT(n,t))}),Q(e,391))}function IT(e,r){!r||!r["!ref"]||(Q(e,648),Q(e,649,yT(Me(r["!ref"]))),Q(e,650))}function NT(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var a=Ve(t,-1,n[1].Target.replace(/#.*$/,""),Re.HLINK);Q(e,494,dT(n,a))}}),delete r["!links"]}function DT(e,r,t,n){if(r["!comments"].length>0){var a=Ve(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Re.VML);Q(e,551,L0("rId"+a)),r["!legacy"]=a}}function OT(e,r,t,n){if(r["!autofilter"]){var a=r["!autofilter"],s=typeof a.ref=="string"?a.ref:Ie(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,o=Kr(s);o.s.r==o.e.r&&(o.e.r=Kr(r["!ref"]).e.r,s=Ie(o));for(var c=0;c<i.length;++c){var l=i[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+s;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Q(e,161,zn(Me(s))),Q(e,162)}}function RT(e,r,t){Q(e,133),Q(e,137,wT(r,t)),Q(e,138),Q(e,134)}function PT(e,r){r["!protect"]&&Q(e,535,ET(r["!protect"]))}function LT(e,r,t,n){var a=Xr(),s=t.SheetNames[e],i=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[e].CodeName||o)}catch{}var c=Me(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Q(a,129),(t.vbaraw||i["!outline"])&&Q(a,147,Fk(o,i["!outline"])),Q(a,148,Sk(c)),RT(a,i,t.Workbook),FT(a,i),AT(a,i,e,r),PT(a,i),OT(a,i,t,e),CT(a,i),NT(a,i,n),i["!margins"]&&Q(a,476,vT(i["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&IT(a,i),DT(a,i,e,n),Q(a,130),a.end()}function BT(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(r[+i[1]]=t?+i[2]:i[2])});var a=Be((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[r,a,n]}function MT(e,r,t,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var d=BT(u);f.s.r=f.s.c=0,f.e.c=o,l=tr(o),d[0].forEach(function(h,p){i[l+cr(p)]={t:"n",v:h,z:d[1]},c=p}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(i["!ref"]=Ie(f)),i}function jT(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(vd);return o&&q0(o[0],s,a,t),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function UT(e,r){e.l+=10;var t=Mr(e);return{name:t}}function WT(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Lt(e,function(c,l,f){switch(f){case 550:s["!rel"]=c;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),c.name&&(a.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!i||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},r),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var J0=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],HT=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],GT=[],VT=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function $c(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var s=r[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=qe(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function zc(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=qe(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Ed(e){zc(e.WBProps,J0),zc(e.CalcPr,VT),$c(e.WBView,HT),$c(e.Sheets,GT),On.date1904=qe(e.WBProps.date1904)}function $T(e){return!e.Workbook||!e.Workbook.WBProps?"false":qe(e.Workbook.WBProps.date1904)?"true":"false"}var zT="][*?/\\".split("");function bd(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return zT.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function XT(e,r,t){e.forEach(function(n,a){bd(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var i=r&&r[a]&&r[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function KT(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];XT(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)$b(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var YT=/<\w+:workbook/;function qT(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Ur,function(c,l){var f=Se(c);switch(At(f[0])){case"<?xml":break;case"<workbook":c.match(YT)&&(a="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":J0.forEach(function(u){if(f[u[0]]!=null)switch(u[2]){case"bool":t.WBProps[u[0]]=qe(f[u[0]]);break;case"int":t.WBProps[u[0]]=parseInt(f[u[0]],10);break;default:t.WBProps[u[0]]=f[u[0]]}}),f.codeName&&(t.WBProps.CodeName=ze(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Be(ze(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=ze(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),qe(f.hidden||"0")&&(s.Hidden=!0),i=l+c.length;break;case"</definedName>":s.Ref=Be(ze(e.slice(i,l))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),vn.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Ed(t),t}function kd(e){var r=[lr];r[r.length]=ie("workbook",null,{xmlns:vn[0],"xmlns:r":mr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(J0.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=ie("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),r[r.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:$e(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}r[r.length]=ie("sheet",null,i)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(r[r.length]=ie("definedName",$e(o.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function JT(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Wi(e),t.name=Mr(e),t}function ZT(e,r){return r||(r=Y(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),L0(e.strRelID,r),wr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function QT(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?Mr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function eS(e,r){r||(r=Y(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),pu(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function rS(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function tS(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),s=Dv(e),i=jb(e,0,t),o=P0(e);e.l=n;var c={Name:s,Ptg:i};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function nS(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Ma[16]={n:"BrtFRTArchID$",f:rS},Lt(e,function(c,l,f){switch(f){case 156:i.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=Rr(c.Ptg,null,null,i,r),delete r.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,c]):i[0]=[f,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!l.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},r),Ed(t),t.Names=s,t.supbooks=i,t}function aS(e,r){Q(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,a={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Q(e,156,ZT(a))}Q(e,144)}function sS(e,r){r||(r=Y(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return wr("SheetJS",r),wr(Ns.version,r),wr(Ns.version,r),wr("7262",r),r.length>r.l?r.slice(0,r.l):r}function iS(e,r){r||(r=Y(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function oS(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,a=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&a==-1?a=n:t[n].Hidden==1&&s==-1&&(s=n);s>a||(Q(e,135),Q(e,158,iS(a)),Q(e,136))}}function cS(e,r){var t=Xr();return Q(t,131),Q(t,128,sS()),Q(t,153,eS(e.Workbook&&e.Workbook.WBProps||null)),oS(t,e),aS(t,e),Q(t,132),t.end()}function lS(e,r,t){return r.slice(-4)===".bin"?nS(e,t):qT(e,t)}function fS(e,r,t,n,a,s,i,o){return r.slice(-4)===".bin"?TT(e,n,t,a,s,i,o):tk(e,n,t,a,s,i,o)}function uS(e,r,t,n,a,s,i,o){return r.slice(-4)===".bin"?WT(e,n,t,a,s):jT(e,n,t,a,s)}function dS(e,r,t,n,a,s,i,o){return r.slice(-4)===".bin"?xE():pE()}function hS(e,r,t,n,a,s,i,o){return r.slice(-4)===".bin"?dE():hE()}function xS(e,r,t,n){return r.slice(-4)===".bin"?ly(e,t,n):Jw(e,t,n)}function pS(e,r,t){return ad(e,t)}function mS(e,r,t){return r.slice(-4)===".bin"?mw(e,t):hw(e,t)}function gS(e,r,t){return r.slice(-4)===".bin"?oE(e,t):Zy(e,t)}function vS(e,r,t){return r.slice(-4)===".bin"?Yy(e):Xy(e)}function _S(e,r,t,n){return t.slice(-4)===".bin"?qy(e,r,t,n):void 0}function wS(e,r,t){return r.slice(-4)===".bin"?Vy(e,r,t):zy(e,r,t)}function yS(e,r,t){return(r.slice(-4)===".bin"?cS:kd)(e)}function ES(e,r,t,n,a){return(r.slice(-4)===".bin"?LT:_d)(e,t,n,a)}function bS(e,r,t){return(r.slice(-4)===".bin"?_y:td)(e,t)}function kS(e,r,t){return(r.slice(-4)===".bin"?_w:Ku)(e,t)}function TS(e,r,t){return(r.slice(-4)===".bin"?cE:od)(e)}function SS(e){return(e.slice(-4)===".bin"?$y:sd)()}var Td=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Sd=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mt(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(Td),s,i,o,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(Sd),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function AS(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Td),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(Sd),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),t[i]=a[2].slice(1,a[2].length-1));return t}var ma;function CS(e,r){var t=ma[e]||Be(e);return t==="General"?un(r):ht(t,r)}function FS(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=qe(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ze(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Be(r)]=a}function IS(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Bt[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fa(e.v):e.w=un(e.v):e.w=CS(r||"General",e.v)}catch(s){if(t.WTF)throw s}try{var n=ma[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Gn(n)){var a=an(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(t.WTF)throw s}}}function NS(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=Gw[n.Pattern]||n.Pattern)}e[r.ID]=r}function DS(e,r,t,n,a,s,i,o,c,l){var f="General",u=n.StyleID,d={};l=l||{};var h=[],p=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&i&&(u=i.StyleID);s[u]!==void 0&&(s[u].nf&&(f=s[u].nf),s[u].Interior&&h.push(s[u].Interior),!!s[u].Parent);)u=s[u].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=qe(e);break;case"String":n.t="s",n.r=lc(Be(e)),n.v=e.indexOf("<")>-1?Be(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ze(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Be(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=wu[e],l.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=lc(r||e));break}if(IS(n,f,l),l.cellFormula!==!1)if(n.Formula){var x=Be(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Dn(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Dn("RC:RC",a):n.ArrayRange&&(n.F=Dn(n.ArrayRange,a),c.push([Me(n.F),n.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(n.F=c[p][1]);l.cellStyles&&(h.forEach(function(m){!d.patternType&&m.patternType&&(d.patternType=m.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function OS(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Fi(e,r){var t=r||{};Vn();var n=na(F0(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=ze(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Qe(t);return i.type="string",Mn.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ye){a.indexOf("<"+Ye)>=0&&(s=!0)}),s)return v4(n,t);ma={"General Number":"General","General Date":be[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":be[15],"Short Date":be[14],"Long Time":be[19],"Medium Time":be[18],"Short Time":be[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:be[2],Standard:be[4],Percent:be[10],Scientific:be[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,f={},u=[],d=t.dense?[]:{},h="",p={},x={},m=mt('<Data ss:Type="String">'),v=0,E=0,w=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},N={},k="",L=0,O=[],W={},B={},M=0,Z=[],le=[],se={},he=[],X,ve=!1,U=[],me=[],ye={},I=0,j=0,R={Sheets:[],WBProps:{date1904:!1}},P={};Da.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=Da.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?DS(n.slice(v,o.index),k,m,c[c.length-1][0]=="comment"?se:p,{c:E,r:w},D,he[E],x,U,t):(k="",m=mt(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(le.length>0&&(p.c=le),(!t.sheetRows||t.sheetRows>w)&&p.v!==void 0&&(t.dense?(d[w]||(d[w]=[]),d[w][E]=p):d[tr(E)+cr(w)]=p),p.HRef&&(p.l={Target:Be(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(I=E+(parseInt(p.MergeAcross,10)|0),j=w+(parseInt(p.MergeDown,10)|0),O.push({s:{c:E,r:w},e:{c:I,r:j}})),!t.sheetStubs)p.MergeAcross?E=I+1:++E;else if(p.MergeAcross||p.MergeDown){for(var re=E;re<=I;++re)for(var te=w;te<=j;++te)(re>E||te>w)&&(t.dense?(d[te]||(d[te]=[]),d[te][re]={t:"z"}):d[tr(re)+cr(te)]={t:"z"});E=I+1}else++E;else p=AS(o[0]),p.Index&&(E=+p.Index-1),E<A.s.c&&(A.s.c=E),E>A.e.c&&(A.e.c=E),o[0].slice(-2)==="/>"&&++E,le=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<A.s.r&&(A.s.r=w),w>A.e.r&&(A.e.r=w),o[0].slice(-2)==="/>"&&(x=mt(o[0]),x.Index&&(w=+x.Index-1)),E=0,++w):(x=mt(o[0]),x.Index&&(w=+x.Index-1),ye={},(x.AutoFitHeight=="0"||x.Height)&&(ye.hpx=parseInt(x.Height,10),ye.hpt=Ba(ye.hpx),me[w]=ye),x.Hidden=="1"&&(ye.hidden=!0,me[w]=ye));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));u.push(h),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(d["!ref"]=Ie(A),t.sheetRows&&t.sheetRows<=A.e.r&&(d["!fullref"]=d["!ref"],A.e.r=t.sheetRows-1,d["!ref"]=Ie(A))),O.length&&(d["!merges"]=O),he.length>0&&(d["!cols"]=he),me.length>0&&(d["!rows"]=me),f[h]=d}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=E=0,c.push([o[3],!1]),l=mt(o[0]),h=Be(l.Name),d=t.dense?[]:{},O=[],U=[],me=[],P={name:h,Hidden:0},R.Sheets.push(P);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),he=[],ve=!1}break;case"style":o[1]==="/"?NS(D,N,t):N=mt(o[0]);break;case"numberformat":N.nf=Be(mt(o[0]).Format||"General"),ma[N.nf]&&(N.nf=ma[N.nf]);for(var J=0;J!=392&&be[J]!=N.nf;++J);if(J==392){for(J=57;J!=392;++J)if(be[J]==null){Dt(N.nf,J);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(X=mt(o[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!ve&&X.wpx>10){ve=!0,Pr=ed;for(var ee=0;ee<he.length;++ee)he[ee]&&Kt(he[ee])}ve&&Kt(X),he[X.Index-1||he.length]=X;for(var ke=0;ke<+X.Span;++ke)he[he.length]=Qe(X);break;case"namedrange":if(o[1]==="/")break;R.Names||(R.Names=[]);var C=Se(o[0]),je={Name:C.Name,Ref:Dn(C.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(je.Sheet=R.Sheets.length-1),R.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(L,o.index):L=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;N.Interior=mt(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?n2(W,K,n.slice(M,o.index)):M=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));OS(se),le.push(se)}else c.push([o[3],!1]),l=mt(o[0]),se={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Fe=mt(o[0]);d["!autofilter"]={ref:Dn(Fe.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Jc(n,t);var Pe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Pe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Pe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Pe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Pe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(M,o.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else M=o.index+o[0].length;break;case"header":d["!margins"]||ln(d["!margins"]={},"xlml"),isNaN(+Se(o[0]).Margin)||(d["!margins"].header=+Se(o[0]).Margin);break;case"footer":d["!margins"]||ln(d["!margins"]={},"xlml"),isNaN(+Se(o[0]).Margin)||(d["!margins"].footer=+Se(o[0]).Margin);break;case"pagemargins":var Ne=Se(o[0]);d["!margins"]||ln(d["!margins"]={},"xlml"),isNaN(+Ne.Top)||(d["!margins"].top=+Ne.Top),isNaN(+Ne.Left)||(d["!margins"].left=+Ne.Left),isNaN(+Ne.Right)||(d["!margins"].right=+Ne.Right),isNaN(+Ne.Bottom)||(d["!margins"].bottom=+Ne.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Pe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Pe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Pe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Pe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Pe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Pe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Pe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Pe=!1}break;case"smarttags":break;default:Pe=!1;break}if(Pe||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?FS(B,K,Z,n.slice(M,o.index)):(Z=o,M=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ue={};return!t.bookSheets&&!t.bookProps&&(ue.Sheets=f),ue.SheetNames=u,ue.Workbook=R,ue.SSF=Qe(be),ue.Props=W,ue.Custprops=B,ue}function Ki(e,r){switch(Q0(r=r||{}),r.type||"base64"){case"base64":return Fi(tt(e),r);case"binary":case"buffer":case"file":return Fi(e,r);case"array":return Fi(Jt(e),r)}}function RS(e,r){var t=[];return e.Props&&t.push(a2(e.Props,r)),e.Custprops&&t.push(s2(e.Props,e.Custprops)),t.join("")}function PS(){return""}function LS(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,a){var s=[];s.push(ie("NumberFormat",null,{"ss:Format":$e(be[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};t.push(ie("Style",s.join(""),i))}),ie("Styles",t.join(""))}function Ad(e){return ie("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+X0(e.Ref,{r:0,c:0})})}function BS(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var a=r[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(Ad(a)))}return ie("Names",t.join(""))}function MS(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(Ad(o)))}return s.join("")}function jS(e,r,t,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ie("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ie("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ie("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)a.push(ie("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Sr("ProtectContents","True")),e["!protect"].objects&&a.push(Sr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Sr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Sr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Sr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":ie("WorksheetOptions",a.join(""),{xmlns:Yr.x})}function US(e){return e.map(function(r){var t=ov(r.t||""),n=ie("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return ie("Comment",n,{"ss:Author":r.a})}).join("")}function WS(e,r,t,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+$e(X0(e.f,i))),e.F&&e.F.slice(0,r.length)==r){var c=nr(e.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=$e(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=$e(e.l.Tooltip))),t["!merges"])for(var l=t["!merges"],f=0;f!=l.length;++f)l[f].s.c!=i.c||l[f].s.r!=i.r||(l[f].e.c>l[f].s.c&&(o["ss:MergeAcross"]=l[f].e.c-l[f].s.c),l[f].e.r>l[f].s.r&&(o["ss:MergeDown"]=l[f].e.r-l[f].s.r));var u="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":u="Number",d=String(e.v);break;case"b":u="Boolean",d=e.v?"1":"0";break;case"e":u="Error",d=Bt[e.v];break;case"d":u="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||be[14]);break;case"s":u="String",d=iv(e.v||"");break}var h=Qt(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=i.c+1;var p=e.v!=null?d:"",x=e.t=="z"?"":'<Data ss:Type="'+u+'">'+p+"</Data>";return(e.c||[]).length>0&&(x+=US(e.c)),ie("Cell",x,o)}function HS(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=jn(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function GS(e,r,t,n){if(!e["!ref"])return"";var a=Me(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(m,v){Kt(m);var E=!!m.width,w=si(v,m),A={"ss:Index":v+1};E&&(A["ss:Width"]=Pa(w.width)),m.hidden&&(A["ss:Hidden"]="1"),o.push(ie("Column",null,A))});for(var c=Array.isArray(e),l=a.s.r;l<=a.e.r;++l){for(var f=[HS(l,(e["!rows"]||[])[l])],u=a.s.c;u<=a.e.c;++u){var d=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>u)&&!(s[i].s.r>l)&&!(s[i].e.c<u)&&!(s[i].e.r<l)){(s[i].s.c!=u||s[i].s.r!=l)&&(d=!0);break}if(!d){var h={r:l,c:u},p=Te(h),x=c?(e[l]||[])[u]:e[p];f.push(WS(x,p,e,r,t,n,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function VS(e,r,t){var n=[],a=t.SheetNames[e],s=t.Sheets[a],i=s?MS(s,r,e,t):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?GS(s,r,e,t):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(jS(s,r,e,t)),n.join("")}function $S(e,r){r||(r={}),e.SSF||(e.SSF=Qe(be)),e.SSF&&(Vn(),Zs(e.SSF),r.revssf=ei(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Qt(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(RS(e,r)),t.push(PS()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(ie("Worksheet",VS(n,r,e),{"ss:Name":$e(e.SheetNames[n])}));return t[2]=LS(e,r),t[3]=BS(e),lr+ie("Workbook",t.join(""),{xmlns:Yr.ss,"xmlns:o":Yr.o,"xmlns:x":Yr.x,"xmlns:ss":Yr.ss,"xmlns:dt":Yr.dt,"xmlns:html":Yr.html})}function zS(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Bv(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=Mv(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var XS=[60,1084,2066,2165,2175];function KS(e,r,t,n,a){var s=n,i=[],o=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),t.l+=s;for(var c=It(t,t.l),l=Yi[c],f=0;l!=null&&XS.indexOf(c)>-1;)s=It(t,t.l+2),f=t.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=t.slice(f,t.l+4+s),i.push(o),t.l+=4+s,l=Yi[c=It(t,t.l)];var u=_r(i);Tr(u,0);var d=0;u.lens=[];for(var h=0;h<i.length;++h)u.lens.push(d),d+=i[h].length;if(u.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+n;return r.f(u,u.length,a)}function bt(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=be[n])}catch(s){if(r.WTF)throw s}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Bt[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fa(e.v):e.w=un(e.v):e.w=ht(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&n&&e.t=="n"&&Gn(be[n]||String(n))){var a=an(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function xs(e,r,t){return{v:e,ixfe:r,t}}function YS(e,r){var t={opts:{}},n={},a=r.dense?[]:{},s={},i={},o=null,c=[],l="",f={},u,d="",h,p,x,m,v={},E=[],w,A,D=[],N=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},L={},O=function(Ae){return Ae<8?sn[Ae]:Ae<64&&N[Ae-8]||sn[Ae]},W=function(Ae,He,pr){var Ke=He.XF.data;if(!(!Ke||!Ke.patternType||!pr||!pr.cellStyles)){He.s={},He.s.patternType=Ke.patternType;var Mt;(Mt=Ra(O(Ke.icvFore)))&&(He.s.fgColor={rgb:Mt}),(Mt=Ra(O(Ke.icvBack)))&&(He.s.bgColor={rgb:Mt})}},B=function(Ae,He,pr){if(!(ye>1)&&!(pr.sheetRows&&Ae.r>=pr.sheetRows)){if(pr.cellStyles&&He.XF&&He.XF.data&&W(Ae,He,pr),delete He.ixfe,delete He.XF,u=Ae,d=Te(Ae),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ae.r<i.s.r&&(i.s.r=Ae.r),Ae.c<i.s.c&&(i.s.c=Ae.c),Ae.r+1>i.e.r&&(i.e.r=Ae.r+1),Ae.c+1>i.e.c&&(i.e.c=Ae.c+1),pr.cellFormula&&He.f){for(var Ke=0;Ke<E.length;++Ke)if(!(E[Ke][0].s.c>Ae.c||E[Ke][0].s.r>Ae.r)&&!(E[Ke][0].e.c<Ae.c||E[Ke][0].e.r<Ae.r)){He.F=Ie(E[Ke][0]),(E[Ke][0].s.c!=Ae.c||E[Ke][0].s.r!=Ae.r)&&delete He.f,He.f&&(He.f=""+Rr(E[Ke][1],i,Ae,U,M));break}}pr.dense?(a[Ae.r]||(a[Ae.r]=[]),a[Ae.r][Ae.c]=He):a[d]=He}},M={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(M.password=r.password);var Z,le=[],se=[],he=[],X=[],ve=!1,U=[];U.SheetNames=M.snames,U.sharedf=M.sharedf,U.arrayf=M.arrayf,U.names=[],U.XTI=[];var me=0,ye=0,I=0,j=[],R=[],P;M.codepage=1200,vt(1200);for(var K=!1;e.l<e.length-1;){var re=e.l,te=e.read_shift(2);if(te===0&&me===10)break;var J=e.l===e.length?0:e.read_shift(2),ee=Yi[te];if(ee&&ee.f){if(r.bookSheets&&me===133&&te!==133)break;if(me=te,ee.r===2||ee.r==12){var ke=e.read_shift(2);if(J-=2,!M.enc&&ke!==te&&((ke&255)<<8|ke>>8)!==te)throw new Error("rt mismatch: "+ke+"!="+te);ee.r==12&&(e.l+=10,J-=10)}var C={};if(te===10?C=ee.f(e,J,M):C=KS(te,ee,e,J,M),ye==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(te){case 34:t.opts.Date1904=k.WBProps.date1904=C;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=C,!r.password)throw new Error("File is password-protected");if(C.valid==null)throw new Error("Encryption scheme unsupported");if(!C.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=C;break;case 66:var je=Number(C);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}vt(M.codepage=je),K=!0;break;case 317:M.rrtabid=C;break;case 25:M.winlocked=C;break;case 439:t.opts.RefreshAll=C;break;case 12:t.opts.CalcCount=C;break;case 16:t.opts.CalcDelta=C;break;case 17:t.opts.CalcIter=C;break;case 13:t.opts.CalcMode=C;break;case 14:t.opts.CalcPrecision=C;break;case 95:t.opts.CalcSaveRecalc=C;break;case 15:M.CalcRefMode=C;break;case 2211:t.opts.FullCalc=C;break;case 129:C.fDialog&&(a["!type"]="dialog"),C.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),C.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:D.push(C);break;case 430:U.push([C]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(C);break;case 24:case 536:P={Name:C.Name,Ref:Rr(C.rgce,i,null,U,M)},C.itab>0&&(P.Sheet=C.itab-1),U.names.push(P),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(C),C.Name=="_xlnm._FilterDatabase"&&C.itab>0&&C.rgce&&C.rgce[0]&&C.rgce[0][0]&&C.rgce[0][0][0]=="PtgArea3d"&&(R[C.itab-1]={ref:Ie(C.rgce[0][0][1][2])});break;case 22:M.ExternCount=C;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(C),U.XTI=U.XTI.concat(C);break;case 2196:if(M.biff<8)break;P!=null&&(P.Comment=C[1]);break;case 18:a["!protect"]=C;break;case 19:C!==0&&M.WTF&&console.error("Password verifier: "+C);break;case 133:s[C.pos]=C,M.snames.push(C.name);break;case 10:{if(--ye)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ie(i),r.sheetRows&&r.sheetRows<=i.e.r){var Fe=i.e.r;i.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ie(i),i.e.r=Fe}i.e.r++,i.e.c++}le.length>0&&(a["!merges"]=le),se.length>0&&(a["!objects"]=se),he.length>0&&(a["!cols"]=he),X.length>0&&(a["!rows"]=X),k.Sheets.push(L)}l===""?f=a:n[l]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[C.BIFFVer]||8),M.biffguess=C.BIFFVer==0,C.BIFFVer==0&&C.dt==4096&&(M.biff=5,K=!0,vt(M.codepage=28591)),M.biff==8&&C.BIFFVer==0&&C.dt==16&&(M.biff=2),ye++)break;if(a=r.dense?[]:{},M.biff<8&&!K&&(K=!0,vt(M.codepage=r.codepage||1252)),M.biff<5||C.BIFFVer==0&&C.dt==4096){l===""&&(l="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Pe={pos:e.l-J,name:l};s[Pe.pos]=Pe,M.snames.push(l)}else l=(s[re]||{name:""}).name;C.dt==32&&(a["!type"]="chart"),C.dt==64&&(a["!type"]="macro"),le=[],se=[],M.arrayf=E=[],he=[],X=[],ve=!1,L={Hidden:(s[re]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[C.r]||[])[C.c]:a[Te({c:C.c,r:C.r})])&&++C.c,w={ixfe:C.ixfe,XF:D[C.ixfe]||{},v:C.val,t:"n"},I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B({c:C.c,r:C.r},w,r);break;case 5:case 517:w={ixfe:C.ixfe,XF:D[C.ixfe],v:C.val,t:C.t},I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B({c:C.c,r:C.r},w,r);break;case 638:w={ixfe:C.ixfe,XF:D[C.ixfe],v:C.rknum,t:"n"},I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B({c:C.c,r:C.r},w,r);break;case 189:for(var Ne=C.c;Ne<=C.C;++Ne){var ue=C.rkrec[Ne-C.c][0];w={ixfe:ue,XF:D[ue],v:C.rkrec[Ne-C.c][1],t:"n"},I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B({c:Ne,r:C.r},w,r)}break;case 6:case 518:case 1030:{if(C.val=="String"){o=C;break}if(w=xs(C.val,C.cell.ixfe,C.tt),w.XF=D[w.ixfe],r.cellFormula){var Ye=C.formula;if(Ye&&Ye[0]&&Ye[0][0]&&Ye[0][0][0]=="PtgExp"){var xr=Ye[0][0][1][0],Cr=Ye[0][0][1][1],pt=Te({r:xr,c:Cr});v[pt]?w.f=""+Rr(C.formula,i,C.cell,U,M):w.F=((r.dense?(a[xr]||[])[Cr]:a[pt])||{}).F}else w.f=""+Rr(C.formula,i,C.cell,U,M)}I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B(C.cell,w,r),o=C}break;case 7:case 519:if(o)o.val=C,w=xs(C,o.cell.ixfe,"s"),w.XF=D[w.ixfe],r.cellFormula&&(w.f=""+Rr(o.formula,i,o.cell,U,M)),I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B(o.cell,w,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(C);var pe=Te(C[0].s);if(h=r.dense?(a[C[0].s.r]||[])[C[0].s.c]:a[pe],r.cellFormula&&h){if(!o||!pe||!h)break;h.f=""+Rr(C[1],i,C[0],U,M),h.F=Ie(C[0])}}break;case 1212:{if(!r.cellFormula)break;if(d){if(!o)break;v[Te(o.cell)]=C[0],h=r.dense?(a[o.cell.r]||[])[o.cell.c]:a[Te(o.cell)],(h||{}).f=""+Rr(C[0],i,u,U,M)}}break;case 253:w=xs(c[C.isst].t,C.ixfe,"s"),c[C.isst].h&&(w.h=c[C.isst].h),w.XF=D[w.ixfe],I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B({c:C.c,r:C.r},w,r);break;case 513:r.sheetStubs&&(w={ixfe:C.ixfe,XF:D[C.ixfe],t:"z"},I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B({c:C.c,r:C.r},w,r));break;case 190:if(r.sheetStubs)for(var Ee=C.c;Ee<=C.C;++Ee){var Xe=C.ixfe[Ee-C.c];w={ixfe:Xe,XF:D[Xe],t:"z"},I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B({c:Ee,r:C.r},w,r)}break;case 214:case 516:case 4:w=xs(C.val,C.ixfe,"s"),w.XF=D[w.ixfe],I>0&&(w.z=j[w.ixfe>>8&63]),bt(w,r,t.opts.Date1904),B({c:C.c,r:C.r},w,r);break;case 0:case 512:ye===1&&(i=C);break;case 252:c=C;break;case 1054:if(M.biff==4){j[I++]=C[1];for(var Fr=0;Fr<I+163&&be[Fr]!=C[1];++Fr);Fr>=163&&Dt(C[1],I+163)}else Dt(C[1],C[0]);break;case 30:{j[I++]=C;for(var br=0;br<I+163&&be[br]!=C;++br);br>=163&&Dt(C,I+163)}break;case 229:le=le.concat(C);break;case 93:se[C.cmo[0]]=M.lastobj=C;break;case 438:M.lastobj.TxO=C;break;case 127:M.lastobj.ImData=C;break;case 440:for(m=C[0].s.r;m<=C[0].e.r;++m)for(x=C[0].s.c;x<=C[0].e.c;++x)h=r.dense?(a[m]||[])[x]:a[Te({c:x,r:m})],h&&(h.l=C[1]);break;case 2048:for(m=C[0].s.r;m<=C[0].e.r;++m)for(x=C[0].s.c;x<=C[0].e.c;++x)h=r.dense?(a[m]||[])[x]:a[Te({c:x,r:m})],h&&h.l&&(h.l.Tooltip=C[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;h=r.dense?(a[C[0].r]||[])[C[0].c]:a[Te(C[0])];var $r=se[C[2]];h||(r.dense?(a[C[0].r]||(a[C[0].r]=[]),h=a[C[0].r][C[0].c]={t:"z"}):h=a[Te(C[0])]={t:"z"},i.e.r=Math.max(i.e.r,C[0].r),i.s.r=Math.min(i.s.r,C[0].r),i.e.c=Math.max(i.e.c,C[0].c),i.s.c=Math.min(i.s.c,C[0].c)),h.c||(h.c=[]),p={a:C[1],t:$r.TxO.t},h.c.push(p)}break;case 2173:Ly(D[C.ixfe],C.ext);break;case 125:{if(!M.cellStyles)break;for(;C.e>=C.s;)he[C.e--]={width:C.w/256,level:C.level||0,hidden:!!(C.flags&1)},ve||(ve=!0,V0(C.w/256)),Kt(he[C.e+1])}break;case 520:{var fr={};C.level!=null&&(X[C.r]=fr,fr.level=C.level),C.hidden&&(X[C.r]=fr,fr.hidden=!0),C.hpt&&(X[C.r]=fr,fr.hpt=C.hpt,fr.hpx=jn(C.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ln(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[te]]=C;break;case 161:a["!margins"]||ln(a["!margins"]={}),a["!margins"].header=C.header,a["!margins"].footer=C.footer;break;case 574:C.RTL&&(k.Views[0].RTL=!0);break;case 146:N=C;break;case 2198:Z=C;break;case 140:A=C;break;case 442:l?L.CodeName=C||L.name:k.WBProps.CodeName=C||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+te.toString(16)),e.l+=J}return t.SheetNames=ir(s).sort(function(Ir,Ae){return Number(Ir)-Number(Ae)}).map(function(Ir){return s[Ir].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&R.forEach(function(Ir,Ae){t.Sheets[t.SheetNames[Ae]]["!autofilter"]=Ir}),t.Strings=c,t.SSF=Qe(be),M.enc&&(t.Encryption=M.enc),Z&&(t.Themes=Z),t.Metadata={},A!==void 0&&(t.Metadata.Country=A),U.names.length>0&&(k.Names=U.names),t.Workbook=k,t}var ga={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function qS(e,r,t){var n=we.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Ac(n,Hi,ga.DSI);for(var s in a)r[s]=a[s]}catch(l){if(t.WTF)throw l}var i=we.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Ac(i,Gi,ga.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(Su(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function JS(e,r){var t=[],n=[],a=[],s=0,i,o=nc(Hi,"n"),c=nc(Gi,"n");if(e.Props)for(i=ir(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?t:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=ir(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?t:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var l=[];for(s=0;s<a.length;++s)Ou.indexOf(a[s][0])>-1||Tu.indexOf(a[s][0])>-1||a[s][1]!=null&&l.push(a[s]);n.length&&we.utils.cfb_add(r,"/SummaryInformation",Cc(n,ga.SI,c,Gi)),(t.length||l.length)&&we.utils.cfb_add(r,"/DocumentSummaryInformation",Cc(t,ga.DSI,o,Hi,l.length?l:null,ga.UDI))}function Cd(e,r){r||(r={}),Q0(r),w0(),r.codepage&&_0(r.codepage);var t,n;if(e.FullPaths){if(we.find(e,"/encryption"))throw new Error("File is password-protected");t=we.find(e,"!CompObj"),n=we.find(e,"/Workbook")||we.find(e,"/Book")}else{switch(r.type){case"base64":e=Jr(tt(e));break;case"binary":e=Jr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Tr(e,0),n={content:e}}var a,s;if(t&&zS(t),r.bookProps&&!r.bookSheets)a={};else{var i=Oe?"buffer":"array";if(n&&n.content)a=YS(n.content,r);else if((s=we.find(e,"PerfectOffice_MAIN"))&&s.content)a=cn.to_workbook(s.content,(r.type=i,r));else if((s=we.find(e,"NativeContent_MAIN"))&&s.content)a=cn.to_workbook(s.content,(r.type=i,r));else throw(s=we.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&we.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=fE(e))}var o={};return e.FullPaths&&qS(e,o,r),a.Props=a.Custprops=o,r.bookFiles&&(a.cfb=e),a}function ZS(e,r){var t=r||{},n=we.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return we.utils.cfb_add(n,a,Fd(e,t)),t.biff==8&&(e.Props||e.Custprops)&&JS(e,n),t.biff==8&&e.vbaraw&&uE(n,we.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Ma={0:{f:Ek},1:{f:Ik},2:{f:Yk},3:{f:Mk},4:{f:Rk},5:{f:zk},6:{f:eT},7:{f:Hk},8:{f:oT},9:{f:iT},10:{f:aT},11:{f:sT},12:{f:Dk},13:{f:Jk},14:{f:Uk},15:{f:Lk},16:{f:wd},17:{f:tT},18:{f:Vk},19:{f:R0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tS},40:{},42:{},43:{f:ey},44:{f:Zw},45:{f:ny},46:{f:sy},47:{f:ay},48:{},49:{f:Tv},50:{},51:{f:jy},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Vu},62:{f:Qk},63:{f:Ky},64:{f:bT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_T},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ck},148:{f:Tk,p:16},151:{f:hT},152:{},153:{f:QT},154:{},155:{},156:{f:JT},157:{},158:{},159:{T:1,f:pw},160:{T:-1},161:{T:1,f:En},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:By},336:{T:-1},337:{f:Hy,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Wi},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Gu},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:xT},427:{f:pT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:gT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Ak},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Wi},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:sE},633:{T:1},634:{T:-1},635:{T:1,f:nE},636:{T:-1},637:{f:Fv},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:UT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Yi={6:{f:Ai},10:{f:jt},12:{f:hr},13:{f:hr},14:{f:or},15:{f:or},16:{f:Lr},17:{f:or},18:{f:or},19:{f:hr},20:{f:Rc},21:{f:Rc},23:{f:Gu},24:{f:Lc},25:{f:or},26:{},27:{},28:{f:k_},29:{},34:{f:or},35:{f:Pc},38:{f:Lr},39:{f:Lr},40:{f:Lr},41:{f:Lr},42:{f:or},43:{f:or},47:{f:Lw},49:{f:J2},51:{f:hr},60:{},61:{f:z2},64:{f:or},65:{f:q2},66:{f:hr},77:{},80:{},81:{},82:{},85:{f:hr},89:{},90:{},91:{},92:{f:P2},93:{f:A_},94:{},95:{f:or},96:{},97:{},99:{f:or},125:{f:Vu},128:{f:d_},129:{f:B2},130:{f:hr},131:{f:or},132:{f:or},133:{f:M2},134:{},140:{f:P_},141:{f:hr},144:{},146:{f:M_},151:{},152:{},153:{},154:{},155:{},156:{f:hr},157:{},158:{},160:{f:$_},161:{f:W_},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:c_},190:{f:l_},193:{f:jt},197:{},198:{},199:{},200:{},201:{},202:{f:or},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:hr},220:{},221:{f:or},222:{},224:{f:u_},225:{f:R2},226:{f:jt},227:{},229:{f:T_},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:U2},253:{f:Q2},255:{f:H2},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ru},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:or},353:{f:jt},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:g_},431:{f:or},432:{},433:{},434:{},437:{},438:{f:I_},439:{f:or},440:{f:N_},441:{},442:{f:Ka},443:{},444:{f:hr},445:{},446:{},448:{f:jt},449:{f:$2,r:2},450:{f:jt},512:{f:Nc},513:{f:V_},515:{f:p_},516:{f:r_},517:{f:Oc},519:{f:z_},520:{f:G2},523:{},545:{f:Bc},549:{f:Ic},566:{},574:{f:K2},638:{f:o_},659:{},1048:{},1054:{f:n_},1084:{},1212:{f:y_},2048:{f:O_},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:us},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:jt},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:j_,r:12},2173:{f:Py,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:or,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:w_,r:12},2197:{},2198:{f:Fy,r:12},2199:{},2200:{},2201:{},2202:{f:E_,r:12},2203:{f:jt},2204:{},2205:{},2206:{},2207:{},2211:{f:V2},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:hr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:H_},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:B_},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Nc},1:{},2:{f:J_},3:{f:Y_},4:{f:K_},5:{f:Oc},7:{f:Q_},8:{},9:{f:us},11:{},22:{f:hr},30:{f:s_},31:{},32:{},33:{f:Bc},36:{},37:{f:Ic},50:{f:ew},62:{},52:{},67:{},68:{f:hr},69:{},86:{},126:{},127:{f:X_},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rw},223:{},234:{},354:{},421:{},518:{f:Ai},521:{f:us},536:{f:Lc},547:{f:Pc},561:{},579:{},1030:{f:Ai},1033:{f:us},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function oe(e,r,t,n){var a=r;if(!isNaN(a)){var s=n||(t||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&N0(t)&&e.push(t)}}function QS(e,r,t,n){var a=(t||[]).length||0;if(a<=8224)return oe(e,r,t,a);var s=r;if(!isNaN(s)){for(var i=t.parts||[],o=0,c=0,l=0;l+(i[o]||8224)<=8224;)l+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,l),e.push(t.slice(c,c+l)),c+=l;c<a;){for(f=e.next(4),f.write_shift(2,60),l=0;l+(i[o]||8224)<=8224;)l+=i[o]||8224,o++;f.write_shift(2,l),e.push(t.slice(c,c+l)),c+=l}}}function Za(e,r,t){return e||(e=Y(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function e4(e,r,t,n){var a=Y(9);return Za(a,e,r),Pu(t,n||"b",a),a}function r4(e,r,t){var n=Y(8+2*t.length);return Za(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function t4(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?gr(Ze(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?oe(e,2,Z_(t,n,a)):oe(e,3,q_(t,n,a));return;case"b":case"e":oe(e,5,e4(t,n,r.v,r.t));return;case"s":case"str":oe(e,4,r4(t,n,(r.v||"").slice(0,255)));return}oe(e,1,Za(null,t,n))}function n4(e,r,t,n){var a=Array.isArray(r),s=Me(r["!ref"]||"A1"),i,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Ie(s)}for(var l=s.s.r;l<=s.e.r;++l){o=cr(l);for(var f=s.s.c;f<=s.e.c;++f){l===s.s.r&&(c[f]=tr(f)),i=c[f]+o;var u=a?(r[l]||[])[f]:r[i];u&&t4(e,u,l,f)}}}function a4(e,r){for(var t=r||{},n=Xr(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==t.sheet&&(a=s);if(a==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return oe(n,t.biff==4?1033:t.biff==3?521:9,W0(e,16,t)),n4(n,e.Sheets[e.SheetNames[a]],a,t),oe(n,10),n.end()}function s4(e,r,t){oe(e,49,Z2({sz:12,name:"Arial"},t))}function i4(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&oe(e,1054,a_(a,r[a],t))})}function o4(e,r){var t=Y(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),oe(e,2151,t),t=Y(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Uu(Me(r["!ref"]||"A1"),t),t.write_shift(4,4),oe(e,2152,t)}function c4(e,r){for(var t=0;t<16;++t)oe(e,224,Dc({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){oe(e,224,Dc(n,0,r))})}function l4(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];oe(e,440,D_(n)),n[1].Tooltip&&oe(e,2048,R_(n))}delete r["!links"]}function f4(e,r){if(r){var t=0;r.forEach(function(n,a){++t<=256&&n&&oe(e,125,U_(si(a,n),a))})}}function u4(e,r,t,n,a){var s=16+Qt(a.cellXfs,r,a);if(r.v==null&&!r.bf){oe(e,513,pn(t,n,s));return}if(r.bf)oe(e,6,Bb(r,t,n,a,s));else switch(r.t){case"d":case"n":var i=r.t=="d"?gr(Ze(r.v)):r.v;oe(e,515,m_(t,n,i,s));break;case"b":case"e":oe(e,517,x_(t,n,r.v,s,a,r.t));break;case"s":case"str":if(a.bookSST){var o=Y0(a.Strings,r.v,a.revStrings);oe(e,253,e_(t,n,o,s))}else oe(e,516,t_(t,n,(r.v||"").slice(0,255),s,a));break;default:oe(e,513,pn(t,n,s))}}function d4(e,r,t){var n=Xr(),a=t.SheetNames[e],s=t.Sheets[a]||{},i=(t||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(s),l=r.biff==8,f,u="",d=[],h=Me(s["!ref"]||"A1"),p=l?65536:16384;if(h.e.c>255||h.e.r>=p){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}oe(n,2057,W0(t,16,r)),oe(n,13,lt(1)),oe(n,12,lt(100)),oe(n,15,Gr(!0)),oe(n,17,Gr(!1)),oe(n,16,hn(.001)),oe(n,95,Gr(!0)),oe(n,42,Gr(!1)),oe(n,43,Gr(!1)),oe(n,130,lt(1)),oe(n,128,h_()),oe(n,131,Gr(!1)),oe(n,132,Gr(!1)),l&&f4(n,s["!cols"]),oe(n,512,i_(h,r)),l&&(s["!links"]=[]);for(var x=h.s.r;x<=h.e.r;++x){u=cr(x);for(var m=h.s.c;m<=h.e.c;++m){x===h.s.r&&(d[m]=tr(m)),f=d[m]+u;var v=c?(s[x]||[])[m]:s[f];v&&(u4(n,v,x,m,r),l&&v.l&&s["!links"].push([f,v.l]))}}var E=o.CodeName||o.name||a;return l&&oe(n,574,Y2((i.Views||[])[0])),l&&(s["!merges"]||[]).length&&oe(n,229,S_(s["!merges"])),l&&l4(n,s),oe(n,442,Lu(E)),l&&o4(n,s),oe(n,10),n.end()}function h4(e,r,t){var n=Xr(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=t.biff==8,c=t.biff==5;if(oe(n,2057,W0(e,5,t)),t.bookType=="xla"&&oe(n,135),oe(n,225,o?lt(1200):null),oe(n,193,x2(2)),c&&oe(n,191),c&&oe(n,192),oe(n,226),oe(n,92,L2("SheetJS",t)),oe(n,66,lt(o?1200:1252)),o&&oe(n,353,lt(0)),o&&oe(n,448),oe(n,317,G_(e.SheetNames.length)),o&&e.vbaraw&&oe(n,211),o&&e.vbaraw){var l=i.CodeName||"ThisWorkbook";oe(n,442,Lu(l))}oe(n,156,lt(17)),oe(n,25,Gr(!1)),oe(n,18,Gr(!1)),oe(n,19,lt(0)),o&&oe(n,431,Gr(!1)),o&&oe(n,444,lt(0)),oe(n,61,X2()),oe(n,64,Gr(!1)),oe(n,141,lt(0)),oe(n,34,Gr($T(e)=="true")),oe(n,14,Gr(!0)),o&&oe(n,439,Gr(!1)),oe(n,218,lt(0)),s4(n,e,t),i4(n,e.SSF,t),c4(n,t),o&&oe(n,352,Gr(!1));var f=n.end(),u=Xr();o&&oe(u,140,L_()),o&&t.Strings&&QS(u,252,W2(t.Strings)),oe(u,10);var d=u.end(),h=Xr(),p=0,x=0;for(x=0;x<e.SheetNames.length;++x)p+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var m=f.length+p+d.length;for(x=0;x<e.SheetNames.length;++x){var v=s[x]||{};oe(h,133,j2({pos:m,hs:v.Hidden||0,dt:0,name:e.SheetNames[x]},t)),m+=r[x].length}var E=h.end();if(p!=E.length)throw new Error("BS8 "+p+" != "+E.length);var w=[];return f.length&&w.push(f),E.length&&w.push(E),d.length&&w.push(d),_r(w)}function x4(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=Qe(be)),e&&e.SSF&&(Vn(),Zs(e.SSF),t.revssf=ei(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,eo(t),t.cellXfs=[],Qt(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=d4(a,t,e);return n.unshift(h4(e,n,t)),_r(n)}function Fd(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var a=Kr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=r||{};switch(s.biff||2){case 8:case 5:return x4(e,r);case 4:case 3:case 2:return a4(e,r)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Xc(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,c=Zg(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,u=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<c.length;++i){var x=c[i].trim(),m=x.slice(0,3).toLowerCase();if(m=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}f=0;continue}if(!(m!="<td"&&m!="<th")){var v=x.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var E=v[o].trim();if(E.match(/<t[dh]/i)){for(var w=E,A=0;w.charAt(0)=="<"&&(A=w.indexOf(">"))>-1;)w=w.slice(A+1);for(var D=0;D<p.length;++D){var N=p[D];N.s.c==f&&N.s.r<l&&l<=N.e.r&&(f=N.e.c+1,D=-1)}var k=Se(E.slice(0,E.indexOf(">")));d=k.colspan?+k.colspan:1,((u=+k.rowspan)>1||d>1)&&p.push({s:{r:l,c:f},e:{r:l+(u||1)-1,c:f+d-1}});var L=k.t||k["data-t"]||"";if(!w.length){f+=d;continue}if(w=Qf(w),h.s.r>l&&(h.s.r=l),h.e.r<l&&(h.e.r=l),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!w.length){f+=d;continue}var O={t:"s",v:w};t.raw||!w.trim().length||L=="s"||(w==="TRUE"?O={t:"b",v:!0}:w==="FALSE"?O={t:"b",v:!1}:isNaN(wt(w))?isNaN(Bn(w).getDate())||(O={t:"d",v:Ze(w)},t.cellDates||(O={t:"n",v:gr(O.v)}),O.z=t.dateNF||be[14]):O={t:"n",v:wt(w)}),t.dense?(n[l]||(n[l]=[]),n[l][f]=O):n[Te({r:l,c:f})]=O,f+=d}}}}return n["!ref"]=Ie(h),p.length&&(n["!merges"]=p),n}function p4(e,r,t,n){for(var a=e["!merges"]||[],s=[],i=r.s.c;i<=r.e.c;++i){for(var o=0,c=0,l=0;l<a.length;++l)if(!(a[l].s.r>t||a[l].s.c>i)&&!(a[l].e.r<t||a[l].e.c<i)){if(a[l].s.r<t||a[l].s.c<i){o=-1;break}o=a[l].e.r-a[l].s.r+1,c=a[l].e.c-a[l].s.c+1;break}if(!(o<0)){var f=Te({r:t,c:i}),u=n.dense?(e[t]||[])[i]:e[f],d=u&&u.v!=null&&(u.h||C0(u.w||(Rt(u),u.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":u&&(h["data-t"]=u&&u.t||"z",u.v!=null&&(h["data-v"]=u.v),u.z!=null&&(h["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+f,s.push(ie("td",d,h))}}var p="<tr>";return p+s.join("")+"</tr>"}var m4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',g4="</body></html>";function v4(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Zt(Xc(t[0],r),r);var n=no();return t.forEach(function(a,s){ao(n,Xc(a,r),"Sheet"+(s+1))}),n}function _4(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Id(e,r){var t=r||{},n=t.header!=null?t.header:m4,a=t.footer!=null?t.footer:g4,s=[n],i=Kr(e["!ref"]);t.dense=Array.isArray(e),s.push(_4(e,i,t));for(var o=i.s.r;o<=i.e.r;++o)s.push(p4(e,i,o,t));return s.push("</table>"+a),s.join("")}function Nd(e,r,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?nr(n.origin):n.origin;a=i.r,s=i.c}var o=r.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=Kr(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),a==-1&&(l.e.r=a=f.e.r+1)}var u=[],d=0,h=e["!rows"]||(e["!rows"]=[]),p=0,x=0,m=0,v=0,E=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&x<c;++p){var A=o[p];if(Kc(A)){if(n.display)continue;h[x]={hidden:!0}}var D=A.children;for(m=v=0;m<D.length;++m){var N=D[m];if(!(n.display&&Kc(N))){var k=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):Qf(N.innerHTML),L=N.getAttribute("data-z")||N.getAttribute("z");for(d=0;d<u.length;++d){var O=u[d];O.s.c==v+s&&O.s.r<x+a&&x+a<=O.e.r&&(v=O.e.c+1-s,d=-1)}w=+N.getAttribute("colspan")||1,((E=+N.getAttribute("rowspan")||1)>1||w>1)&&u.push({s:{r:x+a,c:v+s},e:{r:x+a+(E||1)-1,c:v+s+(w||1)-1}});var W={t:"s",v:k},B=N.getAttribute("data-t")||N.getAttribute("t")||"";k!=null&&(k.length==0?W.t=B||"z":n.raw||k.trim().length==0||B=="s"||(k==="TRUE"?W={t:"b",v:!0}:k==="FALSE"?W={t:"b",v:!1}:isNaN(wt(k))?isNaN(Bn(k).getDate())||(W={t:"d",v:Ze(k)},n.cellDates||(W={t:"n",v:gr(W.v)}),W.z=n.dateNF||be[14]):W={t:"n",v:wt(k)})),W.z===void 0&&L!=null&&(W.z=L);var M="",Z=N.getElementsByTagName("A");if(Z&&Z.length)for(var le=0;le<Z.length&&!(Z[le].hasAttribute("href")&&(M=Z[le].getAttribute("href"),M.charAt(0)!="#"));++le);M&&M.charAt(0)!="#"&&(W.l={Target:M}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][v+s]=W):e[Te({c:v+s,r:x+a})]=W,l.e.c<v+s&&(l.e.c=v+s),v+=w}}++x}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),l.e.r=Math.max(l.e.r,x-1+a),e["!ref"]=Ie(l),x>=c&&(e["!fullref"]=Ie((l.e.r=o.length-p+x-1+a,l))),e}function Dd(e,r){var t=r||{},n=t.dense?[]:{};return Nd(n,e,r)}function w4(e,r){return Zt(Dd(e,r),r)}function Kc(e){var r="",t=y4(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function y4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function E4(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Be(r.replace(/<[^>]*>/g,""));return[t]}var Yc={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Od(e,r){var t=r||{},n=F0(e),a=[],s,i,o={name:""},c="",l=0,f,u,d={},h=[],p=t.dense?[]:{},x,m,v={value:""},E="",w=0,A=[],D=-1,N=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},L=0,O={},W=[],B={},M=0,Z=0,le=[],se=1,he=1,X=[],ve={Names:[]},U={},me=["",""],ye=[],I={},j="",R=0,P=!1,K=!1,re=0;for(Da.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Da.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?p["!ref"]=Ie(k):p["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=k.e.r&&(p["!fullref"]=p["!ref"],k.e.r=t.sheetRows-1,p["!ref"]=Ie(k)),W.length&&(p["!merges"]=W),le.length&&(p["!rows"]=le),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),h.push(f.name),d[f.name]=p,K=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=Se(x[0],!1),D=N=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,p=t.dense?[]:{},W=[],le=[],K=!0);break;case"table-row-group":x[1]==="/"?--L:++L;break;case"table-row":case"":if(x[1]==="/"){D+=se,se=1;break}if(u=Se(x[0],!1),u.?D=u.-1:D==-1&&(D=0),se=+u["number-rows-repeated"]||1,se<10)for(re=0;re<se;++re)L>0&&(le[D+re]={level:L});N=-1;break;case"covered-table-cell":x[1]!=="/"&&++N,t.sheetStubs&&(t.dense?(p[D]||(p[D]=[]),p[D][N]={t:"z"}):p[Te({r:D,c:N})]={t:"z"}),E="",A=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++N,v=Se(x[0],!1),he=parseInt(v["number-columns-repeated"]||"1",10),m={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(m.f=Vc(Be(v.formula))),(v.||v["value-type"])=="string"&&(m.t="s",m.v=Be(v["string-value"]||""),t.dense?(p[D]||(p[D]=[]),p[D][N]=m):p[Te({r:D,c:N})]=m),N+=he-1;else if(x[1]!=="/"){++N,E="",w=0,A=[],he=1;var te=se?D+se-1:D;if(N>k.e.c&&(k.e.c=N),N<k.s.c&&(k.s.c=N),D<k.s.r&&(k.s.r=D),te>k.e.r&&(k.e.r=te),v=Se(x[0],!1),ye=[],I={},m={t:v.||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=Be(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(M=parseInt(v["number-matrix-rows-spanned"],10)||0,Z=parseInt(v["number-matrix-columns-spanned"],10)||0,B={s:{r:D,c:N},e:{r:D+M-1,c:N+Z-1}},m.F=Ie(B),X.push([B,m.F])),v.formula)m.f=Vc(v.formula);else for(re=0;re<X.length;++re)D>=X[re][0].s.r&&D<=X[re][0].e.r&&N>=X[re][0].s.c&&N<=X[re][0].e.c&&(m.F=X[re][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(M=parseInt(v["number-rows-spanned"],10)||0,Z=parseInt(v["number-columns-spanned"],10)||0,B={s:{r:D,c:N},e:{r:D+M-1,c:N+Z-1}},W.push(B)),v["number-columns-repeated"]&&(he=parseInt(v["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=qe(v["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(v.value);break;case"percentage":m.t="n",m.v=parseFloat(v.value);break;case"currency":m.t="n",m.v=parseFloat(v.value);break;case"date":m.t="d",m.v=Ze(v["date-value"]),t.cellDates||(m.t="n",m.v=gr(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=Yg(v["time-value"])/86400,t.cellDates&&(m.t="d",m.v=ri(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(v.);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",v["string-value"]!=null&&(E=Be(v["string-value"]),A=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(P=!1,m.t==="s"&&(m.v=E||"",A.length&&(m.R=A),P=w==0),U.Target&&(m.l=U),ye.length>0&&(m.c=ye,ye=[]),E&&t.cellText!==!1&&(m.w=E),P&&(m.t="z",delete m.v),(!P||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=D))for(var J=0;J<se;++J){if(he=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(p[D+J]||(p[D+J]=[]),p[D+J][N]=J==0?m:Qe(m);--he>0;)p[D+J][N+he]=Qe(m);else for(p[Te({r:D+J,c:N})]=m;--he>0;)p[Te({r:D+J,c:N+he})]=Qe(m);k.e.c<=N&&(k.e.c=N)}he=parseInt(v["number-columns-repeated"]||"1",10),N+=he-1,he=0,m={},E="",A=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s;I.t=E,A.length&&(I.R=A),I.a=j,ye.push(I)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);j="",R=0,E="",w=0,A=[];break;case"creator":x[1]==="/"?j=n.slice(R,x.index):R=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);E="",w=0,A=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(O[o.name]=c,(s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(c="",o=Se(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Se(x[0],!1),c+=Yc[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Se(x[0],!1),c+=Yc[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,x.index);break}else l=x.index+x[0].length;break;case"named-range":i=Se(x[0],!1),me=Ci(i["cell-range-address"]);var ee={Name:i.name,Ref:me[0]+"!"+me[1]};K&&(ee.Sheet=h.length),ve.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!v||!v["string-value"])){var ke=E4(n.slice(w,x.index));E=(E.length>0?E+`
`:"")+ke[0]}else Se(x[0],!1),w=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{me=Ci(Se(x[0])["target-range-address"]),d[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(U=Se(x[0],!1),!U.href)break;U.Target=Be(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(me=Ci(U.Target.slice(1)),U.Target="#"+me[0]+"!"+me[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(x)}}var C={Sheets:d,SheetNames:h,Workbook:ve};return t.bookSheets&&delete C.Sheets,C}function qc(e,r){r=r||{},ct(e,"META-INF/manifest.xml")&&Yv(dr(e,"META-INF/manifest.xml"),r);var t=Zr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=Od(ze(t),r);return ct(e,"meta.xml")&&(n.Props=bu(dr(e,"meta.xml"))),n}function Jc(e,r){return Od(e,r)}var b4=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Na({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return lr+r}})(),Zc=(function(){var e=function(s){return $e(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,i,o){var c=[];c.push('      <table:table table:name="'+$e(i.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,f=0,u=Kr(s["!ref"]||"A1"),d=s["!merges"]||[],h=0,p=Array.isArray(s);if(s["!cols"])for(f=0;f<=u.e.c;++f)c.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",m=s["!rows"]||[];for(l=0;l<u.s.r;++l)x=m[l]?' table:style-name="ro'+m[l].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;l<=u.e.r;++l){for(x=m[l]?' table:style-name="ro'+m[l].ods+'"':"",c.push("        <table:table-row"+x+`>
`),f=0;f<u.s.c;++f)c.push(r);for(;f<=u.e.c;++f){var v=!1,E={},w="";for(h=0;h!=d.length;++h)if(!(d[h].s.c>f)&&!(d[h].s.r>l)&&!(d[h].e.c<f)&&!(d[h].e.r<l)){(d[h].s.c!=f||d[h].s.r!=l)&&(v=!0),E["table:number-columns-spanned"]=d[h].e.c-d[h].s.c+1,E["table:number-rows-spanned"]=d[h].e.r-d[h].s.r+1;break}if(v){c.push(t);continue}var A=Te({r:l,c:f}),D=p?(s[l]||[])[f]:s[A];if(D&&D.f&&(E["table:formula"]=$e(Gb(D.f)),D.F&&D.F.slice(0,A.length)==A)){var N=Kr(D.F);E["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,E["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!D){c.push(r);continue}switch(D.t){case"b":w=D.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=D.v?"true":"false";break;case"n":w=D.w||String(D.v||0),E["office:value-type"]="float",E["office:value"]=D.v||0;break;case"s":case"str":w=D.v==null?"":D.v,E["office:value-type"]="string";break;case"d":w=D.w||Ze(D.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Ze(D.v).toISOString(),E["table:style-name"]="ce1";break;default:c.push(r);continue}var k=e(w);if(D.l&&D.l.Target){var L=D.l.Target;L=L.charAt(0)=="#"?"#"+Vb(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),k=ie("text:a",k,{"xlink:href":L.replace(/&/g,"&amp;")})}c.push("          "+ie("table:table-cell",ie("text:p",k,{}),E)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(l){return i.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var f=0;f<l["!cols"].length;++f)if(l["!cols"][f]){var u=l["!cols"][f];if(u.width==null&&u.wpx==null&&u.wch==null)continue;Kt(u),u.ods=o;var d=l["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(l){return i.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var f=0;f<l["!rows"].length;++f)if(l["!rows"][f]){l["!rows"][f].ods=c;var u=l["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var c=[lr],l=Na({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Na({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+f+`>
`),c.push(Eu().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),a(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var u=0;u!=i.SheetNames.length;++u)c.push(n(i.Sheets[i.SheetNames[u]],i,u));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function Rd(e,r){if(r.bookType=="fods")return Zc(e,r);var t=T0(),n="",a=[],s=[];return n="mimetype",De(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",De(t,n,Zc(e,r)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",De(t,n,b4(e,r)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",De(t,n,lr+Eu()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",De(t,n,Zv(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",De(t,n,qv(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function mn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function qi(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ze(Jt(e))}function k4(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Jr(St(e))}function T4(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function qt(e){var r=e.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function Qc(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function S4(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function A4(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[r+s]=a&255;e[r+15]|=t>=0?0:128}function ja(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Ge(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function sr(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Ue(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=ja(e,t),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var c=t[0];e[t[0]++]>=128;);o=e.slice(c,t[0])}break;case 5:i=4,o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=ja(e,t),o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var l={data:o,type:s};r[a]==null?r[a]=[l]:r[a].push(l)}return r}function kr(e){var r=[];return e.forEach(function(t,n){t.forEach(function(a){a.data&&(r.push(Ge(n*8+a.type)),a.type==2&&r.push(Ge(a.data.length)),r.push(a.data))})}),qt(r)}function Z0(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function it(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=ja(e,n),s=Ue(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:sr(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=Ue(o.data),l=sr(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+l)}),n[0]+=l}),(r=s[3])!=null&&r[0]&&(i.merge=sr(s[3][0].data)>>>0>0),t.push(i)}return t}function Tn(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:Ge(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Ge(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:Ge(i.data.length)}],n[2].push({data:kr(i.meta),type:2})});var s=kr(n);r.push(Ge(s.length)),r.push(s),a.forEach(function(i){return r.push(i)})}),qt(r)}function C4(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=ja(r,t),a=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var i=r[t[0]++]>>2;if(i<60)++i;else{var o=i-59;i=r[t[0]],o>1&&(i|=r[t[0]+1]<<8),o>2&&(i|=r[t[0]+2]<<16),o>3&&(i|=r[t[0]+3]<<24),i>>>=0,i++,t[0]+=o}a.push(r.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var c=0,l=0;if(s==1?(l=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,s==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[qt(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(a.push(a[0].slice(-c)),l-=c;l>=a[a.length-1].length;)a.push(a[a.length-1]),l-=a[a.length-1].length;a.push(a[0].slice(-c,-c+l))}}var f=qt(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function ot(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(C4(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return qt(r)}function Sn(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),a=new Uint8Array(4);r.push(a);var s=Ge(n),i=s.length;r.push(s),n<=60?(i++,r.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,t+=n}return qt(r)}function F4(e,r,t,n){var a=mn(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Qc(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=Qc(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(i,!0),i+=4),s&32&&(l=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:l};break;case 3:u={t:"s",v:r[c]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:t[o]};else if(c>-1)u={t:"s",v:r[c]};else if(!isNaN(l))u={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function I4(e,r,t){var n=mn(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);a&1&&(c=S4(e,s),s+=16),a&2&&(l=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:r[o]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(i>-1)u={t:"s",v:t[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return u}function Ii(e,r){var t=new Uint8Array(32),n=mn(t),a=12,s=0;switch(t[0]=5,e.t){case"n":t[1]=2,A4(t,a,e.v),s|=1,a+=16;break;case"b":t[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(a,r.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),t.slice(0,a)}function Ni(e,r){var t=new Uint8Array(32),n=mn(t),a=12,s=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":t[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(a,r.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),t.slice(0,a)}function N4(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return F4(e,r,t,e[0]);case 5:return I4(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Or(e){var r=Ue(e);return ja(r[1][0].data)}function el(e,r){var t=Ue(r.data),n=sr(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(i){var o=Ue(i.data),c=sr(o[1][0].data)>>>0;switch(n){case 1:s[c]=qi(o[3][0].data);break;case 8:{var l=e[Or(o[9][0].data)][0],f=Ue(l.data),u=e[Or(f[1][0].data)][0],d=sr(u.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=Ue(u.data);s[c]=h[3].map(function(p){return qi(p.data)}).join("")}break}}),s}function D4(e,r){var t,n,a,s,i,o,c,l,f,u,d,h,p,x,m=Ue(e),v=sr(m[1][0].data)>>>0,E=sr(m[2][0].data)>>>0,w=((n=(t=m[8])==null?void 0:t[0])==null?void 0:n.data)&&sr(m[8][0].data)>0||!1,A,D;if((s=(a=m[7])==null?void 0:a[0])!=null&&s.data&&r!=0)A=(o=(i=m[7])==null?void 0:i[0])==null?void 0:o.data,D=(l=(c=m[6])==null?void 0:c[0])==null?void 0:l.data;else if((u=(f=m[4])==null?void 0:f[0])!=null&&u.data&&r!=1)A=(h=(d=m[4])==null?void 0:d[0])==null?void 0:h.data,D=(x=(p=m[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var N=w?4:1,k=mn(A),L=[],O=0;O<A.length/2;++O){var W=k.getUint16(O*2,!0);W<65535&&L.push([O,W])}if(L.length!=E)throw"Expected ".concat(E," cells, found ").concat(L.length);var B=[];for(O=0;O<L.length-1;++O)B[L[O][0]]=D.subarray(L[O][1]*N,L[O+1][1]*N);return L.length>=1&&(B[L[L.length-1][0]]=D.subarray(L[L.length-1][1]*N)),{R:v,cells:B}}function O4(e,r){var t,n=Ue(r.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?sr(n[7][0].data)>>>0>0?1:0:-1,s=Z0(n[5],function(i){return D4(i,a)});return{nrows:sr(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,l){if(i[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));i[o.R][l]=c}),i},[])}}function R4(e,r,t){var n,a=Ue(r.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(sr(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(sr(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Ie(s);var i=Ue(a[4][0].data),o=el(e,e[Or(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?el(e,e[Or(i[17][0].data)][0]):[],l=Ue(i[3][0].data),f=0;l[1].forEach(function(u){var d=Ue(u.data),h=e[Or(d[2][0].data)][0],p=sr(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=O4(e,h);x.data.forEach(function(m,v){m.forEach(function(E,w){var A=Te({r:f+v,c:w}),D=N4(E,o,c);D&&(t[A]=D)})}),f+=x.nrows})}function P4(e,r){var t=Ue(r.data),n={"!ref":"A1"},a=e[Or(t[2][0].data)],s=sr(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return R4(e,a[0],n),n}function L4(e,r){var t,n=Ue(r.data),a={name:(t=n[1])!=null&&t[0]?qi(n[1][0].data):"",sheets:[]},s=Z0(n[2],Or);return s.forEach(function(i){e[i].forEach(function(o){var c=sr(o.meta[1][0].data);c==6e3&&a.sheets.push(P4(e,o))})}),a}function B4(e,r){var t=no(),n=Ue(r.data),a=Z0(n[1],Or);if(a.forEach(function(s){e[s].forEach(function(i){var o=sr(i.meta[1][0].data);if(o==2){var c=L4(e,i);c.sheets.forEach(function(l,f){ao(t,l,f==0?c.name:c.name+"_"+f,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Di(e){var r,t,n,a,s={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=ot(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var f;try{f=it(l)}catch(u){return console.log("## "+(u.message||u))}f.forEach(function(u){s[u.id]=u.messages,i.push(u.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(t=(r=s==null?void 0:s[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&sr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(c){s[c].forEach(function(l){var f=sr(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return B4(s,o)}function M4(e,r,t){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&sr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=mn(e[7][0].data),f=0,u=[],d=mn(e[4][0].data),h=0,p=[],x=0;x<r.length;++x){if(r[x]==null){l.setUint16(x*2,65535,!0),d.setUint16(x*2,65535);continue}l.setUint16(x*2,f,!0),d.setUint16(x*2,h,!0);var m,v;switch(typeof r[x]){case"string":m=Ii({t:"s",v:r[x]},t),v=Ni({t:"s",v:r[x]},t);break;case"number":m=Ii({t:"n",v:r[x]},t),v=Ni({t:"n",v:r[x]},t);break;case"boolean":m=Ii({t:"b",v:r[x]},t),v=Ni({t:"b",v:r[x]},t);break;default:throw new Error("Unsupported value "+r[x])}u.push(m),f+=m.length,p.push(v),h+=v.length,++c}for(e[2][0].data=Ge(c);x<e[7][0].data.length/2;++x)l.setUint16(x*2,65535,!0),d.setUint16(x*2,65535,!0);return e[6][0].data=qt(u),e[3][0].data=qt(p),c}function j4(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Kr(t["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ie(n)));var s=Gs(t,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(j){return j.forEach(function(R){typeof R=="string"&&i.push(R)})});var o={},c=[],l=we.read(r.numbers,{type:"base64"});l.FileIndex.map(function(j,R){return[j,l.FullPaths[R]]}).forEach(function(j){var R=j[0],P=j[1];if(R.type==2&&R.name.match(/\.iwa/)){var K=R.content,re=ot(K),te=it(re);te.forEach(function(J){c.push(J.id),o[J.id]={deps:[],location:P,type:sr(J.messages[0].meta[1][0].data)}})}}),c.sort(function(j,R){return j-R});var f=c.filter(function(j){return j>1}).map(function(j){return[j,Ge(j)]});l.FileIndex.map(function(j,R){return[j,l.FullPaths[R]]}).forEach(function(j){var R=j[0];if(j[1],!!R.name.match(/\.iwa/)){var P=it(ot(R.content));P.forEach(function(K){K.messages.forEach(function(re){f.forEach(function(te){K.messages.some(function(J){return sr(J.meta[1][0].data)!=11006&&T4(J.data,te[1])})&&o[te[0]].deps.push(K.id)})})})}});for(var u=we.find(l,o[1].location),d=it(ot(u.content)),h,p=0;p<d.length;++p){var x=d[p];x.id==1&&(h=x)}var m=Or(Ue(h.messages[0].data)[1][0].data);for(u=we.find(l,o[m].location),d=it(ot(u.content)),p=0;p<d.length;++p)x=d[p],x.id==m&&(h=x);for(m=Or(Ue(h.messages[0].data)[2][0].data),u=we.find(l,o[m].location),d=it(ot(u.content)),p=0;p<d.length;++p)x=d[p],x.id==m&&(h=x);for(m=Or(Ue(h.messages[0].data)[2][0].data),u=we.find(l,o[m].location),d=it(ot(u.content)),p=0;p<d.length;++p)x=d[p],x.id==m&&(h=x);var v=Ue(h.messages[0].data);{v[6][0].data=Ge(n.e.r+1),v[7][0].data=Ge(n.e.c+1);var E=Or(v[46][0].data),w=we.find(l,o[E].location),A=it(ot(w.content));{for(var D=0;D<A.length&&A[D].id!=E;++D);if(A[D].id!=E)throw"Bad ColumnRowUIDMapArchive";var N=Ue(A[D].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var k=0;k<=n.e.c;++k){var L=[];L[1]=L[2]=[{type:0,data:Ge(k+420690)}],N[1].push({type:2,data:kr(L)}),N[2].push({type:0,data:Ge(k)}),N[3].push({type:0,data:Ge(k)})}N[4]=[],N[5]=[],N[6]=[];for(var O=0;O<=n.e.r;++O)L=[],L[1]=L[2]=[{type:0,data:Ge(O+726270)}],N[4].push({type:2,data:kr(L)}),N[5].push({type:0,data:Ge(O)}),N[6].push({type:0,data:Ge(O)});A[D].messages[0].data=kr(N)}w.content=Sn(Tn(A)),w.size=w.content.length,delete v[46];var W=Ue(v[4][0].data);{W[7][0].data=Ge(n.e.r+1);var B=Ue(W[1][0].data),M=Or(B[2][0].data);w=we.find(l,o[M].location),A=it(ot(w.content));{if(A[0].id!=M)throw"Bad HeaderStorageBucket";var Z=Ue(A[0].messages[0].data);for(O=0;O<s.length;++O){var le=Ue(Z[2][0].data);le[1][0].data=Ge(O),le[4][0].data=Ge(s[O].length),Z[2][O]={type:Z[2][0].type,data:kr(le)}}A[0].messages[0].data=kr(Z)}w.content=Sn(Tn(A)),w.size=w.content.length;var se=Or(W[2][0].data);w=we.find(l,o[se].location),A=it(ot(w.content));{if(A[0].id!=se)throw"Bad HeaderStorageBucket";for(Z=Ue(A[0].messages[0].data),k=0;k<=n.e.c;++k)le=Ue(Z[2][0].data),le[1][0].data=Ge(k),le[4][0].data=Ge(n.e.r+1),Z[2][k]={type:Z[2][0].type,data:kr(le)};A[0].messages[0].data=kr(Z)}w.content=Sn(Tn(A)),w.size=w.content.length;var he=Or(W[4][0].data);(function(){for(var j=we.find(l,o[he].location),R=it(ot(j.content)),P,K=0;K<R.length;++K){var re=R[K];re.id==he&&(P=re)}var te=Ue(P.messages[0].data);{te[3]=[];var J=[];i.forEach(function(C,je){J[1]=[{type:0,data:Ge(je)}],J[2]=[{type:0,data:Ge(1)}],J[3]=[{type:2,data:k4(C)}],te[3].push({type:2,data:kr(J)})})}P.messages[0].data=kr(te);var ee=Tn(R),ke=Sn(ee);j.content=ke,j.size=j.content.length})();var X=Ue(W[3][0].data);{var ve=X[1][0];delete X[2];var U=Ue(ve.data);{var me=Or(U[2][0].data);(function(){for(var j=we.find(l,o[me].location),R=it(ot(j.content)),P,K=0;K<R.length;++K){var re=R[K];re.id==me&&(P=re)}var te=Ue(P.messages[0].data);{delete te[6],delete X[7];var J=new Uint8Array(te[5][0].data);te[5]=[];for(var ee=0,ke=0;ke<=n.e.r;++ke){var C=Ue(J);ee+=M4(C,s[ke],i),C[1][0].data=Ge(ke),te[5].push({data:kr(C),type:2})}te[1]=[{type:0,data:Ge(n.e.c+1)}],te[2]=[{type:0,data:Ge(n.e.r+1)}],te[3]=[{type:0,data:Ge(ee)}],te[4]=[{type:0,data:Ge(n.e.r+1)}]}P.messages[0].data=kr(te);var je=Tn(R),Fe=Sn(je);j.content=Fe,j.size=j.content.length})()}ve.data=kr(U)}W[3][0].data=kr(X)}v[4][0].data=kr(W)}h.messages[0].data=kr(v);var ye=Tn(d),I=Sn(ye);return u.content=I,u.size=u.content.length,l}function Pd(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Q0(e){Pd([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function eo(e){Pd([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function U4(e){return Re.WS.indexOf(e)>-1?"sheet":e==Re.CS?"chart":e==Re.DS?"dialog":e==Re.MS?"macro":e&&e.length?e:"sheet"}function W4(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,U4(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function H4(e,r,t,n,a,s,i,o,c,l,f,u){try{s[n]=ha(Zr(e,t,!0),r);var d=dr(e,r),h;switch(o){case"sheet":h=fS(d,r,a,c,s[n],l,f,u);break;case"chart":if(h=uS(d,r,a,c,s[n],l,f,u),!h||!h["!drawel"])break;var p=sa(h["!drawel"].Target,r),x=Oa(p),m=Jy(Zr(e,p,!0),ha(Zr(e,x,!0),p)),v=sa(m,p),E=Oa(v);h=MT(Zr(e,v,!0),v,c,ha(Zr(e,E,!0),v),l,h);break;case"macro":h=dS(d,r,a,c,s[n],l,f,u);break;case"dialog":h=hS(d,r,a,c,s[n],l,f,u);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var w=[];s&&s[n]&&ir(s[n]).forEach(function(A){var D="";if(s[n][A].Type==Re.CMNT){D=sa(s[n][A].Target,r);var N=gS(dr(e,D,!0),D,c);if(!N||!N.length)return;jc(h,N,!1)}s[n][A].Type==Re.TCMNT&&(D=sa(s[n][A].Target,r),w=w.concat(Qy(dr(e,D,!0),c)))}),w&&w.length&&jc(h,w,!0,c.people||[])}catch(A){if(c.WTF)throw A}}function at(e){return e.charAt(0)=="/"?e.slice(1):e}function G4(e,r){if(Vn(),r=r||{},Q0(r),ct(e,"META-INF/manifest.xml")||ct(e,"objectdata.xml"))return qc(e,r);if(ct(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Di<"u"){if(e.FileIndex)return Di(e);var t=we.utils.cfb_new();return ic(e).forEach(function(le){De(t,le,ev(e,le))}),Di(t)}throw new Error("Unsupported NUMBERS file")}if(!ct(e,"[Content_Types].xml"))throw ct(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ct(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=ic(e),a=Xv(Zr(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",dr(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!dr(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!r.bookSheets&&!r.bookProps){if(xa=[],a.sst)try{xa=mS(dr(e,at(a.sst)),a.sst,r)}catch(le){if(r.WTF)throw le}r.cellStyles&&a.themes.length&&(c=pS(Zr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(l=xS(dr(e,at(a.style)),a.style,c,r))}a.links.map(function(le){try{var se=ha(Zr(e,Oa(at(le))),le);return _S(dr(e,at(le)),se,le,r)}catch{}});var f=lS(dr(e,at(a.workbooks[0])),a.workbooks[0],r),u={},d="";a.coreprops.length&&(d=dr(e,at(a.coreprops[0]),!0),d&&(u=bu(d)),a.extprops.length!==0&&(d=dr(e,at(a.extprops[0]),!0),d&&e2(d,u,r)));var h={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(d=Zr(e,at(a.custprops[0]),!0),d&&(h=t2(d,r)));var p={};if((r.bookSheets||r.bookProps)&&(f.Sheets?i=f.Sheets.map(function(se){return se.name}):u.Worksheets&&u.SheetNames.length>0&&(i=u.SheetNames),r.bookProps&&(p.Props=u,p.Custprops=h),r.bookSheets&&typeof i<"u"&&(p.SheetNames=i),r.bookSheets?p.SheetNames:r.bookProps))return p;i={};var x={};r.bookDeps&&a.calcchain&&(x=vS(dr(e,at(a.calcchain)),a.calcchain));var m=0,v={},E,w;{var A=f.Sheets;u.Worksheets=A.length,u.SheetNames=[];for(var D=0;D!=A.length;++D)u.SheetNames[D]=A[D].name}var N=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),L=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");ct(e,L)||(L="xl/_rels/workbook."+N+".rels");var O=ha(Zr(e,L,!0),L.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=wS(dr(e,at(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=rE(dr(e,at(a.people[0])),r)),O&&(O=W4(O,f.Sheets));var W=dr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=u.Worksheets;++m){var B="sheet";if(O&&O[m]?(E="xl/"+O[m][1].replace(/[\/]?xl\//,""),ct(e,E)||(E=O[m][1]),ct(e,E)||(E=L.replace(/_rels\/.*$/,"")+O[m][1]),B=O[m][2]):(E="xl/worksheets/sheet"+(m+1-W)+"."+N,E=E.replace(/sheet0\./,"sheet.")),w=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(u.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var M=!1,Z=0;Z!=r.sheets.length;++Z)typeof r.sheets[Z]=="number"&&r.sheets[Z]==m&&(M=1),typeof r.sheets[Z]=="string"&&r.sheets[Z].toLowerCase()==u.SheetNames[m].toLowerCase()&&(M=1);if(!M)continue e}}H4(e,E,w,u.SheetNames[m],m,v,i,B,r,f,c,l)}return p={Directory:a,Workbook:f,Props:u,Custprops:h,Deps:x,Sheets:i,SheetNames:u.SheetNames,Strings:xa,Styles:l,Themes:c,SSF:Qe(be)},r&&r.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(le,se){le=le.replace(/^Root Entry[\/]/,""),p.keys.push(le),p.files[le]=e.FileIndex[se]}))),r&&r.bookVBA&&(a.vba.length>0?p.vbaraw=dr(e,at(a.vba[0]),!0):a.defaults&&a.defaults.bin===lE&&(p.vbaraw=dr(e,"xl/vbaProject.bin",!0))),p}function V4(e,r){var t=r||{},n="Workbook",a=we.find(e,n);try{if(n="/!DataSpaces/Version",a=we.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(ww(a.content),n="/!DataSpaces/DataSpaceMap",a=we.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Ew(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=we.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=bw(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=we.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Tw(a.content)}catch{}if(n="/EncryptionInfo",a=we.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Sw(a.content);if(n="/EncryptedPackage",a=we.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function $4(e,r){return r.bookType=="ods"?Rd(e,r):r.bookType=="numbers"?j4(e,r):r.bookType=="xlsb"?z4(e,r):X4(e,r)}function z4(e,r){Fn=1024,e&&!e.SSF&&(e.SSF=Qe(be)),e&&e.SSF&&(Vn(),Zs(e.SSF),r.revssf=ei(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,pa?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=cd.indexOf(r.bookType)>-1,a=j0();eo(r=r||{});var s=T0(),i="",o=0;if(r.cellXfs=[],Qt(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",De(s,i,ku(e.Props,r)),a.coreprops.push(i),Ve(r.rels,2,i,Re.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,De(s,i,Au(e.Props)),a.extprops.push(i),Ve(r.rels,3,i,Re.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(i="docProps/custom.xml",De(s,i,Cu(e.Custprops)),a.custprops.push(i),Ve(r.rels,4,i,Re.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},u=e.Sheets[e.SheetNames[o-1]],d=(u||{})["!type"]||"sheet";switch(d){case"chart":default:i="xl/worksheets/sheet"+o+"."+t,De(s,i,ES(o-1,i,r,e,f)),a.sheets.push(i),Ve(r.wbrels,-1,"worksheets/sheet"+o+"."+t,Re.WS[0])}if(u){var h=u["!comments"],p=!1,x="";h&&h.length>0&&(x="xl/comments"+o+"."+t,De(s,x,TS(h,x)),a.comments.push(x),Ve(f,-1,"../comments"+o+"."+t,Re.CMNT),p=!0),u["!legacy"]&&p&&De(s,"xl/drawings/vmlDrawing"+o+".vml",id(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&De(s,Oa(i),Nn(f))}return r.Strings!=null&&r.Strings.length>0&&(i="xl/sharedStrings."+t,De(s,i,kS(r.Strings,i,r)),a.strs.push(i),Ve(r.wbrels,-1,"sharedStrings."+t,Re.SST)),i="xl/workbook."+t,De(s,i,yS(e,i)),a.workbooks.push(i),Ve(r.rels,1,i,Re.WB),i="xl/theme/theme1.xml",De(s,i,$0(e.Themes,r)),a.themes.push(i),Ve(r.wbrels,-1,"theme/theme1.xml",Re.THEME),i="xl/styles."+t,De(s,i,bS(e,i,r)),a.styles.push(i),Ve(r.wbrels,-1,"styles."+t,Re.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",De(s,i,e.vbaraw),a.vba.push(i),Ve(r.wbrels,-1,"vbaProject.bin",Re.VBA)),i="xl/metadata."+t,De(s,i,SS(i)),a.metadata.push(i),Ve(r.wbrels,-1,"metadata."+t,Re.XLMETA),De(s,"[Content_Types].xml",yu(a,r)),De(s,"_rels/.rels",Nn(r.rels)),De(s,"xl/_rels/workbook."+t+".rels",Nn(r.wbrels)),delete r.revssf,delete r.ssf,s}function X4(e,r){Fn=1024,e&&!e.SSF&&(e.SSF=Qe(be)),e&&e.SSF&&(Vn(),Zs(e.SSF),r.revssf=ei(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,pa?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=cd.indexOf(r.bookType)>-1,a=j0();eo(r=r||{});var s=T0(),i="",o=0;if(r.cellXfs=[],Qt(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",De(s,i,ku(e.Props,r)),a.coreprops.push(i),Ve(r.rels,2,i,Re.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,De(s,i,Au(e.Props)),a.extprops.push(i),Ve(r.rels,3,i,Re.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(i="docProps/custom.xml",De(s,i,Cu(e.Custprops)),a.custprops.push(i),Ve(r.rels,4,i,Re.CUST_PROPS));var f=["SheetJ5"];for(r.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+t,De(s,i,_d(o-1,r,e,u)),a.sheets.push(i),Ve(r.wbrels,-1,"worksheets/sheet"+o+"."+t,Re.WS[0])}if(d){var p=d["!comments"],x=!1,m="";if(p&&p.length>0){var v=!1;p.forEach(function(E){E[1].forEach(function(w){w.T==!0&&(v=!0)})}),v&&(m="xl/threadedComments/threadedComment"+o+"."+t,De(s,m,eE(p,f,r)),a.threadedcomments.push(m),Ve(u,-1,"../threadedComments/threadedComment"+o+"."+t,Re.TCMNT)),m="xl/comments"+o+"."+t,De(s,m,od(p)),a.comments.push(m),Ve(u,-1,"../comments"+o+"."+t,Re.CMNT),x=!0}d["!legacy"]&&x&&De(s,"xl/drawings/vmlDrawing"+o+".vml",id(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&De(s,Oa(i),Nn(u))}return r.Strings!=null&&r.Strings.length>0&&(i="xl/sharedStrings."+t,De(s,i,Ku(r.Strings,r)),a.strs.push(i),Ve(r.wbrels,-1,"sharedStrings."+t,Re.SST)),i="xl/workbook."+t,De(s,i,kd(e)),a.workbooks.push(i),Ve(r.rels,1,i,Re.WB),i="xl/theme/theme1.xml",De(s,i,$0(e.Themes,r)),a.themes.push(i),Ve(r.wbrels,-1,"theme/theme1.xml",Re.THEME),i="xl/styles."+t,De(s,i,td(e,r)),a.styles.push(i),Ve(r.wbrels,-1,"styles."+t,Re.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",De(s,i,e.vbaraw),a.vba.push(i),Ve(r.wbrels,-1,"vbaProject.bin",Re.VBA)),i="xl/metadata."+t,De(s,i,sd()),a.metadata.push(i),Ve(r.wbrels,-1,"metadata."+t,Re.XLMETA),f.length>1&&(i="xl/persons/person.xml",De(s,i,tE(f)),a.people.push(i),Ve(r.wbrels,-1,"persons/person.xml",Re.PEOPLE)),De(s,"[Content_Types].xml",yu(a,r)),De(s,"_rels/.rels",Nn(r.rels)),De(s,"xl/_rels/workbook."+t+".rels",Nn(r.wbrels)),delete r.revssf,delete r.ssf,s}function ro(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=tt(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function K4(e,r){return we.find(e,"EncryptedPackage")?V4(e,r):Cd(e,r)}function Y4(e,r){var t,n=e,a=r||{};return a.type||(a.type=Oe&&Buffer.isBuffer(e)?"buffer":"base64"),t=qf(n,a),G4(t,a)}function Ld(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Ki(e.slice(t),r);default:break e}return Mn.to_workbook(e,r)}function q4(e,r){var t="",n=ro(e,r);switch(r.type){case"base64":t=tt(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=dn(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=ze(t)),r.type="binary",Ld(t,r)}function J4(e,r){var t=e;return r.type=="base64"&&(t=tt(t)),t=Aa.utils.decode(1200,t.slice(2),"str"),r.type="binary",Ld(t,r)}function Z4(e){return e.match(/[^\x00-\x7F]/)?St(e):e}function Oi(e,r,t,n){return n?(t.type="string",Mn.to_workbook(e,t)):Mn.to_workbook(r,t)}function Ji(e,r){w0();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ji(new Uint8Array(e),(t=Qe(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),On={},t.dateNF&&(On.dateNF=t.dateNF),t.type||(t.type=Oe&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Oe?"buffer":"binary",n=zg(e),typeof Uint8Array<"u"&&!Oe&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=Z4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return t=Qe(t),t.type="array",Ji(y0(n),t)}switch((a=ro(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return K4(we.read(n,t),t);break;case 9:if(a[1]<=8)return Cd(n,t);break;case 60:return Ki(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return nw(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return zu.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Y4(n,t):Oi(e,n,t,s);case 239:return a[3]===60?Ki(n,t):Oi(e,n,t,s);case 255:if(a[1]===254)return J4(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return cn.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return cn.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Xi.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Qu.to_workbook(n,t);break;case 10:case 13:case 32:return q4(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tw.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Xi.to_workbook(n,t):Oi(e,n,t,s)}function Bd(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return $a(r.file,we.write(e,{type:Oe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return we.write(e,r)}function Q4(e,r){var t=Qe(r||{}),n=$4(e,t);return eA(n,t)}function eA(e,r){var t={},n=Oe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var a=e.FullPaths?we.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(Js(a))}return r.password&&typeof encrypt_agile<"u"?Bd(encrypt_agile(a,r.password),r):r.type==="file"?$a(r.file,a):r.type=="string"?ze(a):a}function rA(e,r){var t=r||{},n=ZS(e,t);return Bd(n,t)}function Tt(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Ca(St(n));case"binary":return St(n);case"string":return e;case"file":return $a(r.file,n,"utf8");case"buffer":return Oe?Pt(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Tt(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function tA(e,r){switch(r.type){case"base64":return Ca(e);case"binary":return e;case"string":return e;case"file":return $a(r.file,e,"binary");case"buffer":return Oe?Pt(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function ps(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Ca(t):r.type=="string"?ze(t):t;case"file":return $a(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Md(e,r){w0(),KT(e);var t=Qe(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Md(e,t);return t.type="array",Js(n)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=e.SheetNames.indexOf(t.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Tt($S(e,t),t);case"slk":case"sylk":return Tt($u.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"htm":case"html":return Tt(Id(e.Sheets[e.SheetNames[a]],t),t);case"txt":return tA(jd(e.Sheets[e.SheetNames[a]],t),t);case"csv":return Tt(to(e.Sheets[e.SheetNames[a]],t),t,"\uFEFF");case"dif":return Tt(zu.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"dbf":return ps(Xi.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"prn":return Tt(Mn.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"rtf":return Tt(Qu.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"eth":return Tt(Xu.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"fods":return Tt(Rd(e,t),t);case"wk1":return ps(cn.sheet_to_wk1(e.Sheets[e.SheetNames[a]],t),t);case"wk3":return ps(cn.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),ps(Fd(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),rA(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Q4(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function nA(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function aA(e,r,t){var n={};return n.type="file",n.file=r,nA(n),Md(e,n)}function sA(e,r,t,n,a,s,i,o){var c=cr(t),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!i||e[t])for(var h=r.s.c;h<=r.e.c;++h){var p=i?e[t][h]:e[n[h]+c];if(p===void 0||p.t===void 0){if(l===void 0)continue;s[h]!=null&&(d[s[h]]=l);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[h]!=null){if(x==null)if(p.t=="e"&&x===null)d[s[h]]=null;else if(l!==void 0)d[s[h]]=l;else if(f&&x===null)d[s[h]]=null;else continue;else d[s[h]]=f&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?x:Rt(p,x,o);x!=null&&(u=!1)}}return{row:d,isempty:u}}function Gs(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof f){case"string":c=Me(f);break;case"number":c=Me(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(a=0);var u=cr(c.s.r),d=[],h=[],p=0,x=0,m=Array.isArray(e),v=c.s.r,E=0,w={};m&&!e[v]&&(e[v]=[]);var A=l.skipHidden&&e["!cols"]||[],D=l.skipHidden&&e["!rows"]||[];for(E=c.s.c;E<=c.e.c;++E)if(!(A[E]||{}).hidden)switch(d[E]=tr(E),t=m?e[v][E]:e[d[E]+u],n){case 1:s[E]=E-c.s.c;break;case 2:s[E]=d[E];break;case 3:s[E]=l.header[E-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=i=Rt(t,null,l),x=w[i]||0,!x)w[i]=1;else{do o=i+"_"+x++;while(w[o]);w[i]=x,w[o]=1}s[E]=o}for(v=c.s.r+a;v<=c.e.r;++v)if(!(D[v]||{}).hidden){var N=sA(e,c,v,d,n,s,m,l);(N.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(h[p++]=N.row)}return h.length=p,h}var rl=/"/g;function iA(e,r,t,n,a,s,i,o){for(var c=!0,l=[],f="",u=cr(t),d=r.s.c;d<=r.e.c;++d)if(n[d]){var h=o.dense?(e[t]||[])[d]:e[n[d]+u];if(h==null)f="";else if(h.v!=null){c=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:Rt(h,null,o));for(var p=0,x=0;p!==f.length;++p)if((x=f.charCodeAt(p))===a||x===s||x===34||o.forceQuotes){f='"'+f.replace(rl,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(c=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(rl,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(i)}function to(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=Me(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),f="",u=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(d[p]||{}).hidden||(u[p]=tr(p));for(var x=0,m=a.s.r;m<=a.e.r;++m)(h[m]||{}).hidden||(f=iA(e,a,m,u,i,c,s,n),f!=null&&(n.strip&&(f=f.replace(l,"")),(f||n.blankrows!==!1)&&t.push((x++?o:"")+f)));return delete n.dense,t.join("")}function jd(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=to(e,r);return t}function oA(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=Me(e["!ref"]),s="",i=[],o,c=[],l=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=tr(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=cr(f),o=a.s.c;o<=a.e.c;++o)if(r=i[o]+s,t=l?(e[f]||[])[o]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=r+"="+n}return c}function Ud(e,r,t){var n=t||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?nr(n.origin):n.origin;i=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:i+r.length-1+a}};if(s["!ref"]){var u=Me(s["!ref"]);f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),i==-1&&(i=u.e.r+1,f.e.r=i+r.length-1+a)}else i==-1&&(i=0,f.e.r=r.length-1+a);var d=n.header||[],h=0;r.forEach(function(x,m){ir(x).forEach(function(v){(h=d.indexOf(v))==-1&&(d[h=d.length]=v);var E=x[v],w="z",A="",D=Te({c:o+h,r:i+m+a});l=Ua(s,D),E&&typeof E=="object"&&!(E instanceof Date)?s[D]=E:(typeof E=="number"?w="n":typeof E=="boolean"?w="b":typeof E=="string"?w="s":E instanceof Date?(w="d",n.cellDates||(w="n",E=gr(E)),A=n.dateNF||be[14]):E===null&&n.nullError&&(w="e",E=0),l?(l.t=w,l.v=E,delete l.w,delete l.R,A&&(l.z=A)):s[D]=l={t:w,v:E},A&&(l.z=A))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var p=cr(i);if(a)for(h=0;h<d.length;++h)s[tr(h+o)+p]={t:"s",v:d[h]};return s["!ref"]=Ie(f),s}function cA(e,r){return Ud(null,e,r)}function Ua(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=nr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Ua(e,Te(r)):Ua(e,Te({r,c:t||0}))}function lA(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function no(){return{SheetNames:[],Sheets:{}}}function ao(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=i+a)!=-1;++a);}if(bd(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function fA(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=lA(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function uA(e,r){return e.z=r,e}function Wd(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function dA(e,r,t){return Wd(e,"#"+r,t)}function hA(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function xA(e,r,t,n){for(var a=typeof r!="string"?r:Me(r),s=typeof r=="string"?r:Ie(r),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var c=Ua(e,i,o);c.t="n",c.F=s,delete c.v,i==a.s.r&&o==a.s.c&&(c.f=t,n&&(c.D=!0))}return e}var ms={encode_col:tr,encode_row:cr,encode_cell:Te,encode_range:Ie,decode_col:O0,decode_row:D0,split_cell:kv,decode_cell:nr,decode_range:Kr,format_cell:Rt,sheet_add_aoa:xu,sheet_add_json:Ud,sheet_add_dom:Nd,aoa_to_sheet:$n,json_to_sheet:cA,table_to_sheet:Dd,table_to_book:w4,sheet_to_csv:to,sheet_to_txt:jd,sheet_to_json:Gs,sheet_to_html:Id,sheet_to_formulae:oA,sheet_to_row_object_array:Gs,sheet_get_cell:Ua,book_new:no,book_append_sheet:ao,book_set_sheet_visibility:fA,cell_set_number_format:uA,cell_set_hyperlink:Wd,cell_set_internal_link:dA,cell_add_comment:hA,sheet_set_array_formula:xA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},tl;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(tl||(tl={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nl;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(nl||(nl={}));var al;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(al||(al={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl=["user","model","function","system"];var il;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(il||(il={}));var ol;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(ol||(ol={}));var cl;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(cl||(cl={}));var ll;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(ll||(ll={}));var va;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"})(va||(va={}));var fl;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(fl||(fl={}));var ul;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(ul||(ul={}));var dl;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(dl||(dl={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br extends Error{constructor(r){super(`[GoogleGenerativeAI Error]: ${r}`)}}class An extends Br{constructor(r,t){super(r),this.response=t}}class Hd extends Br{constructor(r,t,n,a){super(r),this.status=t,this.statusText=n,this.errorDetails=a}}class $t extends Br{}class Gd extends Br{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="https://generativelanguage.googleapis.com",mA="v1beta",gA="0.24.1",vA="genai-js";var gn;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(gn||(gn={}));class _A{constructor(r,t,n,a,s){this.model=r,this.task=t,this.apiKey=n,this.stream=a,this.requestOptions=s}toString(){var r,t;const n=((r=this.requestOptions)===null||r===void 0?void 0:r.apiVersion)||mA;let s=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||pA}/${n}/${this.model}:${this.task}`;return this.stream&&(s+="?alt=sse"),s}}function wA(e){const r=[];return e!=null&&e.apiClient&&r.push(e.apiClient),r.push(`${vA}/${gA}`),r.join(" ")}async function yA(e){var r;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",wA(e.requestOptions)),t.append("x-goog-api-key",e.apiKey);let n=(r=e.requestOptions)===null||r===void 0?void 0:r.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(a){throw new $t(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${a.message}`)}for(const[a,s]of n.entries()){if(a==="x-goog-api-key")throw new $t(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new $t(`Header name ${a} can only be set using the apiClient field`);t.append(a,s)}}return t}async function EA(e,r,t,n,a,s){const i=new _A(e,r,t,n,s);return{url:i.toString(),fetchOptions:Object.assign(Object.assign({},SA(s)),{method:"POST",headers:await yA(i),body:a})}}async function Qa(e,r,t,n,a,s={},i=fetch){const{url:o,fetchOptions:c}=await EA(e,r,t,n,a,s);return bA(o,c,i)}async function bA(e,r,t=fetch){let n;try{n=await t(e,r)}catch(a){kA(a,e)}return n.ok||await TA(n,e),n}function kA(e,r){let t=e;throw t.name==="AbortError"?(t=new Gd(`Request aborted when fetching ${r.toString()}: ${e.message}`),t.stack=e.stack):e instanceof Hd||e instanceof $t||(t=new Br(`Error fetching from ${r.toString()}: ${e.message}`),t.stack=e.stack),t}async function TA(e,r){let t="",n;try{const a=await e.json();t=a.error.message,a.error.details&&(t+=` ${JSON.stringify(a.error.details)}`,n=a.error.details)}catch{}throw new Hd(`Error fetching from ${r.toString()}: [${e.status} ${e.statusText}] ${t}`,e.status,e.statusText,n)}function SA(e){const r={};if((e==null?void 0:e.signal)!==void 0||(e==null?void 0:e.timeout)>=0){const t=new AbortController;(e==null?void 0:e.timeout)>=0&&setTimeout(()=>t.abort(),e.timeout),e!=null&&e.signal&&e.signal.addEventListener("abort",()=>{t.abort()}),r.signal=t.signal}return r}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function so(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),_s(e.candidates[0]))throw new An(`${Ut(e)}`,e);return AA(e)}else if(e.promptFeedback)throw new An(`Text not available. ${Ut(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),_s(e.candidates[0]))throw new An(`${Ut(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),hl(e)[0]}else if(e.promptFeedback)throw new An(`Function call not available. ${Ut(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),_s(e.candidates[0]))throw new An(`${Ut(e)}`,e);return hl(e)}else if(e.promptFeedback)throw new An(`Function call not available. ${Ut(e)}`,e)},e}function AA(e){var r,t,n,a;const s=[];if(!((t=(r=e.candidates)===null||r===void 0?void 0:r[0].content)===null||t===void 0)&&t.parts)for(const i of(a=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||a===void 0?void 0:a.parts)i.text&&s.push(i.text),i.executableCode&&s.push("\n```"+i.executableCode.language+`
`+i.executableCode.code+"\n```\n"),i.codeExecutionResult&&s.push("\n```\n"+i.codeExecutionResult.output+"\n```\n");return s.length>0?s.join(""):""}function hl(e){var r,t,n,a;const s=[];if(!((t=(r=e.candidates)===null||r===void 0?void 0:r[0].content)===null||t===void 0)&&t.parts)for(const i of(a=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||a===void 0?void 0:a.parts)i.functionCall&&s.push(i.functionCall);if(s.length>0)return s}const CA=[va.RECITATION,va.SAFETY,va.LANGUAGE];function _s(e){return!!e.finishReason&&CA.includes(e.finishReason)}function Ut(e){var r,t,n;let a="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)a+="Response was blocked",!((r=e.promptFeedback)===null||r===void 0)&&r.blockReason&&(a+=` due to ${e.promptFeedback.blockReason}`),!((t=e.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(a+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((n=e.candidates)===null||n===void 0)&&n[0]){const s=e.candidates[0];_s(s)&&(a+=`Candidate was blocked due to ${s.finishReason}`,s.finishMessage&&(a+=`: ${s.finishMessage}`))}return a}function Wa(e){return this instanceof Wa?(this.v=e,this):new Wa(e)}function FA(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(e,r||[]),a,s=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(d){n[d]&&(a[d]=function(h){return new Promise(function(p,x){s.push([d,h,p,x])>1||o(d,h)})})}function o(d,h){try{c(n[d](h))}catch(p){u(s[0][3],p)}}function c(d){d.value instanceof Wa?Promise.resolve(d.value.v).then(l,f):u(s[0][2],d)}function l(d){o("next",d)}function f(d){o("throw",d)}function u(d,h){d(h),s.shift(),s.length&&o(s[0][0],s[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xl=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function IA(e){const r=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=OA(r),[n,a]=t.tee();return{stream:DA(n),response:NA(a)}}async function NA(e){const r=[],t=e.getReader();for(;;){const{done:n,value:a}=await t.read();if(n)return so(RA(r));r.push(a)}}function DA(e){return FA(this,arguments,function*(){const t=e.getReader();for(;;){const{value:n,done:a}=yield Wa(t.read());if(a)break;yield yield Wa(so(n))}})}function OA(e){const r=e.getReader();return new ReadableStream({start(n){let a="";return s();function s(){return r.read().then(({value:i,done:o})=>{if(o){if(a.trim()){n.error(new Br("Failed to parse stream"));return}n.close();return}a+=i;let c=a.match(xl),l;for(;c;){try{l=JSON.parse(c[1])}catch{n.error(new Br(`Error parsing JSON response: "${c[1]}"`));return}n.enqueue(l),a=a.substring(c[0].length),c=a.match(xl)}return s()}).catch(i=>{let o=i;throw o.stack=i.stack,o.name==="AbortError"?o=new Gd("Request aborted when reading from the stream"):o=new Br("Error reading from the stream"),o})}}})}function RA(e){const r=e[e.length-1],t={promptFeedback:r==null?void 0:r.promptFeedback};for(const n of e){if(n.candidates){let a=0;for(const s of n.candidates)if(t.candidates||(t.candidates=[]),t.candidates[a]||(t.candidates[a]={index:a}),t.candidates[a].citationMetadata=s.citationMetadata,t.candidates[a].groundingMetadata=s.groundingMetadata,t.candidates[a].finishReason=s.finishReason,t.candidates[a].finishMessage=s.finishMessage,t.candidates[a].safetyRatings=s.safetyRatings,s.content&&s.content.parts){t.candidates[a].content||(t.candidates[a].content={role:s.content.role||"user",parts:[]});const i={};for(const o of s.content.parts)o.text&&(i.text=o.text),o.functionCall&&(i.functionCall=o.functionCall),o.executableCode&&(i.executableCode=o.executableCode),o.codeExecutionResult&&(i.codeExecutionResult=o.codeExecutionResult),Object.keys(i).length===0&&(i.text=""),t.candidates[a].content.parts.push(i)}a++}n.usageMetadata&&(t.usageMetadata=n.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vd(e,r,t,n){const a=await Qa(r,gn.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(t),n);return IA(a)}async function $d(e,r,t,n){const s=await(await Qa(r,gn.GENERATE_CONTENT,e,!1,JSON.stringify(t),n)).json();return{response:so(s)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zd(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function Ha(e){let r=[];if(typeof e=="string")r=[{text:e}];else for(const t of e)typeof t=="string"?r.push({text:t}):r.push(t);return PA(r)}function PA(e){const r={role:"user",parts:[]},t={role:"function",parts:[]};let n=!1,a=!1;for(const s of e)"functionResponse"in s?(t.parts.push(s),a=!0):(r.parts.push(s),n=!0);if(n&&a)throw new Br("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!a)throw new Br("No content is provided for sending chat message.");return n?r:t}function LA(e,r){var t;let n={model:r==null?void 0:r.model,generationConfig:r==null?void 0:r.generationConfig,safetySettings:r==null?void 0:r.safetySettings,tools:r==null?void 0:r.tools,toolConfig:r==null?void 0:r.toolConfig,systemInstruction:r==null?void 0:r.systemInstruction,cachedContent:(t=r==null?void 0:r.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const a=e.generateContentRequest!=null;if(e.contents){if(a)throw new $t("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=e.contents}else if(a)n=Object.assign(Object.assign({},n),e.generateContentRequest);else{const s=Ha(e);n.contents=[s]}return{generateContentRequest:n}}function pl(e){let r;return e.contents?r=e:r={contents:[Ha(e)]},e.systemInstruction&&(r.systemInstruction=zd(e.systemInstruction)),r}function BA(e){return typeof e=="string"||Array.isArray(e)?{content:Ha(e)}:e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],MA={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function jA(e){let r=!1;for(const t of e){const{role:n,parts:a}=t;if(!r&&n!=="user")throw new Br(`First content should be with role 'user', got ${n}`);if(!sl.includes(n))throw new Br(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(sl)}`);if(!Array.isArray(a))throw new Br("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new Br("Each Content should have at least one part");const s={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const o of a)for(const c of ml)c in o&&(s[c]+=1);const i=MA[n];for(const o of ml)if(!i.includes(o)&&s[o]>0)throw new Br(`Content with role '${n}' can't contain '${o}' part`);r=!0}}function gl(e){var r;if(e.candidates===void 0||e.candidates.length===0)return!1;const t=(r=e.candidates[0])===null||r===void 0?void 0:r.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const n of t.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl="SILENT_ERROR";class UA{constructor(r,t,n,a={}){this.model=t,this.params=n,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=r,n!=null&&n.history&&(jA(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(r,t={}){var n,a,s,i,o,c;await this._sendPromise;const l=Ha(r),f={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(s=this.params)===null||s===void 0?void 0:s.tools,toolConfig:(i=this.params)===null||i===void 0?void 0:i.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,l]},u=Object.assign(Object.assign({},this._requestOptions),t);let d;return this._sendPromise=this._sendPromise.then(()=>$d(this._apiKey,this.model,f,u)).then(h=>{var p;if(gl(h.response)){this._history.push(l);const x=Object.assign({parts:[],role:"model"},(p=h.response.candidates)===null||p===void 0?void 0:p[0].content);this._history.push(x)}else{const x=Ut(h.response);x&&console.warn(`sendMessage() was unsuccessful. ${x}. Inspect response object for details.`)}d=h}).catch(h=>{throw this._sendPromise=Promise.resolve(),h}),await this._sendPromise,d}async sendMessageStream(r,t={}){var n,a,s,i,o,c;await this._sendPromise;const l=Ha(r),f={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(s=this.params)===null||s===void 0?void 0:s.tools,toolConfig:(i=this.params)===null||i===void 0?void 0:i.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,l]},u=Object.assign(Object.assign({},this._requestOptions),t),d=Vd(this._apiKey,this.model,f,u);return this._sendPromise=this._sendPromise.then(()=>d).catch(h=>{throw new Error(vl)}).then(h=>h.response).then(h=>{if(gl(h)){this._history.push(l);const p=Object.assign({},h.candidates[0].content);p.role||(p.role="model"),this._history.push(p)}else{const p=Ut(h);p&&console.warn(`sendMessageStream() was unsuccessful. ${p}. Inspect response object for details.`)}}).catch(h=>{h.message!==vl&&console.error(h)}),d}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WA(e,r,t,n){return(await Qa(r,gn.COUNT_TOKENS,e,!1,JSON.stringify(t),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HA(e,r,t,n){return(await Qa(r,gn.EMBED_CONTENT,e,!1,JSON.stringify(t),n)).json()}async function GA(e,r,t,n){const a=t.requests.map(i=>Object.assign(Object.assign({},i),{model:r}));return(await Qa(r,gn.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:a}),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(r,t,n={}){this.apiKey=r,this._requestOptions=n,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=zd(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(r,t={}){var n;const a=pl(r),s=Object.assign(Object.assign({},this._requestOptions),t);return $d(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},a),s)}async generateContentStream(r,t={}){var n;const a=pl(r),s=Object.assign(Object.assign({},this._requestOptions),t);return Vd(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},a),s)}startChat(r){var t;return new UA(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},r),this._requestOptions)}async countTokens(r,t={}){const n=LA(r,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),t);return WA(this.apiKey,this.model,n,a)}async embedContent(r,t={}){const n=BA(r),a=Object.assign(Object.assign({},this._requestOptions),t);return HA(this.apiKey,this.model,n,a)}async batchEmbedContents(r,t={}){const n=Object.assign(Object.assign({},this._requestOptions),t);return GA(this.apiKey,this.model,r,n)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(r){this.apiKey=r}getGenerativeModel(r,t){if(!r.model)throw new Br("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new _l(this.apiKey,r,t)}getGenerativeModelFromCachedContent(r,t,n){if(!r.name)throw new $t("Cached content must contain a `name` field.");if(!r.model)throw new $t("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const i of a)if(t!=null&&t[i]&&r[i]&&(t==null?void 0:t[i])!==r[i]){if(i==="model"){const o=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,c=r.model.startsWith("models/")?r.model.replace("models/",""):r.model;if(o===c)continue}throw new $t(`Different value for "${i}" specified in modelParams (${t[i]}) and cachedContent (${r[i]})`)}const s=Object.assign(Object.assign({},t),{model:r.model,tools:r.tools,toolConfig:r.toolConfig,systemInstruction:r.systemInstruction,cachedContent:r});return new _l(this.apiKey,s,n)}}function $A({isOpen:e,onClose:r,onSuccess:t,partners:n,inboundPaths:a}){var he;const{showToast:s}=bl(),[i,o]=fe.useState("excel"),[c,l]=fe.useState(!1),[f,u]=fe.useState([]),[d,h]=fe.useState([]);fe.useRef(null);const[p,x]=fe.useState(null),[m,v]=fe.useState(null),[E,w]=fe.useState(((he=n==null?void 0:n[0])==null?void 0:he.partnerId)||"");fe.useRef(null);const[A,D]=fe.useState(()=>{var U;const X=sessionStorage.getItem("lm_manual_draft"),ve={customerName:"",phone:"",partnerId:((U=n==null?void 0:n[0])==null?void 0:U.partnerId)||"",inboundPath:(a==null?void 0:a[0])||"",caseType:"",preInfo:""};if(X)try{return{...ve,...JSON.parse(X)}}catch{return ve}return ve}),[N,k]=fe.useState(void 0);if(Je.useEffect(()=>{(A.customerName||A.phone||A.preInfo)&&sessionStorage.setItem("lm_manual_draft",JSON.stringify(A))},[A]),Je.useEffect(()=>{e&&kl().then(u)},[e]),Je.useEffect(()=>{n&&n.length>0&&!E&&(w(n[0].partnerId),D(X=>({...X,partnerId:n[0].partnerId}))),n&&n.length>0&&!A.partnerId&&D(X=>({...X,partnerId:n[0].partnerId})),a&&a.length>0&&!A.inboundPath&&D(X=>({...X,inboundPath:a[0]}))},[n,a]),!e)return null;if(!n||!Array.isArray(n)||!a||!Array.isArray(a))return g.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 flex flex-col items-center gap-4",children:[g.jsx(rs,{className:"animate-spin text-blue-600",size:32}),g.jsx("p",{className:"text-gray-600 font-medium",children:"   ..."}),g.jsx("button",{onClick:r,className:"text-sm text-gray-400 hover:text-gray-600 underline",children:""})]})});const L=()=>{const X=ms.json_to_sheet([{caseType:"",inboundPath:"",phone:"010-1234-5678",customerName:"",preInfo1:" 2,000~4,000",preInfo2:"9 30",preInfo3:""},{caseType:"",inboundPath:"",phone:"010-9876-5432",customerName:"",preInfo1:"",preInfo2:" 1",preInfo3:""}]),ve=ms.book_new();ms.book_append_sheet(ve,X,"CaseTemplate"),aA(ve,"__.xlsx")},O=X=>{var me;const ve=(me=X.target.files)==null?void 0:me[0];if(!ve)return;const U=new FileReader;U.onload=ye=>{var I;try{const j=(I=ye.target)==null?void 0:I.result,R=Ji(j,{type:"array"}),P=R.SheetNames[0],K=R.Sheets[P],te=ms.sheet_to_json(K).map(J=>{const ee=String(J.phone||J.||""),ke=String(J.customerName||J.||""),C=String(J.caseType||J.||""),je=String(J.inboundPath||J.||""),Fe=[],Pe=J.preInfo||J.;Pe&&String(Pe).trim()&&Fe.push(String(Pe).trim());for(let xr=1;xr<=10;xr++){const Cr=J[`preInfo${xr}`]||J[`${xr}`];Cr&&String(Cr).trim()&&Fe.push(String(Cr).trim())}const Ne=Fe.join(`
`),ue=lo(ee),Ye=go(ue,f);return{customerName:ke,phone:ue,caseType:C,inboundPath:je,preInfo:Ne,isNew:!0,isViewed:!1,managerName:localStorage.getItem("managerName")||"",duplicateInfo:Ye}});h(te)}catch(j){console.error(j),X.target&&(X.target.value=""),s(`   : ${j.message}`,"error")}},U.readAsArrayBuffer(ve)},W=async()=>{if(d.length===0)return;const X=d.filter(U=>!U.duplicateInfo),ve=d.length-X.length;if(X.length===0){s("    .","error");return}l(!0);try{await ih(X);let U=`${X.length} .`;ve>0&&(U+=` ( ${ve} )`),s(U),t(),r()}catch{s("    .","error")}finally{l(!1)}},B=async X=>{var U;const ve=(U=X.target.files)==null?void 0:U[0];ve&&(x(ve),v(null))},M=async()=>{var X,ve,U;if(p){l(!0);try{const me=await Th(p),ye=p.type||"image/png",I="AIzaSyAcY0S1fvge0FtV_GsmEo5u15vdsau4sBU",R=new VA(I).getGenerativeModel({model:"gemini-flash-latest"}),P=n.find(C=>C.partnerId===E),K=(P==null?void 0:P.ocrPromptTemplate)||`
        Extract the following information from the provided document image/pdf.
        Return ONLY a raw JSON object (no markdown, no backticks).
        Fields:
        - customerName: (string) Name of the client
        - phone: (string) Phone number
        - summary: (string) specific details found in the doc (debt amount, job, etc)

        If a field is not found, use empty string.
      `;let re=0;const te=3;let J="";for(;re<te;)try{J=(await R.generateContent([{inlineData:{mimeType:ye,data:me}},K])).response.text();break}catch(C){if(re++,console.warn(`OCR Attempt ${re} failed:`,C),((X=C.message)!=null&&X.includes("429")||(ve=C.message)!=null&&ve.includes("503"))&&re<te){const je=Math.pow(2,re)*1e3+Math.random()*500;await new Promise(Fe=>setTimeout(Fe,je));continue}throw C}const ee=J.replace(/```json/g,"").replace(/```/g,"").trim(),ke=JSON.parse(ee);v({customerName:ke.customerName,phone:ke.phone,preInfo:ke.summary,isNew:!0,isViewed:!1,caseType:"",inboundPath:"OCR",partnerId:E,managerName:localStorage.getItem("managerName")||""})}catch(me){console.error(me),(U=me.message)!=null&&U.includes("API Key")?s("Google API Key  .","error"):s("  .   .","error")}finally{l(!1)}}},Z=async()=>{if(m){l(!0);try{await fo(m),s(" ."),t(),r()}catch{s(" ","error")}finally{l(!1)}}},le=(X,ve)=>{if(X==="phone"){ve=lo(ve);const U=go(ve,f);k(U)}D(U=>({...U,[X]:ve}))},se=async()=>{var X;if(!A.customerName||!A.phone){s("  .","error");return}l(!0);try{await fo({...A,isNew:!0,isViewed:!1}),s(" ."),sessionStorage.removeItem("lm_manual_draft"),D({customerName:"",phone:"",partnerId:((X=n==null?void 0:n[0])==null?void 0:X.partnerId)||"",inboundPath:(a==null?void 0:a[0])||"",caseType:"",preInfo:""}),t(),r()}catch{s(" ","error")}finally{l(!1)}};return g.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[g.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[g.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[g.jsx(Es,{size:20,className:"text-blue-600"})," / "]}),g.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:g.jsx(ws,{size:24})})]}),g.jsxs("div",{className:"flex border-b",children:[g.jsx("button",{onClick:()=>o("excel"),className:`flex-1 py-3 text-sm font-medium border-b-2 transition-colors ${i==="excel"?"border-blue-600 text-blue-600 bg-blue-50/50":"border-transparent text-gray-500 hover:bg-gray-50"}`,children:g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx(Ah,{size:16}),"   "]})}),g.jsx("button",{onClick:()=>o("ocr"),className:`flex-1 py-3 text-sm font-medium border-b-2 transition-colors ${i==="ocr"?"border-pink-600 text-pink-600 bg-pink-50/50":"border-transparent text-gray-500 hover:bg-gray-50"}`,children:g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx(_o,{size:16})," /PDF  (AI)"]})}),g.jsx("button",{onClick:()=>o("manual"),className:`flex-1 py-3 text-sm font-medium border-b-2 transition-colors ${i==="manual"?"border-green-600 text-green-600 bg-green-50/50":"border-transparent text-gray-500 hover:bg-gray-50"}`,children:g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx(zh,{size:16}),"   "]})})]}),g.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[i==="excel"&&g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-sm text-blue-800 border border-blue-100 dark:bg-blue-900/20 dark:text-blue-200 dark:border-blue-800",children:[g.jsxs("h4",{className:"font-bold mb-2 flex items-center gap-2",children:[g.jsx(kh,{size:16}),"  "]}),g.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-1 opacity-90",children:[g.jsx("li",{children:"  ."}),g.jsx("li",{children:"    . (  )"}),g.jsx("li",{children:"       ."}),g.jsx("li",{children:"[ ]    ."})]})]}),g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("button",{onClick:L,className:"flex-1 py-3 border border-gray-300 rounded-lg flex items-center justify-center gap-2 text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:[g.jsx(Bh,{size:18}),"  "]}),g.jsxs("div",{className:"flex-1 relative",children:[g.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:O,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),g.jsxs("button",{className:"w-full h-full py-3 bg-blue-600 text-white rounded-lg flex items-center justify-center gap-2 hover:bg-blue-700 font-bold shadow-md transition-colors",children:[g.jsx(Es,{size:18}),"   "]})]})]}),d.length>0&&g.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[g.jsxs("div",{className:"bg-gray-100 px-4 py-2 text-sm font-bold text-gray-600 border-b flex justify-between",children:[g.jsxs("span",{children:[" (",d.length,")"]}),g.jsx("button",{onClick:()=>h([]),className:"text-red-500 text-xs hover:underline",children:""})]}),g.jsx("div",{className:"max-h-48 overflow-y-auto",children:g.jsxs("table",{className:"w-full text-sm text-left",children:[g.jsx("thead",{className:"bg-gray-50 sticky top-0",children:g.jsxs("tr",{children:[g.jsx("th",{className:"p-2",children:""}),g.jsx("th",{className:"p-2",children:""}),g.jsx("th",{className:"p-2",children:""})]})}),g.jsx("tbody",{className:"divide-y",children:d.map((X,ve)=>g.jsxs("tr",{className:X.duplicateInfo?"bg-red-50":"",children:[g.jsxs("td",{className:"p-2",children:[X.customerName,X.duplicateInfo&&g.jsx("span",{className:"text-red-600 text-xs ml-1 font-bold",children:"()"})]}),g.jsx("td",{className:"p-2 text-gray-500",children:g.jsxs("div",{className:"flex flex-col",children:[g.jsx("span",{children:X.phone}),X.duplicateInfo&&g.jsxs("span",{className:"text-[10px] text-red-500",children:[": ",X.duplicateInfo.managerName," (",X.duplicateInfo.status,")"]})]})}),g.jsx("td",{className:"p-2 text-xs",children:X.caseType})]},ve))})]})})]}),d.length>0&&g.jsxs("button",{onClick:W,disabled:c,className:"w-full py-3 bg-green-600 text-white rounded-lg font-bold text-lg hover:bg-green-700 shadow-md flex items-center justify-center gap-2 disabled:opacity-50",children:[c?g.jsx(rs,{className:"animate-spin"}):g.jsx(_a,{size:20}),d.length,"  "]})]}),i==="ocr"&&g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-pink-50 p-4 rounded-lg text-sm text-pink-800 border border-pink-100",children:[g.jsxs("h4",{className:"font-bold mb-2 flex items-center gap-2",children:[g.jsx(ys,{size:16})," AI  "]}),g.jsx("p",{className:"opacity-90",children:"   PDF  , Gemini AI    ."})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  (OCR )"}),g.jsx("select",{className:"w-full p-2 border rounded-md text-sm",value:E,onChange:X=>w(X.target.value),children:n.map(X=>g.jsx("option",{value:X.partnerId,children:X.name},X.partnerId))})]}),g.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center transition-colors hover:border-pink-400 hover:bg-pink-50 group cursor-pointer relative",children:[g.jsx("input",{type:"file",accept:"image/*, application/pdf",onChange:B,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),g.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 group-hover:text-pink-600",children:[g.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center group-hover:bg-pink-100 transition-colors",children:g.jsx(_o,{size:24})}),g.jsx("p",{className:"font-medium text-lg",children:"   "}),g.jsx("p",{className:"text-xs text-gray-400",children:" : JPG, PNG, PDF"})]})]}),p&&g.jsxs("div",{className:"flex items-center justify-between bg-white border p-3 rounded-lg shadow-sm",children:[g.jsx("span",{className:"text-sm font-medium truncat max-w-[200px]",children:p.name}),g.jsxs("div",{className:"flex gap-2",children:[g.jsxs("button",{onClick:M,disabled:c,className:"px-4 py-1.5 bg-pink-600 text-white rounded text-sm font-bold hover:bg-pink-700 disabled:opacity-50 flex items-center gap-2",children:[c?g.jsx(rs,{size:14,className:"animate-spin"}):g.jsx(ys,{size:14})," "]}),g.jsx("button",{onClick:()=>{x(null),v(null)},className:"p-1.5 text-gray-400 hover:bg-gray-100 rounded",children:g.jsx(ws,{size:16})})]})]}),m&&g.jsxs("div",{className:"bg-white border rounded-lg p-4 space-y-3 shadow-sm animate-in slide-in-from-bottom-2",children:[g.jsx("h4",{className:"font-bold text-gray-800 border-b pb-2",children:"  "}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:""}),g.jsx("input",{className:"w-full p-2 border rounded text-sm font-bold text-gray-800 bg-gray-50",value:m.customerName,onChange:X=>v({...m,customerName:X.target.value})})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:""}),g.jsx("input",{className:"w-full p-2 border rounded text-sm font-bold text-gray-800 bg-gray-50",value:m.phone,onChange:X=>v({...m,phone:X.target.value})})]}),g.jsxs("div",{className:"col-span-2",children:[g.jsx("label",{className:"text-xs text-gray-500",children:"  ()"}),g.jsx("textarea",{className:"w-full p-2 border rounded text-sm bg-gray-50 h-20",value:m.preInfo,onChange:X=>v({...m,preInfo:X.target.value})})]})]}),g.jsxs("button",{onClick:Z,disabled:c,className:"w-full py-3 bg-pink-600 text-white rounded-lg font-bold hover:bg-pink-700 shadow-md flex items-center justify-center gap-2",children:[g.jsx(_a,{size:18}),"   "]})]})]}),i==="manual"&&g.jsxs("div",{className:"space-y-5",children:[g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),g.jsx("select",{className:"w-full p-2 border rounded-md text-sm",value:A.partnerId,onChange:X=>le("partnerId",X.target.value),children:n.map(X=>g.jsx("option",{value:X.partnerId,children:X.name},X.partnerId))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),g.jsx("select",{className:"w-full p-2 border rounded-md text-sm",value:A.inboundPath,onChange:X=>le("inboundPath",X.target.value),children:a.map(X=>g.jsx("option",{value:X,children:X},X))})]})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:[" ",g.jsx("span",{className:"text-red-500",children:"*"})]}),g.jsx("input",{className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-green-500 outline-none",placeholder:" ",value:A.customerName,onChange:X=>le("customerName",X.target.value)})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:[" ",g.jsx("span",{className:"text-red-500",children:"*"})]}),g.jsx("input",{className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-green-500 outline-none",placeholder:"010-0000-0000",value:A.phone,onChange:X=>le("phone",X.target.value)})]})]}),N&&g.jsx("div",{className:"mb-2 animate-pulse",children:g.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm flex flex-col gap-1",children:[g.jsxs("div",{className:"flex items-center gap-2 text-red-700 font-bold",children:[g.jsx("span",{className:"text-lg",children:""}),"   !"]}),g.jsxs("div",{className:"text-gray-600 pl-7 text-xs",children:[g.jsxs("p",{children:[" : ",g.jsx("b",{children:N.customerName})]}),g.jsxs("p",{children:[": ",g.jsx("b",{children:N.managerName})]}),g.jsxs("p",{children:[" : ",g.jsx("span",{className:"font-medium text-red-600",children:N.status})]})]})]})}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  ()"}),g.jsx("textarea",{className:"w-full p-2 border rounded-md text-sm h-24 focus:ring-2 focus:ring-green-500 outline-none",placeholder:"    ...",value:A.preInfo,onChange:X=>le("preInfo",X.target.value)})]}),g.jsxs("button",{onClick:se,disabled:c,className:"w-full py-3 bg-green-600 text-white rounded-lg font-bold text-lg hover:bg-green-700 shadow-md flex items-center justify-center gap-2 mt-4",children:[c?g.jsx(rs,{className:"animate-spin"}):g.jsx(Ch,{size:20})," "]})]})]})]})})}const zA=({totalItems:e,newCaseCount:r,showNewOnly:t,setShowNewOnly:n,overdueMissedCallCount:a,showOverdueMissedOnly:s,setShowOverdueMissedOnly:i,missedCallInterval:o,updateAvailable:c,newLeadsCount:l,onManualRefresh:f,onResetPage:u})=>g.jsxs("div",{className:"space-y-4",children:[r>0&&g.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center justify-between animate-fade-in",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"bg-red-100 p-2 rounded-full",children:g.jsx(ys,{className:"text-red-600",size:20})}),g.jsxs("div",{children:[g.jsxs("h3",{className:"font-bold text-red-800",children:["   ",r," !"]}),g.jsxs("p",{className:"text-sm text-red-600",children:["   ",g.jsx("br",{className:"block md:hidden"}),"  ."]})]})]}),g.jsxs("button",{onClick:()=>{n(!0),u()},className:"px-4 py-2 bg-red-600 text-white text-sm font-bold rounded-lg hover:bg-red-700 transition-colors shadow-sm whitespace-nowrap md:whitespace-normal",children:[g.jsx("span",{className:"hidden md:inline",children:""}),g.jsxs("span",{className:"md:hidden flex flex-col items-center leading-tight",children:[g.jsx("span",{children:""}),g.jsx("span",{children:""})]})]}),t&&g.jsx("button",{onClick:()=>{n(!1),u()},className:"absolute top-2 right-2 text-red-400 hover:text-red-600",children:g.jsx(ws,{size:16})})]}),a>0&&!s&&g.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 flex items-center justify-between animate-fade-in",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:g.jsx(ia,{className:"text-orange-600",size:20})}),g.jsxs("div",{children:[g.jsxs("h3",{className:"font-bold text-orange-800",children:["  ",a,""]}),g.jsxs("p",{className:"text-sm text-orange-600",children:["   ",o," ."]})]})]}),g.jsx("button",{onClick:()=>{i(!0),n(!1),u()},className:"px-4 py-2 bg-orange-600 text-white text-sm font-bold rounded-lg hover:bg-orange-700 transition-colors shadow-sm whitespace-nowrap",children:""})]}),c&&g.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 p-3 rounded-lg animate-fade-in shadow-sm cursor-pointer hover:bg-blue-100 transition-colors",onClick:f,children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"bg-blue-100 p-1.5 rounded-full",children:g.jsx(Fl,{className:"text-blue-600 animate-bounce",size:16})}),g.jsx("span",{className:"text-sm font-bold text-blue-800",children:l>0?`   ${l} ( )`:"  . ( )"})]}),g.jsx("button",{className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold rounded shadow-sm transition-colors",children:""})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[" ",t&&g.jsxs("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded-full border border-red-200 cursor-pointer hover:bg-red-200",onClick:()=>{n(!1),u()},children:[":    ",g.jsx("span",{className:"ml-1 font-bold",children:""})]}),s&&g.jsxs("span",{className:"text-xs bg-orange-100 text-orange-600 px-2 py-0.5 rounded-full border border-orange-200 cursor-pointer hover:bg-orange-200",onClick:()=>{i(!1),u()},children:[":   ",g.jsx("span",{className:"ml-1 font-bold",children:""})]})]}),g.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:[" ",e,""]})]})]}),XA=({search:e,setSearch:r,dateFilterStart:t,setDateFilterStart:n,dateFilterEnd:a,setDateFilterEnd:s,partnerFilter:i,setPartnerFilter:o,inboundPathFilter:c,setInboundPathFilter:l,statusFilters:f,setStatusFilters:u,sortOrder:d,setSortOrder:h,layoutMode:p,setLayoutMode:x,viewMode:m,setViewMode:v,partners:E,inboundPaths:w,statuses:A,onOpenImportModal:D,onOpenStatusVisibilityModal:N,onResetPage:k})=>{const[L,O]=Je.useState(!1),W=B=>M=>{B(M.target.value),k()};return g.jsxs("div",{className:"flex flex-col xl:flex-row justify-start items-start xl:items-center gap-2 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700",children:[g.jsxs("div",{className:"flex w-full xl:w-auto gap-2",children:[g.jsxs("div",{className:"relative flex-1",children:[g.jsx(Fh,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),g.jsx("input",{type:"text",placeholder:"   ",className:"pl-10 pr-4 py-2 border rounded-lg text-sm w-full xl:w-56 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400",value:e,onChange:W(r)})]}),g.jsx("button",{type:"button",onClick:B=>{B.preventDefault(),D()},className:"xl:hidden flex items-center justify-center p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm shrink-0",children:g.jsx(Es,{size:18})})]}),g.jsxs("div",{className:"flex flex-wrap gap-1 w-full xl:w-auto items-center",children:[g.jsxs("div",{className:"flex items-center bg-gray-50 border rounded-lg p-1 dark:bg-gray-700 dark:border-gray-600",children:[g.jsx("input",{type:"date",className:"bg-transparent text-sm p-1 outline-none text-gray-600 dark:text-white",value:t,onChange:W(n)}),g.jsx("span",{className:"text-gray-400 mx-1",children:"~"}),g.jsx("input",{type:"date",className:"bg-transparent text-sm p-1 outline-none text-gray-600 dark:text-white",value:a,onChange:W(s)})]}),g.jsxs("div",{className:"relative flex-1 min-w-[100px]",children:[g.jsx(Ih,{className:"absolute left-2.5 top-2.5 text-gray-400",size:16}),g.jsxs("select",{className:"w-full border p-2 pl-8 rounded-lg text-sm bg-white appearance-none",value:i,onChange:W(o),children:[g.jsx("option",{value:"",children:" "}),E.map(B=>g.jsx("option",{value:B.partnerId,children:B.name},B.partnerId))]})]}),g.jsxs("div",{className:"relative flex-1 min-w-[100px]",children:[g.jsx(Nh,{className:"absolute left-2.5 top-2.5 text-gray-400",size:16}),g.jsxs("select",{className:"w-full border p-2 pl-8 rounded-lg text-sm bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white appearance-none",value:c,onChange:W(l),children:[g.jsx("option",{value:"",children:" "}),w.map(B=>g.jsx("option",{value:B,children:B},B))]})]}),g.jsxs("div",{className:"flex flex-wrap w-full xl:w-auto gap-1",children:[g.jsxs("div",{className:"flex flex-1 xl:contents min-w-[200px] gap-1",children:[g.jsxs("div",{className:"relative flex-1 min-w-[100px]",children:[g.jsxs("button",{type:"button",onClick:()=>O(!L),className:"w-full border p-2 rounded-lg text-sm bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white text-left flex items-center justify-between",children:[g.jsx("span",{className:"truncate",children:f.length===0?" ":f.length===1?f[0]:`${f[0]}  ${f.length-1}`}),g.jsx(Ph,{size:16,className:`ml-1 transition-transform ${L?"rotate-180":""}`})]}),L&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>O(!1)}),g.jsxs("div",{className:"absolute top-full left-0 mt-1 w-full min-w-[160px] bg-white dark:bg-gray-700 border dark:border-gray-600 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:[g.jsxs("button",{type:"button",onClick:()=>{u([]),k()},className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center gap-2 ${f.length===0?"bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300":""}`,children:[f.length===0&&g.jsx(_a,{size:14}),g.jsx("span",{className:f.length===0?"font-medium":"",children:" "})]}),g.jsx("div",{className:"border-t dark:border-gray-600"}),A.map(B=>g.jsxs("button",{type:"button",onClick:()=>{u(M=>M.includes(B)?M.filter(Z=>Z!==B):[...M,B]),k()},className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center gap-2 ${f.includes(B)?"bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300":""}`,children:[g.jsx("div",{className:`w-4 h-4 border rounded flex items-center justify-center ${f.includes(B)?"bg-blue-500 border-blue-500 text-white":"border-gray-300"}`,children:f.includes(B)&&g.jsx(_a,{size:12})}),g.jsx("span",{children:B})]},B)),f.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"border-t dark:border-gray-600"}),g.jsx("button",{type:"button",onClick:()=>{u([]),k(),O(!1)},className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900",children:"  "})]})]})]})]}),g.jsx("button",{onClick:N,className:"p-2 bg-white dark:bg-gray-700 text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors shadow-sm",title:"  ",children:g.jsx(oh,{size:18})})]}),g.jsxs("div",{className:"flex flex-1 xl:contents min-w-[200px] gap-1 mt-1 xl:mt-0",children:[g.jsxs("div",{className:"relative flex-1 min-w-[120px]",children:[g.jsx(Fl,{className:"absolute left-2.5 top-2.5 text-gray-400",size:16}),g.jsxs("select",{className:"w-full border p-2 pl-8 rounded-lg text-sm bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white appearance-none text-ellipsis",value:d,onChange:B=>h(B.target.value),children:[g.jsx("option",{value:"createdAt_desc",children:" "}),g.jsx("option",{value:"createdAt_asc",children:" "}),g.jsx("option",{value:"updatedAt_desc",children:" "}),g.jsx("option",{value:"updatedAt_asc",children:" "}),g.jsx("option",{value:"lastConsultation_desc",children:" "}),g.jsx("option",{value:"lastConsultation_asc",children:" "}),g.jsx("option",{value:"inboundPath_asc",children:""})]})]}),g.jsx("button",{type:"button",onClick:B=>{B.preventDefault(),D()},className:"hidden xl:flex items-center justify-center p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm shrink-0",children:g.jsx(Es,{size:18})}),g.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 p-1 rounded-lg flex items-center gap-1",children:[g.jsx("button",{onClick:()=>x("list"),className:`p-1.5 rounded-md transition-all ${p==="list"?"bg-white dark:bg-gray-600 shadow-sm text-blue-600":"text-gray-400 hover:text-gray-600"}`,title:" ",children:g.jsx(Vh,{size:16})}),g.jsx("button",{onClick:()=>x("kanban"),className:`p-1.5 rounded-md transition-all ${p==="kanban"?"bg-white dark:bg-gray-600 shadow-sm text-blue-600":"text-gray-400 hover:text-gray-600"}`,title:"  ",children:g.jsx(Hh,{size:16})})]}),g.jsx("button",{onClick:()=>v(m==="active"?"trash":"active"),className:`flex items-center justify-center p-2 rounded-lg transition-colors shadow-sm shrink-0 ${m==="trash"?"bg-red-600 text-white hover:bg-red-700":"bg-white border text-gray-600 hover:bg-gray-50"}`,title:m==="active"?" ":" ",children:m==="trash"?g.jsx(Cl,{size:18}):g.jsx(oa,{size:18})})]})]})]}),m==="trash"&&g.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded-r-lg",children:g.jsxs("div",{className:"flex items-center",children:[g.jsx("div",{className:"flex-shrink-0",children:g.jsx(oa,{className:"h-5 w-5 text-red-500"})}),g.jsxs("div",{className:"ml-3",children:[g.jsx("p",{className:"text-sm text-red-700 font-bold",children:" ."}),g.jsx("p",{className:"text-xs text-red-600 mt-1",children:"  30    .     ."})]})]})})]})};function gs({trigger:e,content:r,delay:t=1e3,className:n="",mobileAlign:a="left",desktopAlign:s="center"}){const[i,o]=fe.useState(!1),c=fe.useRef(null),l=()=>{c.current=setTimeout(()=>{o(!0)},t)},f=()=>{c.current&&(clearTimeout(c.current),c.current=null),o(!1)};fe.useEffect(()=>()=>{c.current&&clearTimeout(c.current)},[]);const u=()=>{const p=a==="right"?"right-0":"left-0";let x="";return s==="center"?x="md:left-1/2 md:-translate-x-1/2 md:right-auto":s==="right"?x="md:right-0 md:left-auto md:translate-x-0":x="md:left-0 md:translate-x-0",`${p} ${x}`},d=()=>{const p=a==="right"?"right-4":"left-4";let x="";return s==="center"?x="md:left-1/2 md:-translate-x-1/2 md:right-auto":s==="right"?x="md:right-4 md:left-auto md:translate-x-0":x="md:left-4 md:translate-x-0",`${p} ${x}`},h=p=>{p.stopPropagation(),c.current&&(clearTimeout(c.current),c.current=null),o(x=>!x)};return fe.useEffect(()=>{const p=x=>{i&&o(!1)};return i&&document.addEventListener("click",p),()=>{document.removeEventListener("click",p)}},[i]),g.jsxs("div",{className:`relative inline-block ${n}`,onMouseEnter:l,onMouseLeave:f,onClick:h,children:[e,i&&g.jsx("div",{className:`absolute z-50 mt-2 w-64 max-w-[calc(100vw-2rem)] p-3 bg-gray-900/90 text-white text-xs rounded-lg shadow-xl backdrop-blur-sm animate-fade-in border border-gray-700 pointer-events-none ${u()}`,children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:`absolute -top-[18px] border-8 border-transparent border-b-gray-900/90 ${d()}`}),r]})})]})}const wl={:"text-red-400",:"text-red-400",:"text-orange-400",:"text-green-400",:"text-blue-400",:"text-yellow-400",:"text-cyan-400",:"text-indigo-400",:"text-emerald-400",:"text-emerald-400"},KA=({caseId:e})=>{const[r,t]=fe.useState(null),[n,a]=fe.useState([]);return fe.useEffect(()=>{ch(e).then(t),kl().then(s=>{const i=s.find(o=>o.caseId===e);if(i!=null&&i.specialMemo){const o=i.specialMemo.filter(c=>c.content.startsWith("[2  ]")).map(c=>{var f;const l=c.content.match(/\[2  \] (.+?)  (.+?)(\n|$)/);return{date:c.createdAt,from:(l==null?void 0:l[1])||"",to:(l==null?void 0:l[2])||"",memo:c.content.includes(":")?(f=c.content.split(":")[1])==null?void 0:f.trim():void 0}});a(o)}})},[e]),r?r.length===0&&n.length===0?g.jsx("span",{children:" ."}):g.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto custom-scrollbar",children:[r.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"font-bold text-blue-300 border-b border-gray-600 pb-1 sticky top-0 bg-gray-900/90",children:"1   "}),r.map((s,i)=>g.jsxs("div",{className:"text-[11px] border-b border-gray-700 last:border-0 pb-1 mb-1",children:[g.jsxs("div",{className:"flex justify-between text-gray-400 mb-0.5",children:[g.jsxs("span",{children:[s.fromStatus||"","  ",g.jsx("span",{className:"text-blue-300",children:s.toStatus})]}),g.jsx("span",{className:"text-[10px]",children:s.changedAt.split("T")[0]})]}),s.memo&&g.jsx("div",{className:"text-gray-300 pl-1 border-l-2 border-gray-600",children:s.memo})]},i))]}),n.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"font-bold text-purple-300 border-b border-gray-600 pb-1 mt-2",children:"2   "}),n.map((s,i)=>g.jsxs("div",{className:"text-[11px] border-b border-gray-700 last:border-0 pb-1 mb-1",children:[g.jsxs("div",{className:"flex justify-between text-gray-400 mb-0.5",children:[g.jsxs("span",{children:[g.jsx("span",{className:wl[s.from]||"text-gray-300",children:s.from}),"  ",g.jsx("span",{className:wl[s.to]||"text-purple-300",children:s.to})]}),g.jsx("span",{className:"text-[10px]",children:s.date.split("T")[0]})]}),s.memo&&g.jsx("div",{className:"text-gray-300 pl-1 border-l-2 border-purple-600",children:s.memo})]},i))]})]}):g.jsx("span",{children:"..."})},yl=e=>{if(!e||e.length===0)return null;const r=new Date,t=e.map(n=>({...n,dateObj:Sh(n.datetime)})).filter(n=>n.dateObj&&n.dateObj>=r).sort((n,a)=>n.dateObj.getTime()-a.dateObj.getTime());return t.length>0?t[0]:null},YA=e=>{var t;return!e.specialMemo||!Array.isArray(e.specialMemo)||e.specialMemo.length===0?e.updatedAt:((t=[...e.specialMemo].sort((n,a)=>String(a.createdAt||"").localeCompare(String(n.createdAt||"")))[0])==null?void 0:t.createdAt)||e.updatedAt},qA=({cases:e,partners:r,viewMode:t,missedCallStatus:n,missedCallInterval:a,onDelete:s,onRestore:i,onMissedCall:o})=>e.length===0?g.jsx("div",{className:"p-8 text-center text-gray-400 flex-1 flex items-center justify-center",children:"  ."}):g.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 min-h-[500px] flex flex-col",children:[g.jsx("div",{className:"md:hidden space-y-4 p-4",children:e.map((c,l)=>{const f=r.find(u=>u.partnerId===c.partnerId);return vo(c,f),g.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg flex flex-col gap-2 relative",children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${c.status===""||c.status===""?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:c.status}),c.isNew&&g.jsx("span",{className:"text-[10px] bg-red-500 text-white px-1.5 py-0.5 rounded-full animate-pulse",children:"NEW"})]}),g.jsx("span",{className:"text-xs text-gray-400",children:Jn(c.createdAt,"MM-dd")})]}),g.jsxs("div",{className:"flex justify-between items-center mt-1",children:[g.jsx(fi,{to:`/case/${c.caseId}`,className:"font-bold text-lg text-gray-800 dark:text-gray-200",children:c.customerName}),g.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:c.phone})]}),(()=>{var d,h,p;const u=yl(c.reminders);return u?g.jsx("div",{className:"mt-1",children:g.jsx(gs,{mobileAlign:"left",trigger:g.jsxs("div",{className:"flex items-center gap-1.5 p-1 px-2 bg-yellow-50 dark:bg-yellow-900/30 rounded border border-yellow-100 dark:border-yellow-900/50 w-fit",children:[(()=>{const x=u.type||"";return x===""?g.jsx(ia,{size:12,className:"text-blue-600"}):x===""?g.jsx(ho,{size:12,className:"text-green-600"}):x===""?g.jsx(xo,{size:12,className:"text-purple-600"}):g.jsx(po,{size:12,className:"text-gray-600"})})(),g.jsx("span",{className:"text-xs font-bold text-yellow-800 dark:text-yellow-300",children:u.datetime}),(((d=c.reminders)==null?void 0:d.length)||0)>1&&g.jsxs("span",{className:"text-[10px] text-gray-500 bg-white dark:bg-gray-800 px-1 rounded-full border border-gray-200 dark:border-gray-600",children:["+",(((h=c.reminders)==null?void 0:h.length)||0)-1]})]}),content:g.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[g.jsx("p",{className:"font-bold text-gray-200 border-b border-gray-600 pb-1 sticky top-0 bg-gray-900/90",children:" "}),(p=c.reminders)==null?void 0:p.map((x,m)=>g.jsxs("div",{className:"text-[11px] border-b border-gray-700 last:border-0 pb-1.5 mb-1.5",children:[g.jsx("p",{className:"text-gray-300 font-medium",children:x.datetime}),x.content&&g.jsx("p",{className:"text-gray-400 mt-0.5 pl-1 border-l-2 border-gray-600",children:x.content})]},m))]})})}):null})(),g.jsxs("div",{className:"flex justify-between items-end mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[g.jsxs("div",{className:"flex flex-col text-xs text-gray-500",children:[g.jsxs("span",{children:[c.caseType," | ",c.inboundPath]}),g.jsx("span",{children:f==null?void 0:f.name})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("a",{href:`tel:${c.phone}`,className:"p-2 bg-green-100 text-green-600 rounded-full",children:g.jsx(ia,{size:16})}),g.jsx(fi,{to:`/case/${c.caseId}`,className:"p-2 bg-blue-100 text-blue-600 rounded-full",children:g.jsx(wo,{size:16})}),g.jsx("button",{onClick:u=>s(c.caseId,u),className:"p-2 bg-red-100 text-red-600 rounded-full hover:bg-red-200 transition-colors",title:" ",children:g.jsx(oa,{size:16})})]})]})]},c.caseId)})}),g.jsx("div",{className:"hidden md:block flex-1",children:g.jsxs("table",{className:"w-full text-sm text-left text-gray-600 dark:text-gray-300 table-fixed",children:[g.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300 uppercase font-medium text-xs",children:g.jsxs("tr",{children:[g.jsx("th",{className:"px-4 py-3 w-[15%]",children:"//"}),g.jsx("th",{className:"px-4 py-3 w-[12%]",children:""}),g.jsx("th",{className:"px-4 py-3 w-[13%]",children:""}),g.jsx("th",{className:"px-4 py-3 w-[10%]",children:""}),g.jsx("th",{className:"px-4 py-3 w-[10%]",children:""}),g.jsx("th",{className:"px-4 py-3 w-[10%]",children:""}),g.jsx("th",{className:"px-4 py-3 w-[20%]",children:""}),g.jsx("th",{className:"px-4 py-3 w-[10%] text-center",children:""})]})}),g.jsx("tbody",{children:e.map((c,l)=>{var p,x,m;const f=r.find(v=>v.partnerId===c.partnerId),u=vo(c,f),d=YA(c),h=yl(c.reminders);return g.jsxs(Al.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:l*.05},className:"border-b border-gray-50 dark:border-gray-700 hover:bg-white/60 dark:hover:bg-gray-700/60 transition-colors",children:[g.jsx("td",{className:"px-4 py-3",children:g.jsxs("div",{className:"flex flex-col gap-1",children:[g.jsx("span",{className:"text-xs font-bold text-indigo-700 dark:text-indigo-400",children:c.caseType}),g.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400",children:c.inboundPath}),g.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500",children:f==null?void 0:f.name})]})}),g.jsxs("td",{className:"px-4 py-3",children:[g.jsxs(fi,{to:c.isNew?`/new?leadId=${c.caseId}`:`/case/${c.caseId}`,className:"font-medium text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",children:[g.jsx("span",{className:"truncate max-w-[90px] inline-block align-bottom",title:c.customerName,children:c.customerName}),c.isNew&&g.jsx("span",{className:"text-[10px] bg-red-500 text-white px-1.5 py-0.5 rounded-full animate-pulse flex-shrink-0",children:"NEW"})]}),g.jsx("div",{className:"ml-1 inline-block",children:g.jsx(gs,{trigger:g.jsx(wo,{size:14,className:"text-gray-300 hover:text-blue-500 transition-colors"}),content:g.jsxs("div",{className:"space-y-2",children:[g.jsx("p",{className:"font-bold text-gray-300 border-b border-gray-600 pb-1",children:"  "}),c.specialMemo&&Array.isArray(c.specialMemo)&&c.specialMemo.filter(v=>!v.content.startsWith("[]")).length>0?c.specialMemo.filter(v=>!v.content.startsWith("[]")).slice(0,3).map((v,E)=>g.jsxs("div",{className:"text-[11px] leading-relaxed",children:[g.jsxs("span",{className:"text-blue-300 mr-1",children:["[",v.createdAt.split("T")[0],"]"]}),v.content]},E)):g.jsx("span",{className:"text-gray-500 italic",children:" "})]})})}),u.length>0&&g.jsx("span",{className:"ml-2 text-red-500 text-xs",children:""})]}),g.jsx("td",{className:`px-4 py-3 font-medium ${c.status===""||c.status===""?"text-red-600 dark:text-red-400":""}`,children:c.phone}),g.jsxs("td",{className:"px-4 py-3",children:[g.jsx(gs,{trigger:c.status===" "&&c.secondaryStatus?g.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs whitespace-nowrap bg-gradient-to-r from-green-50 to-purple-50 border border-purple-200",children:[g.jsx("span",{className:"text-green-700 font-medium",children:""}),g.jsx("span",{className:"text-gray-400 mx-0.5",children:""}),g.jsx("span",{className:`font-medium ${c.secondaryStatus===""||c.secondaryStatus===""?"text-red-600":c.secondaryStatus===""?"text-orange-600":c.secondaryStatus===""?"text-green-600":c.secondaryStatus===""?"text-blue-600":c.secondaryStatus===""?"text-yellow-600":c.secondaryStatus===""?"text-cyan-600":c.secondaryStatus===""?"text-indigo-600":c.secondaryStatus===""||c.secondaryStatus===""?"text-emerald-600":"text-purple-700"}`,children:c.secondaryStatus})]}):g.jsx("span",{className:`px-2 py-1 rounded text-xs cursor-help whitespace-nowrap ${uo[c.status]?uo[c.status].replace("bg-blue-50","bg-blue-100"):"bg-gray-100 dark:bg-gray-700"} ${c.status===""||c.status===""?"text-red-700 bg-red-100":""} ${c.status===" "?"bg-green-100 text-green-700":""}`,children:c.status===" "?" ":c.status}),content:g.jsx(KA,{caseId:c.caseId})}),c.status===n&&g.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[g.jsxs("button",{onClick:v=>o(v,c),className:`flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold border transition-all ${c.lastMissedCallAt&&new Date().getTime()-new Date(c.lastMissedCallAt).getTime()>a*24*60*60*1e3?"bg-red-50 border-red-200 text-red-600 animate-pulse":"bg-white border-orange-200 text-orange-600 hover:bg-orange-50"}`,title:` : ${Jn(c.lastMissedCallAt,"yyyy-MM-dd HH:mm","")}`,children:[g.jsx(Yh,{size:10}),g.jsxs("span",{children:["+",c.missedCallCount||0]})]}),g.jsx("span",{className:"text-[10px] text-gray-500 tracking-tight",children:Jn(c.lastMissedCallAt,"MM.dd HH:mm")})]})]}),g.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:Jn(c.createdAt,"yyyy-MM-dd")}),g.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:Jn(d,"yyyy-MM-dd")}),g.jsx("td",{className:"px-4 py-3 text-xs",children:h?g.jsx(gs,{trigger:g.jsxs("div",{className:"flex items-center gap-1.5 cursor-help",children:[(()=>{const v=h.type||"";return v===""?g.jsx(ia,{size:14,className:"text-blue-600"}):v===""?g.jsx(ho,{size:14,className:"text-green-600"}):v===""?g.jsx(xo,{size:14,className:"text-purple-600"}):g.jsx(po,{size:14,className:"text-gray-600"})})(),g.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:h.datetime}),(((p=c.reminders)==null?void 0:p.length)||0)>1&&g.jsxs("span",{className:"text-[10px] text-gray-400 bg-gray-100 dark:bg-gray-700 px-1 rounded-sm",children:["+",(((x=c.reminders)==null?void 0:x.length)||0)-1]})]}),content:g.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[g.jsx("p",{className:"font-bold text-gray-200 border-b border-gray-600 pb-1 sticky top-0 bg-gray-900/90",children:" "}),(m=c.reminders)==null?void 0:m.map((v,E)=>g.jsxs("div",{className:"text-[11px] border-b border-gray-700 last:border-0 pb-1.5 mb-1.5",children:[g.jsx("p",{className:"text-gray-300 font-medium",children:v.datetime}),v.content&&g.jsx("p",{className:"text-gray-400 mt-0.5 pl-1 border-l-2 border-gray-600",children:v.content})]},E))]})}):"-"}),g.jsx("td",{className:"px-4 py-3 text-center",children:t==="trash"?g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx("button",{onClick:v=>i(c.caseId,v),className:"text-green-500 hover:text-green-700 p-1.5 rounded hover:bg-green-50",title:"",children:g.jsx(ys,{size:16})}),g.jsx("button",{onClick:v=>s(c.caseId,v),className:"text-red-500 hover:text-red-700 p-1.5 rounded hover:bg-red-50",title:" ",children:g.jsx(oa,{size:16})})]}):g.jsx("button",{onClick:v=>s(c.caseId,v),className:"text-gray-300 hover:text-red-500 p-2 rounded transition-colors hover:bg-red-50 dark:hover:bg-red-900/20",title:"",children:g.jsx(oa,{size:16})})})]},`${c.caseId}_${l}`)})})]})})]}),JA=({currentPage:e,totalPages:r,onPageChange:t})=>r<=0?null:g.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/30",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:()=>t(e-1),disabled:e===1,className:"p-2 rounded-lg bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700",children:g.jsx(Cl,{size:16})}),g.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Page ",e," of ",r]}),g.jsx("button",{onClick:()=>t(e+1),disabled:e===r,className:"p-2 rounded-lg bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700",children:g.jsx(Dh,{size:16})})]}),g.jsx("div",{className:"hidden sm:flex gap-1",children:Array.from({length:r},(n,a)=>a+1).map(n=>n===1||n===r||Math.abs(n-e)<=1?g.jsx("button",{onClick:()=>t(n),className:`w-8 h-8 flex items-center justify-center rounded-lg text-xs font-medium border ${e===n?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:n},n):n===2&&e>3||n===r-1&&e<r-2?g.jsx("span",{className:"w-8 h-8 flex items-center justify-center text-gray-400",children:"..."},n):null)})]});function hC(){El();const{showToast:e}=bl(),{data:r=[],isLoading:t,refetch:n}=lh(),{data:a=[]}=fh(),{data:s=[]}=uh(),{data:i=[]}=dh(),o=hh(),c=xh(),[l,f]=fe.useState(!1),[u,d]=fe.useState("active"),[h,p]=fe.useState("list"),[x,m]=fe.useState(!1),[v,E]=fe.useState(()=>{try{const pe=localStorage.getItem("lm_hiddenStatuses");return pe?JSON.parse(pe):[]}catch{return[]}});fe.useEffect(()=>{localStorage.setItem("lm_hiddenStatuses",JSON.stringify(v))},[v]);const w=pe=>{E(Ee=>Ee.includes(pe)?Ee.filter(Xe=>Xe!==pe):[...Ee,pe])},[A,D]=fe.useState(()=>localStorage.getItem("lm_missedStatus")||""),[N,k]=fe.useState(()=>Number(localStorage.getItem("lm_missedInterval"))||3),[L,O]=fe.useState(()=>sessionStorage.getItem("lm_search")||""),[W,B]=fe.useState(()=>{const pe=sessionStorage.getItem("lm_statusFilters");return pe?JSON.parse(pe):[]}),[M,Z]=fe.useState(()=>sessionStorage.getItem("lm_inboundPathFilter")||""),[le,se]=fe.useState(()=>sessionStorage.getItem("lm_partnerFilter")||""),[he,X]=fe.useState(()=>sessionStorage.getItem("lm_dateFilterStart")||""),[ve,U]=fe.useState(()=>sessionStorage.getItem("lm_dateFilterEnd")||""),[me,ye]=fe.useState(()=>sessionStorage.getItem("lm_sortOrder")||"createdAt_desc"),[I,j]=fe.useState(()=>sessionStorage.getItem("lm_showNewOnly")==="true"),[R,P]=fe.useState(()=>sessionStorage.getItem("lm_showOverdueMissed")==="true");fe.useEffect(()=>{sessionStorage.setItem("lm_search",L),sessionStorage.setItem("lm_statusFilters",JSON.stringify(W)),sessionStorage.setItem("lm_inboundPathFilter",M),sessionStorage.setItem("lm_partnerFilter",le),sessionStorage.setItem("lm_dateFilterStart",he),sessionStorage.setItem("lm_dateFilterEnd",ve),sessionStorage.setItem("lm_sortOrder",me),sessionStorage.setItem("lm_showNewOnly",String(I)),sessionStorage.setItem("lm_showOverdueMissed",String(R)),sessionStorage.setItem("lm_viewMode",u)},[L,W,M,le,he,ve,me,I,R,u]);const[K,re]=fe.useState(()=>{const pe=sessionStorage.getItem("lm_caselist_page");return pe?Number(pe):1});fe.useEffect(()=>{sessionStorage.setItem("lm_caselist_page",String(K))},[K]);const te=10,J=fe.useMemo(()=>r.filter(pe=>{const Ee=String(pe.customerName||"").includes(L)||String(pe.phone||"").includes(L),Xe=v.includes(pe.status),Fr=W.length===0?!Xe:W.includes(pe.status),br=M===""||pe.inboundPath===M,$r=le===""||pe.partnerId===le,fr=I?pe.isNew:!0,Ir=pe.status===""||!!pe.deletedAt;if(u==="active"&&Ir||u==="trash"&&!Ir)return!1;let Ae=!0;if(he||ve){const He=Zn(pe.createdAt);if(He){const pr=ph(He,"yyyy-MM-dd");he&&pr<he&&(Ae=!1),ve&&pr>ve&&(Ae=!1)}else(he||ve)&&(Ae=!1)}if(R){const He=new Date().getTime();if(!(pe.status===A&&pe.lastMissedCallAt&&He-new Date(pe.lastMissedCallAt).getTime()>N*24*60*60*1e3))return!1}return Ee&&Fr&&br&&$r&&Ae&&fr}),[r,L,v,W,M,le,I,u,he,ve,R,A,N]),ee=fe.useMemo(()=>[...J].sort((pe,Ee)=>{var Ir,Ae,He,pr;if(me==="inboundPath_asc")return String(pe.inboundPath||"").localeCompare(String(Ee.inboundPath||""));if(me==="createdAt_desc"){if(pe.isNew&&!Ee.isNew)return-1;if(!pe.isNew&&Ee.isNew)return 1}const[Xe,Fr]=me.split("_");let br,$r;const fr=Ke=>{var Xn;return!Ke.specialMemo||!Array.isArray(Ke.specialMemo)||Ke.specialMemo.length===0?Ke.updatedAt:((Xn=[...Ke.specialMemo].sort((ii,oi)=>String(oi.createdAt||"").localeCompare(String(ii.createdAt||"")))[0])==null?void 0:Xn.createdAt)||Ke.updatedAt};return Xe==="lastConsultation"?(br=new Date(fr(pe)).getTime(),$r=new Date(fr(Ee)).getTime()):Xe==="updatedAt"?(br=((Ir=Zn(pe.updatedAt))==null?void 0:Ir.getTime())||0,$r=((Ae=Zn(Ee.updatedAt))==null?void 0:Ae.getTime())||0):(br=((He=Zn(pe.createdAt))==null?void 0:He.getTime())||0,$r=((pr=Zn(Ee.createdAt))==null?void 0:pr.getTime())||0),br!==$r?Fr==="desc"?$r-br:br-$r:Fr==="desc"?String(Ee.caseId||"").localeCompare(String(pe.caseId||"")):String(pe.caseId||"").localeCompare(String(Ee.caseId||""))}),[J,me]),ke=ee.length,C=Math.ceil(ke/te),je=K*te,Fe=je-te,Pe=ee.slice(Fe,je);fe.useEffect(()=>{C>0&&K>C&&re(C)},[C,K]),fe.useLayoutEffect(()=>{const pe=sessionStorage.getItem("lm_caselist_scrollTop");if(pe&&!t){const Ee=document.getElementById("main-scroll-container");Ee&&(Ee.scrollTop=Number(pe))}},[t]),fe.useEffect(()=>{const pe=()=>{const Xe=document.getElementById("main-scroll-container");Xe&&sessionStorage.setItem("lm_caselist_scrollTop",Xe.scrollTop.toString())},Ee=document.getElementById("main-scroll-container");return Ee&&Ee.addEventListener("scroll",pe),()=>Ee==null?void 0:Ee.removeEventListener("scroll",pe)},[]);const Ne=async(pe,Ee)=>{o.mutate({id:pe,updates:Ee})},ue=async(pe,Ee)=>{if(Ee==null||Ee.stopPropagation(),u==="active"){if(!window.confirm(" ?"))return;o.mutate({id:pe,updates:{status:""}})}else{if(!window.confirm("  ?"))return;c.mutate(pe)}},Ye=async(pe,Ee)=>{if(Ee==null||Ee.stopPropagation(),!!window.confirm("?"))try{await mh(pe),n(),e(".")}catch{e(" ","error")}},xr=async(pe,Ee)=>{pe.preventDefault(),pe.stopPropagation();const Xe=new Date,Fr=(Ee.missedCallCount||0)+1;o.mutate({id:Ee.caseId,updates:{missedCallCount:Fr,lastMissedCallAt:Xe.toISOString()}})};if(t&&r.length===0)return g.jsx(gh,{});const Cr=r.filter(pe=>pe.isNew).length,pt=r.filter(pe=>pe.status!==A||!pe.lastMissedCallAt?!1:new Date().getTime()-new Date(pe.lastMissedCallAt).getTime()>N*24*60*60*1e3).length;return g.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[g.jsx(zA,{totalItems:ke,newCaseCount:Cr,showNewOnly:I,setShowNewOnly:j,overdueMissedCallCount:pt,showOverdueMissedOnly:R,setShowOverdueMissedOnly:P,missedCallInterval:N,updateAvailable:!1,newLeadsCount:0,onManualRefresh:()=>n(),onResetPage:()=>re(1)}),g.jsx(XA,{search:L,setSearch:O,dateFilterStart:he,setDateFilterStart:X,dateFilterEnd:ve,setDateFilterEnd:U,partnerFilter:le,setPartnerFilter:se,inboundPathFilter:M,setInboundPathFilter:Z,statusFilters:W,setStatusFilters:B,sortOrder:me,setSortOrder:ye,layoutMode:h,setLayoutMode:p,viewMode:u,setViewMode:d,partners:a,inboundPaths:s,statuses:i,onOpenImportModal:()=>f(!0),onOpenStatusVisibilityModal:()=>m(!0),onResetPage:()=>re(1)}),g.jsx(hg,{isOpen:x,onClose:()=>m(!1),allStatuses:i,hiddenStatuses:v,onToggleStatus:w}),g.jsx($A,{isOpen:l,onClose:()=>f(!1),onSuccess:()=>{n(),re(1)},partners:a,inboundPaths:s}),h==="kanban"?g.jsx(dg,{cases:Pe,statuses:i.filter(pe=>pe!==""),onUpdateStatus:(pe,Ee)=>Ne(pe,{status:Ee})}):g.jsxs(g.Fragment,{children:[g.jsx(qA,{cases:Pe,partners:a,viewMode:u,missedCallStatus:A,missedCallInterval:N,onDelete:ue,onRestore:Ye,onMissedCall:xr}),g.jsx(JA,{currentPage:K,totalPages:C,onPageChange:pe=>{var Ee;re(pe),(Ee=document.getElementById("main-scroll-container"))==null||Ee.scrollTo({top:0,behavior:"instant"})}})]})]})}export{hC as default};
