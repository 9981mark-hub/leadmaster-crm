const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.B6L--SUM.js","assets/index.ZPMVgb5w.css"])))=>i.map(i=>d[i]);
import{c as Lt,n as cs,a6 as ds,a as is,a7 as pt,a8 as At,a9 as Tt,r as T,j as e,f as De,s as xs,aa as ms,X as ps,g as hs,ab as ke,ac as ht,ad as He,ae as gs,af as us,ag as bs,b as gt,d as ys,ah as fs,ai as ze,aj as Ye,a1 as Le,a0 as ut,R as Ae,ak as js,al as Ns,am as vs,an as se,ao as bt,ap as ws,aq as Ss,ar as Is,as as Cs,at as Ds,au as ks}from"./index.B6L--SUM.js";import{q as yt,a as Ls,i as ft,m as jt,r as Nt}from"./utils.tBOVTsX4.js";import{M as vt}from"./Modal.p5dCg0Wb.js";import{C as Et}from"./chevron-left.CZVehWzW.js";import{C as Ft}from"./chevron-right.DrLcqalU.js";import{a as As,b as Ts,s as Es,e as Fs,R as be,B as Ve,C as Ke,X as Ge,Y as Ze,T as ye,L as wt,c as de,P as St,d as It,f as Ct}from"./PieChart.fqq-9wV0.js";import{e as $s,i as Ps}from"./isSameMonth.B82_sZwh.js";import{u as Fe,w as Ms,r as Rs}from"./xlsx.BBWTpfDg.js";import{B as Os}from"./building.DDKrHNwu.js";import{C as Bs}from"./calendar.BCViwnU4.js";import{F as Us,S as _s}from"./search.CIaElK0M.js";import{C as Ws}from"./check.BDMinnm4.js";import{C as Hs}from"./copy.BrTWSaia.js";import{P as Xe,T as Dt}from"./trash-2.B1IbCjZo.js";import{L as zs}from"./Line.Ii5nUNaG.js";import{D as Ys}from"./download.B33Or_9_.js";import"./index.Dt0Ym7pX.js";import"./tiny-invariant.CpNLCZ6g.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Ks=Lt("credit-card",Vs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Zs=Lt("refresh-cw",Gs);function Je(u,h,N){const[b,C]=cs(N==null?void 0:N.in,u,h),v=kt(b,C),M=Math.abs(ds(b,C));b.setDate(b.getDate()-v*M);const f=+(kt(b,C)===-v),U=v*(M-f);return U===0?0:U}function kt(u,h){const N=u.getFullYear()-h.getFullYear()||u.getMonth()-h.getMonth()||u.getDate()-h.getDate()||u.getHours()-h.getHours()||u.getMinutes()-h.getMinutes()||u.getSeconds()-h.getSeconds()||u.getMilliseconds()-h.getMilliseconds();return N<0?-1:N>0?1:N}function Te(u,h){const N=()=>is(h==null?void 0:h.in,NaN),C=Qs(u);let v;if(C.date){const S=ea(C.date,2);v=ta(S.restDateString,S.year)}if(!v||isNaN(+v))return N();const M=+v;let f=0,U;if(C.time&&(f=sa(C.time),isNaN(f)))return N();if(C.timezone){if(U=aa(C.timezone),isNaN(U))return N()}else{const S=new Date(M+f),ae=pt(0,h==null?void 0:h.in);return ae.setFullYear(S.getUTCFullYear(),S.getUTCMonth(),S.getUTCDate()),ae.setHours(S.getUTCHours(),S.getUTCMinutes(),S.getUTCSeconds(),S.getUTCMilliseconds()),ae}return pt(M+f+U,h==null?void 0:h.in)}const Ee={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Xs=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Js=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,qs=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Qs(u){const h={},N=u.split(Ee.dateTimeDelimiter);let b;if(N.length>2)return h;if(/:/.test(N[0])?b=N[0]:(h.date=N[0],b=N[1],Ee.timeZoneDelimiter.test(h.date)&&(h.date=u.split(Ee.timeZoneDelimiter)[0],b=u.substr(h.date.length,u.length))),b){const C=Ee.timezone.exec(b);C?(h.time=b.replace(C[1],""),h.timezone=C[1]):h.time=b}return h}function ea(u,h){const N=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+h)+"})|(\\d{2}|[+-]\\d{"+(2+h)+"})$)"),b=u.match(N);if(!b)return{year:NaN,restDateString:""};const C=b[1]?parseInt(b[1]):null,v=b[2]?parseInt(b[2]):null;return{year:v===null?C:v*100,restDateString:u.slice((b[1]||b[2]).length)}}function ta(u,h){if(h===null)return new Date(NaN);const N=u.match(Xs);if(!N)return new Date(NaN);const b=!!N[4],C=fe(N[1]),v=fe(N[2])-1,M=fe(N[3]),f=fe(N[4]),U=fe(N[5])-1;if(b)return ca(h,f,U)?ra(h,f,U):new Date(NaN);{const S=new Date(0);return!la(h,v,M)||!oa(h,C)?new Date(NaN):(S.setUTCFullYear(h,v,Math.max(C,M)),S)}}function fe(u){return u?parseInt(u):1}function sa(u){const h=u.match(Js);if(!h)return NaN;const N=qe(h[1]),b=qe(h[2]),C=qe(h[3]);return da(N,b,C)?N*At+b*Tt+C*1e3:NaN}function qe(u){return u&&parseFloat(u.replace(",","."))||0}function aa(u){if(u==="Z")return 0;const h=u.match(qs);if(!h)return 0;const N=h[1]==="+"?-1:1,b=parseInt(h[2]),C=h[3]&&parseInt(h[3])||0;return ia(b,C)?N*(b*At+C*Tt):NaN}function ra(u,h,N){const b=new Date(0);b.setUTCFullYear(u,0,4);const C=b.getUTCDay()||7,v=(h-1)*7+N+1-C;return b.setUTCDate(b.getUTCDate()+v),b}const na=[31,null,31,30,31,30,31,31,30,31,30,31];function $t(u){return u%400===0||u%4===0&&u%100!==0}function la(u,h,N){return h>=0&&h<=11&&N>=1&&N<=(na[h]||($t(u)?29:28))}function oa(u,h){return h>=1&&h<=($t(u)?366:365)}function ca(u,h,N){return h>=1&&h<=53&&N>=0&&N<=6}function da(u,h,N){return u===24?h===0&&N===0:N>=0&&N<60&&h>=0&&h<60&&u>=0&&u<25}function ia(u,h){return h>=0&&h<=59}function xa({batches:u}){const[h,N]=T.useState(new Date),[b,C]=T.useState(null),[v,M]=T.useState(!1),f=Array.isArray(u)?u:[],U=[];f.forEach(D=>{var L,Y;(L=D.collectionInfo)!=null&&L.collectedAt?U.push({date:D.collectionInfo.collectedAt,type:"collection",label:"ÏàòÍ∏à",amount:D.collectionInfo.amount,batchId:D.batchId,weekLabel:D.weekLabel}):["collected","paid","completed"].includes(D.status)&&U.push({date:D.endDate,type:"collection",label:"ÏàòÍ∏à (ÏÉÅÌÉúÍ∏∞Ï§Ä)",amount:D.totalCommission,batchId:D.batchId,weekLabel:D.weekLabel}),(D.payoutItems||[]).forEach(R=>{R.paidAt&&U.push({date:R.paidAt,type:"payout",label:`ÏßÄÍ∏â: ${R.partnerName||"ÎØ∏ÏßÄÏ†ï"}`,amount:R.amount,batchId:D.batchId,weekLabel:D.weekLabel})}),(Y=D.purchaseInvoice)!=null&&Y.receivedAt&&U.push({date:D.purchaseInvoice.receivedAt,type:"invoice",label:"ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú ÏàòÏ∑®",batchId:D.batchId,weekLabel:D.weekLabel})});const S=D=>{const L=De(D,"yyyy-MM-dd");return U.filter(Y=>(Y.date?Y.date.substring(0,10):"")===L)},ae=()=>e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>N(As(h,1)),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Et,{size:20})}),e.jsx("h3",{className:"text-lg font-bold text-gray-700",children:De(h,"yyyyÎÖÑ MÏõî",{locale:yt})}),e.jsx("button",{onClick:()=>N(Ts(h,1)),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Ft,{size:20})})]}),$e=()=>{const D=["Ïùº","Ïõî","Ìôî","Ïàò","Î™©","Í∏à","ÌÜ†"];return e.jsx("div",{className:"grid grid-cols-7 mb-2",children:D.map(L=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:L},L))})},Pe=()=>{const D=Es(h),L=Fs(D),Y=xs(D),R=$s(L),W=[];let Q=[],O=Y;for(;O<=R;){for(let je=0;je<7;je++){const ie=O,re=S(O),xe=re.length>0,K=Ps(O,D),me=b&&Ls(O,b);Q.push(e.jsxs("div",{onClick:()=>{xe&&(C(ie),M(!0))},className:`
              min-h-[60px] p-1 border border-gray-100 cursor-pointer transition-all
              ${K?"hover:bg-blue-50":"bg-gray-50 text-gray-300"}
              ${ft(O)?"bg-blue-50 border-blue-300":""}
              ${me?"ring-2 ring-blue-500":""}
            `,children:[e.jsx("span",{className:`text-sm ${ft(O)?"font-bold text-blue-600":""}`,children:De(O,"d")}),xe&&e.jsxs("div",{className:"mt-1 space-y-0.5",children:[re.slice(0,2).map((X,Ne)=>e.jsxs("div",{className:`text-[10px] px-1 py-0.5 rounded truncate
                      ${X.type==="collection"?"bg-green-100 text-green-700":X.type==="payout"?"bg-orange-100 text-orange-700":"bg-purple-100 text-purple-700"}`,children:[X.type==="collection"?"üí∞":X.type==="payout"?"üí≥":"üì•"," ",X.amount?`${X.amount}ÎßåÏõê`:X.label]},Ne)),re.length>2&&e.jsxs("div",{className:"text-[10px] text-gray-500",children:["+",re.length-2,"Í±¥ Îçî"]})]})]},O.toString())),O=ms(O,1)}W.push(e.jsx("div",{className:"grid grid-cols-7",children:Q},O.toString())),Q=[]}return e.jsx("div",{children:W})},P=()=>{if(!v||!b)return null;const D=S(b);return e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:()=>M(!1),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6",onClick:L=>L.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["üìÖ ",De(b,"yyyyÎÖÑ MÏõî dÏùº (EEEE)",{locale:yt})]}),e.jsx("button",{onClick:()=>M(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:e.jsx(ps,{size:20})})]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:D.map((L,Y)=>e.jsx("div",{className:`p-4 rounded-lg border
                  ${L.type==="collection"?"bg-green-50 border-green-200":L.type==="payout"?"bg-orange-50 border-orange-200":"bg-purple-50 border-purple-200"}`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-sm font-bold
                      ${L.type==="collection"?"text-green-700":L.type==="payout"?"text-orange-700":"text-purple-700"}`,children:L.type==="collection"?"üí∞ ÏàòÍ∏à":L.type==="payout"?"üí≥ ÏßÄÍ∏â":"üì• ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:L.label}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:L.weekLabel})]}),L.amount&&e.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[L.amount.toLocaleString(),"ÎßåÏõê"]})]})},Y))})]})})};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-700",children:"üìÜ Ï†ïÏÇ∞ ÌûàÏä§ÌÜ†Î¶¨ Ï∫òÎ¶∞Îçî"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ï¥ù ",U.length,"Í∞úÏùò Ïù¥Î≤§Ìä∏ / ",f.length,"Í∞ú Î∞∞Ïπò"]})]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full",children:"üí∞ ÏàòÍ∏à"}),e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 rounded-full",children:"üí≥ ÏßÄÍ∏â"}),e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full",children:"üì• ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú"})]})]}),ae(),$e(),Pe(),P()]})}const ma=(u,h,N="Sheet1")=>{const b=Fe.book_new(),C=Fe.json_to_sheet(h),v=h.length>0?Object.keys(h[0]).map(M=>({wch:Math.max(M.length,...h.map(f=>f[M]?f[M].toString().length:0))+2})):[];C["!cols"]=v,Fe.book_append_sheet(b,C,N),Ms(b,`${u}.xlsx`)};function Ea(){const{showToast:u}=hs(),[h,N]=T.useState([]),[b,C]=T.useState([]),[v,M]=T.useState(""),[f,U]=T.useState(new Date().getFullYear()),[S,ae]=T.useState("all"),[$e,Pe]=T.useState(!0),[P,D]=T.useState("monday"),[L,Y]=T.useState(()=>ke(new Date)),[R,W]=T.useState([]),[Q,O]=T.useState(!1),[je,ie]=T.useState(!1),[re,xe]=T.useState(!1),[K,me]=T.useState([]),[X,Ne]=T.useState(!1),[Pt,pe]=T.useState(!1),[ve,he]=T.useState(null),[H,ee]=T.useState({category:"Í¥ëÍ≥†ÎπÑ",amount:0,description:"",date:new Date().toISOString().split("T")[0]}),[B,Me]=T.useState({total:0,byCategory:{Í¥ëÍ≥†ÎπÑ:0,ÎßàÏºÄÌåÖÎπÑ:0,ÏÇ¨Î¨¥ÎπÑÏö©:0,Ïù∏Í±¥ÎπÑ:0,ÍµêÌÜµÎπÑ:0,ÏãùÎåÄ:0,Í∏∞ÌÉÄ:0},byMonth:[]}),[$,Re]=T.useState([]),[Mt,Qe]=T.useState(!1),[et,we]=T.useState(!1),ge=T.useRef(null);T.useEffect(()=>{(async()=>{const[l,c]=await Promise.all([gt(),ys()]);N(l),C(c),c.length>0&&M(c[0].partnerId),Pe(!1),setTimeout(async()=>{const d=await gt(),s=Array.isArray(d)?d:[],r=Array.isArray(l)?l:[];s.length>r.length&&(console.log("[Settlement] Re-fetched cases:",s.length),N(s))},1500)})()},[]),T.useEffect(()=>{(async()=>{if(!v||v==="all")return;O(!0);const l=await fs(v,L.getFullYear());W(Array.isArray(l)?l:[]),O(!1)})()},[v,L]),T.useEffect(()=>{(async()=>{if(P!=="expenses")return;Ne(!0);const[l,c]=await Promise.all([ze(v,f),Ye(f,S,v)]);me(l),Me(c),Ne(!1)})()},[P,f,S,v]),T.useEffect(()=>{if(P!=="expenses")return;Qe(!0);const t=ht(f),l=He(t,b);Re(l),Qe(!1)},[P,f,b]);const Rt=async t=>{var d;const l=(d=t.target.files)==null?void 0:d[0];if(!l)return;we(!0);const c=new FileReader;c.onload=s=>{var r;try{const n=(r=s.target)==null?void 0:r.result;if(!n){u("ÌååÏùºÏùÑ ÏùΩÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.","error"),we(!1);return}const i=Rs(n,{type:"binary",cellDates:!0,codepage:949}),x=i.SheetNames[0],a=i.Sheets[x],m=Fe.sheet_to_json(a,{header:1,raw:!1,defval:""});console.log("[DEBUG] Excel Data - Total Rows:",m.length),console.log("[DEBUG] First 15 rows:",m.slice(0,15)),console.log("[DEBUG] File name:",l.name);const{bank:o,transactions:g}=Cs(m,l.name);console.log("[DEBUG] Detected bank:",o),console.log("[DEBUG] Parsed transactions count:",g.length),g.length>0&&console.log("[DEBUG] First transaction:",g[0]);const j=He(g,b),{added:y,skipped:E}=Ds(j),_=ht(f),A=He(_,b);Re(A),u(`${o==="kakao"?"Ïπ¥Ïπ¥Ïò§Î±ÖÌÅ¨":"ÏºÄÏù¥Î±ÖÌÅ¨"}: ${y}Í±¥ Ï∂îÍ∞ÄÎê® ${E>0?`(${E}Í±¥ Ï§ëÎ≥µ)`:""}`,"success")}catch(n){console.error("ÌååÏùº ÌååÏã± Ïò§Î•ò:",n),u("ÌååÏùº ÌååÏã±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Ïò¨Î∞îÎ•∏ ÏùÄÌñâ Í±∞ÎûòÎÇ¥Ïó≠ ÌååÏùºÏù∏ÏßÄ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.","error")}finally{we(!1),ge.current&&(ge.current.value="")}},c.onerror=()=>{console.error("ÌååÏùº ÏùΩÍ∏∞ Ïò§Î•ò"),u("ÌååÏùºÏùÑ ÏùΩÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.","error"),we(!1),ge.current&&(ge.current.value="")},c.readAsBinaryString(l)},Ot=(t,l)=>{const c=ks(t,{category:l,isVerified:!0});c&&Re(d=>d.map(s=>s.id===t?c:s))};if($e)return e.jsx("div",{children:"Î°úÎî©Ï§ë..."});const z=Array.isArray(h)?h:[],J=v==="all",I=J?null:b.find(t=>t.partnerId===v),Oe=gs(L),p=(Array.isArray(R)?R:[]).find(t=>t.weekLabel===Oe&&t.partnerId===v),Bt=()=>{const t=new Date(L);t.setDate(t.getDate()-7),Y(ke(t))},Ut=()=>{const t=new Date(L);t.setDate(t.getDate()+7),Y(ke(t))},_t=()=>Y(ke(new Date)),Wt=async()=>{if(!v||v==="all")return;O(!0);const t=await ws(v,L);W(l=>l.find(d=>d.batchId===t.batchId)?l:[t,...l]),O(!1),u(`${Oe} Î∞∞ÏπòÍ∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.`,"success")},Ht=async()=>{if(!p)return;O(!0);const t=await Ss(p.batchId);t&&(W(l=>l.map(c=>c.batchId===t.batchId?t:c)),u("Î∞∞Ïπò Îç∞Ïù¥ÌÑ∞Í∞Ä ÏµúÏã† Í≥†Í∞ù Ï†ïÎ≥¥Î°ú ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§.","success")),O(!1)},tt=async t=>{p&&(await se(p.batchId,{status:t}),W(l=>l.map(c=>c.batchId===p.batchId?{...c,status:t,updatedAt:new Date().toISOString()}:c)),u(`ÏÉÅÌÉúÍ∞Ä '${Le(t)}'(Ïúº)Î°ú Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.`,"success"))},zt=async t=>{p&&(await se(p.batchId,{confirmationEvidence:{text:t,confirmedAt:new Date().toISOString()},status:"confirmed"}),W(l=>l.map(c=>c.batchId===p.batchId?{...c,status:"confirmed",confirmationEvidence:{text:t,confirmedAt:new Date().toISOString()},updatedAt:new Date().toISOString()}:c)),u("ÌôïÏù∏ Ï¶ùÎπôÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.","success"))},Yt=async t=>{if(!p)return;const l=t.supplyAmount+t.vat;await se(p.batchId,{invoiceInfo:{...t,total:l},status:"invoiced"}),W(c=>c.map(d=>d.batchId===p.batchId?{...d,status:"invoiced",invoiceInfo:{...t,total:l},updatedAt:new Date().toISOString()}:d)),u("ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Ï†ïÎ≥¥Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.","success")},Vt=()=>{var c,d,s,r;if(!I||!p)return;const l=(((c=I.kakaoTemplates)==null?void 0:c.invoiceNotice)||"").replace(/\{\{Í±∞ÎûòÏ≤òÎ™Ö\}\}/g,I.name).replace(/\{\{Ï£ºÏ∞®ÎùºÎ≤®\}\}/g,p.weekLabel).replace(/\{\{Í≥µÍ∏âÍ∞Ä\}\}/g,(((d=p.invoiceInfo)==null?void 0:d.supplyAmount)||0).toLocaleString()).replace(/\{\{VAT\}\}/g,(((s=p.invoiceInfo)==null?void 0:s.vat)||0).toLocaleString()).replace(/\{\{Ìï©Í≥Ñ\}\}/g,(((r=p.invoiceInfo)==null?void 0:r.total)||0).toLocaleString()).replace(/\{\{Í≥ÑÏ¢åÏ†ïÎ≥¥\}\}/g,I.bankInfo?`${I.bankInfo.bankName} ${I.bankInfo.accountNumber} (${I.bankInfo.accountHolder})`:"");navigator.clipboard.writeText(l),xe(!0),setTimeout(()=>xe(!1),2e3),u("ÌÖúÌîåÎ¶øÏù¥ ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.","success")},ce=b.find(t=>t.partnerId===v),st=J?z:z.filter(t=>!t||!t.partnerId?!1:!!(t.partnerId===v||ce&&t.partnerId===ce.name||ce&&v&&t.partnerId&&(String(t.partnerId).includes(String(v))||String(v).includes(String(t.partnerId))))),ne=Array.isArray(st)?st:[];console.log("[Settlement Debug]",{selectedPartnerId:v,selectedPartnerName:ce==null?void 0:ce.name,totalCases:z.length,partnerCasesCount:ne.length,sampleCasePartnerIds:z.slice(0,5).map(t=>({name:t.customerName,partnerId:t.partnerId,contractAt:t.contractAt}))});const Se=t=>{const l=b.find(c=>c.partnerId===t.partnerId);return l?jt(t.contractFee||0,l.commissionRules):0},Kt=(t,l,c)=>{var le,oe;const d=b.find(F=>F.partnerId===t.partnerId);if(!d)return{payable:0,thisWeekPayable:0,total:0,isPartial:!1,thisWeekDeposit:0,cumulativeDeposit:0,isThisWeekDeposit:!1,isFutureDeposit:!1,previouslyPaid:0};const s=d.commissionRules.find(F=>F.active&&(t.contractFee||0)>=F.minFee&&((t.contractFee||0)<=F.maxFee||F.maxFee===0)),r=(s==null?void 0:s.commission)||0,n=(s==null?void 0:s.fullPayoutThreshold)||0,i=t.depositHistory&&t.depositHistory.length>0?t.depositHistory:[{date:t.deposit1Date||"",amount:t.deposit1Amount||0},{date:t.deposit2Date||"",amount:t.deposit2Amount||0}],x=new Date().toISOString().split("T")[0],a=i.filter(F=>F.date&&F.date>=l&&F.date<=c),m=a.reduce((F,V)=>F+(V.amount||0),0),o=a.length>0&&a.every(F=>F.date>x),g=i.filter(F=>F.date&&F.date<=c).reduce((F,V)=>F+(V.amount||0),0),j=i.filter(F=>F.date&&F.date<l).reduce((F,V)=>F+(V.amount||0),0),y=(le=d.settlementConfig)!=null&&le.downPaymentPercentage?d.settlementConfig.downPaymentPercentage/100:.1,E=(oe=d.settlementConfig)!=null&&oe.firstPayoutPercentage?d.settlementConfig.firstPayoutPercentage/100:.5,_=t.contractFee||0;let A=0;n>0&&j>=n?A=r:j>=_*y&&(A=r*E);let w=0,k=!1;n>0&&g>=n?(w=r,k=!1):g>=_*y&&(w=r*E,k=!0);const G=Math.max(0,w-A);return{payable:w,thisWeekPayable:G,previouslyPaid:A,total:r,isPartial:k,thisWeekDeposit:m,cumulativeDeposit:g,isThisWeekDeposit:m>0,isFutureDeposit:o}},Z=ne.filter(t=>{if(!t.contractAt||!t.contractFee)return!1;const l=t.contractAt;let c;try{c=Te(l),isNaN(c.getTime())&&(c=new Date(l))}catch{return!1}if(isNaN(c.getTime()))return!1;const d=c.getFullYear(),s=c.getMonth()+1;return d===f&&(S==="all"||s===S)}),Be=new Date().toISOString().split("T")[0],Ie=t=>{const l=t.depositHistory&&t.depositHistory.length>0?t.depositHistory:[{date:t.deposit1Date||"",amount:t.deposit1Amount||0},{date:t.deposit2Date||"",amount:t.deposit2Amount||0}],c=l.filter(r=>r.date&&r.date<=Be).reduce((r,n)=>r+(n.amount||0),0),d=l.filter(r=>r.date&&r.date>Be).reduce((r,n)=>r+(n.amount||0),0),s=l.reduce((r,n)=>r+(n.amount||0),0);return{actualDeposit:c,expectedDeposit:d,totalDeposit:s}},Gt=()=>{const t=S==="all"?`${f}-`:`${f}-${String(S).padStart(2,"0")}`;let l=0,c=0;return ne.forEach(d=>{(d.depositHistory&&d.depositHistory.length>0?d.depositHistory:[{date:d.deposit1Date||"",amount:d.deposit1Amount||0},{date:d.deposit2Date||"",amount:d.deposit2Amount||0}]).forEach(r=>{r.date&&r.date.startsWith(t)&&r.date>Be&&r.amount>0&&(l++,c+=r.amount)})}),{expectedCount:l,expectedAmount:c}},ue=t=>{var m,o;const l=b.find(g=>g.partnerId===t.partnerId);if(!l)return{paidCommission:0,unpaidCommission:0,totalCommission:0};const c=l.commissionRules.find(g=>g.active&&(t.contractFee||0)>=g.minFee&&((t.contractFee||0)<=g.maxFee||g.maxFee===0)),d=(c==null?void 0:c.commission)||0,s=(c==null?void 0:c.fullPayoutThreshold)||0,{actualDeposit:r}=Ie(t),n=(m=l.settlementConfig)!=null&&m.downPaymentPercentage?l.settlementConfig.downPaymentPercentage/100:.1,i=(o=l.settlementConfig)!=null&&o.firstPayoutPercentage?l.settlementConfig.firstPayoutPercentage/100:.5,x=t.contractFee||0;let a=0;return s>0&&r>=s?a=d:r>=x*n&&(a=d*i),{paidCommission:a,unpaidCommission:d-a,totalCommission:d}},Ce=Z.length,Ue=Z.reduce((t,l)=>t+(l.contractFee||0),0),_e=Z.reduce((t,l)=>t+Se(l),0),at=ne.filter(t=>["Í≥ÑÏïΩ ÏôÑÎ£å","1Ï∞® ÏûÖÍ∏àÏôÑÎ£å","2Ï∞® ÏûÖÍ∏àÏôÑÎ£å"].includes(t.status)&&!t.contractAt).length,rt=Z.reduce((t,l)=>t+Ie(l).actualDeposit,0),{expectedCount:Zt,expectedAmount:Xt}=Gt(),q=Z.reduce((t,l)=>t+ue(l).paidCommission,0),nt=_e-q,Jt=Z.filter(t=>(t.installmentMonths||1)>1&&ue(t).paidCommission<ue(t).totalCommission).length,qt=Z.filter(t=>{const{actualDeposit:l,totalDeposit:c}=Ie(t);return c>0&&l>=c}).length,lt=Ce>0?Math.round(qt/Ce*100):0,ot=Array.from({length:12},(t,l)=>{const c=`${f}-${String(l+1).padStart(2,"0")}`,d=ne.filter(a=>a.contractAt&&a.contractAt.startsWith(c)),s=d.reduce((a,m)=>a+(m.contractFee||0),0),r=d.reduce((a,m)=>a+Se(m),0),n=d.reduce((a,m)=>a+Ie(m).actualDeposit,0),i=d.reduce((a,m)=>a+ue(m).paidCommission,0),x=r-i;return{name:`${l+1}Ïõî`,count:d.length,revenue:s,commission:r,actualDeposit:n,paidCommission:i,unpaidCommission:x,netProfit:n-i}}),Qt=t=>{var l;return((l=b.find(c=>c.partnerId===t))==null?void 0:l.name)||"-"},ct=(p==null?void 0:p.dealIds.map(t=>z.find(l=>l.caseId===t)).filter(Boolean))||[],es=()=>{var t,l;return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-xl border border-blue-100",children:[e.jsxs("h3",{className:"font-bold text-blue-800 mb-4 text-lg flex items-center",children:[e.jsx(Bs,{className:"mr-2",size:20})," ÏõîÏöîÏùº: Ï†ïÏÇ∞ ÌôïÏù∏"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Ìï¥Îãπ Ï£ºÏ∞®Ïóê Ï†ïÏÇ∞ ÎåÄÏÉÅ ÎîúÏùÑ ÌôïÏù∏ÌïòÍ≥†, Í±∞ÎûòÏ≤ò Ïπ¥ÌÜ° ÌôïÏù∏ Ï¶ùÎπôÏùÑ Í∏∞Î°ùÌï©ÎãàÎã§."}),p?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Îîú Ïàò"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:[p.dealIds.length,"Í±¥"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Ï¥ù ÏàòÏûÑÎ£å"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[p.totalContractFee.toLocaleString(),"ÎßåÏõê"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Ï¥ù ÏàòÏàòÎ£å"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[p.totalCommission.toLocaleString(),"ÎßåÏõê"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"ÏÉÅÌÉú"}),e.jsx("p",{className:`text-xl font-bold ${p.status==="draft"?"text-gray-600":"text-green-600"}`,children:Le(p.status)})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-gray-100 bg-gray-50 flex justify-between items-center",children:[e.jsx("h4",{className:"font-bold text-gray-700 text-sm",children:"Ï†ïÏÇ∞ ÎåÄÏÉÅ Îîú Î™©Î°ù"}),e.jsxs("button",{onClick:Ht,disabled:Q,className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700 disabled:opacity-50",title:"Í≥†Í∞ù ÏÉÅÏÑ∏ÌéòÏù¥ÏßÄ Î≥ÄÍ≤ΩÏÇ¨Ìï≠ÏùÑ Î∞òÏòÅÌï©ÎãàÎã§",children:[e.jsx(Zs,{size:14,className:Q?"animate-spin":""}),"ÏÉàÎ°úÍ≥†Ïπ®"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:ct.length===0?e.jsx("p",{className:"text-center text-gray-500 py-6",children:"Ï†ïÏÇ∞ ÎåÄÏÉÅ ÎîúÏù¥ ÏóÜÏäµÎãàÎã§."}):e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-3 py-2",children:"Í≥†Í∞ùÎ™Ö"}),e.jsx("th",{className:"text-center px-2 py-2 text-xs",children:"Î∂ÑÎÇ©"}),e.jsx("th",{className:"text-right px-2 py-2",children:"ÏàòÏûÑÎ£å"}),e.jsx("th",{className:"text-right px-2 py-2",children:"ÏûÖÍ∏àÏï°"}),e.jsx("th",{className:"text-right px-2 py-2 text-orange-600",children:"Ï¥ùÏàòÏàòÎ£å"}),e.jsx("th",{className:"text-right px-2 py-2 text-green-600 font-bold",children:"Í∏àÏ£ºÏßÄÍ∏â"}),e.jsx("th",{className:"text-center px-2 py-2",children:"ÏÉÅÌÉú"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:ct.map(c=>{var s;const d=Kt(c,p.startDate,p.endDate);return e.jsxs("tr",{className:`hover:bg-gray-50 ${d.isFutureDeposit?"bg-purple-50/50":""}`,children:[e.jsxs("td",{className:"px-3 py-2 font-medium",children:[c.customerName,d.isFutureDeposit&&e.jsx("span",{className:"ml-1 text-xs text-purple-500",children:"(ÏòàÏÉÅ)"})]}),e.jsx("td",{className:"px-2 py-2 text-center text-xs text-gray-500",children:c.installmentMonths||"-"}),e.jsxs("td",{className:"px-2 py-2 text-right text-gray-700",children:[(s=c.contractFee)==null?void 0:s.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:`px-2 py-2 text-right font-medium ${d.isFutureDeposit?"text-purple-500":"text-blue-600"}`,children:[d.isFutureDeposit&&e.jsx("span",{className:"text-xs mr-0.5",children:"ÏòàÏÉÅ"}),d.thisWeekDeposit.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"px-2 py-2 text-right text-orange-500",children:[d.total.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:`px-2 py-2 text-right font-bold ${d.isFutureDeposit?"text-purple-600":"text-green-600"}`,children:[d.isFutureDeposit&&e.jsx("span",{className:"text-xs mr-0.5",children:"ÏòàÏÉÅ"}),d.thisWeekPayable.toLocaleString(),"ÎßåÏõê"]}),e.jsx("td",{className:"px-2 py-2 text-center",children:d.isFutureDeposit?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-purple-100 text-purple-700",children:"ÏòàÏÉÅ"}):d.isPartial?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"50%"}):d.thisWeekPayable>0?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"100%"}):e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-500",children:"ÎåÄÍ∏∞"})})]},c.caseId)})})]})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2 text-sm",children:"üìù Ïπ¥ÌÜ° ÌôïÏù∏ Ï¶ùÎπô"}),e.jsx("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg text-sm",rows:3,placeholder:"Í±∞ÎûòÏ≤òÏôÄÏùò Ïπ¥ÌÜ° ÌôïÏù∏ ÎÇ¥Ïö©ÏùÑ Í∏∞Î°ùÌïòÏÑ∏Ïöî...",defaultValue:((t=p.confirmationEvidence)==null?void 0:t.text)||"",onBlur:c=>{var d;c.target.value!==((d=p.confirmationEvidence)==null?void 0:d.text)&&zt(c.target.value)}}),((l=p.confirmationEvidence)==null?void 0:l.confirmedAt)&&e.jsxs("p",{className:"text-xs text-green-600 mt-2",children:["‚úì ",new Date(p.confirmationEvidence.confirmedAt).toLocaleString()," ÌôïÏù∏Îê®"]})]}),p.status==="draft"&&e.jsx("button",{onClick:()=>tt("confirmed"),className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700",children:"‚úì Ï†ïÏÇ∞ ÌôïÏù∏ ÏôÑÎ£å (ÎùΩ0)"})]}):e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 text-center",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Ïù¥ Ï£ºÏ∞®Ïóê ÎåÄÌïú Î∞∞ÏπòÍ∞Ä ÏóÜÏäµÎãàÎã§."}),e.jsx("button",{onClick:Wt,disabled:Q||v==="all",className:"bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50",children:Q?"ÏÉùÏÑ± Ï§ë...":"Î∞∞Ïπò ÏÉùÏÑ±ÌïòÍ∏∞"})]})]})})},ts=()=>{var t,l,c,d,s,r,n,i,x,a;return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-yellow-50 p-6 rounded-xl border border-yellow-100",children:[e.jsxs("h3",{className:"font-bold text-yellow-800 mb-4 text-lg flex items-center",children:[e.jsx(Us,{className:"mr-2",size:20})," ÌôîÏöîÏùº: Î∞úÌñâ / ÏàòÍ∏à"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑúÎ•º Î∞úÌñâÌïòÍ≥†, ÏàòÍ∏à ÏÉÅÌÉúÎ•º Í¥ÄÎ¶¨Ìï©ÎãàÎã§."}),p?p.status==="draft"?e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 text-center",children:[e.jsx(ut,{className:"mx-auto text-yellow-500 mb-2",size:32}),e.jsx("p",{className:"text-gray-600",children:"Î®ºÏ†Ä ÏõîÏöîÏùº ÌÉ≠ÏóêÏÑú Ï†ïÏÇ∞ ÌôïÏù∏ÏùÑ ÏôÑÎ£åÌï¥Ï£ºÏÑ∏Ïöî."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-3 text-sm",children:"üìÑ ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Ï†ïÎ≥¥"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Î∞úÌñâÏùº"}),e.jsx("input",{type:"date",className:"w-full p-2 border border-gray-300 rounded text-sm",defaultValue:((t=p.invoiceInfo)==null?void 0:t.issueDate)||"",id:"issueDate"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Í≥µÍ∏âÍ∞Ä (ÎßåÏõê)"}),e.jsx("input",{type:"number",className:"w-full p-2 border border-gray-300 rounded text-sm",defaultValue:((l=p.invoiceInfo)==null?void 0:l.supplyAmount)||p.totalCommission,id:"supplyAmount"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"VAT (ÎßåÏõê)"}),e.jsx("input",{type:"number",className:"w-full p-2 border border-gray-300 rounded text-sm",defaultValue:((c=p.invoiceInfo)==null?void 0:c.vat)||Math.round(p.totalCommission*.1),id:"vat"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"ÏäπÏù∏Î≤àÌò∏"}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded text-sm",placeholder:"Î∞úÌñâ ÌõÑ ÏûÖÎ†•",defaultValue:((d=p.invoiceInfo)==null?void 0:d.approvalNumber)||"",id:"approvalNumber"})]})]}),e.jsx("button",{onClick:()=>{const m=document.getElementById("issueDate").value,o=Number(document.getElementById("supplyAmount").value),g=Number(document.getElementById("vat").value),j=document.getElementById("approvalNumber").value;Yt({issueDate:m,supplyAmount:o,vat:g,approvalNumber:j})},className:"mt-4 bg-yellow-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-yellow-700",children:"üíæ Ï†ÄÏû•"})]}),((s=I==null?void 0:I.kakaoTemplates)==null?void 0:s.invoiceNotice)&&e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-bold text-gray-700 text-sm",children:"üì± Ïπ¥ÌÜ° ÌÖúÌîåÎ¶ø"}),e.jsxs("button",{onClick:Vt,className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700",children:[re?e.jsx(Ws,{size:14}):e.jsx(Hs,{size:14}),re?"Î≥µÏÇ¨Îê®!":"Î≥µÏÇ¨"]})]}),e.jsx("div",{className:"bg-gray-50 p-3 rounded text-sm text-gray-600 whitespace-pre-line",children:I.kakaoTemplates.invoiceNotice.replace(/\{\{Í±∞ÎûòÏ≤òÎ™Ö\}\}/g,I.name).replace(/\{\{Ï£ºÏ∞®ÎùºÎ≤®\}\}/g,p.weekLabel).replace(/\{\{Í≥µÍ∏âÍ∞Ä\}\}/g,(((r=p.invoiceInfo)==null?void 0:r.supplyAmount)||p.totalCommission).toLocaleString()).replace(/\{\{VAT\}\}/g,(((n=p.invoiceInfo)==null?void 0:n.vat)||Math.round(p.totalCommission*.1)).toLocaleString()).replace(/\{\{Ìï©Í≥Ñ\}\}/g,(((i=p.invoiceInfo)==null?void 0:i.total)||Math.round(p.totalCommission*1.1)).toLocaleString()).replace(/\{\{Í≥ÑÏ¢åÏ†ïÎ≥¥\}\}/g,I.bankInfo?`${I.bankInfo.bankName} ${I.bankInfo.accountNumber} (${I.bankInfo.accountHolder})`:"(Í≥ÑÏ¢åÏ†ïÎ≥¥ ÎØ∏ÏÑ§Ï†ï)")})]}),p.status!=="draft"&&e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2 text-sm",children:"üí∞ ÏàòÍ∏à ÏÉÅÌÉú"}),(x=p.collectionInfo)!=null&&x.collectedAt?e.jsxs("p",{className:"text-green-600 font-bold",children:["‚úì ÏàòÍ∏àÏôÑÎ£å (",p.collectionInfo.collectedAt,") - ",(a=p.collectionInfo.amount)==null?void 0:a.toLocaleString(),"ÎßåÏõê"]}):e.jsx("button",{onClick:()=>tt("collected"),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-green-700",children:"ÏàòÍ∏à ÏôÑÎ£å Ï≤òÎ¶¨"})]})]}):e.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Î®ºÏ†Ä ÏõîÏöîÏùº ÌÉ≠ÏóêÏÑú Î∞∞ÏπòÎ•º ÏÉùÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî."})})]})})},ss=()=>{var x,a,m;const t=(p==null?void 0:p.payoutItems)||[],l=async()=>{if(!p)return;const o={id:`payout-${Date.now()}`,partnerName:"",partnerAccount:"",amount:0},g=[...t,o];await se(p.batchId,{payoutItems:g}),W(j=>j.map(y=>y.batchId===p.batchId?{...y,payoutItems:g}:y))},c=async(o,g)=>{if(!p)return;const j=t.map(y=>y.id===o?{...y,...g}:y);await se(p.batchId,{payoutItems:j}),W(y=>y.map(E=>E.batchId===p.batchId?{...E,payoutItems:j}:E))},d=async o=>{if(!p)return;const g=t.filter(j=>j.id!==o);await se(p.batchId,{payoutItems:g}),W(j=>j.map(y=>y.batchId===p.batchId?{...y,payoutItems:g}:y))},s=async o=>{const g=new Date().toISOString().split("T")[0];await c(o,{paidAt:g})},r=async()=>{if(!p)return;const g={collectedAt:new Date().toISOString().split("T")[0],amount:p.totalCommission};await se(p.batchId,{collectionInfo:g,status:"collected"}),W(j=>j.map(y=>y.batchId===p.batchId?{...y,collectionInfo:g,status:"collected"}:y)),u("ÏàòÍ∏à ÏôÑÎ£å Ï≤òÎ¶¨ÎêòÏóàÏäµÎãàÎã§.","success")},n=async()=>{if(!p)return;const g={receivedAt:new Date().toISOString().split("T")[0]};await se(p.batchId,{purchaseInvoice:g,status:"completed"}),W(j=>j.map(y=>y.batchId===p.batchId?{...y,purchaseInvoice:g,status:"completed"}:y)),u("Îß§ÏûÖ ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú ÏàòÏ∑® ÏôÑÎ£å Ï≤òÎ¶¨ÎêòÏóàÏäµÎãàÎã§.","success")},i=(I==null?void 0:I.payoutPartnerPresets)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-6 rounded-xl border border-blue-100",children:[e.jsx("h3",{className:"font-bold text-blue-800 mb-4 text-lg flex items-center",children:"üí∞ ÏàòÍ∏à Ï†ïÎ≥¥ (Í±∞ÎûòÏ≤òÏóêÏÑú Î∞õÏùÑ Í∏àÏï°)"}),!p||!["collected","invoiced","confirmed","paid","completed"].includes(p.status)?e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 text-center",children:[e.jsx(ut,{className:"mx-auto text-yellow-500 mb-2",size:32}),e.jsx("p",{className:"text-gray-600",children:"ÌôîÏöîÏùº ÌÉ≠ÏóêÏÑú Î∞úÌñâÏùÑ Î®ºÏ†Ä ÏôÑÎ£åÌï¥Ï£ºÏÑ∏Ïöî."})]}):e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"ÏàòÍ∏à ÎåÄÏÉÅ Í∏àÏï°"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[p.totalCommission.toLocaleString(),"ÎßåÏõê"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Í±∞ÎûòÏ≤ò"}),e.jsx("p",{className:"text-lg font-bold text-gray-700",children:I==null?void 0:I.name})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"ÎÇ¥ ÏûÖÍ∏à Í≥ÑÏ¢å"}),e.jsx("p",{className:"text-sm font-medium text-gray-600",children:I!=null&&I.bankInfo?`${I.bankInfo.bankName} ${I.bankInfo.accountNumber}`:"(ÏÑ§Ï†ïÏóêÏÑú ÏûÖÎ†•)"})]})]}),(x=p.collectionInfo)!=null&&x.collectedAt?e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:[e.jsxs("p",{className:"text-green-700 font-bold text-lg",children:["‚úì ÏàòÍ∏àÏôÑÎ£å (",p.collectionInfo.collectedAt,")"]}),e.jsxs("p",{className:"text-green-600",children:[(a=p.collectionInfo.amount)==null?void 0:a.toLocaleString(),"ÎßåÏõê ÏûÖÍ∏à ÌôïÏù∏"]})]}):e.jsx("button",{onClick:r,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700",children:"üí∞ ÏàòÍ∏à ÏôÑÎ£å Ï≤òÎ¶¨"})]})]}),e.jsxs("div",{className:"bg-green-50 p-6 rounded-xl border border-green-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-bold text-green-800 text-lg flex items-center",children:[e.jsx(Ks,{className:"mr-2",size:20})," ÌååÌä∏ÎÑà ÏßÄÍ∏â (",t.length,"Í±¥)"]}),p&&["collected","invoiced","confirmed","paid","completed"].includes(p.status)&&e.jsxs("button",{onClick:l,className:"bg-green-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-green-700 flex items-center gap-1",children:[e.jsx(Xe,{size:16})," ÏßÄÍ∏â Ï∂îÍ∞Ä"]})]}),t.length===0?e.jsx("p",{className:"text-sm text-gray-500 bg-white p-4 rounded-lg",children:'ÌååÌä∏ÎÑà ÏßÄÍ∏âÏù¥ ÏóÜÏúºÎ©¥ "ÏßÄÍ∏â Ï∂îÍ∞Ä" ÏóÜÏù¥ ÎëêÏÑ∏Ïöî.'}):e.jsx("div",{className:"space-y-3",children:t.map((o,g)=>{var j;return e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["ÏßÄÍ∏â #",g+1]}),!o.paidAt&&e.jsx("button",{onClick:()=>d(o.id),className:"text-red-500 hover:text-red-700",children:e.jsx(Dt,{size:16})})]}),i.length>0&&!o.partnerName&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ÌîÑÎ¶¨ÏÖã ÏÑ†ÌÉù"}),e.jsxs("select",{onChange:y=>{const E=i.find(_=>_.id===y.target.value);E&&c(o.id,{partnerName:E.name,partnerAccount:E.accountInfo,amount:E.defaultAmount||0})},className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"ÏßÅÏ†ë ÏûÖÎ†•"}),i.map(y=>e.jsxs("option",{value:y.id,children:[y.name," - ",y.accountInfo]},y.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ÌååÌä∏ÎÑàÎ™Ö"}),e.jsx("input",{type:"text",defaultValue:o.partnerName,onBlur:y=>c(o.id,{partnerName:y.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"ÌååÌä∏ÎÑàÎ™Ö"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Í≥ÑÏ¢åÏ†ïÎ≥¥"}),e.jsx("input",{type:"text",defaultValue:o.partnerAccount,onBlur:y=>c(o.id,{partnerAccount:y.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"ÏùÄÌñâ Í≥ÑÏ¢åÎ≤àÌò∏"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Í∏àÏï° (ÎßåÏõê)"}),e.jsx("input",{type:"number",defaultValue:o.amount,onBlur:y=>c(o.id,{amount:parseInt(y.target.value)||0}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 font-bold",placeholder:"0"})]})]}),e.jsx("div",{className:"mt-3",children:o.paidAt?e.jsx("div",{className:"bg-green-50 p-2 rounded border border-green-200",children:e.jsxs("p",{className:"text-green-700 font-bold",children:["‚úì ÏßÄÍ∏âÏôÑÎ£å (",o.paidAt,") - ",(j=o.amount)==null?void 0:j.toLocaleString(),"ÎßåÏõê"]})}):e.jsx("button",{onClick:()=>s(o.id),className:"w-full bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700",children:"‚úì ÏßÄÍ∏â ÏôÑÎ£å Ï≤òÎ¶¨"})})]},o.id)})})]}),e.jsxs("div",{className:"bg-purple-50 p-6 rounded-xl border border-purple-100",children:[e.jsx("h3",{className:"font-bold text-purple-800 mb-4 text-lg flex items-center",children:"üì• Îß§ÏûÖ ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú ÏàòÏ∑®"}),p&&["collected","invoiced","confirmed","paid","completed"].includes(p.status)&&e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:(m=p.purchaseInvoice)!=null&&m.receivedAt?e.jsx("div",{className:"bg-purple-50 p-3 rounded border border-purple-200",children:e.jsxs("p",{className:"text-purple-700 font-bold text-lg",children:["‚úì ÏàòÏ∑®ÏôÑÎ£å (",p.purchaseInvoice.receivedAt,")"]})}):e.jsx("button",{onClick:n,className:"w-full bg-purple-600 text-white py-3 rounded-lg font-bold hover:bg-purple-700",children:"üì• Îß§ÏûÖ ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú ÏàòÏ∑® ÏôÑÎ£å"})})]})]})},as=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{onClick:()=>ie(!0),className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100 cursor-pointer hover:bg-gray-50 hover:border-blue-300 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"üìã Í≥ÑÏïΩ Í±¥Ïàò"}),e.jsx(_s,{size:14,className:"text-gray-300 group-hover:text-blue-500"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:[Ce,"Í±¥"]}),e.jsx("p",{className:"text-xs text-blue-500 mt-1",children:"ÏÉÅÏÑ∏ Î≥¥Í∏∞ ‚Üí"})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"üí∞ Ï¥ù Îß§Ï∂ú"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:[Ue.toLocaleString(),"ÎßåÏõê"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"ÏàòÏûÑÎ£å Ìï©Í≥Ñ"})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"‚úÖ Ïã§Ï†ú ÏûÖÍ∏àÏï°"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 mt-1",children:[rt.toLocaleString(),"ÎßåÏõê"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Ïò§ÎäòÍπåÏßÄ ÌôïÏ†ï"})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"üìÖ ÏòàÏÉÅ ÏûÖÍ∏àÏï°"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-500 mt-1",children:[Xt.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[Zt,"Í±¥ ÏûÖÍ∏à ÏòàÏ†ï"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-white p-5 rounded-xl shadow-sm border border-green-200",children:[e.jsx("p",{className:"text-sm text-green-700",children:"üíµ ÏßÄÍ∏âÎêú ÏàòÏàòÎ£å"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 mt-1",children:[q.toLocaleString(),"ÎßåÏõê"]}),e.jsx("p",{className:"text-xs text-green-500 mt-1",children:"ÏûÖÍ∏à ÌôïÏ†ï Í∏∞Ï§Ä"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-white p-5 rounded-xl shadow-sm border border-orange-200",children:[e.jsx("p",{className:"text-sm text-orange-700",children:"üîú ÎØ∏ÏßÄÍ∏â ÏàòÏàòÎ£å"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:[nt.toLocaleString(),"ÎßåÏõê"]}),e.jsx("p",{className:"text-xs text-orange-500 mt-1",children:"Ï∂îÍ∞Ä ÏûÖÍ∏à ÌïÑÏöî"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-white p-5 rounded-xl shadow-sm border border-indigo-200",children:[e.jsx("p",{className:"text-sm text-indigo-700",children:"üìä Î∂ÑÎÇ© ÏßÑÌñâÏ§ë"}),e.jsxs("p",{className:"text-2xl font-bold text-indigo-600 mt-1",children:[Jt,"Í±¥"]}),e.jsx("p",{className:"text-xs text-indigo-500 mt-1",children:"Ï∂îÍ∞Ä ÏûÖÍ∏à ÎåÄÍ∏∞"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white p-5 rounded-xl shadow-sm border border-blue-200",children:[e.jsx("p",{className:"text-sm text-blue-700",children:"üìà ÏûÖÍ∏à ÏôÑÎ£åÏú®"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:[lt,"%"]}),e.jsx("div",{className:"mt-2 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${lt}%`}})})]})]}),(()=>{const t=Array.isArray(ne)?ne:[],l=new Date,c=t.filter(d=>{if(d.status==="Ï¢ÖÍ≤∞"||d.status==="Ï∑®ÏÜå")return!1;const s=d.contractFee||0,r=(d.depositHistory||[]).reduce((m,o)=>m+(o.amount||0),0);if(s-r<=0)return!1;let i=d.contractAt||d.createdAt;if(d.depositHistory&&d.depositHistory.length>0){const m=d.depositHistory.map(o=>o.date).sort();i=m[m.length-1]}if(!i)return!1;const x=Te(i);return Je(l,x)>=30}).map(d=>{const s=d.contractFee||0,r=(d.depositHistory||[]).reduce((x,a)=>x+(a.amount||0),0),n=s-r;let i=d.contractAt||d.createdAt;if(d.depositHistory&&d.depositHistory.length>0){const x=d.depositHistory.map(a=>a.date).sort();i=x[x.length-1]}return{...d,unpaidAmount:n,overdueDays:Je(l,Te(i))}}).sort((d,s)=>s.unpaidAmount-d.unpaidAmount);return c.length===0?null:e.jsxs("div",{className:"bg-red-50 rounded-xl shadow-sm border border-red-100 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"p-1.5 bg-red-100 text-red-600 rounded-lg",children:"üö®"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-red-800",children:"Ïû•Í∏∞ ÎØ∏ÏàòÍ∏à ÌòÑÌô©"}),e.jsxs("p",{className:"text-xs text-red-600",children:["ÏµúÍ∑º 30Ïùº Ïù¥ÏÉÅ ÎØ∏ÏûÖÍ∏à Í≥†Í∞ù (",c.length,"Î™Ö)"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-red-500",children:"Ï¥ù ÎØ∏ÏàòÍ∏à"}),e.jsxs("p",{className:"font-bold text-red-700 text-lg",children:[c.reduce((d,s)=>d+s.unpaidAmount,0).toLocaleString(),"ÎßåÏõê"]})]})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2 scrollbar-hide",children:c.map(d=>{var s;return e.jsxs("div",{className:"min-w-[240px] bg-white p-4 rounded-lg border border-red-200 shadow-sm flex-shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"font-bold text-gray-800",children:d.customerName}),e.jsxs("span",{className:"px-2 py-0.5 bg-red-100 text-red-600 text-xs rounded-full font-bold",children:["+",d.overdueDays,"ÏùºÏß∏"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"ÎØ∏ÎÇ©Ïï°"}),e.jsxs("span",{className:"font-bold text-red-600",children:[d.unpaidAmount.toLocaleString(),"ÎßåÏõê"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"ÏßÑÌñâÏÉÅÌÉú"}),e.jsx("span",{className:"text-gray-700",children:d.status})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 flex justify-between items-center",children:e.jsxs("p",{className:"text-xs text-gray-400",children:["ÎßàÏßÄÎßâ: ",(s=d.depositHistory)!=null&&s.length?"ÏûÖÍ∏à":"Í≥ÑÏïΩ","Ïùº Í∏∞Ï§Ä"]})})]},d.caseId)})})]})})(),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 h-80 flex flex-col",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-700 mb-4 flex-shrink-0",children:"üìä ÏõîÎ≥Ñ ÏàòÏùµ ÌòÑÌô©"}),e.jsx("div",{className:"flex-1 min-h-0 w-full",children:e.jsx(be,{width:"100%",height:"100%",children:e.jsxs(Ve,{data:ot,children:[e.jsx(Ke,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Ge,{dataKey:"name"}),e.jsx(Ze,{}),e.jsx(ye,{formatter:t=>[`${t.toLocaleString()}ÎßåÏõê`,""]}),e.jsx(wt,{}),e.jsx(de,{dataKey:"actualDeposit",fill:"#10b981",name:"Ïã§Ï†úÏûÖÍ∏à",radius:[4,4,0,0]}),e.jsx(de,{dataKey:"paidCommission",fill:"#ef4444",name:"ÏßÄÍ∏âÏàòÏàòÎ£å",radius:[4,4,0,0]}),e.jsx(zs,{type:"monotone",dataKey:"netProfit",stroke:"#3b82f6",strokeWidth:2,name:"ÏàúÏàòÏùµ (ÏûÖÍ∏à-ÏßÄÍ∏â)",dot:{r:4}})]})})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:e.jsx("h3",{className:"font-bold text-gray-700",children:"üìÖ ÏõîÎ≥Ñ ÏÉÅÏÑ∏ ÏöîÏïΩ"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-3 text-center",children:"Ïõî"}),e.jsx("th",{className:"py-3 px-3 text-center",children:"Í±¥Ïàò"}),e.jsx("th",{className:"py-3 px-3 text-right",children:"Îß§Ï∂ú"}),e.jsx("th",{className:"py-3 px-3 text-right text-green-600",children:"ÏûÖÍ∏àÏï°"}),e.jsx("th",{className:"py-3 px-3 text-right text-blue-600",children:"Ï¥ùÏàòÏàòÎ£å"}),e.jsx("th",{className:"py-3 px-3 text-right text-green-600",children:"ÏßÄÍ∏âÏôÑÎ£å"}),e.jsx("th",{className:"py-3 px-3 text-right text-orange-600",children:"ÎØ∏ÏßÄÍ∏â"})]})}),e.jsxs("tbody",{children:[ot.map((t,l)=>e.jsxs("tr",{className:`border-b border-gray-50 last:border-0 hover:bg-gray-50 ${S===l+1?"bg-blue-50":""}`,children:[e.jsx("td",{className:"py-3 px-3 font-medium text-center",children:t.name}),e.jsx("td",{className:"py-3 px-3 text-center text-gray-500",children:t.count}),e.jsxs("td",{className:"py-3 px-3 text-right text-gray-700",children:[t.revenue.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-green-600 font-medium",children:[t.actualDeposit.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-blue-600",children:[t.commission.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-green-600 font-bold",children:[t.paidCommission.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-orange-600",children:[t.unpaidCommission.toLocaleString(),"ÎßåÏõê"]})]},l)),e.jsxs("tr",{className:"bg-gray-100 font-bold border-t-2 border-gray-300",children:[e.jsx("td",{className:"py-3 px-3 text-center",children:"Ìï©Í≥Ñ"}),e.jsx("td",{className:"py-3 px-3 text-center",children:Ce}),e.jsxs("td",{className:"py-3 px-3 text-right text-gray-700",children:[Ue.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-green-600",children:[rt.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-blue-600",children:[_e.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-green-600",children:[q.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-orange-600",children:[nt.toLocaleString(),"ÎßåÏõê"]})]})]})]})})]}),J&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-white",children:[e.jsx("h3",{className:"font-bold text-gray-700",children:"ü§ù ÌååÌä∏ÎÑàÎ≥Ñ ÏÑ±Í≥º Î∂ÑÏÑù"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ÌååÌä∏ÎÑàÎ≥Ñ ÏàòÏûÑ Í±¥Ïàò Î∞è ÏàòÏàòÎ£å ÏßÄÍ∏â ÌòÑÌô©"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-3 text-left",children:"ÌååÌä∏ÎÑàÎ™Ö"}),e.jsx("th",{className:"py-3 px-3 text-center",children:"Í±¥Ïàò"}),e.jsx("th",{className:"py-3 px-3 text-right",children:"Ï¥ù ÏàòÏûÑÎ£å"}),e.jsx("th",{className:"py-3 px-3 text-right text-blue-600",children:"ÏßÄÍ∏â ÏôÑÎ£å"}),e.jsx("th",{className:"py-3 px-3 text-right text-orange-600",children:"ÎØ∏ÏßÄÍ∏â"}),e.jsx("th",{className:"py-3 px-3 text-right",children:"ÏßÄÍ∏âÎ•†"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:b.map(t=>{const l=z.filter(x=>x.partnerId===t.partnerId);if(l.length===0)return null;const c=l.length,d=l.reduce((x,a)=>x+(a.contractFee||0),0),s=l.reduce((x,a)=>x+ue(a).paidCommission,0),r=l.reduce((x,a)=>x+Se(a),0),n=r-s,i=r>0?Math.round(s/r*100):0;return{p:t,count:c,revenue:d,paid:s,unpaid:n,rate:i}}).filter(t=>t!==null).sort((t,l)=>((l==null?void 0:l.revenue)||0)-((t==null?void 0:t.revenue)||0)).map((t,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"py-3 px-3 font-medium text-gray-800",children:[l+1,". ",t.p.name]}),e.jsxs("td",{className:"py-3 px-3 text-center",children:[t.count,"Í±¥"]}),e.jsxs("td",{className:"py-3 px-3 text-right font-bold",children:[t.revenue.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-blue-600",children:[t.paid.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-orange-600",children:[t.unpaid.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-right text-gray-500",children:[t.rate,"%"]})]},t.p.partnerId))})]})})]}),(()=>{const t=new Date,l=t.toISOString().split("T")[0],c=[];z.filter(a=>a.partnerId===v).forEach(a=>{if(!a.depositHistory||a.depositHistory.length===0||!I)return;jt(I,a.contractFee||0);let m=0;a.depositHistory.forEach((o,g)=>{if(!o.date||o.date<=l){m+=o.amount||0;return}const j=(I==null?void 0:I.commissionRules)||[],y=I==null?void 0:I.settlementConfig,E=a.depositHistory.filter((mt,pa)=>mt.date&&mt.date<=l),_={...a,depositHistory:E},w=Nt(_,j,y).payable;m+=o.amount||0;const k={...a,depositHistory:a.depositHistory.slice(0,g+1)},G=Nt(k,j,y),le=Math.max(0,G.payable-w),oe=new Date(o.date),F=oe.getDay(),V=new Date(oe);V.setDate(V.getDate()+(7-F)),V.setDate(V.getDate()+2),c.push({caseId:a.caseId,customerName:a.customerName,depositDate:o.date,amount:o.amount||0,depositNumber:g+1,contractFee:a.contractFee||0,totalDeposited:m,expectedPayout:le,payoutDate:V.toISOString().split("T")[0]})})}),c.sort((a,m)=>a.depositDate.localeCompare(m.depositDate));const s=new Date(t);s.setDate(s.getDate()+60);const r=s.toISOString().split("T")[0],n=c.filter(a=>a.depositDate<=r),i=n.reduce((a,m)=>a+m.amount,0),x=n.reduce((a,m)=>a+m.expectedPayout,0);return n.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"üîÆ"}),e.jsx("h3",{className:"font-bold text-gray-700",children:"ÎØ∏Îûò ÏûÖÍ∏à/ÏßÄÍ∏â ÏòàÏ∏°"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Ìñ•ÌõÑ 60Ïùº ÎÇ¥ ÏòàÏ†ïÎêú ÏûÖÍ∏àÏù¥ ÏóÜÏäµÎãàÎã§."})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-amber-50 to-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üîÆ"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700",children:"ÎØ∏Îûò ÏûÖÍ∏à/ÏßÄÍ∏â ÏòàÏ∏°"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ìñ•ÌõÑ 60Ïùº ÎÇ¥ ÏòàÏ†ïÎêú ÏûÖÍ∏àÍ≥º ÏàòÏàòÎ£å ÏßÄÍ∏â ÏùºÏ†ï"})]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"ÏòàÏÉÅ ÏûÖÍ∏à"}),e.jsxs("p",{className:"font-bold text-green-600",children:[i.toLocaleString(),"ÎßåÏõê"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"ÏòàÏÉÅ ÏßÄÍ∏â"}),e.jsxs("p",{className:"font-bold text-orange-600",children:[x.toLocaleString(),"ÎßåÏõê"]})]})]})]})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-3",children:n.map((a,m)=>e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex-shrink-0 text-center",children:[e.jsx("div",{className:"bg-blue-100 text-blue-700 px-3 py-1 rounded-lg font-bold text-sm",children:new Date(a.depositDate).toLocaleDateString("ko-KR",{month:"short",day:"numeric"})}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"ÏûÖÍ∏àÏòàÏ†ï"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-800",children:a.customerName}),e.jsxs("span",{className:"text-xs bg-blue-50 text-blue-600 px-2 py-0.5 rounded-full",children:[a.depositNumber,"Ï∞® ÏûÖÍ∏à"]})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["ÏàòÏûÑÎ£å ",a.contractFee,"ÎßåÏõê Ï§ë ÎàÑÏ†Å ",a.totalDeposited,"ÎßåÏõê ÏûÖÍ∏à"]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"font-bold text-green-600 text-lg",children:["+",a.amount.toLocaleString(),"ÎßåÏõê"]}),a.expectedPayout>0&&e.jsx("div",{className:"mt-1 text-xs",children:e.jsxs("span",{className:"text-orange-600",children:["‚Üí ",a.payoutDate.slice(5).replace("-","/")," ÏàòÏàòÎ£å ",a.expectedPayout,"ÎßåÏõê"]})})]})]},`${a.caseId}-${a.depositNumber}`))})})]})})(),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-indigo-50 to-white flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700",children:"üìã Ï£ºÍ∞Ñ Ï†ïÏÇ∞ Î∞∞Ïπò ÌòÑÌô©"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ÏµúÍ∑º Ï†ïÏÇ∞ Î∞∞ÏπòÎ≥Ñ ÏàòÍ∏à/ÏßÄÍ∏â/ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú ÏÉÅÌÉú"})]}),e.jsxs("button",{onClick:()=>{const t=Array.isArray(R)?R:[];if(t.length===0){u("ÎÇ¥Î≥¥ÎÇº Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.","error");return}const l=t.map(c=>{var d,s;return{Ï£ºÏ∞®:c.weekLabel,Í∏∞Í∞Ñ:`${c.startDate} ~ ${c.endDate}`,"ÏàòÏàòÎ£å(ÎßåÏõê)":c.totalCommission,ÏàòÍ∏àÏÉÅÌÉú:(d=c.collectionInfo)!=null&&d.collectedAt?`ÏôÑÎ£å (${c.collectionInfo.collectedAt})`:"ÎåÄÍ∏∞","ÌååÌä∏ÎÑà ÏßÄÍ∏â":(c.payoutItems||[]).length>0?(c.payoutItems||[]).map(r=>`${r.partnerName}(${r.amount}ÎßåÏõê)`).join(", "):"ÏóÜÏùå",ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú:(s=c.purchaseInvoice)!=null&&s.receivedAt?`ÏàòÏ∑® (${c.purchaseInvoice.receivedAt})`:"ÎØ∏ÏàòÏ∑®",ÏÉÅÌÉú:Le(c.status)}});ma(`Ï†ïÏÇ∞ÎÇ¥Ïó≠_${new Date().toISOString().split("T")[0]}`,l),u("ÏóëÏÖÄ ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§.","success")},className:"flex items-center gap-1.5 px-3 py-1.5 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors",children:[e.jsx(Ys,{size:16}),"ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-3 text-left",children:"Ï£ºÏ∞®"}),e.jsx("th",{className:"py-3 px-3 text-right",children:"ÏàòÏàòÎ£å"}),e.jsx("th",{className:"py-3 px-3 text-center",children:"ÏàòÍ∏à"}),e.jsx("th",{className:"py-3 px-3 text-center",children:"ÌååÌä∏ÎÑà ÏßÄÍ∏â"}),e.jsx("th",{className:"py-3 px-3 text-center",children:"Îß§ÏûÖÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú"}),e.jsx("th",{className:"py-3 px-3 text-center",children:"ÏÉÅÌÉú"})]})}),e.jsx("tbody",{children:(Array.isArray(R)?R:[]).slice(0,8).map(t=>{var s,r,n;const l=(t.payoutItems||[]).length,c=(t.payoutItems||[]).filter(i=>i.paidAt).length,d=(t.payoutItems||[]).reduce((i,x)=>i+(x.amount||0),0);return e.jsxs("tr",{className:"border-b border-gray-50 last:border-0 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-3 font-medium",children:t.weekLabel}),e.jsxs("td",{className:"py-3 px-3 text-right font-bold text-blue-600",children:[t.totalCommission.toLocaleString(),"ÎßåÏõê"]}),e.jsx("td",{className:"py-3 px-3 text-center",children:(s=t.collectionInfo)!=null&&s.collectedAt?e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:["‚úì ",(r=t.collectionInfo.amount)==null?void 0:r.toLocaleString(),"ÎßåÏõê"]}):e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-500 rounded-full text-xs",children:"ÎåÄÍ∏∞"})}),e.jsx("td",{className:"py-3 px-3 text-center",children:l>0?e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c===l?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:[c,"/",l,"Í±¥ (",d,"ÎßåÏõê)"]}):e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-400 rounded-full text-xs",children:"ÏóÜÏùå"})}),e.jsx("td",{className:"py-3 px-3 text-center",children:(n=t.purchaseInvoice)!=null&&n.receivedAt?e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:"‚úì ÏàòÏ∑®ÏôÑÎ£å"}):e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-500 rounded-full text-xs",children:"ÎØ∏ÏàòÏ∑®"})}),e.jsx("td",{className:"py-3 px-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium
                                                ${t.status==="completed"?"bg-green-100 text-green-700":t.status==="paid"?"bg-blue-100 text-blue-700":t.status==="collected"?"bg-teal-100 text-teal-700":"bg-gray-100 text-gray-600"}`,children:Le(t.status)})})]},t.batchId)})})]})})]}),(()=>{const t=Array.isArray(R)?R:[],l={};t.forEach(d=>{(d.payoutItems||[]).forEach(s=>{const r=s.partnerName||"ÎØ∏ÏßÄÏ†ï";l[r]||(l[r]={total:0,paid:0,count:0}),l[r].total+=s.amount||0,l[r].count+=1,s.paidAt&&(l[r].paid+=s.amount||0)})});const c=Object.entries(l).sort((d,s)=>s[1].total-d[1].total);return c.length===0?null:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-green-50 to-white",children:[e.jsx("h3",{className:"font-bold text-gray-700",children:"üí≥ ÌååÌä∏ÎÑàÎ≥Ñ ÏßÄÍ∏â ÌòÑÌô©"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ï†ÑÏ≤¥ Ï†ïÏÇ∞ Í∏∞Í∞Ñ ÌååÌä∏ÎÑà ÏßÄÍ∏â ÎàÑÍ≥Ñ"})]}),e.jsx("div",{className:"p-4 grid gap-3",children:c.map(([d,s])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üè¢"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:d}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.count,"Í±¥"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-green-600",children:[s.paid.toLocaleString(),"ÎßåÏõê ",e.jsx("span",{className:"text-gray-400 font-normal",children:"ÏßÄÍ∏â"})]}),s.total>s.paid&&e.jsxs("p",{className:"text-xs text-orange-600",children:[(s.total-s.paid).toLocaleString(),"ÎßåÏõê ÎØ∏ÏßÄÍ∏â"]})]})]},d))})]})})(),at>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-red-700",children:["Í≥ÑÏïΩÏùº ÎàÑÎùΩ: ",at,"Í±¥"]}),e.jsx("p",{className:"text-sm text-red-600",children:"Í≥ÑÏïΩÏùºÏù¥ ÏóÜÎäî Í±¥ÏùÄ Ï†ïÏÇ∞ ÏßëÍ≥ÑÏóêÏÑú Ï†úÏô∏Îê©ÎãàÎã§."})]})]}),e.jsx(xa,{batches:R}),(()=>{const[t,l]=Ae.useState(!1),[c,d]=Ae.useState(null),[s,r]=Ae.useState({date:"",amount:0,description:"",category:"Í∏∞ÌÉÄÏßÄÏ∂ú"}),n=Ae.useRef(null),i=async a=>{var o;const m=(o=a.target.files)==null?void 0:o[0];if(m){l(!0),d(null);try{const{imageToBase64:g,resizeImage:j,analyzeReceiptImage:y,hasGoogleApiKey:E,setGoogleApiKey:_}=await bt(async()=>{const{imageToBase64:G,resizeImage:le,analyzeReceiptImage:oe,hasGoogleApiKey:F,setGoogleApiKey:V}=await import("./visionService.DcQZK72v.js");return{imageToBase64:G,resizeImage:le,analyzeReceiptImage:oe,hasGoogleApiKey:F,setGoogleApiKey:V}},[]);if(!E()){const G=prompt("Google Vision API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî:");if(G)_(G);else{l(!1);return}}const A=await g(m),w=await j(A),k=await y(w);d(k),k.success&&k.parsed&&r({date:k.parsed.date||new Date().toISOString().split("T")[0],amount:k.parsed.amount||0,description:k.parsed.storeName||"",category:"Í∏∞ÌÉÄÏßÄÏ∂ú"})}catch(g){console.error("OCR Error:",g),d({success:!1,rawText:"",parsed:{date:null,amount:null,storeName:null,items:[]},error:"OCR Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§."})}finally{l(!1),n.current&&(n.current.value="")}}},x=async()=>{if(!s.amount||!s.date){alert("ÎÇ†ÏßúÏôÄ Í∏àÏï°ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.");return}try{const{createExpense:a}=await bt(async()=>{const{createExpense:m}=await import("./index.B6L--SUM.js").then(o=>o.b1);return{createExpense:m}},__vite__mapDeps([0,1]));await a({date:s.date,amount:s.amount,category:s.category,description:s.description,ocrText:(c==null?void 0:c.rawText)||""}),alert("ÏßÄÏ∂úÏù¥ Îì±Î°ùÎêòÏóàÏäµÎãàÎã§!"),d(null),r({date:"",amount:0,description:"",category:"Í∏∞ÌÉÄÏßÄÏ∂ú"}),window.location.reload()}catch(a){console.error("Save expense error:",a),alert("ÏßÄÏ∂ú Îì±Î°ù Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.")}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cyan-100 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-cyan-100 bg-gradient-to-r from-cyan-50 to-teal-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-cyan-700 flex items-center gap-2",children:"üì∑ ÏòÅÏàòÏ¶ù Ïä§Ï∫î (OCR)"}),e.jsx("p",{className:"text-xs text-cyan-500 mt-1",children:"ÏòÅÏàòÏ¶ù ÏÇ¨ÏßÑÏùÑ ÏóÖÎ°úÎìúÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú ÎÇ†Ïßú, Í∏àÏï°ÏùÑ Ï∂îÏ∂úÌï©ÎãàÎã§"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:n,type:"file",accept:"image/*",capture:"environment",onChange:i,className:"hidden",id:"receipt-upload"}),e.jsx("label",{htmlFor:"receipt-upload",className:`px-4 py-2 rounded-lg cursor-pointer flex items-center gap-2 ${t?"bg-gray-300 cursor-not-allowed":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"‚è≥"}),"Î∂ÑÏÑù Ï§ë..."]}):e.jsx(e.Fragment,{children:"üì∑ ÏòÅÏàòÏ¶ù Ï¥¨ÏòÅ/ÏóÖÎ°úÎìú"})})]})]})}),e.jsxs("div",{className:"p-4",children:[c&&!c.success&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("p",{className:"text-red-700",children:["‚ùå ",c.error]})}),c&&c.success&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsx("p",{className:"text-green-700 text-sm",children:"‚úÖ ÏòÅÏàòÏ¶ù Î∂ÑÏÑù ÏôÑÎ£å! ÏïÑÎûò Ï†ïÎ≥¥Î•º ÌôïÏù∏ ÌõÑ Ï†ÄÏû•Ìï¥Ï£ºÏÑ∏Ïöî."})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ÎÇ†Ïßú"}),e.jsx("input",{type:"date",value:s.date,onChange:a=>r(m=>({...m,date:a.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Í∏àÏï° (Ïõê)"}),e.jsx("input",{type:"number",value:s.amount,onChange:a=>r(m=>({...m,amount:parseInt(a.target.value)||0})),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ÏÉÅÌò∏/ÎÇ¥Ïö©"}),e.jsx("input",{type:"text",value:s.description,onChange:a=>r(m=>({...m,description:a.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"ÏÉÅÌò∏Î™Ö ÎòêÎäî ÎÇ¥Ïö©"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ïπ¥ÌÖåÍ≥†Î¶¨"}),e.jsxs("select",{value:s.category,onChange:a=>r(m=>({...m,category:a.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"Í¥ëÍ≥†ÎπÑ",children:"Í¥ëÍ≥†ÎπÑ"}),e.jsx("option",{value:"ÎßàÏºÄÌåÖÎπÑ",children:"ÎßàÏºÄÌåÖÎπÑ"}),e.jsx("option",{value:"ÏÇ¨Î¨¥ÎπÑÏö©",children:"ÏÇ¨Î¨¥ÎπÑÏö©"}),e.jsx("option",{value:"Ïù∏Í±¥ÎπÑ",children:"Ïù∏Í±¥ÎπÑ"}),e.jsx("option",{value:"ÍµêÌÜµÎπÑ",children:"ÍµêÌÜµÎπÑ"}),e.jsx("option",{value:"ÏãùÎåÄ",children:"ÏãùÎåÄ"}),e.jsx("option",{value:"Í∏∞ÌÉÄÏßÄÏ∂ú",children:"Í∏∞ÌÉÄÏßÄÏ∂ú"})]})]})]}),e.jsxs("details",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("summary",{className:"text-sm text-gray-600 cursor-pointer",children:"üìÑ Ïù∏ÏãùÎêú ÏõêÎ≥∏ ÌÖçÏä§Ìä∏ Î≥¥Í∏∞"}),e.jsx("pre",{className:"mt-2 text-xs text-gray-500 whitespace-pre-wrap max-h-40 overflow-y-auto",children:c.rawText})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:x,className:"flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700",children:"üíæ ÏßÄÏ∂ú Ï†ÄÏû•"}),e.jsx("button",{onClick:()=>{d(null),r({date:"",amount:0,description:"",category:"Í∏∞ÌÉÄÏßÄÏ∂ú"})},className:"px-4 bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300",children:"Ï∑®ÏÜå"})]})]}),!c&&!t&&e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx("span",{className:"text-4xl block mb-2",children:"üì∑"}),e.jsx("p",{children:"ÏòÅÏàòÏ¶ù ÏÇ¨ÏßÑÏùÑ ÏóÖÎ°úÎìúÌïòÎ©¥ AIÍ∞Ä ÏûêÎèôÏúºÎ°ú Î∂ÑÏÑùÌï©ÎãàÎã§"}),e.jsx("p",{className:"text-xs mt-1",children:"ÏßÄÏõê ÌòïÏãù: JPG, PNG (ÏµúÎåÄ 4MB)"})]})]})]})})()]}),dt={Í¥ëÍ≥†ÎπÑ:"#ef4444",ÎßàÏºÄÌåÖÎπÑ:"#f97316",ÏÇ¨Î¨¥ÎπÑÏö©:"#eab308",Ïù∏Í±¥ÎπÑ:"#22c55e",ÍµêÌÜµÎπÑ:"#3b82f6",ÏãùÎåÄ:"#8b5cf6",Í∏∞ÌÉÄ:"#6b7280"},rs=async()=>{if(!H.amount||!H.description){u("Í∏àÏï°Í≥º ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.","error");return}ve?(await js(ve.id,H),u("ÏßÄÏ∂úÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§.","success")):(await Ns({...H,partnerId:v!=="all"?v:void 0}),u("ÏßÄÏ∂úÏù¥ Îì±Î°ùÎêòÏóàÏäµÎãàÎã§.","success"));const[t,l]=await Promise.all([ze(v,f),Ye(f,S,v)]);me(t),Me(l),pe(!1),he(null),ee({category:"Í¥ëÍ≥†ÎπÑ",amount:0,description:"",date:new Date().toISOString().split("T")[0]})},ns=async t=>{if(!confirm("Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?"))return;await Is(t),u("ÏßÄÏ∂úÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.","success");const[l,c]=await Promise.all([ze(v,f),Ye(f,S,v)]);me(l),Me(c)},ls=t=>{he(t),ee({date:t.date,category:t.category,amount:t.amount,description:t.description,memo:t.memo}),pe(!0)},os=()=>{const l=q-0-B.total,c=S==="all"?B.total:K.filter(s=>s.date&&s.date.startsWith(`${f}-${String(S).padStart(2,"0")}`)).reduce((s,r)=>s+(r.amount||0),0),d=Object.entries(B.byCategory).filter(([s,r])=>r>0).map(([s,r])=>({name:s,value:r,color:dt[s]}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-white p-5 rounded-xl shadow-sm border border-green-200",children:[e.jsx("p",{className:"text-sm text-green-700",children:"üíµ Î∞õÏùÄ ÏàòÏàòÎ£å"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 mt-1",children:[q.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("p",{className:"text-xs text-green-500 mt-1",children:[f,"ÎÖÑ ÎàÑÏ†Å"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-white p-5 rounded-xl shadow-sm border border-red-200",children:[e.jsx("p",{className:"text-sm text-red-700",children:"üí∏ Ï¥ù ÏßÄÏ∂ú"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600 mt-1",children:[B.total.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("p",{className:"text-xs text-red-500 mt-1",children:[S==="all"?"Ï†ÑÏ≤¥ Ïõî":`${S}Ïõî`,": ",c.toLocaleString(),"ÎßåÏõê"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white p-5 rounded-xl shadow-sm border border-blue-200",children:[e.jsx("p",{className:"text-sm text-blue-700",children:"üìä Í¥ëÍ≥†ÎπÑ ÎπÑÏ§ë"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:[B.total>0?Math.round(B.byCategory.Í¥ëÍ≥†ÎπÑ/B.total*100):0,"%"]}),e.jsxs("p",{className:"text-xs text-blue-500 mt-1",children:[B.byCategory.Í¥ëÍ≥†ÎπÑ.toLocaleString(),"ÎßåÏõê"]})]}),e.jsxs("div",{className:`bg-gradient-to-br ${l>=0?"from-green-50 to-white border-green-200":"from-red-50 to-white border-red-200"} p-5 rounded-xl shadow-sm border`,children:[e.jsx("p",{className:`text-sm ${l>=0?"text-green-700":"text-red-700"}`,children:"üí∞ ÏàúÏù¥Ïùµ"}),e.jsxs("p",{className:`text-2xl font-bold mt-1 ${l>=0?"text-green-600":"text-red-600"}`,children:[l.toLocaleString(),"ÎßåÏõê"]}),e.jsx("p",{className:`text-xs mt-1 ${l>=0?"text-green-500":"text-red-500"}`,children:"ÏàòÏàòÎ£åÏàòÏùµ - ÏßÄÏ∂ú"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>{he(null),ee({category:"Í¥ëÍ≥†ÎπÑ",amount:0,description:"",date:new Date().toISOString().split("T")[0]}),pe(!0)},className:"bg-red-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-red-700 flex items-center gap-2",children:[e.jsx(Xe,{size:18})," ÏßÄÏ∂ú Îì±Î°ù"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-700 mb-4",children:"üìä Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÏßÄÏ∂ú"}),d.length>0?e.jsxs("div",{className:"flex items-center",children:[e.jsx(be,{width:"50%",height:200,children:e.jsxs(St,{children:[e.jsx(It,{data:d,cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"value",children:d.map((s,r)=>e.jsx(Ct,{fill:s.color},`cell-${r}`))}),e.jsx(ye,{formatter:s=>[`${Number(s).toLocaleString()}ÎßåÏõê`,""]})]})}),e.jsx("div",{className:"flex-1 space-y-2",children:d.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),e.jsx("span",{children:s.name})]}),e.jsxs("span",{className:"font-medium",children:[s.value.toLocaleString(),"ÎßåÏõê"]})]},r))})]}):e.jsx("div",{className:"h-48 flex items-center justify-center text-gray-400",children:"ÏßÄÏ∂ú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-700 mb-4",children:"üìà ÏõîÎ≥Ñ ÏßÄÏ∂ú Ï∂îÏù¥"}),e.jsx(be,{width:"100%",height:200,children:e.jsxs(Ve,{data:B.byMonth,children:[e.jsx(Ke,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Ge,{dataKey:"month"}),e.jsx(Ze,{}),e.jsx(ye,{formatter:s=>[`${s.toLocaleString()}ÎßåÏõê`,"ÏßÄÏ∂ú"]}),e.jsx(de,{dataKey:"amount",fill:"#ef4444",radius:[4,4,0,0]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-gray-700",children:"üìã ÏßÄÏ∂ú ÎÇ¥Ïó≠"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[K.length,"Í±¥"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-3 text-left",children:"ÎÇ†Ïßú"}),e.jsx("th",{className:"py-3 px-3 text-left",children:"Ïπ¥ÌÖåÍ≥†Î¶¨"}),e.jsx("th",{className:"py-3 px-3 text-left",children:"ÎÇ¥Ïö©"}),e.jsx("th",{className:"py-3 px-3 text-right",children:"Í∏àÏï°"}),e.jsx("th",{className:"py-3 px-3 text-center",children:"Í¥ÄÎ¶¨"})]})}),e.jsx("tbody",{children:X?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-8 text-center text-gray-400",children:"Î°úÎî©Ï§ë..."})}):K.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-8 text-center text-gray-400",children:"Îì±Î°ùÎêú ÏßÄÏ∂úÏù¥ ÏóÜÏäµÎãàÎã§"})}):K.slice(0,20).map(s=>e.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-3 text-gray-600",children:s.date}),e.jsx("td",{className:"py-3 px-3",children:e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium text-white",style:{backgroundColor:dt[s.category]},children:s.category})}),e.jsxs("td",{className:"py-3 px-3 text-gray-800",children:[s.description,s.memo&&e.jsxs("span",{className:"text-gray-400 ml-2 text-xs",children:["(",s.memo,")"]})]}),e.jsxs("td",{className:"py-3 px-3 text-right font-bold text-red-600",children:[s.amount.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-3 px-3 text-center",children:[e.jsx("button",{onClick:()=>ls(s),className:"text-blue-600 hover:text-blue-700 mr-2",children:"ÏàòÏ†ï"}),e.jsx("button",{onClick:()=>ns(s.id),className:"text-red-500 hover:text-red-700",children:e.jsx(Dt,{size:14})})]})]},s.id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-indigo-50 to-blue-50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-indigo-700",children:"üè¶ ÏùÄÌñâ Í±∞ÎûòÎÇ¥Ïó≠ ÏóÖÎ°úÎìú"}),e.jsx("p",{className:"text-xs text-indigo-500 mt-1",children:"Ïπ¥Ïπ¥Ïò§Î±ÖÌÅ¨, ÏºÄÏù¥Î±ÖÌÅ¨ ÏóëÏÖÄ ÌååÏùº ÏßÄÏõê"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:ge,type:"file",accept:".xlsx,.xls",onChange:Rt,className:"hidden",id:"bank-file-upload"}),e.jsx("label",{htmlFor:"bank-file-upload",className:`px-4 py-2 rounded-lg font-medium cursor-pointer flex items-center gap-2 ${et?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:et?e.jsx(e.Fragment,{children:"‚è≥ ÏóÖÎ°úÎìú Ï§ë..."}):e.jsxs(e.Fragment,{children:[e.jsx(Xe,{size:18})," ÏóëÏÖÄ ÏóÖÎ°úÎìú"]})})]})]}),e.jsx("div",{className:"overflow-x-auto max-h-96",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-3 text-left",children:"ÏùºÏãú"}),e.jsx("th",{className:"py-3 px-3 text-left",children:"ÏùÄÌñâ"}),e.jsx("th",{className:"py-3 px-3 text-left",children:"ÏÉÅÎåÄÎ∞©"}),e.jsx("th",{className:"py-3 px-3 text-left",children:"Î∂ÑÎ•ò"}),e.jsx("th",{className:"py-3 px-3 text-right",children:"Í∏àÏï°"})]})}),e.jsx("tbody",{children:Mt?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-8 text-center text-gray-400",children:"Î°úÎî©Ï§ë..."})}):$.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-8 text-center text-gray-400",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üì§"}),e.jsx("span",{children:"ÏùÄÌñâ Í±∞ÎûòÎÇ¥Ïó≠ ÏóëÏÖÄ ÌååÏùºÏùÑ ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî"})]})})}):$.filter(s=>{if(S==="all")return!0;const r=String(S).padStart(2,"0");return s.date.substring(5,7)===r}).slice(0,50).map(s=>e.jsxs("tr",{className:`border-b border-gray-50 hover:bg-gray-50 ${!s.isVerified&&s.category.includes("Í∏∞ÌÉÄ")?"bg-yellow-50":""}`,children:[e.jsx("td",{className:"py-2 px-3 text-gray-600 text-xs",children:s.datetime}),e.jsx("td",{className:"py-2 px-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${s.bank==="kakao"?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"}`,children:s.bank==="kakao"?"Ïπ¥Ïπ¥Ïò§":"ÏºÄÏù¥"})}),e.jsx("td",{className:"py-2 px-3 text-gray-800",children:s.counterparty||s.description}),e.jsx("td",{className:"py-2 px-3",children:e.jsx("select",{value:s.category,onChange:r=>Ot(s.id,r.target.value),className:`text-xs border rounded px-2 py-1 ${s.type==="income"?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:vs.filter(r=>s.type==="income"?["ÏàòÏàòÎ£åÏàòÏûÖ","Ïù¥Ïûê","Í∏∞ÌÉÄÏàòÏûÖ"].includes(r):!["ÏàòÏàòÎ£åÏàòÏûÖ","Ïù¥Ïûê","Í∏∞ÌÉÄÏàòÏûÖ"].includes(r)).map(r=>e.jsx("option",{value:r,children:r},r))})}),e.jsxs("td",{className:`py-2 px-3 text-right font-bold ${s.type==="income"?"text-green-600":"text-red-600"}`,children:[s.type==="income"?"+":"-",s.amount.toLocaleString(),"Ïõê"]})]},s.id))})]})}),$.length>0&&e.jsxs("div",{className:"p-3 bg-gray-50 border-t border-gray-100 flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Ï¥ù ",$.length,"Í±¥"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("span",{className:"text-green-600",children:["ÏûÖÍ∏à: +",$.filter(s=>s.type==="income").reduce((s,r)=>s+r.amount,0).toLocaleString(),"Ïõê"]}),e.jsxs("span",{className:"text-red-600",children:["Ï∂úÍ∏à: -",$.filter(s=>s.type==="expense").reduce((s,r)=>s+r.amount,0).toLocaleString(),"Ïõê"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-purple-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-purple-100 bg-gradient-to-r from-purple-50 to-indigo-50",children:[e.jsx("h3",{className:"font-bold text-purple-700 flex items-center gap-2",children:"üìä ÏÑ∏Í∏à Í≥ÑÏÇ∞ ÎèÑÏö∞ÎØ∏ (Í∞úÏù∏ÏÇ¨ÏóÖÏûê)"}),e.jsxs("p",{className:"text-xs text-purple-500 mt-1",children:[f,"ÎÖÑ Í∏∞Ï§Ä ÏòàÏÉÅ ÏÑ∏Í∏à Í≥ÑÏÇ∞"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-100",children:[e.jsx("p",{className:"text-xs text-green-600",children:"Ï¥ù ÏàòÏûÖ"}),e.jsxs("p",{className:"text-lg font-bold text-green-700",children:[(q*1e4+$.filter(s=>s.type==="income"&&s.category!=="Ïù¥Ïûê").reduce((s,r)=>s+r.amount,0)).toLocaleString(),"Ïõê"]}),e.jsx("p",{className:"text-[10px] text-green-500",children:"ÏàòÏàòÎ£å + Í∏∞ÌÉÄÏàòÏûÖ"})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100",children:[e.jsx("p",{className:"text-xs text-red-600",children:"ÌïÑÏöîÍ≤ΩÎπÑ"}),e.jsxs("p",{className:"text-lg font-bold text-red-700",children:[(B.total*1e4+$.filter(s=>s.type==="expense"&&!["Ïù¥Ï≤¥","Í∏∞ÌÉÄÏßÄÏ∂ú"].includes(s.category)).reduce((s,r)=>s+r.amount,0)).toLocaleString(),"Ïõê"]}),e.jsx("p",{className:"text-[10px] text-red-500",children:"Í¥ëÍ≥†ÎπÑ, ÏÇ¨Î¨¥ÎπÑ Îì±"})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"text-xs text-blue-600",children:"ÏÜåÎìùÍ∏àÏï°"}),e.jsxs("p",{className:"text-lg font-bold text-blue-700",children:[(()=>{const s=q*1e4+$.filter(n=>n.type==="income"&&n.category!=="Ïù¥Ïûê").reduce((n,i)=>n+i.amount,0),r=B.total*1e4+$.filter(n=>n.type==="expense"&&!["Ïù¥Ï≤¥","Í∏∞ÌÉÄÏßÄÏ∂ú"].includes(n.category)).reduce((n,i)=>n+i.amount,0);return(s-r).toLocaleString()})(),"Ïõê"]}),e.jsx("p",{className:"text-[10px] text-blue-500",children:"ÏàòÏûÖ - ÌïÑÏöîÍ≤ΩÎπÑ"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-100",children:[e.jsx("p",{className:"text-xs text-purple-600",children:"ÏòàÏÉÅ Ï¢ÖÌï©ÏÜåÎìùÏÑ∏"}),e.jsxs("p",{className:"text-lg font-bold text-purple-700",children:[(()=>{const s=q*1e4+$.filter(x=>x.type==="income"&&x.category!=="Ïù¥Ïûê").reduce((x,a)=>x+a.amount,0),r=B.total*1e4+$.filter(x=>x.type==="expense"&&!["Ïù¥Ï≤¥","Í∏∞ÌÉÄÏßÄÏ∂ú"].includes(x.category)).reduce((x,a)=>x+a.amount,0),n=Math.max(0,s-r);let i=0;return n<=14e6?i=n*.06:n<=5e7?i=84e4+(n-14e6)*.15:n<=88e6?i=624e4+(n-5e7)*.24:n<=15e7?i=1536e4+(n-88e6)*.35:n<=3e8?i=3706e4+(n-15e7)*.38:n<=5e8?i=9406e4+(n-3e8)*.4:i=17406e4+(n-5e8)*.45,Math.round(i).toLocaleString()})(),"Ïõê"]}),e.jsx("p",{className:"text-[10px] text-purple-500",children:"Ïã§Ï†ú ÏÑ∏Í∏àÏùÄ Îã§Î•º Ïàò ÏûàÏùå"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-3",children:"üìã ÏÑ∏Î¨¥ Î∂ÑÎ•òÎ≥Ñ ÏöîÏïΩ"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üì¢ Í¥ëÍ≥†ÎπÑ"}),e.jsxs("span",{className:"font-medium",children:[(B.byCategory.Í¥ëÍ≥†ÎπÑ*1e4+$.filter(s=>s.category==="Í¥ëÍ≥†ÎπÑ").reduce((s,r)=>s+r.amount,0)).toLocaleString(),"Ïõê"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üè¢ ÏÇ¨Î¨¥ÎπÑ"}),e.jsxs("span",{className:"font-medium",children:[(B.byCategory.ÏÇ¨Î¨¥ÎπÑÏö©*1e4+$.filter(s=>s.category==="ÏÇ¨Î¨¥ÎπÑ").reduce((s,r)=>s+r.amount,0)).toLocaleString(),"Ïõê"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üöó ÍµêÌÜµÎπÑ"}),e.jsxs("span",{className:"font-medium",children:[(B.byCategory.ÍµêÌÜµÎπÑ*1e4+$.filter(s=>s.category==="ÍµêÌÜµÎπÑ").reduce((s,r)=>s+r.amount,0)).toLocaleString(),"Ïõê"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üì± ÌÜµÏã†ÎπÑ"}),e.jsxs("span",{className:"font-medium",children:[(B.byCategory.ÌÜµÏã†ÎπÑ*1e4+$.filter(s=>s.category==="ÌÜµÏã†ÎπÑ").reduce((s,r)=>s+r.amount,0)).toLocaleString(),"Ïõê"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üçΩÔ∏è Ï†ëÎåÄÎπÑ"}),e.jsxs("span",{className:"font-medium",children:[(B.byCategory.Ï†ëÎåÄÎπÑ*1e4+$.filter(s=>s.category==="Ï†ëÎåÄÎπÑ").reduce((s,r)=>s+r.amount,0)).toLocaleString(),"Ïõê"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üì¶ Í∏∞ÌÉÄ"}),e.jsxs("span",{className:"font-medium",children:[(B.byCategory.Í∏∞ÌÉÄ*1e4+$.filter(s=>s.category==="Í∏∞ÌÉÄÏßÄÏ∂ú").reduce((s,r)=>s+r.amount,0)).toLocaleString(),"Ïõê"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>{const s=[[`${f}ÎÖÑ ÏÑ∏Î¨¥ Î≥¥Í≥†ÏÑú`,"","","",""],["","","","",""],["[ ÏàòÏûÖ ÎÇ¥Ïó≠ ]","","","",""],["ÎÇ†Ïßú","Íµ¨Î∂Ñ","Í±∞ÎûòÏ≤ò","Î∂ÑÎ•ò","Í∏àÏï°(Ïõê)"]];$.filter(o=>o.type==="income").sort((o,g)=>o.date.localeCompare(g.date)).forEach(o=>{s.push([o.date,"ÏûÖÍ∏à",o.counterparty||"",o.category,o.amount.toString()])}),s.push(["","","","",""]),s.push(["[ ÏßÄÏ∂ú ÎÇ¥Ïó≠ ]","","","",""]),s.push(["ÎÇ†Ïßú","Íµ¨Î∂Ñ","ÎÇ¥Ïö©","Î∂ÑÎ•ò","Í∏àÏï°(Ïõê)"]),K.forEach(o=>{s.push([o.date,"ÏßÄÏ∂ú",o.description,o.category,(o.amount*1e4).toString()])}),$.filter(o=>o.type==="expense").sort((o,g)=>o.date.localeCompare(g.date)).forEach(o=>{s.push([o.date,"Ï∂úÍ∏à",o.counterparty||o.description,o.category,o.amount.toString()])}),s.push(["","","","",""]),s.push(["[ ÏöîÏïΩ ]","","","",""]);const r=q*1e4+$.filter(o=>o.type==="income").reduce((o,g)=>o+g.amount,0),n=B.total*1e4+$.filter(o=>o.type==="expense").reduce((o,g)=>o+g.amount,0);s.push(["Ï¥ù ÏàòÏûÖ","","","",r.toString()]),s.push(["Ï¥ù ÏßÄÏ∂ú","","","",n.toString()]),s.push(["ÏÜåÎìùÍ∏àÏï°","","","",(r-n).toString()]);const i=s.map(o=>o.join(",")).join(`
`),x=new Blob(["\uFEFF"+i],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(x),m=document.createElement("a");m.href=a,m.download=`ÏÑ∏Î¨¥Î≥¥Í≥†ÏÑú_${f}ÎÖÑ.csv`,m.click(),URL.revokeObjectURL(a)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-700 flex items-center gap-2",children:"üì• ÏÑ∏Î¨¥Ïö© ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú"}),e.jsx("button",{onClick:()=>{const r=[["ÎÇ†Ïßú","ÏãúÍ∞Ñ","ÏùÄÌñâ","Íµ¨Î∂Ñ","ÏÉÅÎåÄÎ∞©","Î∂ÑÎ•ò","Í∏àÏï°","Î©îÎ™®"],...$.map(a=>[a.date,a.datetime.split(" ")[1]||"",a.bank==="kakao"?"Ïπ¥Ïπ¥Ïò§Î±ÖÌÅ¨":"ÏºÄÏù¥Î±ÖÌÅ¨",a.type==="income"?"ÏûÖÍ∏à":"Ï∂úÍ∏à",a.counterparty||"",a.category,a.amount.toString(),a.memo||""])].map(a=>a.join(",")).join(`
`),n=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),x=document.createElement("a");x.href=i,x.download=`ÏùÄÌñâÍ±∞ÎûòÎÇ¥Ïó≠_${f}ÎÖÑ.csv`,x.click(),URL.revokeObjectURL(i)},className:"bg-indigo-100 text-indigo-700 px-4 py-2 rounded-lg font-medium hover:bg-indigo-200 flex items-center gap-2",children:"üìÑ Í±∞ÎûòÎÇ¥Ïó≠Îßå Îã§Ïö¥Î°úÎìú"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"‚ö†Ô∏è Î≥∏ Í≥ÑÏÇ∞ÏùÄ Ï∞∏Í≥†Ïö©Ïù¥Î©∞, Ï†ïÌôïÌïú ÏÑ∏Í∏àÏùÄ ÏÑ∏Î¨¥ÏÇ¨ÏôÄ ÏÉÅÎã¥ÌïòÏÑ∏Ïöî."})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-teal-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-teal-100 bg-gradient-to-r from-teal-50 to-cyan-50",children:[e.jsx("h3",{className:"font-bold text-teal-700 flex items-center gap-2",children:"üßæ Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏ ÏòàÏÉÅÏï°"}),e.jsxs("p",{className:"text-xs text-teal-500 mt-1",children:[f,"ÎÖÑ Î∂ÑÍ∏∞Î≥Ñ Î∂ÄÍ∞ÄÏÑ∏ (10%)"]})]}),e.jsx("div",{className:"p-4",children:(()=>{const s=[1,2,3,4].map(n=>{const i=(n-1)*3+1,x=n*3,a=z.filter(w=>{const k=w.settledAt||w.contractAt;if(!k)return!1;const G=parseInt(k.substring(5,7));return parseInt(k.substring(0,4))===f&&G>=i&&G<=x}).reduce((w,k)=>w+(k.commission||0),0)*1e4,m=$.filter(w=>{if(w.type!=="income"||w.category==="Ïù¥Ïûê")return!1;const k=parseInt(w.date.substring(5,7));return k>=i&&k<=x}).reduce((w,k)=>w+k.amount,0),o=a+m,g=Math.round(o*.1),j=K.filter(w=>{if(!w.date)return!1;const k=parseInt(w.date.substring(5,7));return k>=i&&k<=x}).reduce((w,k)=>w+(k.amount||0)*1e4,0),y=$.filter(w=>{if(w.type!=="expense")return!1;const k=parseInt(w.date.substring(5,7));return k>=i&&k<=x}).reduce((w,k)=>w+k.amount,0),E=j+y,_=Math.round(E*.1),A=g-_;return{quarter:n,sales:o,purchase:E,outputVat:g,inputVat:_,vatPayable:A}}),r=s.reduce((n,i)=>n+Math.max(0,i.vatPayable),0);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:s.map(n=>e.jsxs("div",{className:`p-3 rounded-lg border ${n.vatPayable>0?"bg-teal-50 border-teal-200":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[n.quarter,"Î∂ÑÍ∏∞ (",(n.quarter-1)*3+1,"~",n.quarter*3,"Ïõî)"]}),e.jsxs("p",{className:"text-sm font-bold text-teal-700 mt-1",children:[n.vatPayable>0?"+":"",n.vatPayable.toLocaleString(),"Ïõê"]}),e.jsxs("div",{className:"text-[10px] text-gray-400 mt-1",children:[e.jsxs("div",{children:["Îß§Ï∂úÏÑ∏Ïï°: ",n.outputVat.toLocaleString()]}),e.jsxs("div",{children:["Îß§ÏûÖÏÑ∏Ïï°: -",n.inputVat.toLocaleString()]})]})]},n.quarter))}),e.jsxs("div",{className:"bg-teal-100 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-teal-700",children:"Ïó∞Í∞Ñ ÏòàÏÉÅ Î∂ÄÍ∞ÄÏÑ∏ ÎÇ©Î∂ÄÏï°"}),e.jsxs("span",{className:"text-xl font-bold text-teal-800",children:[r.toLocaleString(),"Ïõê"]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"üí° 1Ïõî, 7Ïõî: Î∂ÄÍ∞ÄÏÑ∏ ÌôïÏ†ïÏã†Í≥† / 4Ïõî, 10Ïõî: ÏòàÏ†ïÏã†Í≥†"})]})})()})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-orange-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-orange-100 bg-gradient-to-r from-orange-50 to-amber-50",children:[e.jsx("h3",{className:"font-bold text-orange-700 flex items-center gap-2",children:"üí∞ ÏõêÏ≤úÏßïÏàò Í≥ÑÏÇ∞Í∏∞"}),e.jsx("p",{className:"text-xs text-orange-500 mt-1",children:"ÌååÌä∏ÎÑà ÏßÄÍ∏â Ïãú 3.3% ÏõêÏ≤úÏÑ∏ ÏûêÎèô Í≥ÑÏÇ∞"})]}),e.jsx("div",{className:"p-4",children:(()=>{const s=b.map(n=>{const x=R.filter(o=>o.partnerId===n.partnerId&&(o.status==="paid"||o.status==="completed")).reduce((o,g)=>o+(g.totalPayableCommission||0),0)*1e4,a=Math.round(x*.033),m=x-a;return{partner:n,totalPayout:x,withholdingTax:a,netPayout:m}}).filter(n=>n.totalPayout>0),r=s.reduce((n,i)=>n+i.withholdingTax,0);return e.jsxs(e.Fragment,{children:[s.length===0?e.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"ÏßÄÍ∏â ÏôÑÎ£åÎêú Ï†ïÏÇ∞ Í±¥Ïù¥ ÏóÜÏäµÎãàÎã§."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-orange-50 text-orange-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-3 text-left",children:"ÌååÌä∏ÎÑà"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"ÏßÄÍ∏âÏï°"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"ÏõêÏ≤úÏÑ∏(3.3%)"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Ïã§ÏßÄÍ∏âÏï°"})]})}),e.jsx("tbody",{children:s.map(n=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-3",children:n.partner.name}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[n.totalPayout.toLocaleString(),"Ïõê"]}),e.jsxs("td",{className:"py-2 px-3 text-right text-red-600",children:["-",n.withholdingTax.toLocaleString(),"Ïõê"]}),e.jsxs("td",{className:"py-2 px-3 text-right font-bold",children:[n.netPayout.toLocaleString(),"Ïõê"]})]},n.partner.partnerId))})]})}),e.jsxs("div",{className:"bg-orange-100 p-3 rounded-lg flex justify-between items-center mt-3",children:[e.jsx("span",{className:"text-sm text-orange-700",children:"Îß§Ïõî 10ÏùºÍπåÏßÄ ÎÇ©Î∂ÄÌï† ÏõêÏ≤úÏÑ∏"}),e.jsxs("span",{className:"text-xl font-bold text-orange-800",children:[r.toLocaleString(),"Ïõê"]})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"üí° ÏÇ¨ÏóÖÏÜåÎìù ÏõêÏ≤úÏßïÏàò: ÏÜåÎìùÏÑ∏ 3% + ÏßÄÎ∞©ÏÜåÎìùÏÑ∏ 0.3% = 3.3%"})]})})()})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-rose-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-rose-100 bg-gradient-to-r from-rose-50 to-pink-50",children:[e.jsx("h3",{className:"font-bold text-rose-700 flex items-center gap-2",children:"üìÖ ÏÑ∏Î¨¥ Ï∫òÎ¶∞Îçî"}),e.jsx("p",{className:"text-xs text-rose-500 mt-1",children:"Ï£ºÏöî ÏÑ∏Í∏à Ïã†Í≥† ÏùºÏ†ï"})]}),e.jsx("div",{className:"p-4",children:(()=>{const s=new Date,r=s.getFullYear();s.getMonth()+1;const i=[{month:1,day:25,name:"Î∂ÄÍ∞ÄÏÑ∏ ÌôïÏ†ïÏã†Í≥†",desc:"7~12ÏõîÎ∂Ñ",type:"Î∂ÄÍ∞ÄÏÑ∏"},{month:2,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"1ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:3,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"2ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:4,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"3ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:4,day:25,name:"Î∂ÄÍ∞ÄÏÑ∏ ÏòàÏ†ïÏã†Í≥†",desc:"1~3ÏõîÎ∂Ñ",type:"Î∂ÄÍ∞ÄÏÑ∏"},{month:5,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"4ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:5,day:31,name:"Ï¢ÖÌï©ÏÜåÎìùÏÑ∏ Ïã†Í≥†",desc:"Ï†ÑÎÖÑÎèÑÎ∂Ñ",type:"ÏÜåÎìùÏÑ∏"},{month:6,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"5ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:7,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"6ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:7,day:25,name:"Î∂ÄÍ∞ÄÏÑ∏ ÌôïÏ†ïÏã†Í≥†",desc:"1~6ÏõîÎ∂Ñ",type:"Î∂ÄÍ∞ÄÏÑ∏"},{month:8,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"7ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:9,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"8ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:10,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"9ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:10,day:25,name:"Î∂ÄÍ∞ÄÏÑ∏ ÏòàÏ†ïÏã†Í≥†",desc:"7~9ÏõîÎ∂Ñ",type:"Î∂ÄÍ∞ÄÏÑ∏"},{month:11,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"10ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"},{month:12,day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",desc:"11ÏõîÎ∂Ñ",type:"ÏõêÏ≤úÏÑ∏"}].map(a=>{let m=new Date(r,a.month-1,a.day);m<s&&(m=new Date(r+1,a.month-1,a.day));const o=Math.ceil((m.getTime()-s.getTime())/(1e3*60*60*24));return{...a,scheduleDate:m,dDay:o}}).sort((a,m)=>a.dDay-m.dDay).slice(0,6),x={Î∂ÄÍ∞ÄÏÑ∏:"bg-teal-100 text-teal-700",ÏõêÏ≤úÏÑ∏:"bg-orange-100 text-orange-700",ÏÜåÎìùÏÑ∏:"bg-purple-100 text-purple-700"};return e.jsx("div",{className:"space-y-2",children:i.map((a,m)=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${a.dDay<=7?"bg-red-50 border-red-200":a.dDay<=14?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${x[a.type]||"bg-gray-100 text-gray-700"}`,children:a.type}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:a.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.desc," ‚Ä¢ ",a.month,"Ïõî ",a.day,"Ïùº"]})]})]}),e.jsx("div",{className:`text-right ${a.dDay<=7?"text-red-600 font-bold":"text-gray-600"}`,children:a.dDay===0?"D-Day!":a.dDay>0?`D-${a.dDay}`:`D+${Math.abs(a.dDay)}`})]},m))})})()})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-indigo-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-indigo-100 bg-gradient-to-r from-indigo-50 to-violet-50",children:[e.jsx("h3",{className:"font-bold text-indigo-700 flex items-center gap-2",children:"üìà ÏõîÎ≥Ñ ÏÜêÏùµÍ≥ÑÏÇ∞ÏÑú"}),e.jsxs("p",{className:"text-xs text-indigo-500 mt-1",children:[f,"ÎÖÑ ÏõîÎ≥Ñ ÏàòÏûÖ/ÏßÄÏ∂ú/ÏàúÏù¥Ïùµ Î∂ÑÏÑù"]})]}),e.jsx("div",{className:"p-4",children:(()=>{const s=Array.from({length:12},(n,i)=>{const x=i+1,a=String(x).padStart(2,"0"),m=z.filter(A=>{const w=A.settledAt||A.contractAt;return w?w.startsWith(`${f}-${a}`):!1}).reduce((A,w)=>A+(w.commission||0),0)*1e4,o=$.filter(A=>A.type==="income"&&A.date.substring(5,7)===a).reduce((A,w)=>A+w.amount,0),g=K.filter(A=>{var w;return((w=A.date)==null?void 0:w.substring(5,7))===a}).reduce((A,w)=>A+(w.amount||0)*1e4,0),j=$.filter(A=>A.type==="expense"&&A.date.substring(5,7)===a).reduce((A,w)=>A+w.amount,0),y=m+o,E=g+j,_=y-E;return{month:x,income:y,expense:E,profit:_}}),r=s.reduce((n,i)=>({income:n.income+i.income,expense:n.expense+i.expense,profit:n.profit+i.profit}),{income:0,expense:0,profit:0});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-indigo-50 text-indigo-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-2 text-left",children:"Ïõî"}),e.jsx("th",{className:"py-2 px-2 text-right",children:"ÏàòÏûÖ"}),e.jsx("th",{className:"py-2 px-2 text-right",children:"ÏßÄÏ∂ú"}),e.jsx("th",{className:"py-2 px-2 text-right",children:"ÏàúÏù¥Ïùµ"})]})}),e.jsx("tbody",{children:s.filter(n=>n.income>0||n.expense>0).map(n=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsxs("td",{className:"py-2 px-2 font-medium",children:[n.month,"Ïõî"]}),e.jsxs("td",{className:"py-2 px-2 text-right text-green-600",children:["+",n.income.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right text-red-600",children:["-",n.expense.toLocaleString()]}),e.jsxs("td",{className:`py-2 px-2 text-right font-bold ${n.profit>=0?"text-blue-600":"text-red-600"}`,children:[n.profit>=0?"+":"",n.profit.toLocaleString()]})]},n.month))}),e.jsx("tfoot",{className:"bg-indigo-100 font-bold",children:e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-2",children:"Ïó∞Í∞Ñ Ìï©Í≥Ñ"}),e.jsxs("td",{className:"py-2 px-2 text-right text-green-700",children:["+",r.income.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right text-red-700",children:["-",r.expense.toLocaleString()]}),e.jsxs("td",{className:`py-2 px-2 text-right ${r.profit>=0?"text-blue-700":"text-red-700"}`,children:[r.profit>=0?"+":"",r.profit.toLocaleString()]})]})})]})}),e.jsx("div",{className:"mt-4 h-48",children:e.jsx(be,{width:"100%",height:"100%",children:e.jsxs(Ve,{data:s.filter(n=>n.income>0||n.expense>0),children:[e.jsx(Ke,{strokeDasharray:"3 3"}),e.jsx(Ge,{dataKey:"month",tickFormatter:n=>`${n}Ïõî`}),e.jsx(Ze,{tickFormatter:n=>`${(n/1e4).toFixed(0)}Îßå`}),e.jsx(ye,{formatter:n=>`${n.toLocaleString()}Ïõê`}),e.jsx(wt,{}),e.jsx(de,{dataKey:"income",name:"ÏàòÏûÖ",fill:"#22c55e"}),e.jsx(de,{dataKey:"expense",name:"ÏßÄÏ∂ú",fill:"#ef4444"}),e.jsx(de,{dataKey:"profit",name:"ÏàúÏù¥Ïùµ",fill:"#3b82f6"})]})})})]})})()})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-emerald-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-emerald-100 bg-gradient-to-r from-emerald-50 to-green-50",children:[e.jsx("h3",{className:"font-bold text-emerald-700 flex items-center gap-2",children:"üè¢ Í±∞ÎûòÏ≤òÎ≥Ñ ÏàòÏùµ Î∂ÑÏÑù"}),e.jsxs("p",{className:"text-xs text-emerald-500 mt-1",children:[f,"ÎÖÑ ÌååÌä∏ÎÑàÎ≥Ñ Î∞úÏÉù ÏàòÏàòÎ£å"]})]}),e.jsx("div",{className:"p-4",children:(()=>{const s=b.map(i=>{const x=z.filter(g=>{var j;return g.partnerId===i.partnerId&&((j=g.settledAt||g.contractAt)==null?void 0:j.startsWith(String(f)))}),a=x.reduce((g,j)=>g+(j.commission||0),0),m=x.length,o=m>0?a/m:0;return{partner:i,totalCommission:a,caseCount:m,avgCommission:o}}).filter(i=>i.totalCommission>0).sort((i,x)=>x.totalCommission-i.totalCommission),r=s.reduce((i,x)=>i+x.totalCommission,0),n=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16"];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-emerald-50 text-emerald-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-2 text-left",children:"Í±∞ÎûòÏ≤ò"}),e.jsx("th",{className:"py-2 px-2 text-right",children:"Í±¥Ïàò"}),e.jsx("th",{className:"py-2 px-2 text-right",children:"ÏàòÏàòÎ£å"}),e.jsx("th",{className:"py-2 px-2 text-right",children:"ÎπÑÏ§ë"})]})}),e.jsx("tbody",{children:s.map((i,x)=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsxs("td",{className:"py-2 px-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n[x%n.length]}}),i.partner.name]}),e.jsxs("td",{className:"py-2 px-2 text-right",children:[i.caseCount,"Í±¥"]}),e.jsxs("td",{className:"py-2 px-2 text-right font-bold text-emerald-600",children:[i.totalCommission.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"py-2 px-2 text-right text-gray-500",children:[r>0?Math.round(i.totalCommission/r*100):0,"%"]})]},i.partner.partnerId))})]})}),e.jsx("div",{className:"h-48",children:e.jsx(be,{width:"100%",height:"100%",children:e.jsxs(St,{children:[e.jsx(It,{data:s.map((i,x)=>({name:i.partner.name,value:i.totalCommission,fill:n[x%n.length]})),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:60,label:({name:i,percent:x})=>`${i} ${(x*100).toFixed(0)}%`,children:s.map((i,x)=>e.jsx(Ct,{fill:n[x%n.length]},x))}),e.jsx(ye,{formatter:i=>`${i.toLocaleString()}ÎßåÏõê`})]})})})]})})})()})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-gray-50",children:[e.jsx("h3",{className:"font-bold text-slate-700 flex items-center gap-2",children:"üì§ ÏÑ∏Î¨¥ÏÇ¨ Ï†úÏ∂úÏö© ÏóëÏÖÄ ÎÇ¥Î≥¥ÎÇ¥Í∏∞"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"ÎçîÏ°¥, ÏÑ∏Î¨¥ÏÇ¨Îûë Îì± ÌöåÍ≥Ñ ÌîÑÎ°úÍ∑∏Îû® Ìò∏Ìôò ÌòïÏãù"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("button",{onClick:()=>{const s=[["Ï†ÑÌëúÏùºÏûê","Í≥ÑÏ†ïÍ≥ºÎ™©ÏΩîÎìú","Í≥ÑÏ†ïÍ≥ºÎ™©Î™Ö","Ï†ÅÏöî","Ï∞®Î≥ÄÍ∏àÏï°","ÎåÄÎ≥ÄÍ∏àÏï°","Í±∞ÎûòÏ≤òÏΩîÎìú","Í±∞ÎûòÏ≤òÎ™Ö"]];z.filter(a=>{var m;return(m=a.settledAt||a.contractAt)==null?void 0:m.startsWith(String(f))}).forEach(a=>{const m=(a.settledAt||a.contractAt||"").replace(/-/g,""),o=b.find(g=>g.partnerId===a.partnerId);s.push([m.substring(0,8),"401","ÏàòÏàòÎ£åÏàòÏûÖ",`${a.customerName} ÏàòÏàòÎ£å`,"",String((a.commission||0)*1e4),(o==null?void 0:o.partnerId)||"",(o==null?void 0:o.name)||""])}),K.forEach(a=>{const m=(a.date||"").replace(/-/g,""),o=a.category==="Í¥ëÍ≥†ÎπÑ"?"811":a.category==="Ïù∏Í±¥ÎπÑ"?"813":"819";s.push([m.substring(0,8),o,a.category,a.description,String((a.amount||0)*1e4),"","",""])});const r=s.map(a=>a.join(",")).join(`
`),n=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),x=document.createElement("a");x.href=i,x.download=`ÎçîÏ°¥_ÏùºÎ∞òÏ†ÑÌëú_${f}ÎÖÑ.csv`,x.click(),URL.revokeObjectURL(i)},className:"bg-blue-100 text-blue-700 p-4 rounded-lg font-medium hover:bg-blue-200 flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üìä"}),e.jsx("span",{className:"text-sm",children:"ÎçîÏ°¥ Smart A"}),e.jsx("span",{className:"text-xs text-blue-500",children:"ÏùºÎ∞òÏ†ÑÌëú ÌòïÏãù"})]}),e.jsxs("button",{onClick:()=>{const s=[["ÏùºÏûê","Íµ¨Î∂Ñ","Í≥ÑÏ†ïÍ≥ºÎ™©","Ï†ÅÏöî","Í≥µÍ∏âÍ∞ÄÏï°","Î∂ÄÍ∞ÄÏÑ∏","Ìï©Í≥Ñ","Í±∞ÎûòÏ≤ò"]];z.filter(a=>{var m;return(m=a.settledAt||a.contractAt)==null?void 0:m.startsWith(String(f))}).forEach(a=>{const m=a.settledAt||a.contractAt||"",o=b.find(y=>y.partnerId===a.partnerId),g=(a.commission||0)*1e4,j=Math.round(g*.1);s.push([m,"Îß§Ï∂ú","ÏàòÏàòÎ£åÏàòÏûÖ",`${a.customerName}`,String(g),String(j),String(g+j),(o==null?void 0:o.name)||""])}),K.forEach(a=>{const m=(a.amount||0)*1e4,o=Math.round(m*.1);s.push([a.date||"","Îß§ÏûÖ",a.category,a.description,String(m),String(o),String(m+o),""])});const r=s.map(a=>a.join(",")).join(`
`),n=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),x=document.createElement("a");x.href=i,x.download=`ÏÑ∏Î¨¥ÏÇ¨Îûë_Îß§ÏûÖÎß§Ï∂ú_${f}ÎÖÑ.csv`,x.click(),URL.revokeObjectURL(i)},className:"bg-green-100 text-green-700 p-4 rounded-lg font-medium hover:bg-green-200 flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üíö"}),e.jsx("span",{className:"text-sm",children:"ÏÑ∏Î¨¥ÏÇ¨Îûë"}),e.jsx("span",{className:"text-xs text-green-500",children:"Îß§ÏûÖÎß§Ï∂ú ÌòïÏãù"})]}),e.jsxs("button",{onClick:()=>{const s=[["Íµ¨Î∂Ñ","ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑúÎ∞úÍ∏âÏùº","Í≥µÍ∏âÏûêÏÇ¨ÏóÖÏûêÎ≤àÌò∏","Í≥µÍ∏âÏûêÏÉÅÌò∏","Í≥µÍ∏âÍ∞ÄÏï°","ÏÑ∏Ïï°","ÎπÑÍ≥†"]];s.push(["[ Îß§Ï∂ú ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Ìï©Í≥Ñ ]","","","","","",""]);const r=z.filter(j=>{var y;return(y=j.settledAt||j.contractAt)==null?void 0:y.startsWith(String(f))}).reduce((j,y)=>j+(y.commission||0)*1e4,0),n=Math.round(r*.1);s.push(["Îß§Ï∂úÌï©Í≥Ñ","","","",String(r),String(n),""]),s.push(["","","","","","",""]),s.push(["[ Îß§ÏûÖ ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Ìï©Í≥Ñ ]","","","","","",""]);const i=K.reduce((j,y)=>j+(y.amount||0)*1e4,0),x=Math.round(i*.1);s.push(["Îß§ÏûÖÌï©Í≥Ñ","","","",String(i),String(x),""]),s.push(["","","","","","",""]),s.push(["[ Î∂ÄÍ∞ÄÏÑ∏ ÎÇ©Î∂Ä ÏòàÏ†ïÏï° ]","","","","",String(n-x),""]);const a=s.map(j=>j.join(",")).join(`
`),m=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(m),g=document.createElement("a");g.href=o,g.download=`Î∂ÄÍ∞ÄÏÑ∏Ïã†Í≥†ÏûêÎ£å_${f}ÎÖÑ.csv`,g.click(),URL.revokeObjectURL(o)},className:"bg-purple-100 text-purple-700 p-4 rounded-lg font-medium hover:bg-purple-200 flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üßæ"}),e.jsx("span",{className:"text-sm",children:"Î∂ÄÍ∞ÄÏÑ∏ Ïã†Í≥†"}),e.jsx("span",{className:"text-xs text-purple-500",children:"ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Ìï©Í≥Ñ"})]}),e.jsxs("button",{onClick:()=>{const s=[["ÏÜåÎìùÏûêÏÑ±Î™Ö","Ï£ºÎØºÎ≤àÌò∏","ÏÜåÎìùÍµ¨Î∂Ñ","ÏßÄÍ∏âÏï°","ÏÜåÎìùÏÑ∏","ÏßÄÎ∞©ÏÜåÎìùÏÑ∏","Ïã§ÏßÄÍ∏âÏï°","ÏßÄÍ∏âÏùº"]];b.forEach(a=>{R.filter(o=>o.partnerId===a.partnerId&&(o.status==="paid"||o.status==="completed")).forEach(o=>{const g=(o.totalPayableCommission||0)*1e4,j=Math.round(g*.03),y=Math.round(g*.003),E=g-j-y;s.push([a.name,"","ÏÇ¨ÏóÖÏÜåÎìù",String(g),String(j),String(y),String(E),o.weekStart||""])})});const r=s.map(a=>a.join(",")).join(`
`),n=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),x=document.createElement("a");x.href=i,x.download=`ÏõêÏ≤úÏÑ∏Ïã†Í≥†ÏûêÎ£å_${f}ÎÖÑ.csv`,x.click(),URL.revokeObjectURL(i)},className:"bg-orange-100 text-orange-700 p-4 rounded-lg font-medium hover:bg-orange-200 flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üí∞"}),e.jsx("span",{className:"text-sm",children:"ÏõêÏ≤úÏÑ∏ Ïã†Í≥†"}),e.jsx("span",{className:"text-xs text-orange-500",children:"ÏßÄÍ∏âÎ™ÖÏÑ∏ÏÑú ÌòïÏãù"})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"üí° Îã§Ïö¥Î°úÎìú ÌõÑ ÏÑ∏Î¨¥ÏÇ¨ÏóêÍ≤å Ï†úÏ∂ú ÎòêÎäî ÌöåÍ≥Ñ ÌîÑÎ°úÍ∑∏Îû®Ïóê ÏßÅÏ†ë ÏûÑÌè¨Ìä∏ÌïòÏÑ∏Ïöî."})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-rose-100 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-rose-100 bg-gradient-to-r from-rose-50 to-pink-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-rose-700 flex items-center gap-2",children:"üìú ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Í¥ÄÎ¶¨"}),e.jsxs("p",{className:"text-xs text-rose-500 mt-1",children:[f,"ÎÖÑ Îß§ÏûÖ/Îß§Ï∂ú ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú"]})]}),e.jsx("button",{onClick:()=>{const s=prompt(`ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Ïú†ÌòïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî:
1. Îß§Ï∂ú
2. Îß§ÏûÖ`,"1");if(!s)return;const r=s==="1"?"Îß§Ï∂ú":"Îß§ÏûÖ",n=prompt("Î∞úÌñâÏùº (YYYY-MM-DD):",new Date().toISOString().split("T")[0]);if(!n)return;const i=prompt("Í±∞ÎûòÏ≤ò ÏÉÅÌò∏:");if(!i)return;const x=prompt("ÏÇ¨ÏóÖÏûêÎ≤àÌò∏ (ÌïòÏù¥Ìîà Ìè¨Ìï®):","000-00-00000")||"",a=prompt("Í≥µÍ∏âÍ∞ÄÏï° (Ïõê):");if(!a)return;const m=parseInt(a.replace(/,/g,"")),o=Math.round(m*.1),g=prompt("Ï†ÅÏöî/ÌíàÎ™©:","")||"",j=prompt("ÏäπÏù∏Î≤àÌò∏ (ÏÑ†ÌÉù):","")||void 0,y=confirm("Ï†ÑÏûêÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú ÏûÖÎãàÍπå?"),{createTaxInvoice:E}=require("../services/api");E({type:r,issueDate:n,supplyAmount:m,vatAmount:o,totalAmount:m+o,businessNumber:x,companyName:i,description:g,approvalNumber:j,isElectronic:y}),alert(`ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑúÍ∞Ä Îì±Î°ùÎêòÏóàÏäµÎãàÎã§:
${r} ${m.toLocaleString()}Ïõê`),window.location.reload()},className:"px-3 py-1.5 bg-rose-600 text-white text-sm rounded-lg hover:bg-rose-700",children:"+ ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Îì±Î°ù"})]})}),e.jsx("div",{className:"p-4",children:(()=>{const{fetchTaxInvoices:s,getTaxInvoiceStats:r,deleteTaxInvoice:n}=require("../services/api"),i=s(f),x=r(f);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-xs text-green-600",children:"Îß§Ï∂ú ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú"}),e.jsxs("p",{className:"text-lg font-bold text-green-700",children:[x.salesCount,"Í±¥"]}),e.jsxs("p",{className:"text-xs text-green-500",children:[x.salesTotal.toLocaleString(),"Ïõê"]})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-xs text-red-600",children:"Îß§ÏûÖ ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú"}),e.jsxs("p",{className:"text-lg font-bold text-red-700",children:[x.purchaseCount,"Í±¥"]}),e.jsxs("p",{className:"text-xs text-red-500",children:[x.purchaseTotal.toLocaleString(),"Ïõê"]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-xs text-blue-600",children:"Îß§Ï∂úÏÑ∏Ïï°"}),e.jsxs("p",{className:"text-lg font-bold text-blue-700",children:[x.salesVat.toLocaleString(),"Ïõê"]})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:[e.jsx("p",{className:"text-xs text-purple-600",children:"ÎÇ©Î∂Ä ÏòàÏ†ï ÏÑ∏Ïï°"}),e.jsxs("p",{className:`text-lg font-bold ${x.vatPayable>=0?"text-purple-700":"text-green-700"}`,children:[x.vatPayable>=0?"":"-",Math.abs(x.vatPayable).toLocaleString(),"Ïõê"]})]})]}),i.length>0?e.jsx("div",{className:"overflow-x-auto max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-rose-50 text-rose-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-2 text-left",children:"Ïú†Ìòï"}),e.jsx("th",{className:"py-2 px-2 text-left",children:"Î∞úÌñâÏùº"}),e.jsx("th",{className:"py-2 px-2 text-left",children:"Í±∞ÎûòÏ≤ò"}),e.jsx("th",{className:"py-2 px-2 text-right",children:"Í≥µÍ∏âÍ∞ÄÏï°"}),e.jsx("th",{className:"py-2 px-2 text-right",children:"ÏÑ∏Ïï°"}),e.jsx("th",{className:"py-2 px-2 text-center",children:"Ï†ÑÏûê"}),e.jsx("th",{className:"py-2 px-2"})]})}),e.jsx("tbody",{children:i.map(a=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-2",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${a.type==="Îß§Ï∂ú"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:a.type})}),e.jsx("td",{className:"py-2 px-2",children:a.issueDate}),e.jsx("td",{className:"py-2 px-2",children:a.companyName}),e.jsx("td",{className:"py-2 px-2 text-right",children:a.supplyAmount.toLocaleString()}),e.jsx("td",{className:"py-2 px-2 text-right",children:a.vatAmount.toLocaleString()}),e.jsx("td",{className:"py-2 px-2 text-center",children:a.isElectronic?"‚úì":""}),e.jsx("td",{className:"py-2 px-2",children:e.jsx("button",{onClick:()=>{confirm("Ïù¥ ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑúÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?")&&(n(a.id),window.location.reload())},className:"text-gray-400 hover:text-red-500",children:"√ó"})})]},a.id))})]})}):e.jsx("div",{className:"text-center py-8 text-gray-400",children:"Îì±Î°ùÎêú ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑúÍ∞Ä ÏóÜÏäµÎãàÎã§."})]})})()})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-amber-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-amber-100 bg-gradient-to-r from-amber-50 to-yellow-50",children:[e.jsx("h3",{className:"font-bold text-amber-700 flex items-center gap-2",children:"üìÜ ÏõîÍ∞Ñ ÏÑ∏Î¨¥ Ï∫òÎ¶∞Îçî"}),e.jsxs("p",{className:"text-xs text-amber-500 mt-1",children:[f,"ÎÖÑ ÏÑ∏Î¨¥ ÏùºÏ†ï ÌïúÎààÏóê"]})]}),e.jsxs("div",{className:"p-4",children:[(()=>{const r=new Date().getMonth()+1,n={1:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"},{day:25,name:"Î∂ÄÍ∞ÄÏÑ∏ ÌôïÏ†ïÏã†Í≥†",type:"Î∂ÄÍ∞ÄÏÑ∏",color:"bg-green-500"}],2:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"}],3:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"},{day:31,name:"Î≤ïÏù∏ÏÑ∏ Ïã†Í≥†",type:"Î≤ïÏù∏ÏÑ∏",color:"bg-purple-500"}],4:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"},{day:25,name:"Î∂ÄÍ∞ÄÏÑ∏ ÏòàÏ†ïÏã†Í≥†",type:"Î∂ÄÍ∞ÄÏÑ∏",color:"bg-green-500"}],5:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"},{day:31,name:"Ï¢ÖÌï©ÏÜåÎìùÏÑ∏ Ïã†Í≥†",type:"ÏÜåÎìùÏÑ∏",color:"bg-red-500"}],6:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"}],7:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"},{day:25,name:"Î∂ÄÍ∞ÄÏÑ∏ ÌôïÏ†ïÏã†Í≥†",type:"Î∂ÄÍ∞ÄÏÑ∏",color:"bg-green-500"}],8:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"}],9:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"}],10:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"},{day:25,name:"Î∂ÄÍ∞ÄÏÑ∏ ÏòàÏ†ïÏã†Í≥†",type:"Î∂ÄÍ∞ÄÏÑ∏",color:"bg-green-500"}],11:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"}],12:[{day:10,name:"ÏõêÏ≤úÏÑ∏ ÎÇ©Î∂Ä",type:"ÏõêÏ≤úÏÑ∏",color:"bg-blue-500"}]};return e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2",children:Array.from({length:12},(i,x)=>x+1).map(i=>{const x=n[i]||[],a=i===r;return e.jsxs("div",{className:`p-3 rounded-lg border ${a?"border-amber-400 bg-amber-50 ring-2 ring-amber-200":"border-gray-200 bg-gray-50"}`,children:[e.jsxs("div",{className:`text-sm font-bold mb-2 ${a?"text-amber-700":"text-gray-600"}`,children:[i,"Ïõî"]}),e.jsx("div",{className:"space-y-1",children:x.length>0?x.map((m,o)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${m.color}`}),e.jsxs("span",{className:"text-[10px] text-gray-600 truncate",children:[m.day,"Ïùº ",m.name]})]},o)):e.jsx("div",{className:"text-[10px] text-gray-400",children:"ÏùºÏ†ï ÏóÜÏùå"})})]},i)})})})(),e.jsx("div",{className:"mt-4 p-3 bg-amber-50 rounded-lg border border-amber-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:"üîî"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-700",children:"Ïï± ÏÑ∏Î¨¥ ÏïåÎ¶º"}),e.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"LeadMaster Ïï±ÏóêÏÑú ÏÑ∏Î¨¥ ÏùºÏ†ï ÏïåÎ¶ºÏùÑ Î∞õÏúºÏÑ∏Ïöî! ÏÑ§Ï†ï ‚Üí ÏïåÎ¶ºÏóêÏÑú ÏÑ∏Î¨¥ ÏïåÎ¶ºÏùÑ ÌôúÏÑ±ÌôîÌïòÎ©¥ Î∂ÄÍ∞ÄÏÑ∏, ÏõêÏ≤úÏÑ∏, ÏÜåÎìùÏÑ∏ Ïã†Í≥† Í∏∞Ìïú 7Ïùº, 3Ïùº, 1Ïùº Ï†ÑÏóê Ìë∏Ïãú ÏïåÎ¶ºÏùÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§."})]})]})})]})]})]})},it=new Date,We=it.getDay(),xt=z.filter(t=>{var s;if(t.status==="Ï¢ÖÍ≤∞"||t.status==="Ï∑®ÏÜå")return!1;const l=(t.depositHistory||[]).reduce((r,n)=>r+(n.amount||0),0);if((t.contractFee||0)-l<=0)return!1;const d=(s=t.depositHistory)!=null&&s.length?t.depositHistory.map(r=>r.date).sort().pop():t.contractAt||t.createdAt;return d?Je(it,Te(d))>=30:!1}).length;let te=null;return We===1?p?p.status==="draft"&&(te={type:"info",msg:"Ï†ïÏÇ∞ ÎÇ¥Ïó≠ÏùÑ ÌôïÏù∏ÌïòÍ≥† ÌôïÏ†ï(Confirmed)Ìï¥Ï£ºÏÑ∏Ïöî."}):te={type:"warning",msg:"ÏõîÏöîÏùºÏûÖÎãàÎã§. Í∏àÏ£º Ï†ïÏÇ∞ Î∞∞ÏπòÎ•º ÏÉùÏÑ±ÌïòÍ≥† ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî."}:We===2?p&&!p.invoiceInfo&&(te={type:"warning",msg:"ÌôîÏöîÏùºÏûÖÎãàÎã§. ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Î∞úÌñâ Î∞è ÏàòÍ∏à ÌôïÏù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§."}):We===3&&p&&p.status!=="completed"&&p.status!=="paid"&&(te={type:"warning",msg:"ÏàòÏöîÏùºÏûÖÎãàÎã§. ÌååÌä∏ÎÑà ÏàòÏàòÎ£å ÏßÄÍ∏âÏùÑ ÏßÑÌñâÌï¥Ï£ºÏÑ∏Ïöî."}),e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Ï£ºÍ∞ÑÏ†ïÏÇ∞ÏÑºÌÑ∞"}),e.jsx("div",{className:"flex gap-2 items-center flex-wrap",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"bg-white border p-2 pl-9 rounded text-lg font-bold text-indigo-700 min-w-[200px] outline-none cursor-pointer",value:v,onChange:t=>M(t.target.value),children:[e.jsx("option",{value:"all",children:"Ï†ÑÏ≤¥ ÌÜµÍ≥Ñ (Total)"}),b.map(t=>e.jsx("option",{value:t.partnerId,children:t.name},t.partnerId))]}),e.jsx(Os,{className:"absolute left-3 top-3 text-indigo-500",size:18})]})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[xt>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 flex items-center justify-between animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx("span",{className:"font-bold",children:"üö® Í∏¥Í∏â"}),e.jsxs("span",{className:"text-sm",children:["ÌòÑÏû¨ 30Ïùº Ïù¥ÏÉÅ Ïû•Í∏∞ ÎØ∏ÏàòÍ∏à Í±¥Ïù¥ ",e.jsxs("span",{className:"font-bold underline",children:[xt,"Í±¥"]})," ÏûàÏäµÎãàÎã§."]})]}),e.jsx("button",{onClick:()=>{D("report")},className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded font-bold hover:bg-red-200",children:"ÌôïÏù∏ÌïòÍ∏∞"})]}),te&&e.jsxs("div",{className:`border rounded-lg p-3 flex items-center gap-2 ${te.type==="warning"?"bg-orange-50 border-orange-200 text-orange-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:[e.jsx("span",{children:te.type==="warning"?"‚ö†Ô∏è":"‚ÑπÔ∏è"}),e.jsx("span",{className:"text-sm font-medium",children:te.msg})]})]}),P!=="report"&&!J&&e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:Bt,className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(Et,{size:20})}),e.jsxs("div",{className:"text-center min-w-[200px]",children:[e.jsx("p",{className:"font-bold text-lg text-gray-800",children:Oe}),e.jsxs("p",{className:"text-sm text-gray-500",children:[L.toLocaleDateString("ko-KR")," ~ ",us(L).toLocaleDateString("ko-KR")]})]}),e.jsx("button",{onClick:Ut,className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(Ft,{size:20})})]}),e.jsx("button",{onClick:_t,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Ïù¥Î≤à Ï£ºÎ°ú Ïù¥Îèô"})]}),e.jsxs("div",{className:"flex border-b border-gray-200 overflow-x-auto",children:[!J&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>D("monday"),className:`px-6 py-3 font-medium text-sm whitespace-nowrap border-b-2 transition-colors ${P==="monday"?"border-blue-600 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"üìÖ ÏõîÏöîÏùº (ÌôïÏù∏)"}),e.jsx("button",{onClick:()=>D("tuesday"),className:`px-6 py-3 font-medium text-sm whitespace-nowrap border-b-2 transition-colors ${P==="tuesday"?"border-yellow-600 text-yellow-600 bg-yellow-50":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"üìÑ ÌôîÏöîÏùº (Î∞úÌñâ/ÏàòÍ∏à)"}),e.jsx("button",{onClick:()=>D("wednesday"),className:`px-6 py-3 font-medium text-sm whitespace-nowrap border-b-2 transition-colors ${P==="wednesday"?"border-green-600 text-green-600 bg-green-50":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"üí∞ ÏàòÏöîÏùº (ÏßÄÍ∏â)"})]}),e.jsx("button",{onClick:()=>D("report"),className:`px-6 py-3 font-medium text-sm whitespace-nowrap border-b-2 transition-colors ${P==="report"?"border-purple-600 text-purple-600 bg-purple-50":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"üìä Î¶¨Ìè¨Ìä∏"}),e.jsx("button",{onClick:()=>D("expenses"),className:`px-6 py-3 font-medium text-sm whitespace-nowrap border-b-2 transition-colors ${P==="expenses"?"border-red-600 text-red-600 bg-red-50":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"üí≥ ÏßÄÏ∂ú"})]}),(P==="report"||P==="expenses")&&e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("select",{className:"bg-white border p-2 rounded text-lg font-bold cursor-pointer min-w-[100px]",value:f,onChange:t=>U(Number(t.target.value)),children:Array.from({length:13},(t,l)=>2024+l).map(t=>e.jsxs("option",{value:t,children:[t,"ÎÖÑ"]},t))}),e.jsxs("select",{className:"bg-white border p-2 rounded text-lg font-bold cursor-pointer min-w-[100px]",value:S,onChange:t=>ae(t.target.value==="all"?"all":Number(t.target.value)),children:[e.jsx("option",{value:"all",children:"Ï†ÑÏ≤¥ Ïõî"}),Array.from({length:12},(t,l)=>l+1).map(t=>e.jsxs("option",{value:t,children:[t,"Ïõî"]},t))]})]}),P==="monday"&&!J&&es(),P==="tuesday"&&!J&&ts(),P==="wednesday"&&!J&&ss(),P==="report"&&as(),P==="expenses"&&os(),J&&P!=="report"&&P!=="expenses"&&e.jsxs("div",{className:"bg-gray-50 p-8 rounded-xl text-center",children:[e.jsx("p",{className:"text-gray-500",children:"Ï£ºÍ∞Ñ Ï†ïÏÇ∞ Í∏∞Îä•ÏùÄ ÌäπÏ†ï Í±∞ÎûòÏ≤òÎ•º ÏÑ†ÌÉùÌï¥Ïïº ÏÇ¨Ïö©Ìï† Ïàò ÏûàÏäµÎãàÎã§."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:'ÌÜµÍ≥ÑÎ•º Î≥¥ÏãúÎ†§Î©¥ "Î¶¨Ìè¨Ìä∏" ÌÉ≠ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.'})]}),e.jsxs(vt,{isOpen:je,onClose:()=>ie(!1),title:`${f}ÎÖÑ ${S==="all"?"Ï†ÑÏ≤¥":S+"Ïõî"} Í≥ÑÏïΩ Î∞è Ï†ïÏÇ∞ ÏÉÅÏÑ∏ ÎÇ¥Ïó≠`,children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left whitespace-nowrap",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Í≥ÑÏïΩÏùº"}),e.jsx("th",{className:"px-4 py-2",children:"Í≥†Í∞ùÎ™Ö"}),e.jsx("th",{className:"px-4 py-2",children:"Í±∞ÎûòÏ≤ò"}),e.jsx("th",{className:"px-4 py-2",children:"ÏÉÅÌÉú"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"ÏàòÏûÑÎ£å"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"ÏàòÎãπ(Rule)"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:Z.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"Ìï¥Îãπ Í∏∞Í∞ÑÏóê ÏôÑÎ£åÎêú Í≥ÑÏïΩ Í±¥Ïù¥ ÏóÜÏäµÎãàÎã§."})}):Z.sort((t,l)=>(l.contractAt||"").localeCompare(t.contractAt||"")).map(t=>{var c;const l=Se(t);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 text-gray-600",children:t.contractAt}),e.jsx("td",{className:"px-4 py-2 font-medium text-gray-900",children:t.customerName}),e.jsx("td",{className:"px-4 py-2 text-gray-500",children:Qt(t.partnerId)}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-600 border border-gray-200",children:t.status})}),e.jsxs("td",{className:"px-4 py-2 text-right text-blue-600 font-medium",children:[(c=t.contractFee)==null?void 0:c.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"px-4 py-2 text-right text-green-600 font-bold",children:[l.toLocaleString(),"ÎßåÏõê"]})]},t.caseId)})}),Z.length>0&&e.jsx("tfoot",{className:"bg-gray-50 font-bold",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-4 py-2 text-center text-gray-700",children:"Ìï©Í≥Ñ"}),e.jsxs("td",{className:"px-4 py-2 text-right text-blue-700",children:[Ue.toLocaleString(),"ÎßåÏõê"]}),e.jsxs("td",{className:"px-4 py-2 text-right text-green-700",children:[_e.toLocaleString(),"ÎßåÏõê"]})]})})]})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:()=>ie(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 text-sm font-medium",children:"Îã´Í∏∞"})})]}),e.jsx(vt,{isOpen:Pt,onClose:()=>{pe(!1),he(null)},title:ve?"ÏßÄÏ∂ú ÏàòÏ†ï":"ÏßÄÏ∂ú Îì±Î°ù",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ÎÇ†Ïßú"}),e.jsx("input",{type:"date",className:"w-full border rounded-lg p-2",value:H.date||"",onChange:t=>ee({...H,date:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ïπ¥ÌÖåÍ≥†Î¶¨"}),e.jsx("select",{className:"w-full border rounded-lg p-2",value:H.category||"Í¥ëÍ≥†ÎπÑ",onChange:t=>ee({...H,category:t.target.value}),children:bs.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Í∏àÏï° (ÎßåÏõê)"}),e.jsx("input",{type:"number",className:"w-full border rounded-lg p-2",placeholder:"Ïòà: 100",value:H.amount||"",onChange:t=>ee({...H,amount:Number(t.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ÎÇ¥Ïö© *"}),e.jsx("input",{type:"text",className:"w-full border rounded-lg p-2",placeholder:"Ïòà: ÎÑ§Ïù¥Î≤Ñ Í¥ëÍ≥†ÎπÑ",value:H.description||"",onChange:t=>ee({...H,description:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Î©îÎ™® (ÏÑ†ÌÉù)"}),e.jsx("textarea",{className:"w-full border rounded-lg p-2",rows:2,placeholder:"Ï∂îÍ∞Ä Î©îÎ™®",value:H.memo||"",onChange:t=>ee({...H,memo:t.target.value})})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{onClick:rs,className:"flex-1 bg-red-600 text-white py-2 rounded-lg font-bold hover:bg-red-700",children:ve?"ÏàòÏ†ï":"Îì±Î°ù"}),e.jsx("button",{onClick:()=>{pe(!1),he(null)},className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg font-medium hover:bg-gray-300",children:"Ï∑®ÏÜå"})]})]})})]})}export{Ea as default};
