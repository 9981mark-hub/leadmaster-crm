import{aE as _,a as O,n as Y,aF as E,t as M,aG as v,aH as D,aI as P,aJ as q,aK as B,aL as C,aM as x,f as $,aN as y,aw as G,p as K}from"./index-CA7jmXQg.js";function j(e,t,a){return _(e,t*7,a)}function Z(e){return O(e,Date.now())}function J(e,t,a){const[n,o]=Y(a==null?void 0:a.in,e,t);return+E(n)==+E(o)}function ee(e,t){return M(e,t==null?void 0:t.in).getDay()}function te(e,t){return+M(e)<+M(t)}function ne(e){return+M(e)<Date.now()}function z(e,t){return J(O(e,e),Z(e))}function ae(e,t,a){let n=t-ee(e,a);return n<=0&&(n+=7),_(e,n,a)}const oe={lessThanXSeconds:{one:"1초 미만",other:"{{count}}초 미만"},xSeconds:{one:"1초",other:"{{count}}초"},halfAMinute:"30초",lessThanXMinutes:{one:"1분 미만",other:"{{count}}분 미만"},xMinutes:{one:"1분",other:"{{count}}분"},aboutXHours:{one:"약 1시간",other:"약 {{count}}시간"},xHours:{one:"1시간",other:"{{count}}시간"},xDays:{one:"1일",other:"{{count}}일"},aboutXWeeks:{one:"약 1주",other:"약 {{count}}주"},xWeeks:{one:"1주",other:"{{count}}주"},aboutXMonths:{one:"약 1개월",other:"약 {{count}}개월"},xMonths:{one:"1개월",other:"{{count}}개월"},aboutXYears:{one:"약 1년",other:"약 {{count}}년"},xYears:{one:"1년",other:"{{count}}년"},overXYears:{one:"1년 이상",other:"{{count}}년 이상"},almostXYears:{one:"거의 1년",other:"거의 {{count}}년"}},re=(e,t,a)=>{let n;const o=oe[e];return typeof o=="string"?n=o:t===1?n=o.one:n=o.other.replace("{{count}}",t.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?n+" 후":n+" 전":n},se={full:"y년 M월 d일 EEEE",long:"y년 M월 d일",medium:"y.MM.dd",short:"y.MM.dd"},ie={full:"a H시 mm분 ss초 zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},ue={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},le={date:v({formats:se,defaultWidth:"full"}),time:v({formats:ie,defaultWidth:"full"}),dateTime:v({formats:ue,defaultWidth:"full"})},de={lastWeek:"'지난' eeee p",yesterday:"'어제' p",today:"'오늘' p",tomorrow:"'내일' p",nextWeek:"'다음' eeee p",other:"P"},me=(e,t,a,n)=>de[e],ce={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["기원전","서기"]},fe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1분기","2분기","3분기","4분기"]},he={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],wide:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},pe={narrow:["일","월","화","수","목","금","토"],short:["일","월","화","수","목","금","토"],abbreviated:["일","월","화","수","목","금","토"],wide:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},ye={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},ge={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},we=(e,t)=>{const a=Number(e);switch(String(t==null?void 0:t.unit)){case"minute":case"second":return String(a);case"date":return a+"일";default:return a+"번째"}},De={ordinalNumber:we,era:D({values:ce,defaultWidth:"wide"}),quarter:D({values:fe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:D({values:he,defaultWidth:"wide"}),day:D({values:pe,defaultWidth:"wide"}),dayPeriod:D({values:ye,defaultWidth:"wide",formattingValues:ge,defaultFormattingWidth:"wide"})},Pe=/^(\d+)(일|번째)?/i,be=/\d+/i,Ae={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(기원전|서기)/i},Me={any:[/^(bc|기원전)/i,/^(ad|서기)/i]},$e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]사?분기/i},Te={any:[/1/i,/2/i,/3/i,/4/i]},Se={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])월/i,wide:/^(1[012]|[123456789])월/i},Le={any:[/^1월?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},ve={narrow:/^[일월화수목금토]/,short:/^[일월화수목금토]/,abbreviated:/^[일월화수목금토]/,wide:/^[일월화수목금토]요일/},Ce={any:[/^일/,/^월/,/^화/,/^수/,/^목/,/^금/,/^토/]},Fe={any:/^(am|pm|오전|오후|자정|정오|아침|저녁|밤)/i},We={any:{am:/^(am|오전)/i,pm:/^(pm|오후)/i,midnight:/^자정/i,noon:/^정오/i,morning:/^아침/i,afternoon:/^오후/i,evening:/^저녁/i,night:/^밤/i}},Re={ordinalNumber:q({matchPattern:Pe,parsePattern:be,valueCallback:e=>parseInt(e,10)}),era:P({matchPatterns:Ae,defaultMatchWidth:"wide",parsePatterns:Me,defaultParseWidth:"any"}),quarter:P({matchPatterns:$e,defaultMatchWidth:"wide",parsePatterns:Te,defaultParseWidth:"any",valueCallback:e=>e+1}),month:P({matchPatterns:Se,defaultMatchWidth:"wide",parsePatterns:Le,defaultParseWidth:"any"}),day:P({matchPatterns:ve,defaultMatchWidth:"wide",parsePatterns:Ce,defaultParseWidth:"any"}),dayPeriod:P({matchPatterns:Fe,defaultMatchWidth:"any",parsePatterns:We,defaultParseWidth:"any"})},He={code:"ko",formatDistance:re,formatLong:le,formatRelative:me,localize:De,match:Re,options:{weekStartsOn:0,firstWeekContainsDate:1}},R=(e,t)=>{const n=t.filter(o=>o.active).filter(o=>{const s=e>=o.minFee,c=!o.maxFee||e<=o.maxFee;return s&&c});if(n.length!==0)return n.sort((o,s)=>s.minFee!==o.minFee?s.minFee-o.minFee:s.priority!==o.priority?s.priority-o.priority:s.updatedAt!==o.updatedAt?s.updatedAt.localeCompare(o.updatedAt):s.ruleId.localeCompare(o.ruleId)),n[0]},U=(e,t)=>{if(!e)return 0;const a=R(e,t);return a?a.commission:0},V=(e,t,a)=>{if(!e.contractFee)return{payable:0,total:0,isPartial:!1};const n=R(e.contractFee,t);if(!n)return{payable:0,total:0,isPartial:!1};const o=(e.deposit1Amount||0)+(e.deposit2Amount||0),s=n.fullPayoutThreshold||0,c=a?a.downPaymentPercentage/100:.1,u=a?a.firstPayoutPercentage/100:.5;return s>0&&o>=s?{payable:n.commission,total:n.commission,isPartial:!1,rule:n}:o>=e.contractFee*c?{payable:n.commission*u,total:n.commission,isPartial:!0,rule:n}:{payable:0,total:n.commission,isPartial:!1,rule:n}},Ne=(e,t)=>{const a=[];return B.includes(e.status)&&(!e.reminders||e.reminders.length===0)&&a.push("리마인더 없음"),C.includes(e.status)&&!e.contractAt&&a.push("계약일 미입력"),C.includes(e.status)&&!e.contractFee&&a.push("수임료 미입력"),e.contractFee&&C.includes(e.status)&&t&&U(e.contractFee,t.commissionRules)===0&&a.push("수당 룰 없음"),a},ke=e=>{const t=e.replace(/[^\d]/g,"");return t.length===2?parseInt(t,10)<=30?`20${t}`:`19${t}`:t},F=e=>e?String(e).replace(/[^0-9]/g,""):"",Ie=(e,t)=>{if(!e)return;const a=F(e);if(!(a.length<9))return t.find(n=>n.phone&&F(n.phone)===a)},i=e=>{if(e==null||isNaN(e))return"";if(e===0)return"0원";const t=Math.floor(e/1e4),a=e%1e4;return t>0&&a>0?`${t.toLocaleString()}억 ${a.toLocaleString()}만원`:t>0&&a===0?`${t.toLocaleString()}억원`:t===0&&a>0?`${a.toLocaleString()}만원`:"0원"},Ee=(e,t=G)=>{var N,k,I;let a=t;e.maritalStatus==="미혼"&&(a=a.replace(/^\* 미성년 자녀 수 : .*\r?\n?/gm,"")),e.creditCardUse==="미사용"&&(a=a.replace(/^\* 신용카드 사용금액 : .*\r?\n?/gm,"")),e.jobTypes&&e.jobTypes.length===1&&e.jobTypes[0]==="무직"&&(a=a.replace(/^\* 4대보험 가입유무 : .*\r?\n?/gm,""));const n=[];e.housingType==="자가"?(e.ownHousePrice&&n.push(`집 시세 ${i(e.ownHousePrice)}`),e.ownHouseLoan&&n.push(`(집 담보대출 ${i(e.ownHouseLoan)})`),e.ownHouseOwner&&n.push(`[명의: ${e.ownHouseOwner}]`)):e.housingType==="무상거주"?(n.push("무상거주"),e.freeHousingOwner&&n.push(`[명의: ${e.freeHousingOwner}]`)):(e.deposit&&n.push(`보증금 ${i(e.deposit)}`),e.rent&&n.push(`월세 ${i(e.rent)}`),e.depositLoanAmount&&n.push(`(보증금 대출: ${i(e.depositLoanAmount)})`),e.rentContractor&&n.push(`[계약자: ${e.rentContractor}]`));const o=n.length>0?n.join(" "):"정보 없음",s=e.assets&&e.assets.length>0?e.assets.map(r=>{const w=r.desc?`(${r.desc})`:"",Q=r.rentDeposit?`/전세${i(r.rentDeposit)}`:"";return`(${r.owner}/${r.type}${w} 시세 ${i(r.amount)}${r.loanAmount?`/담보${i(r.loanAmount)}`:""}${Q})`}):[];let c=s.length>0?s.join(" "):"없음";const u=[];let d=0;e.housingType!=="자가"&&e.housingType!=="무상거주"&&e.depositLoanAmount&&(u.push(`보증금 대출(${i(e.depositLoanAmount)})`),d+=e.depositLoanAmount),e.housingType==="자가"&&e.ownHouseLoan&&(u.push(`집 담보 대출(${i(e.ownHouseLoan)})`),d+=e.ownHouseLoan),e.assets&&e.assets.filter(r=>r.loanAmount>0).forEach(r=>{u.push(`${r.type} 담보(${i(r.loanAmount)})`),d+=r.loanAmount}),e.collateralLoanMemo&&u.push(e.collateralLoanMemo);let m=u.length>0?u.join(", "):"없음";d>0&&(m+=` [총 합계: ${i(d)}]`);let l=0;const h=e.creditLoan&&e.creditLoan.length>0?e.creditLoan.map(r=>(l+=r.amount||0,`${r.desc} ${i(r.amount)}`)):[];e.creditCardUse==="사용"&&e.creditCardAmount&&(l+=e.creditCardAmount,h.push(`신용카드 ${i(e.creditCardAmount)}`));let f=h.length>0?h.join(", "):"없음";l>0&&(f+=` [총 합계: ${i(l)}]`);let p=e.historyType||"없음";e.historyType&&e.historyType!=="없음"&&e.historyMemo&&(p+=` (${e.historyMemo})`);const b=e.specialMemo?[...e.specialMemo].filter(r=>!r.content.startsWith("[상태변경]")).sort((r,w)=>w.createdAt.localeCompare(r.createdAt)):[],T=b.length>0?b.map(r=>`[${$(new Date(r.createdAt),"yyyy-MM-dd HH:mm",{locale:He})}]
${r.content}`).join(`

`):"없음",A=e.jobTypes&&e.jobTypes.length>0?e.jobTypes.join(", "):"정보 없음",g=[];(N=e.incomeDetails)!=null&&N.salary&&g.push(`직장인 ${i(e.incomeDetails.salary)}`),(k=e.incomeDetails)!=null&&k.business&&g.push(`사업자 ${i(e.incomeDetails.business)}`),(I=e.incomeDetails)!=null&&I.freelance&&g.push(`프리랜서 ${i(e.incomeDetails.freelance)}`);let S=g.join(" + ");g.length>1?S+=` (총 ${i(e.incomeNet)})`:g.length===0&&(S=i(e.incomeNet));const H={managerName:e.managerName,customerName:e.customerName,phone:e.phone,birth:e.birth?e.birth+"년생":"-",gender:e.gender,region:e.region,jobTypes:A,insurance4:e.insurance4,maritalStatus:e.maritalStatus,childrenCount:e.childrenCount!==void 0?e.childrenCount+"명":"-",incomeDetails:S,loanMonthlyPay:i(e.loanMonthlyPay),housingType:e.housingType,housingDetail:e.housingDetail,depositRentStr:o,assetsStr:c,creditLoanStr:f,collateralStr:m,creditCardUse:e.creditCardUse||"미사용",creditCardAmountStr:e.creditCardUse==="사용"&&e.creditCardAmount?i(e.creditCardAmount):"없음",historyStr:p,specialMemo:T};let L=a;for(const r in H){const w=new RegExp(`{{${r}}}`,"g");L=L.replace(w,H[r]||"")}return L.trim()},X=e=>{if(!e)return null;const t=K(e,"yyyy-MM-dd HH:mm",new Date);return y(t)?t:null},xe=e=>{if(!e)return"none";const t=X(e);return t?z(t)?"today":ne(t)?"overdue":"future":"none"},je=e=>{if(e==null)return null;if(e instanceof Date)return y(e)?e:null;const t=String(e);if(!t)return null;const a=new Date(t);if(y(a)&&t.includes("-")&&!isNaN(a.getTime()))return a;const n=t.trim(),o=/(\d{4})[\.\-]\s*(\d{1,2})[\.\-]\s*(\d{1,2})[\.]?\s*(오전|오후)?\s*(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?/,s=n.match(o);if(s){const m=parseInt(s[1]),l=parseInt(s[2])-1,h=parseInt(s[3]),f=s[4];let p=parseInt(s[5]);const b=parseInt(s[6]),T=s[7]?parseInt(s[7]):0;f==="오후"&&p<12&&(p+=12),f==="오전"&&p===12&&(p=0);const A=new Date(m,l,h,p,b,T);if(y(A))return A}const c=/(\d{4})[\.\-]\s*(\d{1,2})[\.\-]\s*(\d{1,2})/,u=n.match(c);if(u){const m=parseInt(u[1]),l=parseInt(u[2])-1,h=parseInt(u[3]),f=new Date(m,l,h);if(y(f))return f}const d=new Date(t.replace(/\./g,"-"));return y(d)&&!isNaN(d.getTime())?d:null},W=e=>["일","월","화","수","목","금","토"][e]||"",_e=(e,t)=>{const a=t.commissionRules,n=t.settlementConfig,o=e.filter(l=>l.partnerId===t.partnerId&&["1차 입금완료","2차 입금완료","계약 완료"].includes(l.status)&&l.contractFee);let s=0,c=0;o.forEach(l=>{const h=(l.deposit1Amount||0)+(l.deposit2Amount||0);s+=h;const{payable:f}=V(l,a,n);c+=f});const u=new Date;let d=x(u,n.cutoffDay,{weekStartsOn:0});te(d,u)&&!z(d)&&(d=ae(u,n.cutoffDay));let m=x(d,n.payoutDay,{weekStartsOn:0});return n.payoutDay<=n.cutoffDay&&(m=j(m,1)),n.payoutWeekDelay>0&&(m=j(m,n.payoutWeekDelay)),{cutoffDate:$(d,"yyyy-MM-dd"),payoutDate:$(m,"yyyy-MM-dd"),currentTotalDeposit:s,expectedCommission:c,threshold:0,isEligible:c>0,cutoffDayName:W(n.cutoffDay),payoutDayName:W(n.payoutDay)}},Oe=e=>new Promise((t,a)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>{if(typeof n.result=="string"){const o=n.result.split(",")[1];t(o)}},n.onerror=o=>a(o)}),ze=e=>{if(!e)return"";if(!e.includes("drive.google.com"))return e;let t="";const a=e.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);if(a)t=a[1];else{const n=e.match(/[?&]id=([a-zA-Z0-9_-]+)/);n&&(t=n[1])}return t?`https://drive.google.com/uc?export=download&id=${t}`:e},Ue=(e,t)=>{if(!e)return"";let a=e;const n=t.managerName||localStorage.getItem("managerName")||"담당자 미정",o=/^[*]?\s*담당자\s*:.*/m;return o.test(a)?a=a.replace(o,`* 담당자 : ${n}`):a=`* 담당자 : ${n}
`+a,a},Ve=(e,t,a="-")=>{if(!e)return a;try{const n=new Date(e);return y(n)?$(n,t):a}catch(n){return console.warn("Date formatting error:",n),a}},Xe=e=>{const t=[];let a=0;return e.housingType!=="자가"&&e.housingType!=="무상거주"&&e.depositLoanAmount&&(t.push(`보증금 대출(${i(e.depositLoanAmount)})`),a+=e.depositLoanAmount),e.housingType==="자가"&&e.ownHouseLoan&&(t.push(`집 담보 대출(${i(e.ownHouseLoan)})`),a+=e.ownHouseLoan),e.assets&&e.assets.filter(n=>n.loanAmount>0).forEach(n=>{t.push(`${n.type} 담보(${i(n.loanAmount)})`),a+=n.loanAmount}),t.length===0?"없음":`${t.join(", ")} (총 ${i(a)})`},Qe=async e=>(console.log("Mock Generating AI Summary for",e.name),new Promise(t=>{setTimeout(()=>{t(`[AI 요약 - ${e.name}]

1. 상담 내용: 
(내용이 자동으로 생성됩니다)

2. 주요 자산:
- 확인 필요

3. 특이사항:
- 고객 요청사항...`)},2e3)})),qe=Object.freeze(Object.defineProperty({__proto__:null,calculateCommission:U,calculateNextSettlement:_e,calculatePayableCommission:V,checkIsDuplicate:Ie,convertToPlayableUrl:ze,fileToBase64:Oe,formatKoreanMoney:i,generateAiSummary:Qe,generateSummary:Ee,getAutoCollateralString:Xe,getCaseWarnings:Ne,getDayName:W,getMatchingRule:R,getReminderStatus:xe,injectSummaryMetadata:Ue,normalizeBirthYear:ke,normalizePhone:F,parseGenericDate:je,parseReminder:X,safeFormat:Ve},Symbol.toStringTag,{value:"Module"}));export{J as a,Ne as b,_e as c,Ie as d,je as e,Oe as f,xe as g,ze as h,z as i,Xe as j,Ee as k,Ue as l,U as m,ke as n,Qe as o,X as p,W as q,Ve as s,qe as u};
