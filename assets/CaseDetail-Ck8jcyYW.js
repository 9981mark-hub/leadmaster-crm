import{c as w,I as Ss,e as ks,r as d,b as As,d as Ms,o as Ts,p as Is,E as le,G as Ds,v as Ue,j as e,T as Hs,S as Rs,f as B,X as oe,C as Ls,J as _s,H as zs,y as Ps,F as Es,R as Os,A as Fs,z as Us,B as Gs,K as $s,N as Bs,O as Ys}from"./index-gXwFrOTy.js";import{b as Vs,h as Js,j as Ge,n as Ws,f as qs}from"./utils-DFIKhzxV.js";import{G as Ks}from"./index-BpRkNtKl.js";import{T as I,P as de}from"./trash-2-BS6qSLjz.js";import{C as Xs,S as Qs}from"./sparkles-YCcMEX_Y.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],et=w("archive",Zs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],$e=w("calendar-clock",st);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],at=w("circle-play",tt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],rt=w("copy",nt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],ot=w("mic",lt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Be=w("pen",dt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ct=w("send",it),m=({label:x,value:l,onChange:t,onBlur:j,type:b="text",placeholder:g="",suffix:C="",readOnly:A=!1})=>{const Y=b==="number"&&(l===0||l===void 0||l===null)?"":l;return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:x}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:b,className:"w-full p-2 border border-blue-300 rounded text-sm outline-none "+(A?"bg-gray-100 text-gray-500 cursor-not-allowed":"focus:ring-1 focus:ring-blue-500"),value:Y,onChange:D=>!A&&t(b==="number"?Number(D.target.value)||0:D.target.value),onBlur:j,placeholder:g,readOnly:A}),C&&e.jsx("span",{className:"absolute right-3 top-2 text-gray-500 text-xs",children:C})]})]})},p=({label:x,value:l,onChange:t,options:j,isMulti:b=!1})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:x}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:j.map(g=>{const C=b?l==null?void 0:l.includes(g):l===g;return e.jsx("button",{type:"button",onClick:()=>t(g),className:"px-3 py-1.5 text-xs rounded border "+(C?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"),children:g},g)})})]});function gt(){var Te,Ie,De,He,Re,Le,_e,ze,Pe,Ee,Oe;const{caseId:x}=Ss(),{showToast:l}=ks(),[t,j]=d.useState(null),[b,g]=d.useState([]),[C,A]=d.useState([]),[Y,D]=d.useState([]),[H,Ye]=d.useState("info"),[c,S]=d.useState({owner:"ë³¸ì¸",type:"ìë™ì°¨",amount:0,loanAmount:0,desc:""}),[f,V]=d.useState({amount:0,desc:""}),[J,ie]=d.useState(""),[R,ce]=d.useState(""),[L,me]=d.useState("09"),[_,xe]=d.useState("00"),[ue,W]=d.useState("");d.useEffect(()=>{W(R&&L&&_?`${R} ${L}:${_}`:"")},[R,L,_]);const[q,he]=d.useState("í†µí™”"),[pe,be]=d.useState(""),[Ve,K]=d.useState(null),[z,X]=d.useState(null),[ge,Q]=d.useState(""),[Je,P]=d.useState(null),[ye,je]=d.useState(!1),[fe,Z]=d.useState(!1),[k,E]=d.useState(""),[M,We]=d.useState(null),[ee,qe]=d.useState(null),Ne=d.useRef(null),O=d.useRef(null),[ve,we]=d.useState([]),[Ke,se]=d.useState(!1),[F,te]=d.useState(null),[Ce,Se]=d.useState("");if(d.useEffect(()=>(x&&(Promise.all([As(),Ms(),Ts(),Is()]).then(([s,a,r,i])=>{const o=s.find(h=>h.caseId===x)||null;o&&(o.isNew&&(o.isNew=!1,le(o.caseId,{isNew:!1})),typeof o.jobType=="string"&&(o.jobTypes=[o.jobType],delete o.jobType),o.jobTypes||(o.jobTypes=[]),o.incomeDetails||(o.incomeDetails={}),o.reminders||(o.reminders=[]),o.recordings||(o.recordings=[]),j(o),Ds(o.caseId)),g(a),A(r),D(i),o!=null&&o.aiSummary&&E(o.aiSummary)}),Ue(x).then(we)),()=>{ee&&URL.revokeObjectURL(ee)}),[x]),!t)return e.jsx("div",{className:"p-8 text-center text-gray-500",children:"ë¡œë”©ì¤‘..."});const u=b.find(s=>s.partnerId===t.partnerId),Xe=u?u.commissionRules:[],Qe=s=>{const a=s.target.value;te(a),se(!0),Se("")},Ze=async()=>{if(!(!x||!F))try{const s=await $s(x,F,Ce);j(s);const a=await Ue(x);we(a),l("ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."),se(!1),te(null)}catch{l("ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}},n=(s,a)=>{if(!t)return;const r={...t,[s]:a};s==="incomeDetails"&&(r.incomeNet=Object.values(a).reduce((i,o)=>i+(o||0),0)),j(r),le(t.caseId,{[s]:a})},ae=(s,a)=>{if(!t)return;const r={...t.incomeDetails||{},[s]:a};n("incomeDetails",r)},es=s=>{if(!t)return;const a=t.jobTypes||[],r=a.includes(s)?a.filter(N=>N!==s):[...a,s],i={...t.incomeDetails||{}};s==="ì§ì¥ì¸"&&!r.includes("ì§ì¥ì¸")&&delete i.salary,["ê°œì¸ì‚¬ì—…ì","ë²•ì¸ì‚¬ì—…ì"].includes(s)&&!r.some(N=>["ê°œì¸ì‚¬ì—…ì","ë²•ì¸ì‚¬ì—…ì"].includes(N))&&delete i.business,s==="í”„ë¦¬ëœì„œ"&&!r.includes("í”„ë¦¬ëœì„œ")&&delete i.freelance;const o=Object.values(i).reduce((N,U)=>N+(U||0),0),h={...t,jobTypes:r,incomeDetails:i,incomeNet:o};j(h),le(t.caseId,{jobTypes:r,incomeDetails:i,incomeNet:o})},ss=()=>{const s=Ws(t.birth);s!==t.birth&&n("birth",s)},ts=()=>{if(!c.type||!t)return;const s={id:Date.now().toString(),owner:c.owner||"ë³¸ì¸",type:c.type||"ê¸°íƒ€",amount:c.amount||0,loanAmount:c.loanAmount||0,desc:c.desc||""},a=t.assets?[...t.assets,s]:[s];n("assets",a),S({owner:"ë³¸ì¸",type:"ìë™ì°¨",amount:0,loanAmount:0,desc:""})},as=()=>{if(!f.amount||!f.desc){l("ëŒ€ì¶œê¸ˆì•¡ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}const s={id:Date.now().toString(),amount:f.amount||0,desc:f.desc||""};n("creditLoan",[...t.creditLoan||[],s]),V({amount:0,desc:""})},ns=s=>{if(!t)return;const a=t.assets.filter(r=>r.id!==s);n("assets",a)},rs=s=>{if(!t)return;const a=(t.creditLoan||[]).filter(r=>r.id!==s);n("creditLoan",a)},ls=()=>{if(!J.trim()||!t)return;const a=[{id:Date.now().toString(),createdAt:new Date().toISOString(),content:J.trim()},...t.specialMemo||[]];n("specialMemo",a),ie(""),l("ìƒë‹´ ë‚´ìš©ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")},os=s=>{X(s.id),Q(s.content),P(null)},ds=()=>{if(!t||!z)return;const s=(t.specialMemo||[]).map(a=>a.id===z?{...a,content:ge}:a);n("specialMemo",s),X(null),Q(""),l("ìƒë‹´ ë‚´ìš©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")},is=s=>{if(!t)return;const a=(t.specialMemo||[]).filter(r=>r.id!==s);n("specialMemo",a),l("ìƒë‹´ ë‚´ìš©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),P(null)},cs=()=>{if(!ue){l("ë‚ ì§œì™€ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.","error");return}if(!t||!t.reminders)return;if(t.reminders.length>=5){l("ë¦¬ë§ˆì¸ë”ëŠ” ìµœëŒ€ 5ê°œê¹Œì§€ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.","error");return}const s={id:Date.now().toString(),datetime:ue.replace("T"," "),type:q,content:pe},a=[...t.reminders,s];n("reminders",a),ce(""),me("09"),xe("00"),W(""),be(""),he("í†µí™”"),l("ë‹¤ìŒ ì¼ì •ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")},ms=s=>{if(!t||!t.reminders)return;const a=t.reminders.filter(r=>r.id!==s);n("reminders",a),K(null),l("ì¼ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")},xs=s=>{var r;const a=(r=s.target.files)==null?void 0:r[0];if(a){if(a.size>20*1024*1024){l("íŒŒì¼ í¬ê¸°ëŠ” 20MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error");return}We(a);const i=URL.createObjectURL(a);qe(i),l("'"+a.name+"' íŒŒì¼ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.");const o={id:Bs(),filename:a.name,uploadDate:new Date().toISOString(),url:i,mimeType:a.type};if(t){const h=[o,...t.recordings||[]];n("recordings",h)}}},ke=()=>{var s;(s=Ne.current)==null||s.click()},us=s=>{O.current&&(O.current.src=s.url,O.current.play(),l(s.filename+" ì¬ìƒì„ ì‹œì‘í•©ë‹ˆë‹¤."))},hs=s=>{if(t&&confirm("ì´ ë…¹ìŒ íŒŒì¼ì„ ëª©ë¡ì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){const a=(t.recordings||[]).filter(r=>r.id!==s);n("recordings",a)}},ps=async()=>{var i,o,h,N,U;if(!t)return;let s=M;if(!s&&(!t.recordings||t.recordings.length===0)){l("ë¶„ì„í•  í†µí™” ë…¹ìŒ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.","error");return}if(!s){l("ë¶„ì„ì„ ìœ„í•´ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.","error"),ke();return}const a=b.find(v=>v.partnerId===t.partnerId),r=(a==null?void 0:a.aiPromptTemplate)||Ys;je(!0);try{const v="AIzaSyAcY0S1fvge0FtV_GsmEo5u15vdsau4sBU",vs=new Ks(v).getGenerativeModel({model:"gemini-flash-latest"}),ws=`
[ê¸°ë³¸ ì •ë³´]
ê³ ê°ëª…: `+t.customerName+`
ì—°ë½ì²˜: `+t.phone+`
ì§ì—…: `+((i=t.jobTypes)==null?void 0:i.join(", "))+`

[ê¸°ì¡´ ìƒë‹´ ì´ë ¥]
`+(((o=t.specialMemo)==null?void 0:o.map(y=>y.content).join(`
`))||"ì—†ìŒ")+`

[ì‚¬ì „ ì •ë³´]
`+(t.preInfo||"ì—†ìŒ")+`
`,re=[];if(s){const y=await qs(s),$=s.type||"audio/mp3";re.push({inlineData:{mimeType:$,data:y}})}re.push({text:r+`

`+ws});let T=0;const Fe=3;let G="";for(;T<Fe;)try{G=(await(await vs.generateContent(re)).response).text();break}catch(y){if(T++,console.warn(`AI Attempt ${T} failed: `,y),((h=y.message)!=null&&h.includes("429")||(N=y.message)!=null&&N.includes("503"))&&T<Fe){const $=Math.pow(2,T)*1e3+Math.random()*500;await new Promise(Cs=>setTimeout(Cs,$));continue}throw y}G?(E(G),n("aiSummary",G),l("AI ìš”ì•½ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")):l("AI ìš”ì•½ ë‚´ìš©ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.","error")}catch(v){console.error("AI Generation Error:",v),(U=v.message)!=null&&U.includes("429")?l("ì‚¬ìš©ëŸ‰ì´ ë§ì•„ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.","error"):l("ì˜¤ë¥˜: "+(v.message||"AI ìš”ì•½ ìƒì„± ì‹¤íŒ¨"),"error")}finally{je(!1)}},bs=()=>{if(!k.trim())return;const a=[{id:Date.now().toString(),createdAt:new Date().toISOString(),content:`[AI ìš”ì•½]
`+k},...t.specialMemo||[]];n("specialMemo",a),l("ìƒë‹´ ë‚´ìš©ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")},gs=()=>{n("aiSummary",k),Z(!1),l("ìš”ì•½ ë‚´ìš©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")},ys=()=>{confirm("AI ìš”ì•½ ë‚´ìš©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(E(""),n("aiSummary",""),l("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."))},js=()=>{const s=u?u.summaryTemplate:void 0,a=Ge(t,s);navigator.clipboard.writeText(a),l("ìš”ì•½ë¬¸ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")},fs=()=>{const s=[];return(t.depositLoanAmount||0)>0&&s.push("ë³´ì¦ê¸ˆ ëŒ€ì¶œ "+t.depositLoanAmount+" ë§Œì›"),(t.ownHouseLoan||0)>0&&s.push("ì§‘ ë‹´ë³´ ëŒ€ì¶œ "+t.ownHouseLoan+" ë§Œì›"),t.assets&&t.assets.forEach(a=>{a.loanAmount>0&&s.push(a.type+" ë‹´ë³´ "+a.loanAmount+" ë§Œì›")}),s.length>0?s.join(" + "):"ì—†ìŒ"},Ae=Vs(t,u),Ns=Js(t.contractFee||0,Xe),Me=t.specialMemo?[...t.specialMemo].sort((s,a)=>a.createdAt.localeCompare(s.createdAt)):[],ne=t.reminders?[...t.reminders].sort((s,a)=>s.datetime.localeCompare(a.datetime)):[];return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 sticky top-0 z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold text-white whitespace-nowrap "+(["ê°œì¸íšŒìƒ","íŒŒì‚°"].includes(t.caseType||"")?"bg-indigo-500":"bg-gray-500"),children:t.caseType}),e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded font-bold border border-gray-200 whitespace-nowrap",children:(u==null?void 0:u.name)||"ê±°ë˜ì²˜ ë¯¸ì •"}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 whitespace-nowrap",children:t.customerName}),e.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:t.phone})]}),Ae.length>0&&e.jsx("div",{className:"flex gap-2 mt-2",children:Ae.map(s=>e.jsxs("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded font-bold flex items-center",children:[e.jsx(Hs,{size:12,className:"mr-1"})," ",s]},s))})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px]",children:[e.jsx("label",{className:"text-xs text-gray-400 font-medium",children:"í˜„ì¬ ìƒíƒœ ë³€ê²½"}),e.jsx("select",{className:"p-2 border border-gray-300 rounded font-semibold outline-none "+(Rs[t.status]||"bg-blue-50 text-blue-800"),value:t.status,onChange:Qe,children:Y.map(s=>e.jsx("option",{value:s,children:s},s))})]})]})}),Ke&&F&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-[400px] shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"ìƒíƒœ ë³€ê²½ í™•ì¸"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["ìƒíƒœë¥¼ ",e.jsx("span",{className:"font-bold text-blue-600",children:t.status}),"ì—ì„œ ",e.jsx("span",{className:"font-bold text-blue-600",children:F}),"(ìœ¼)ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ë³€ê²½ ì‚¬ìœ  / ë©”ëª¨"}),e.jsx("textarea",{className:"w-full p-2 border rounded resize-none h-24 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"ìƒíƒœ ë³€ê²½ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”...",value:Ce,onChange:s=>Se(s.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{se(!1),te(null)},className:"px-4 py-2 bg-gray-200 rounded text-gray-800 font-medium hover:bg-gray-300",children:"ì·¨ì†Œ"}),e.jsx("button",{onClick:Ze,className:"px-4 py-2 bg-blue-600 rounded text-white font-medium hover:bg-blue-700",children:"ë³€ê²½í•˜ê¸°"})]})]})}),e.jsx("div",{className:"flex border-b border-gray-200 bg-white px-4 rounded-t-lg overflow-x-auto no-scrollbar",children:[{id:"info",label:"ì •ë³´ ìˆ˜ì •"},{id:"summary",label:"ìš”ì•½ë¬¸"},{id:"settlement",label:"ìˆ˜ì„ë£Œ/ì •ì‚°"}].map(s=>e.jsx("button",{onClick:()=>Ye(s.id),className:"px-4 py-3 text-sm font-medium border-b-2 whitespace-nowrap "+(H===s.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:s.label},s.id))}),e.jsxs("div",{className:"bg-white p-6 rounded-b-xl shadow-sm border border-gray-100 border-t-0 min-h-[600px]",children:[H==="info"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-100",children:[e.jsx("h3",{className:"font-bold text-yellow-800 mb-2 flex items-center gap-2",children:"ğŸ“… ë¦¬ë§ˆì¸ë” ë° ìƒë‹´ ì´ë ¥"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-yellow-200 shadow-sm",children:[e.jsxs("label",{className:"block text-xs font-bold text-yellow-800 mb-2",children:["ë‹¤ìŒ ì¼ì • ë“±ë¡ (",ne.length,"/5)"]}),e.jsx("div",{className:"flex flex-col md:flex-row gap-2 mb-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2 flex-[2]",children:[e.jsxs("div",{className:"flex flex-wrap gap-1 items-center flex-1 min-w-[200px]",children:[e.jsx("input",{type:"date",className:"flex-[2] p-2 border border-blue-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500",value:R,onChange:s=>ce(s.target.value),disabled:(((Te=t.reminders)==null?void 0:Te.length)||0)>=5}),e.jsx("select",{className:"flex-1 p-2 border border-blue-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500",value:L,onChange:s=>me(s.target.value),disabled:(((Ie=t.reminders)==null?void 0:Ie.length)||0)>=5,children:Array.from({length:24}).map((s,a)=>{const r=a.toString().padStart(2,"0");return e.jsxs("option",{value:r,children:[r,"ì‹œ"]},r)})}),e.jsx("select",{className:"flex-1 p-2 border border-blue-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500",value:_,onChange:s=>xe(s.target.value),disabled:(((De=t.reminders)==null?void 0:De.length)||0)>=5,children:["00","10","20","30","40","50"].map(s=>e.jsxs("option",{value:s,children:[s,"ë¶„"]},s))})]}),e.jsxs("select",{className:"p-2 border border-gray-300 rounded text-sm min-w-[80px]",value:q,onChange:s=>he(s.target.value),children:[e.jsx("option",{value:"í†µí™”",children:"í†µí™”"}),e.jsx("option",{value:"ì¶œì¥ë¯¸íŒ…",children:"ì¶œì¥ë¯¸íŒ…"}),e.jsx("option",{value:"ë°©ë¬¸ë¯¸íŒ…",children:"ë°©ë¬¸ë¯¸íŒ…"}),e.jsx("option",{value:"ê¸°íƒ€",children:"ê¸°íƒ€"})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"flex-1 p-2 border border-gray-300 rounded text-sm",placeholder:q==="ê¸°íƒ€"?"ì¼ì • ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”":"ë©”ëª¨ (ì„ íƒì‚¬í•­)",value:pe,onChange:s=>be(s.target.value)}),e.jsx("button",{onClick:cs,disabled:(((He=t.reminders)==null?void 0:He.length)||0)>=5,className:"bg-yellow-500 text-white px-3 py-2 rounded text-sm font-bold hover:bg-yellow-600 whitespace-nowrap disabled:bg-gray-400",children:"ì¶”ê°€"})]}),e.jsx("div",{className:"space-y-2",children:ne.length===0?e.jsx("div",{className:"text-center py-2 text-xs text-gray-400 bg-gray-50 rounded border border-gray-100 border-dashed",children:"ì§€ì •ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤."}):ne.map(s=>e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded p-2 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{size:16,className:"text-blue-600"}),e.jsx("span",{className:"text-sm font-bold text-gray-800",children:s.datetime})]}),Ve===s.id?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ms(s.id),className:"text-green-600 text-xs font-bold",children:"í™•ì¸"}),e.jsx("button",{onClick:()=>K(null),className:"text-red-500 text-xs",children:"ì·¨ì†Œ"})]}):e.jsx("button",{onClick:()=>K(s.id),className:"text-red-500 p-1 hover:bg-red-50 rounded",title:"ì¼ì • ì‚­ì œ",children:e.jsx(I,{size:16})})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-yellow-800 mb-1",children:"ìƒë‹´ íŠ¹ì´ì‚¬í•­ ì¶”ê°€"}),e.jsx("textarea",{className:"w-full p-2 border border-yellow-300 rounded bg-white h-[60px] text-sm focus:ring-1 focus:ring-yellow-500 outline-none",value:J,onChange:s=>ie(s.target.value),placeholder:"ì¶”ê°€í•  ìƒë‹´ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."}),e.jsx("button",{onClick:ls,className:"w-full mt-1 bg-yellow-100 text-yellow-800 border border-yellow-300 px-3 py-1.5 rounded text-xs font-bold hover:bg-yellow-200",children:"ìƒë‹´ ë‚´ìš© ì¶”ê°€"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-yellow-800 mb-2",children:"ìƒë‹´ ì´ë ¥"}),e.jsxs("div",{className:"max-h-64 overflow-y-auto space-y-2 bg-yellow-100/30 p-2 rounded",children:[Me.length===0&&e.jsx("p",{className:"text-center text-xs text-gray-500 py-4",children:"ì €ì¥ëœ ìƒë‹´ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤."}),Me.map(s=>e.jsxs("div",{className:"bg-white p-3 rounded text-xs shadow-sm border border-yellow-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("p",{className:"font-bold text-gray-500 text-[10px]",children:B(new Date(s.createdAt),"yyyy-MM-dd HH:mm")}),e.jsx("div",{className:"flex gap-1",children:z===s.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:ds,className:"text-green-600 hover:bg-green-50 p-1 rounded",title:"ì €ì¥",children:e.jsx(Xs,{size:14})}),e.jsx("button",{type:"button",onClick:()=>X(null),className:"text-gray-400 hover:bg-gray-100 p-1 rounded",title:"ì·¨ì†Œ",children:e.jsx(oe,{size:14})})]}):Je===s.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>is(s.id),className:"text-green-600 hover:bg-green-50 p-1 rounded font-bold",title:"í™•ì¸",children:"í™•ì¸"}),e.jsx("button",{type:"button",onClick:()=>P(null),className:"text-red-500 hover:bg-red-50 p-1 rounded",title:"ì·¨ì†Œ",children:"ì·¨ì†Œ"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>os(s),className:"text-blue-500 hover:bg-blue-50 p-1 rounded",title:"ìˆ˜ì •",children:e.jsx(Be,{size:14})}),e.jsx("button",{type:"button",onClick:()=>P(s.id),className:"text-red-500 hover:bg-red-50 p-1 rounded",title:"ì‚­ì œ",children:e.jsx(I,{size:14})})]})})]}),z===s.id?e.jsx("textarea",{className:"w-full p-1 border rounded text-xs h-20",value:ge,onChange:a=>Q(a.target.value)}):e.jsx("p",{className:"text-gray-800 whitespace-pre-wrap leading-relaxed",children:s.content})]},s.id))]})]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"font-bold text-purple-800 flex items-center gap-2",children:[e.jsx(Qs,{size:18,className:"flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col leading-none",children:[e.jsx("span",{children:"AI ìƒë‹´ ìš”ì•½"}),e.jsx("span",{children:"& ë…¹ìŒ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",ref:Ne,className:"hidden",accept:"audio/*",onChange:xs}),e.jsxs("button",{onClick:ke,className:"flex items-center gap-1 text-xs px-2 py-1.5 rounded border "+(M?"bg-green-100 text-green-700 border-green-300":"bg-white text-gray-600 border-gray-300"),children:[e.jsx(ot,{size:14,className:"flex-shrink-0"}),e.jsx("span",{className:"text-center leading-tight",children:M?"íŒŒì¼ ë³€ê²½":e.jsxs(e.Fragment,{children:["ë…¹ìŒíŒŒì¼",e.jsx("br",{}),"ì—…ë¡œë“œ"]})})]}),e.jsx("button",{onClick:ps,disabled:ye,className:"flex items-center gap-1 text-xs bg-purple-600 text-white px-3 py-1.5 rounded font-bold hover:bg-purple-700 disabled:opacity-50 transition-colors shadow-sm",children:ye?"ë¶„ì„ ì¤‘...":e.jsxs("span",{className:"text-center leading-tight",children:["ìš”ì•½",e.jsx("br",{}),"ì‹¤í–‰"]})})]})]}),e.jsxs("div",{className:"mb-4 bg-white p-3 rounded-lg border border-purple-100",children:[e.jsx("audio",{ref:O,controls:!0,className:"w-full h-8 mb-2",src:ee||""}),M&&e.jsxs("p",{className:"text-xs text-gray-500",children:["í˜„ì¬ ì„ íƒëœ íŒŒì¼: ",M.name]})]}),t.recordings&&t.recordings.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-gray-600 mb-2 flex items-center",children:[e.jsx(et,{size:12,className:"mr-1"})," ë…¹ìŒ ì•„ì¹´ì´ë¸Œ"]}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto no-scrollbar",children:t.recordings.map(s=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-2 rounded border border-gray-200 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx(at,{size:16,className:"text-blue-500 cursor-pointer flex-shrink-0",onClick:()=>us(s)}),e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"font-medium",children:s.filename}),e.jsx("span",{className:"text-gray-400 text-[10px] ml-1",children:B(new Date(s.uploadDate),"yy.MM.dd HH:mm")})]})]}),e.jsx("button",{onClick:()=>hs(s.id),className:"text-gray-400 hover:text-red-500",children:e.jsx(oe,{size:14})})]},s.id))})]}),e.jsx("div",{className:"bg-white p-3 rounded-lg border border-purple-100 shadow-sm relative min-h-[80px]",children:fe?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{className:"w-full h-32 p-2 text-sm border border-purple-200 rounded focus:outline-none focus:ring-1 focus:ring-purple-500",value:k,onChange:s=>E(s.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:gs,className:"text-xs bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"ì €ì¥"}),e.jsx("button",{onClick:()=>Z(!1),className:"text-xs bg-gray-200 text-gray-700 px-3 py-1 rounded hover:bg-gray-300",children:"ì·¨ì†Œ"})]})]}):e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>Z(!0),className:"p-1 text-blue-500 hover:bg-blue-50 rounded",title:"ìˆ˜ì •",children:e.jsx(Be,{size:14})}),e.jsx("button",{onClick:ys,className:"p-1 text-red-500 hover:bg-red-50 rounded",title:"ì‚­ì œ",children:e.jsx(I,{size:14})})]}),e.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap leading-relaxed pr-10",children:k||e.jsx("span",{className:"text-gray-400",children:"ìš”ì•½ëœ ìƒë‹´ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. í†µí™” íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ê¸°ì¡´ ìƒë‹´ ë‚´ì—­ì„ ë°”íƒ•ìœ¼ë¡œ ìš”ì•½ì„ ì‹¤í–‰í•´ë³´ì„¸ìš”."})})]})}),k&&!fe&&e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("button",{onClick:bs,className:"flex items-center gap-1 text-xs bg-indigo-50 text-indigo-700 px-3 py-2 rounded font-bold hover:bg-indigo-100 border border-indigo-200 transition-colors",children:[e.jsx(ct,{size:14})," ìƒë‹´ ë‚´ìš©ìœ¼ë¡œ ë³´ë‚´ê¸° (íŠ¹ì´ì‚¬í•­ ì¶”ê°€)"]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ê¸°ë³¸ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ê±°ë˜ì²˜ (ë²•ë¥ ì‚¬ë¬´ì†Œ)"}),e.jsx("select",{className:"w-full p-2 border border-gray-300 rounded text-sm bg-gray-50",value:t.partnerId,onChange:s=>n("partnerId",s.target.value),children:b.map(s=>e.jsx("option",{value:s.partnerId,children:s.name},s.partnerId))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ìœ ì… ê²½ë¡œ"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-blue-500 outline-none",value:t.inboundPath,onChange:s=>n("inboundPath",s.target.value),children:[e.jsx("option",{value:"",children:"ì„ íƒí•˜ì„¸ìš”"}),C.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ì‚¬ì „ ê³ ê° ì •ë³´ (ë¦¬ë“œ ìˆ˜ì§‘ ì •ë³´)"}),e.jsx("div",{className:"w-full p-2 border border-gray-200 rounded text-sm bg-gray-50 min-h-[40px] whitespace-pre-wrap "+(t.preInfo?"text-gray-800":"text-gray-400"),children:t.preInfo?t.preInfo.split(/\s\/\s|\n/).filter(s=>{const a=s.toLowerCase();return!a.includes("[referrer]")&&!a.includes("[marketing_consent]")&&!a.includes("[third_party_consent]")&&!a.includes("[user_agent]")&&s.trim()!==""}).join(`
`)||e.jsx("span",{className:"text-gray-400 italic",children:"í‘œì‹œí•  ì¶”ê°€ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. (ê¸°ìˆ  ì •ë³´ ì œì™¸ë¨)"}):""})]}),ve.length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 mb-6",children:[e.jsxs("h4",{className:"font-bold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx($e,{size:16})," ìƒíƒœ ë³€ê²½ ì´ë ¥"]}),e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2",children:ve.map(s=>e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-blue-100 shadow-sm text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gray-400 line-through text-xs px-2 py-0.5 bg-gray-100 rounded",children:s.fromStatus}),e.jsx("span",{className:"text-gray-400",children:"â†’"}),e.jsx("span",{className:"font-bold text-blue-600 text-xs px-2 py-0.5 bg-blue-50 rounded border border-blue-100",children:s.toStatus})]}),e.jsx("span",{className:"text-[10px] text-gray-400",children:B(new Date(s.changedAt),"yy.MM.dd HH:mm")})]}),s.memo&&e.jsx("div",{className:"mt-2 text-gray-600 bg-gray-50 p-2 rounded text-xs leading-relaxed",children:s.memo}),e.jsx("div",{className:"mt-1 text-right",children:e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Changed by ",s.changedBy]})})]},s.logId))})]}),e.jsx(m,{label:"ìµœì´ˆ ë“±ë¡ì¼ì‹œ",value:t.createdAt?B(new Date(t.createdAt),"yyyy-MM-dd HH:mm"):"-",readOnly:!0,onChange:()=>{}}),e.jsx("div",{className:"mb-4",children:e.jsx(p,{label:"ì‚¬ê±´ ìœ í˜•",value:t.caseType,onChange:s=>n("caseType",s),options:Ls})}),e.jsx(m,{label:"ì´ë¦„",value:t.customerName,onChange:s=>n("customerName",s)}),e.jsx(m,{label:"ì—°ë½ì²˜",value:t.phone,onChange:s=>n("phone",s),placeholder:"010-0000-0000"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(m,{label:"ì¶œìƒë…„ë„ (2ìë¦¬)",value:t.birth,onChange:s=>n("birth",s),onBlur:ss,placeholder:"ì˜ˆ: 77",suffix:((Re=t.birth)==null?void 0:Re.length)===4?"ë…„ìƒ":""}),e.jsx(p,{label:"ì„±ë³„",value:t.gender,onChange:s=>n("gender",s),options:["ë‚¨","ì—¬"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ì§ì—… / ê°€ì¡±"}),e.jsx(p,{label:"ì§ì—… (ë³µìˆ˜ì„ íƒ ê°€ëŠ¥)",value:t.jobTypes,onChange:es,options:_s,isMulti:!0}),((Le=t.jobTypes)==null?void 0:Le.includes("ì§ì¥ì¸"))&&e.jsx(m,{label:"ì§ì¥ì¸ ì›”ìˆ˜ì…(ë§Œì›)",type:"number",value:t.incomeDetails.salary,onChange:s=>ae("salary",s)}),(((_e=t.jobTypes)==null?void 0:_e.includes("ê°œì¸ì‚¬ì—…ì"))||((ze=t.jobTypes)==null?void 0:ze.includes("ë²•ì¸ì‚¬ì—…ì")))&&e.jsx(m,{label:"ì‚¬ì—…ì ì›”ìˆ˜ì…(ë§Œì›)",type:"number",value:t.incomeDetails.business,onChange:s=>ae("business",s)}),((Pe=t.jobTypes)==null?void 0:Pe.includes("í”„ë¦¬ëœì„œ"))&&e.jsx(m,{label:"í”„ë¦¬ëœì„œ ì›”ìˆ˜ì…(ë§Œì›)",type:"number",value:t.incomeDetails.freelance,onChange:s=>ae("freelance",s)}),e.jsx(p,{label:"4ëŒ€ë³´í—˜",value:t.insurance4,onChange:s=>n("insurance4",s),options:["ê°€ì…","ë¯¸ê°€ì…"]}),e.jsx(p,{label:"ê²°í˜¼ì—¬ë¶€",value:t.maritalStatus,onChange:s=>n("maritalStatus",s),options:["ë¯¸í˜¼","ê¸°í˜¼","ì´í˜¼"]}),t.maritalStatus!=="ë¯¸í˜¼"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ë¯¸ì„±ë…„ ìë…€ ìˆ˜"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[0,1,2,3,4,5,6,7].map(s=>e.jsxs("button",{type:"button",onClick:()=>n("childrenCount",s),className:"px-3 py-1.5 text-xs rounded border "+(t.childrenCount===s?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"),children:[s,"ëª…"]},s))})]})]})]}),e.jsx("hr",{className:"border-gray-100"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ì£¼ê±°"}),e.jsx(p,{label:"ê±°ì£¼í˜•íƒœ",value:t.housingType,onChange:s=>n("housingType",s),options:zs}),e.jsx(p,{label:"ì£¼ê±°ìƒì„¸",value:t.housingDetail,onChange:s=>n("housingDetail",s),options:Ps}),t.housingType==="ìê°€"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(m,{label:"ì§‘ ì‹œì„¸(ë§Œì›)",type:"number",value:t.ownHousePrice,onChange:s=>n("ownHousePrice",s)}),e.jsx(m,{label:"ì§‘ ë‹´ë³´ ëŒ€ì¶œ(ë§Œì›)",type:"number",value:t.ownHouseLoan,onChange:s=>n("ownHouseLoan",s)})]}),e.jsx(p,{label:"ì§‘ ëª…ì˜ì",value:t.ownHouseOwner,onChange:s=>n("ownHouseOwner",s),options:["ë³¸ì¸","ë°°ìš°ì"]})]}):t.housingType==="ë¬´ìƒê±°ì£¼"?e.jsx(e.Fragment,{children:e.jsx(p,{label:"ì§‘ ëª…ì˜ì",value:t.freeHousingOwner,onChange:s=>n("freeHousingOwner",s),options:Es})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(m,{label:"ë³´ì¦ê¸ˆ(ë§Œì›)",type:"number",value:t.deposit,onChange:s=>n("deposit",s)}),e.jsx(m,{label:"ë³´ì¦ê¸ˆ ëŒ€ì¶œ(ë§Œì›)",type:"number",value:t.depositLoanAmount,onChange:s=>n("depositLoanAmount",s)})]}),e.jsx(m,{label:"ì›”ì„¸(ë§Œì›)",type:"number",value:t.rent,onChange:s=>n("rent",s)}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ì„ëŒ€ì°¨ ê³„ì•½ì¸"}),e.jsx("div",{className:"flex gap-2",children:Os.map(s=>e.jsx("button",{type:"button",onClick:()=>n("rentContractor",s),className:"flex-1 py-1.5 text-xs rounded border "+(t.rentContractor===s?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"),children:s},s))})]})]}),e.jsx(m,{label:"ê±°ì£¼ì§€ì—­",value:t.region,onChange:s=>n("region",s)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ìì‚° / ë¶€ì±„"}),e.jsxs("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2 text-xs",children:"ìì‚° ëª©ë¡"}),e.jsxs("div",{className:"space-y-2 mb-3",children:[(!t.assets||t.assets.length===0)&&e.jsx("p",{className:"text-xs text-gray-400 text-center py-2",children:"ë“±ë¡ëœ ìì‚°ì´ ì—†ìŠµë‹ˆë‹¤."}),t.assets&&t.assets.map(s=>e.jsxs("div",{className:"bg-white p-2 rounded border flex justify-between items-center text-xs",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"font-bold text-blue-600 mr-2",children:["[",s.owner,"]"]}),e.jsx("span",{className:"font-semibold mr-2",children:s.type}),e.jsxs("span",{className:"text-gray-800 mr-2",children:["ì‹œì„¸ ",s.amount>0?s.amount.toLocaleString()+" ë§Œì›":"0ì›"]}),s.loanAmount>0&&e.jsxs("span",{className:"text-red-500 mr-2",children:["ë‹´ë³´ ",s.loanAmount.toLocaleString(),"ë§Œì›"]}),s.desc&&e.jsxs("span",{className:"text-gray-500",children:["(",s.desc,")"]})]}),e.jsx("button",{onClick:()=>ns(s.id),className:"text-red-500 p-1",children:e.jsx(I,{size:14})})]},s.id))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx("select",{className:"p-1.5 border rounded text-xs bg-white",value:c.owner,onChange:s=>S({...c,owner:s.target.value}),children:Fs.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("select",{className:"p-1.5 border rounded text-xs bg-white",value:c.type,onChange:s=>S({...c,type:s.target.value}),children:Us.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx("input",{type:"number",placeholder:"ì‹œì„¸ (ë§Œì›)",className:"w-full p-1.5 border rounded text-xs",value:c.amount||"",onChange:s=>S({...c,amount:Number(s.target.value)})}),e.jsx("input",{type:"number",placeholder:"ë‹´ë³´ëŒ€ì¶œ (ë§Œì›)",className:"w-full p-1.5 border rounded text-xs",value:c.loanAmount||"",onChange:s=>S({...c,loanAmount:Number(s.target.value)})})]}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",placeholder:"ìƒì„¸ ë‚´ìš© (ì˜ˆ: ì°¨ì¢… ë“±)",className:"flex-1 p-1.5 border rounded text-xs",value:c.desc||"",onChange:s=>S({...c,desc:s.target.value})}),e.jsxs("button",{type:"button",onClick:ts,className:"w-24 bg-blue-600 text-white rounded text-xs font-bold flex justify-center items-center hover:bg-blue-700 flex-shrink-0",children:[e.jsx(de,{size:14,className:"mr-1"})," ì¶”ê°€"]})]})]}),e.jsxs("div",{className:"mb-6 bg-pink-50 p-4 rounded-lg border border-pink-200",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2 text-xs",children:"ì‹ ìš©ëŒ€ì¶œ ëª©ë¡"}),e.jsxs("div",{className:"space-y-2 mb-3",children:[(!t.creditLoan||t.creditLoan.length===0)&&e.jsx("p",{className:"text-xs text-gray-400 text-center py-2",children:"ë“±ë¡ëœ ì‹ ìš©ëŒ€ì¶œì´ ì—†ìŠµë‹ˆë‹¤."}),(Ee=t.creditLoan)==null?void 0:Ee.map(s=>e.jsxs("div",{className:"bg-white p-2 rounded border flex justify-between items-center text-xs",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-semibold mr-2",children:s.desc}),e.jsxs("span",{className:"text-gray-800",children:[s.amount.toLocaleString(),"ë§Œì›"]})]}),e.jsx("button",{type:"button",onClick:()=>rs(s.id),className:"text-red-500 p-1",children:e.jsx(I,{size:14})})]},s.id))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx("input",{type:"text",placeholder:"ëŒ€ì¶œ ë‚´ìš© (ì˜ˆ: í–‡ì‚´ë¡ )",className:"w-full p-1.5 border rounded text-xs col-span-2",value:f.desc||"",onChange:s=>V({...f,desc:s.target.value})}),e.jsx("input",{type:"number",placeholder:"ê¸ˆì•¡ (ë§Œì›)",className:"w-full p-1.5 border rounded text-xs",value:f.amount||"",onChange:s=>V({...f,amount:Number(s.target.value)})}),e.jsxs("button",{type:"button",onClick:as,className:"w-full py-1.5 bg-blue-600 text-white rounded text-xs font-bold flex justify-center items-center hover:bg-blue-700",children:[e.jsx(de,{size:14,className:"mr-1"})," ì‹ ìš©ëŒ€ì¶œ ì¶”ê°€"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ë‹´ë³´ ëŒ€ì¶œ ë‚´ìš© (ìë™ ì§‘ê³„ + ì¶”ê°€)"}),e.jsxs("div",{className:"bg-gray-50 p-2 rounded text-xs text-blue-800 font-medium mb-1",children:["ìë™ ì§‘ê³„: ",fs()]}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500",value:t.collateralLoanMemo||"",onChange:s=>n("collateralLoanMemo",s.target.value),placeholder:"ì¶”ê°€ë¡œ ì‘ì„±í•  ë‹´ë³´ ëŒ€ì¶œ ë‚´ìš©"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(p,{label:"ì‹ ìš©ì¹´ë“œ ì‚¬ìš©",value:t.creditCardUse,onChange:s=>n("creditCardUse",s),options:["ì‚¬ìš©","ë¯¸ì‚¬ìš©"]}),t.creditCardUse==="ì‚¬ìš©"&&e.jsx(m,{label:"ì‚¬ìš© ê¸ˆì•¡(ë§Œì›)",type:"number",value:t.creditCardAmount,onChange:s=>n("creditCardAmount",s)})]}),e.jsx(m,{label:"ì›” ëŒ€ì¶œë‚©ì…(ë§Œì›)",type:"number",value:t.loanMonthlyPay,onChange:s=>n("loanMonthlyPay",s)})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ê°œì¸íšŒìƒ / íŒŒì‚° ì´ë ¥"}),e.jsx("div",{className:"flex gap-2 mb-2 flex-wrap",children:Gs.map(s=>e.jsx("button",{type:"button",onClick:()=>n("historyType",s),className:"px-3 py-1.5 text-xs rounded border "+(t.historyType===s?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"),children:s},s))}),t.historyType&&t.historyType!=="ì—†ìŒ"&&e.jsx("textarea",{className:"w-full p-2 border border-gray-300 rounded text-sm h-24",value:t.historyMemo,onChange:s=>n("historyMemo",s.target.value),placeholder:"ì´ë ¥ ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”."})]})]}),H==="summary"&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"bg-gray-800 text-white p-4 rounded text-left text-sm whitespace-pre-wrap font-mono leading-relaxed",children:Ge(t,u?u.summaryTemplate:void 0)}),e.jsxs("button",{onClick:js,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-bold flex items-center justify-center mx-auto hover:bg-blue-700",children:[e.jsx(rt,{className:"mr-2"})," ìš”ì•½ë¬¸ ë³µì‚¬í•˜ê¸°"]})]}),H==="settlement"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-green-50 p-6 rounded-xl border border-green-100",children:[e.jsx("h3",{className:"font-bold text-green-800 mb-4 text-lg",children:"ê³„ì•½ ë° ìˆ˜ì„ë£Œ"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-green-900 mb-1",children:"ê³„ì•½ì™„ë£Œì¼ (ì •ì‚°ê¸°ì¤€)"}),e.jsx("input",{type:"date",className:"w-full p-2 border border-green-300 rounded",value:t.contractAt||"",onChange:s=>n("contractAt",s.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-green-900 mb-1 flex items-center justify-between",children:["ë¶„ë‚© ê°œì›”",e.jsxs("label",{className:"flex items-center gap-1 cursor-pointer text-blue-600 bg-white px-2 py-0.5 rounded border border-blue-100",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox h-3 w-3",checked:t.useCapital||!1,onChange:s=>n("useCapital",s.target.checked)}),e.jsx("span",{className:"text-xs",children:"ìºí”¼íƒˆ ì‚¬ìš©"})]})]}),e.jsxs("select",{className:"w-full p-2 border border-green-300 rounded bg-white",value:t.installmentMonths||"",onChange:s=>n("installmentMonths",s.target.value),children:[e.jsx("option",{value:"",children:"ì„ íƒ"}),!t.useCapital&&e.jsx("option",{value:"ì™„ë‚©",children:"ì™„ë‚©"}),Array.from({length:8},(s,a)=>a+1).map(s=>t.useCapital||s>=2?e.jsxs("option",{value:`${s} ê°œì›”`,children:[s,"ê°œì›”"]},s):null)]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-green-900 mb-1",children:"ì´ ìˆ˜ì„ë£Œ (ë§Œì›)"}),e.jsx("input",{type:"number",className:"w-full p-2 border border-green-300 rounded text-right font-mono text-lg font-bold",value:t.contractFee||0,onChange:s=>n("contractFee",Number(s.target.value))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-green-200 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"ì˜ˆìƒ ìˆ˜ë‹¹ (Commission):"}),e.jsxs("span",{className:"text-xl font-bold text-green-900",children:[Ns.toLocaleString(),"ë§Œì›"]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-xl border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-gray-700 text-lg",children:"ì…ê¸ˆ ë‚´ì—­"}),e.jsxs("button",{onClick:()=>{const a=[...t.depositHistory&&t.depositHistory.length>0?t.depositHistory:[{date:t.deposit1Date||"",amount:t.deposit1Amount||0},{date:t.deposit2Date||"",amount:t.deposit2Amount||0}],{date:"",amount:0}];n("depositHistory",a)},className:"flex items-center gap-1 bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm font-bold hover:bg-blue-700 shadow-sm",children:[e.jsx(de,{size:16})," ì¶”ê°€ (",(((Oe=t.depositHistory)==null?void 0:Oe.length)||2)+1,"ì°¨)"]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:(t.depositHistory&&t.depositHistory.length>0?t.depositHistory:[{date:t.deposit1Date||"",amount:t.deposit1Amount||0},{date:t.deposit2Date||"",amount:t.deposit2Amount||0}]).map((s,a)=>e.jsxs("div",{className:"bg-white p-4 rounded border border-gray-200 shadow-sm relative group",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:"font-bold text-gray-600 text-sm",children:[a+1,"ì°¨ ì…ê¸ˆ"]}),a>=2&&e.jsx("button",{onClick:()=>{const i=(t.depositHistory||[]).filter((o,h)=>h!==a);n("depositHistory",i)},className:"text-gray-400 hover:text-red-500",children:e.jsx(oe,{size:16})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ê¸ˆì•¡ (ë§Œì›)"}),e.jsx("input",{type:"number",className:"w-full p-2 border border-gray-300 rounded text-sm font-bold",value:s.amount||"",onChange:r=>{const i=t.depositHistory&&t.depositHistory.length>0?[...t.depositHistory]:[{date:t.deposit1Date||"",amount:t.deposit1Amount||0},{date:t.deposit2Date||"",amount:t.deposit2Amount||0}];i[a].amount=Number(r.target.value),n("depositHistory",i)}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ì…ê¸ˆì¼"}),e.jsx("input",{type:"date",className:"w-full p-2 border border-gray-300 rounded text-sm",value:s.date||"",onChange:r=>{const i=t.depositHistory&&t.depositHistory.length>0?[...t.depositHistory]:[{date:t.deposit1Date||"",amount:t.deposit1Amount||0},{date:t.deposit2Date||"",amount:t.deposit2Amount||0}];i[a].date=r.target.value,n("depositHistory",i)}})]})]})]},a))}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-gray-700",children:"ì´ ëˆ„ì  ì…ê¸ˆì•¡"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[(t.depositHistory&&t.depositHistory.length>0?t.depositHistory.reduce((s,a)=>s+(a.amount||0),0):(t.deposit1Amount||0)+(t.deposit2Amount||0)).toLocaleString()," ë§Œì›"]})]})]})]})]})]})}export{gt as default};
