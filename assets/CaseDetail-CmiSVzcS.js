const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DFG_svVS.js","assets/index-ZPMVgb5w.css","assets/utils-C188joeX.js"])))=>i.map(i=>d[i]);
import{c as w,r as o,j as e,P as Jt,h as Xt,b as es,d as ts,x as ss,y as as,Q as rs,w as re,O as ns,B as gt,T as ls,v as os,f as ne,X as Se,S as ke,D as is,J as ds,H as cs,E as xs,F as us,G as ms,I as ps,K as hs,M as gs,U as bs,_ as bt,V as ft,W as fs}from"./index-DFG_svVS.js";import{h as le,b as ys,j as js,k as Ns,l as Ae,n as vs,f as ws,m as Cs}from"./utils-C188joeX.js";import{F as Ss,G as ks}from"./index-CJC0oO5A.js";import{C as As}from"./circle-alert-Cge_Cgju.js";import{T as Q,P as Me}from"./trash-2-3pwxhi3X.js";import{C as Ms}from"./check-Cm5IHW_G.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Is=w("archive",Ts);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],yt=w("calendar-clock",Ds);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Rs=w("circle-play",_s);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],jt=w("copy",zs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],Ls=w("mic",Hs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Es=w("pause",Ps);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],oe=w("pen",$s);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Os=w("play",Us);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Bs=w("rotate-ccw",Fs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Gs=w("rotate-cw",Vs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Nt=w("send",Ys);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],Ws=w("volume-2",qs),vt=c=>{if(!c||isNaN(c))return"00:00";const n=Math.floor(c/60),s=Math.floor(c%60);return`${n.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},Ks=({src:c,fileName:n})=>{const s=o.useRef(null),[y,N]=o.useState(!1),[f,C]=o.useState(0),[A,L]=o.useState(0),[R,M]=o.useState(!1);o.useEffect(()=>{N(!1),L(0),C(0),M(!1),s.current&&(s.current.currentTime=0,s.current.load())},[c]);const V=()=>{if(s.current){if(y)s.current.pause();else{const p=s.current.play();p!==void 0&&p.catch(j=>{console.error("Playback failed",j),M(!0)})}N(!y)}},G=()=>{s.current&&L(s.current.currentTime)},S=()=>{s.current&&(C(s.current.duration),M(!1))},u=p=>{const j=Number(p.target.value);s.current&&(s.current.currentTime=j,L(j))},D=p=>{s.current&&(s.current.currentTime+=p)},x=()=>{M(!0),N(!1)},_=c.includes("drive.google.com"),T=p=>{if(!p.includes("drive.google.com"))return p;let j="";const Y=p.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);if(Y)j=Y[1];else{const P=p.match(/[?&]id=([a-zA-Z0-9_-]+)/);P&&(j=P[1])}return j?`https://drive.google.com/file/d/${j}/preview`:p};return e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-purple-100 p-4 w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"bg-purple-100 p-1.5 rounded-full text-purple-600",children:e.jsx(Ws,{size:16})}),e.jsx("span",{className:"text-sm font-bold text-gray-700 truncate flex-1",children:n||"ì˜¤ë””ì˜¤ ì¬ìƒ ì¤‘"})]}),_?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"relative w-full h-[100px] bg-gray-100 rounded-lg overflow-hidden border border-gray-200",children:e.jsx("iframe",{src:T(c),className:"w-full h-full border-none",title:"Audio Preview",allow:"autoplay"})}),e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:"* êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë³´ì•ˆ ì •ì±…ìœ¼ë¡œ í‘œì¤€ í”Œë ˆì´ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤."}),e.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"text-xs bg-purple-50 text-purple-700 px-2 py-1 rounded font-bold hover:bg-purple-100 transition-colors",children:"ìƒˆ ì°½ì—ì„œ ì—´ê¸°"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("audio",{ref:s,src:c,onTimeUpdate:G,onLoadedMetadata:S,onEnded:()=>N(!1),onError:x}),R?e.jsxs("div",{className:"bg-red-50 text-red-600 text-xs p-3 rounded flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(As,{size:14})," ì¬ìƒí•  ìˆ˜ ì—†ëŠ” íŒŒì¼ì…ë‹ˆë‹¤."]}),e.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"underline font-bold",children:"ì§ì ‘ ì—´ê¸°"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"range",min:0,max:f||100,value:A,onChange:u,className:"w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-600 hover:h-2 transition-all",style:{background:`linear-gradient(to right, #9333ea ${A/(f||1)*100}%, #e5e7eb ${A/(f||1)*100}%)`}}),e.jsxs("div",{className:"flex justify-between text-[10px] text-gray-400 font-mono mt-1",children:[e.jsx("span",{children:vt(A)}),e.jsx("span",{children:vt(f)})]})]}),e.jsxs("div",{className:"flex justify-center items-center gap-6",children:[e.jsx("button",{onClick:()=>D(-10),className:"text-gray-400 hover:text-purple-600 transition-colors p-2 hover:bg-purple-50 rounded-full",title:"10ì´ˆ ë’¤ë¡œ",children:e.jsx(Bs,{size:20})}),e.jsx("button",{onClick:V,className:"bg-purple-600 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg hover:bg-purple-700 hover:scale-105 transition-all",children:y?e.jsx(Es,{size:24,fill:"currentColor"}):e.jsx(Os,{size:24,fill:"currentColor",className:"ml-1"})}),e.jsx("button",{onClick:()=>D(30),className:"text-gray-400 hover:text-purple-600 transition-colors p-2 hover:bg-purple-50 rounded-full",title:"30ì´ˆ ì•ìœ¼ë¡œ",children:e.jsx(Gs,{size:20})})]})]})]})]})},b=({label:c,value:n,onChange:s,onBlur:y,type:N="text",placeholder:f="",suffix:C="",readOnly:A=!1,isPhone:L=!1,isCurrency:R=!1})=>{let M=n;N==="number"&&!R&&(n===0||n===void 0||n===null)&&(M=""),R&&(typeof n=="number"||!isNaN(Number(n)))&&(M=Number(n).toLocaleString());const V=G=>{let S=G.target.value;if(L){const u=S.replace(/[^0-9]/g,"");let D=u;u.length>3&&u.length<=7?D=`${u.slice(0,3)}-${u.slice(3)}`:u.length>7&&(D=`${u.slice(0,3)}-${u.slice(3,7)}-${u.slice(7,11)}`),s(D);return}if(R){const u=S.replace(/,/g,"");(u===""||/^[0-9]+$/.test(u))&&s(u===""?0:Number(u));return}N==="number"?(S===""||/^[0-9]+$/.test(S))&&s(S===""?0:Number(S)):s(S)};return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:c}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",autoComplete:"off",className:"w-full p-2 border border-blue-300 rounded text-sm outline-none "+(A?"bg-gray-100 text-gray-500 cursor-not-allowed":"focus:ring-1 focus:ring-blue-500"),value:M||"",onChange:A?void 0:V,onBlur:y,placeholder:f,readOnly:A}),C&&e.jsx("span",{className:"absolute right-3 top-2 text-gray-500 text-xs",children:C})]})]})},I=({label:c,value:n,onChange:s,options:y,isMulti:N=!1})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:c}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:y.map(f=>{const C=N?n==null?void 0:n.includes(f):n===f;return e.jsx("button",{type:"button",onClick:()=>s(f),className:"px-3 py-1.5 text-xs rounded border "+(C?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"),children:f},f)})})]});function sa(){var st,at,rt,nt,lt,ot,it,dt,ct,xt,ut,mt,pt;const{caseId:c}=Jt(),{showToast:n}=Xt(),[s,y]=o.useState(null),[N,f]=o.useState(!0),[C,A]=o.useState([]),[L,R]=o.useState([]),[M,V]=o.useState([]),[G,S]=o.useState([]),[u,D]=o.useState("info"),[x,_]=o.useState({owner:"ë³¸ì¸",type:"ìë™ì°¨",amount:0,loanAmount:0,rentDeposit:0,desc:""}),[T,p]=o.useState({amount:0,desc:""}),[j,Y]=o.useState(""),[P,Te]=o.useState(""),[Z,Ie]=o.useState("09"),[J,De]=o.useState("00"),[_e,ie]=o.useState("");o.useEffect(()=>{ie(P&&Z&&J?`${P} ${Z}:${J}`:"")},[P,Z,J]);const[de,Re]=o.useState("í†µí™”"),[ze,He]=o.useState(""),[wt,ce]=o.useState(null),[X,xe]=o.useState(null),[Le,ue]=o.useState(""),[Ct,ee]=o.useState(null),[Pe,Ee]=o.useState(!1),[te,U]=o.useState(!1),[h,E]=o.useState(""),[$e,Ue]=o.useState(""),[me,Oe]=o.useState(!1),[O,Fe]=o.useState(null),[z,Be]=o.useState(null),[pe,Ve]=o.useState(!1),Ge=o.useRef(null);o.useRef(null);const[Ye,qe]=o.useState([]),[St,he]=o.useState(!1),[q,ge]=o.useState(null),[We,Ke]=o.useState(""),[kt,be]=o.useState(!1),[$,fe]=o.useState(null),[ye,Qe]=o.useState("");if(o.useEffect(()=>(c&&(Promise.all([es(),ts(),ss(),as(),rs()]).then(([t,a,l,d,m])=>{const i=t.find(k=>k.caseId===c)||null;i&&(i.isNew&&(i.isNew=!1,re(i.caseId,{isNew:!1})),typeof i.jobType=="string"&&(i.jobTypes=[i.jobType],delete i.jobType),i.jobTypes||(i.jobTypes=[]),i.incomeDetails||(i.incomeDetails={}),i.reminders||(i.reminders=[]),i.recordings||(i.recordings=[]),y(i),ns(i.caseId)),A(a),R(l),V(d),S(m),i!=null&&i.aiSummary&&E(le(i.aiSummary,i))}).finally(()=>f(!1)),gt(c).then(qe)),()=>{z&&URL.revokeObjectURL(z)}),[c]),N)return e.jsx("div",{className:"p-8 text-center text-gray-500",children:"ë¡œë”©ì¤‘..."});if(!s)return e.jsx("div",{className:"p-8 text-center text-gray-500",children:"ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."});const g=C.find(t=>t.partnerId===s.partnerId),At=g?g.commissionRules:[],Mt=t=>{const a=t.target.value;ge(a),setTimeout(()=>{he(!0)},100),Ke("")},Tt=async()=>{if(!(!c||!q))try{const t=await bs(c,q,We);y(t);const a=await gt(c);qe(a),n("ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."),he(!1),ge(null)}catch{n("ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}},It=t=>{const a=t.target.value;a!==((s==null?void 0:s.secondaryStatus)||"")&&(fe(a||null),setTimeout(()=>{be(!0)},100),Qe(""))},Dt=async()=>{if(!(!s||$===null))try{const t=$||void 0,l=`[2ì°¨ ìƒíƒœ ë³€ê²½] ${s.secondaryStatus||"ì—†ìŒ"} â†’ ${$||"ì—†ìŒ"}${ye?`
ì‚¬ìœ : `+ye:""}`,m=[{id:Date.now().toString(),createdAt:new Date().toISOString(),content:l},...s.specialMemo||[]],i={...s,secondaryStatus:t,specialMemo:m};y(i),await re(s.caseId,{secondaryStatus:t,specialMemo:m}),n("2ì°¨ ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."),be(!1),fe(null)}catch{n("2ì°¨ ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}},r=(t,a)=>{if(!s)return;const l={...s,[t]:a};t==="incomeDetails"&&(l.incomeNet=Object.values(a).reduce((d,m)=>d+(m||0),0)),y(l),re(s.caseId,{[t]:a})},je=(t,a)=>{if(!s)return;const l={...s.incomeDetails||{},[t]:a};r("incomeDetails",l)},_t=t=>{if(!s)return;const a=s.jobTypes||[],l=a.includes(t)?a.filter(k=>k!==t):[...a,t],d={...s.incomeDetails||{}};t==="ì§ì¥ì¸"&&!l.includes("ì§ì¥ì¸")&&delete d.salary,["ê°œì¸ì‚¬ì—…ì","ë²•ì¸ì‚¬ì—…ì"].includes(t)&&!l.some(k=>["ê°œì¸ì‚¬ì—…ì","ë²•ì¸ì‚¬ì—…ì"].includes(k))&&delete d.business,t==="í”„ë¦¬ëœì„œ"&&!l.includes("í”„ë¦¬ëœì„œ")&&delete d.freelance;const m=Object.values(d).reduce((k,F)=>k+(F||0),0),i={...s,jobTypes:l,incomeDetails:d,incomeNet:m};y(i),re(s.caseId,{jobTypes:l,incomeDetails:d,incomeNet:m})},Rt=()=>{const t=vs(s.birth);t!==s.birth&&r("birth",t)},zt=()=>{if(!x.type||!s)return;const t={id:Date.now().toString(),owner:x.owner||"ë³¸ì¸",type:x.type||"ê¸°íƒ€",amount:x.amount||0,loanAmount:x.loanAmount||0,rentDeposit:x.rentDeposit||0,desc:x.desc||""},a=s.assets?[...s.assets,t]:[t];r("assets",a),_({owner:"ë³¸ì¸",type:"ìë™ì°¨",amount:0,loanAmount:0,rentDeposit:0,desc:""})},Ht=()=>{if(!T.amount||!T.desc){n("ëŒ€ì¶œê¸ˆì•¡ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}const t={id:Date.now().toString(),amount:T.amount||0,desc:T.desc||""};r("creditLoan",[...s.creditLoan||[],t]),p({amount:0,desc:""})},Lt=t=>{if(!s)return;const a=s.assets.filter(l=>l.id!==t);r("assets",a)},Pt=t=>{if(!s)return;const a=(s.creditLoan||[]).filter(l=>l.id!==t);r("creditLoan",a)},Et=()=>{if(!j.trim()||!s)return;const a=[{id:Date.now().toString(),createdAt:new Date().toISOString(),content:j.trim()},...s.specialMemo||[]];r("specialMemo",a),Y(""),n("ìƒë‹´ ë‚´ìš©ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")},$t=t=>{xe(t.id),ue(t.content),ee(null)},Ut=()=>{if(!s||!X)return;const t=(s.specialMemo||[]).map(a=>a.id===X?{...a,content:Le}:a);r("specialMemo",t),xe(null),ue(""),n("ìƒë‹´ ë‚´ìš©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")},Ot=t=>{if(!s)return;const a=(s.specialMemo||[]).filter(l=>l.id!==t);r("specialMemo",a),n("ìƒë‹´ ë‚´ìš©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),ee(null)},Ft=()=>{if(!_e){n("ë‚ ì§œì™€ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.","error");return}if(!s||!s.reminders)return;if(s.reminders.length>=5){n("ë¦¬ë§ˆì¸ë”ëŠ” ìµœëŒ€ 5ê°œê¹Œì§€ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.","error");return}const t={id:Date.now().toString(),datetime:_e.replace("T"," "),type:de,content:ze},a=[...s.reminders,t];r("reminders",a),Te(""),Ie("09"),De("00"),ie(""),He(""),Re("í†µí™”"),n("ë‹¤ìŒ ì¼ì •ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")},Bt=t=>{if(!s||!s.reminders)return;const a=s.reminders.filter(l=>l.id!==t);r("reminders",a),ce(null),n("ì¼ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")},Vt=async t=>{var l;const a=(l=t.target.files)==null?void 0:l[0];if(a){if(a.size>20*1024*1024){n("íŒŒì¼ í¬ê¸°ëŠ” 20MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error");return}Fe(a);const d=URL.createObjectURL(a);Be(d);try{Ve(!0),n("í´ë¼ìš°ë“œ(êµ¬ê¸€ ë“œë¼ì´ë¸Œ)ì— ì—…ë¡œë“œ ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.");const{uploadRecording:m}=await bt(async()=>{const{uploadRecording:B}=await import("./index-DFG_svVS.js").then(W=>W.av);return{uploadRecording:B}},__vite__mapDeps([0,1])),{fileToBase64:i,convertToPlayableUrl:k}=await bt(async()=>{const{fileToBase64:B,convertToPlayableUrl:W}=await import("./utils-C188joeX.js").then(ve=>ve.u);return{fileToBase64:B,convertToPlayableUrl:W}},__vite__mapDeps([2,0,1])),{url:F,id:H}=await m(a);n("ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì–´ë””ì„œë“  ë“£ê¸°ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤!","success");const se={id:H||ft(),filename:a.name,uploadDate:new Date().toISOString(),url:F,mimeType:a.type};if(s){const B=[se,...s.recordings||[]];r("recordings",B)}}catch(m){console.error("Upload failed",m),n("ì—…ë¡œë“œ ì‹¤íŒ¨: ë¡œì»¬ì—ì„œë§Œ ì¬ìƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.","error");const i={id:ft(),filename:a.name+" (ë¯¸ë™ê¸°í™”)",uploadDate:new Date().toISOString(),url:d,mimeType:a.type};s&&r("recordings",[i,...s.recordings||[]])}finally{Ve(!1)}}},Ze=()=>{var t;(t=Ge.current)==null||t.click()},Gt=t=>{Be(t.url),Fe(null),n(t.filename+" ì¬ìƒì„ ì¤€ë¹„í•©ë‹ˆë‹¤.")},Yt=t=>{if(s&&confirm("ì´ ë…¹ìŒ íŒŒì¼ì„ ëª©ë¡ì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){const a=(s.recordings||[]).filter(l=>l.id!==t);r("recordings",a)}},qt=async()=>{var d,m,i,k,F;if(!s)return;let t=O;if(!t&&(!s.recordings||s.recordings.length===0)){n("ë¶„ì„í•  í†µí™” ë…¹ìŒ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.","error");return}if(!t){n("ë¶„ì„ì„ ìœ„í•´ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.","error"),Ze();return}const a=C.find(H=>H.partnerId===s.partnerId),l=(a==null?void 0:a.aiPromptTemplate)||fs;Ee(!0);try{const H=atob("QUl6YVN5RDEySXF0Q2RrV0luc01SQW9ZS2Y2WVdwakU1MlZwaVRB"),se="AIzaSyAcY0S1fvge0FtV_GsmEo5u15vdsau4sBU",W=new ks(se).getGenerativeModel({model:"gemini-flash-latest"}),ve=`
[ê¸°ë³¸ ì •ë³´]
ê³ ê°ëª…: `+s.customerName+`
ì—°ë½ì²˜: `+s.phone+`
ì§ì—…: `+((d=s.jobTypes)==null?void 0:d.join(", "))+`

[ê¸°ì¡´ ìƒë‹´ ì´ë ¥]
`+(((m=s.specialMemo)==null?void 0:m.map(v=>v.content).join(`
`))||"ì—†ìŒ")+`

[ì‚¬ì „ ì •ë³´]
`+(s.preInfo||"ì—†ìŒ")+`
`,we=[];if(t){const v=await ws(t),ae=t.type||"audio/mp3";we.push({inlineData:{mimeType:ae,data:v}})}we.push({text:l+`

`+ve});let K=0;const ht=3;let Ce="";for(;K<ht;)try{Ce=(await(await W.generateContent(we)).response).text();break}catch(v){if(K++,console.warn(`AI Attempt ${K} failed: `,v),((i=v.message)!=null&&i.includes("429")||(k=v.message)!=null&&k.includes("503"))&&K<ht){const ae=Math.pow(2,K)*1e3+Math.random()*500;await new Promise(Zt=>setTimeout(Zt,ae));continue}throw v}if(Ce){const v=le(Ce,s);E(v),r("aiSummary",v),n("AI ìš”ì•½ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")}else n("AI ìš”ì•½ ë‚´ìš©ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.","error")}catch(H){console.error("AI Generation Error:",H),(F=H.message)!=null&&F.includes("429")?n("ì‚¬ìš©ëŸ‰ì´ ë§ì•„ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.","error"):n("ì˜¤ë¥˜: "+(H.message||"AI ìš”ì•½ ìƒì„± ì‹¤íŒ¨"),"error")}finally{Ee(!1)}},Je=()=>{if(!h.trim())return;const t=Cs(h),a=t.length<h.length?`[AI ìš”ì•½ - íŠ¹ì´ì‚¬í•­]
`+t:`[AI ìš”ì•½]
`+h,d=[{id:Date.now().toString(),createdAt:new Date().toISOString(),content:a},...s.specialMemo||[]];r("specialMemo",d),n("ìƒë‹´ ë‚´ìš©(íŠ¹ì´ì‚¬í•­)ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")},Xe=()=>{r("aiSummary",h),U(!1),n("ìš”ì•½ ë‚´ìš©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")},Wt=()=>{confirm("AI ìš”ì•½ ë‚´ìš©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(E(""),r("aiSummary",""),n("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."))},Kt=()=>{const t=[];return(s.depositLoanAmount||0)>0&&t.push("ë³´ì¦ê¸ˆ ëŒ€ì¶œ "+s.depositLoanAmount+" ë§Œì›"),(s.ownHouseLoan||0)>0&&t.push("ì§‘ ë‹´ë³´ ëŒ€ì¶œ "+s.ownHouseLoan+" ë§Œì›"),s.assets&&s.assets.forEach(a=>{a.loanAmount>0&&t.push(a.type+" ë‹´ë³´ "+a.loanAmount+" ë§Œì›")}),t.length>0?t.join(" + "):"ì—†ìŒ"},et=ys(s,g),Qt=js(s.contractFee||0,At),tt=s.specialMemo?[...s.specialMemo].sort((t,a)=>a.createdAt.localeCompare(t.createdAt)):[],Ne=s.reminders?[...s.reminders].sort((t,a)=>t.datetime.localeCompare(a.datetime)):[];return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 sticky top-0 z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold text-white whitespace-nowrap "+(["ê°œì¸íšŒìƒ","íŒŒì‚°"].includes(s.caseType||"")?"bg-indigo-500":"bg-gray-500"),children:s.caseType}),e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded font-bold border border-gray-200 whitespace-nowrap",children:(g==null?void 0:g.name)||"ê±°ë˜ì²˜ ë¯¸ì •"}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 whitespace-nowrap",children:s.customerName}),e.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:s.phone})]}),et.length>0&&e.jsx("div",{className:"flex gap-2 mt-2",children:et.map(t=>e.jsxs("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded font-bold flex items-center",children:[e.jsx(ls,{size:12,className:"mr-1"})," ",t]},t))})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs text-gray-400 font-medium",children:"1ì°¨ ìƒíƒœ"}),e.jsx("select",{className:"p-2 border border-gray-300 rounded font-semibold outline-none min-w-[140px] "+(os[s.status]||"bg-blue-50 text-blue-800"),value:q||s.status,onChange:Mt,children:M.map(t=>e.jsx("option",{value:t,children:t},t))})]}),s.status==="ì‚¬ë¬´ì¥ ì ‘ìˆ˜"&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs text-purple-500 font-medium",children:"2ì°¨ ìƒíƒœ"}),e.jsxs("select",{className:"p-2 border border-purple-300 rounded font-semibold outline-none min-w-[140px] bg-purple-50 text-purple-800",value:$!==null?$:s.secondaryStatus||"",onChange:It,children:[e.jsx("option",{value:"",children:"ì„ íƒ ì•ˆí•¨"}),G.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]})]})}),St&&q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-[400px] shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"ìƒíƒœ ë³€ê²½ í™•ì¸"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["ìƒíƒœë¥¼ ",e.jsx("span",{className:"font-bold text-blue-600",children:s.status}),"ì—ì„œ ",e.jsx("span",{className:"font-bold text-blue-600",children:q}),"(ìœ¼)ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ë³€ê²½ ì‚¬ìœ  / ë©”ëª¨"}),e.jsx("textarea",{className:"w-full p-2 border rounded resize-none h-24 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"ìƒíƒœ ë³€ê²½ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”...",value:We,onChange:t=>Ke(t.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{he(!1),ge(null)},className:"px-4 py-2 bg-gray-200 rounded text-gray-800 font-medium hover:bg-gray-300",children:"ì·¨ì†Œ"}),e.jsx("button",{onClick:Tt,className:"px-4 py-2 bg-blue-600 rounded text-white font-medium hover:bg-blue-700",children:"ë³€ê²½í•˜ê¸°"})]})]})}),kt&&$!==null&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-[400px] shadow-xl border-t-4 border-purple-500",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-purple-700",children:"2ì°¨ ìƒíƒœ ë³€ê²½ í™•ì¸"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["2ì°¨ ìƒíƒœë¥¼ ",e.jsx("span",{className:"font-bold text-purple-600",children:s.secondaryStatus||"ì—†ìŒ"}),"ì—ì„œ ",e.jsx("span",{className:"font-bold text-purple-600",children:$||"ì—†ìŒ"}),"(ìœ¼)ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ë³€ê²½ ì‚¬ìœ  / ë©”ëª¨"}),e.jsx("textarea",{className:"w-full p-2 border border-purple-200 rounded resize-none h-24 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"ìƒíƒœ ë³€ê²½ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”...",value:ye,onChange:t=>Qe(t.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{be(!1),fe(null)},className:"px-4 py-2 bg-gray-200 rounded text-gray-800 font-medium hover:bg-gray-300",children:"ì·¨ì†Œ"}),e.jsx("button",{onClick:Dt,className:"px-4 py-2 bg-purple-600 rounded text-white font-medium hover:bg-purple-700",children:"ë³€ê²½í•˜ê¸°"})]})]})}),e.jsx("div",{className:"flex border-b border-gray-200 bg-white px-4 rounded-t-lg overflow-x-auto no-scrollbar",children:[{id:"info",label:"ì •ë³´ ìˆ˜ì •"},{id:"summary",label:"ìš”ì•½ë¬¸"},{id:"settlement",label:"ìˆ˜ì„ë£Œ/ì •ì‚°"}].map(t=>e.jsx("button",{onClick:()=>D(t.id),className:"px-4 py-3 text-sm font-medium border-b-2 whitespace-nowrap "+(u===t.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:t.label},t.id))}),e.jsxs("div",{className:"bg-white p-6 rounded-b-xl shadow-sm border border-gray-100 border-t-0 min-h-[600px]",children:[u==="info"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-100",children:[e.jsx("h3",{className:"font-bold text-yellow-800 mb-2 flex items-center gap-2",children:"ğŸ“… ë¦¬ë§ˆì¸ë” ë° ìƒë‹´ ì´ë ¥"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-yellow-200 shadow-sm",children:[e.jsxs("label",{className:"block text-xs font-bold text-yellow-800 mb-2",children:["ë‹¤ìŒ ì¼ì • ë“±ë¡ (",Ne.length,"/5)"]}),e.jsx("div",{className:"flex flex-col md:flex-row gap-2 mb-3",children:e.jsxs("div",{className:"flex flex-col gap-2 flex-[2]",children:[e.jsx("input",{type:"date",className:"w-full p-2 border border-blue-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500",value:P,onChange:t=>Te(t.target.value),disabled:(((st=s.reminders)==null?void 0:st.length)||0)>=5}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("select",{className:"flex-1 p-2 border border-blue-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500",value:Z,onChange:t=>Ie(t.target.value),disabled:(((at=s.reminders)==null?void 0:at.length)||0)>=5,children:Array.from({length:24}).map((t,a)=>{const l=a.toString().padStart(2,"0");return e.jsxs("option",{value:l,children:[l,"ì‹œ"]},l)})}),e.jsx("select",{className:"flex-1 p-2 border border-blue-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500",value:J,onChange:t=>De(t.target.value),disabled:(((rt=s.reminders)==null?void 0:rt.length)||0)>=5,children:["00","10","20","30","40","50"].map(t=>e.jsxs("option",{value:t,children:[t,"ë¶„"]},t))}),e.jsxs("select",{className:"flex-1 p-2 border border-blue-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500 min-w-[60px]",value:de,onChange:t=>Re(t.target.value),children:[e.jsx("option",{value:"í†µí™”",children:"í†µí™”"}),e.jsx("option",{value:"ì¶œì¥ë¯¸íŒ…",children:"ì¶œì¥ë¯¸íŒ…"}),e.jsx("option",{value:"ë°©ë¬¸ë¯¸íŒ…",children:"ë°©ë¬¸ë¯¸íŒ…"}),e.jsx("option",{value:"ì…ê¸ˆ",children:"ì…ê¸ˆ"}),e.jsx("option",{value:"ê¸°íƒ€",children:"ê¸°íƒ€"})]})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"flex-1 p-2 border border-gray-300 rounded text-sm",placeholder:de==="ê¸°íƒ€"?"ì¼ì • ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”":"ë©”ëª¨ (ì„ íƒì‚¬í•­)",value:ze,onChange:t=>He(t.target.value)}),e.jsx("button",{onClick:Ft,disabled:(((nt=s.reminders)==null?void 0:nt.length)||0)>=5,className:"bg-yellow-500 text-white px-3 py-2 rounded text-sm font-bold hover:bg-yellow-600 whitespace-nowrap disabled:bg-gray-400",children:"ì¶”ê°€"})]}),e.jsx("div",{className:"space-y-2",children:Ne.length===0?e.jsx("div",{className:"text-center py-2 text-xs text-gray-400 bg-gray-50 rounded border border-gray-100 border-dashed",children:"ì§€ì •ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤."}):Ne.map(t=>e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded p-2 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center w-full gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(yt,{size:16,className:"text-blue-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold text-gray-800 whitespace-nowrap",children:t.datetime}),e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-bold whitespace-nowrap ${t.type==="ë°©ë¬¸ë¯¸íŒ…"?"bg-purple-100 text-purple-700":t.type==="ì¶œì¥ë¯¸íŒ…"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:t.type||"í†µí™”"})]}),t.content&&e.jsx("span",{className:"text-xs text-gray-600 break-words w-full md:w-auto md:max-w-[200px]",children:t.content})]}),e.jsx("div",{className:"pt-2 border-t border-blue-100 w-full",children:t.resultStatus?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:`font-bold px-2 py-0.5 rounded ${t.resultStatus==="ì™„ë£Œ"?"bg-green-100 text-green-700":t.resultStatus==="ë¯¸ì—°ê²°"?"bg-red-100 text-red-700":t.resultStatus==="ì¬ì˜ˆì•½"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:t.resultStatus}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 truncate max-w-[150px]",children:t.resultNote}),e.jsx("button",{onClick:()=>{const a=s.reminders.map(l=>l.id===t.id?{...l,resultStatus:void 0,resultNote:void 0}:l);r("reminders",a)},className:"text-gray-400 hover:text-gray-600 underline whitespace-nowrap",children:"ìˆ˜ì •"})]})]}):e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar pb-1",children:[e.jsx("span",{className:"text-xs text-blue-400 font-bold flex-shrink-0",children:"ê²°ê³¼:"}),["ì™„ë£Œ","ë¯¸ì—°ê²°","ì¬ì˜ˆì•½","ì·¨ì†Œ"].map(a=>e.jsx("button",{type:"button",onClick:()=>{const l=prompt(`${a} ì²˜ë¦¬ì— ëŒ€í•œ ë©”ëª¨ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš” (ì„ íƒ):`),d=s.reminders.map(m=>m.id===t.id?{...m,resultStatus:a,resultNote:l||""}:m);r("reminders",d)},className:`text-[10px] px-2 py-1 rounded border flex-shrink-0 transition-colors ${a==="ì™„ë£Œ"?"border-green-200 text-green-700 hover:bg-green-50":a==="ë¯¸ì—°ê²°"?"border-red-200 text-red-700 hover:bg-red-50":a==="ì¬ì˜ˆì•½"?"border-blue-200 text-blue-700 hover:bg-blue-50":"border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:a},a)),wt===t.id?e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>Bt(t.id),className:"text-green-600 text-xs font-bold",children:"í™•ì¸"}),e.jsx("button",{onClick:()=>ce(null),className:"text-red-500 text-xs",children:"ì·¨ì†Œ"})]}):e.jsx("button",{onClick:()=>ce(t.id),className:"text-red-500 p-1 hover:bg-red-50 rounded flex-shrink-0",title:"ì¼ì • ì‚­ì œ",children:e.jsx(Q,{size:16})})]})})]},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-yellow-800 mb-1",children:"ìƒë‹´ íŠ¹ì´ì‚¬í•­ ì¶”ê°€"}),e.jsx("textarea",{className:"w-full p-2 border border-yellow-300 rounded bg-white h-[60px] text-sm focus:ring-1 focus:ring-yellow-500 outline-none",value:j,onChange:t=>Y(t.target.value),placeholder:"ì¶”ê°€í•  ìƒë‹´ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."}),e.jsx("button",{onClick:Et,className:"w-full mt-1 bg-yellow-100 text-yellow-800 border border-yellow-300 px-3 py-1.5 rounded text-xs font-bold hover:bg-yellow-200",children:"ìƒë‹´ ë‚´ìš© ì¶”ê°€"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-yellow-800 mb-2",children:"ìƒë‹´ ì´ë ¥"}),e.jsxs("div",{className:"max-h-64 overflow-y-auto space-y-2 bg-yellow-100/30 p-2 rounded",children:[tt.length===0&&e.jsx("p",{className:"text-center text-xs text-gray-500 py-4",children:"ì €ì¥ëœ ìƒë‹´ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤."}),tt.map(t=>e.jsxs("div",{className:"bg-white p-3 rounded text-xs shadow-sm border border-yellow-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("p",{className:"font-bold text-gray-500 text-[10px]",children:ne(new Date(t.createdAt),"yyyy-MM-dd HH:mm")}),e.jsx("div",{className:"flex gap-1",children:X===t.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:Ut,className:"text-green-600 hover:bg-green-50 p-1 rounded",title:"ì €ì¥",children:e.jsx(Ms,{size:14})}),e.jsx("button",{type:"button",onClick:()=>xe(null),className:"text-gray-400 hover:bg-gray-100 p-1 rounded",title:"ì·¨ì†Œ",children:e.jsx(Se,{size:14})})]}):Ct===t.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>Ot(t.id),className:"text-green-600 hover:bg-green-50 p-1 rounded font-bold",title:"í™•ì¸",children:"í™•ì¸"}),e.jsx("button",{type:"button",onClick:()=>ee(null),className:"text-red-500 hover:bg-red-50 p-1 rounded",title:"ì·¨ì†Œ",children:"ì·¨ì†Œ"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>$t(t),className:"text-blue-500 hover:bg-blue-50 p-1 rounded",title:"ìˆ˜ì •",children:e.jsx(oe,{size:14})}),e.jsx("button",{type:"button",onClick:()=>ee(t.id),className:"text-red-500 hover:bg-red-50 p-1 rounded",title:"ì‚­ì œ",children:e.jsx(Q,{size:14})})]})})]}),X===t.id?e.jsx("textarea",{className:"w-full p-1 border rounded text-xs h-20",value:Le,onChange:a=>ue(a.target.value)}):e.jsx("p",{className:"text-gray-800 whitespace-pre-wrap leading-relaxed",children:t.content})]},t.id))]})]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"font-bold text-purple-800 flex items-center gap-2",children:[e.jsx(ke,{size:18,className:"flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col leading-none",children:[e.jsx("span",{children:"AI ìƒë‹´ ìš”ì•½"}),e.jsx("span",{children:"& ë…¹ìŒ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",ref:Ge,className:"hidden",accept:"audio/*",onChange:Vt}),e.jsxs("button",{onClick:Ze,disabled:pe,className:"flex items-center gap-1 text-xs px-2 py-1.5 rounded border "+(O?"bg-green-100 text-green-700 border-green-300":"bg-white text-gray-600 border-gray-300")+(pe?" opacity-50 cursor-not-allowed":""),children:[e.jsx(Ls,{size:14,className:"flex-shrink-0"}),e.jsx("span",{className:"text-center leading-tight",children:pe?"ì—…ë¡œë“œì¤‘...":O?"íŒŒì¼ ë³€ê²½":e.jsxs(e.Fragment,{children:["ë…¹ìŒíŒŒì¼",e.jsx("br",{}),"ì—…ë¡œë“œ"]})})]}),e.jsx("button",{onClick:qt,disabled:Pe,className:"flex items-center gap-1 text-xs bg-purple-600 text-white px-3 py-1.5 rounded font-bold hover:bg-purple-700 disabled:opacity-50 transition-colors shadow-sm",children:Pe?"ë¶„ì„ ì¤‘...":e.jsxs("span",{className:"text-center leading-tight",children:["ìš”ì•½",e.jsx("br",{}),"ì‹¤í–‰"]})})]})]}),e.jsx("div",{className:"mb-4",children:(z||O)&&e.jsx(Ks,{src:z&&z.includes("drive.google.com")?Ns(z):z||"",fileName:O?O.name:`ë…¹ìŒ íŒŒì¼ (ID: ${(ot=(lt=s.recordings)==null?void 0:lt.find(t=>t.url===z))==null?void 0:ot.id.substring(0,8)}...)`})}),s.recordings&&s.recordings.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-gray-600 mb-2 flex items-center",children:[e.jsx(Is,{size:12,className:"mr-1"})," ë…¹ìŒ ì•„ì¹´ì´ë¸Œ"]}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto no-scrollbar",children:s.recordings.map(t=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-2 rounded border border-gray-200 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx(Rs,{size:16,className:"text-blue-500 cursor-pointer flex-shrink-0",onClick:()=>Gt(t)}),e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"font-medium",children:t.filename}),e.jsx("span",{className:"text-gray-400 text-[10px] ml-1",children:ne(new Date(t.uploadDate),"yy.MM.dd HH:mm")})]})]}),e.jsx("button",{onClick:()=>Yt(t.id),className:"text-gray-400 hover:text-red-500",children:e.jsx(Se,{size:14})})]},t.id))})]}),e.jsx("div",{className:"bg-white p-3 rounded-lg border border-purple-100 shadow-sm relative min-h-[80px]",children:te?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{className:"w-full h-32 p-2 text-sm border border-purple-200 rounded focus:outline-none focus:ring-1 focus:ring-purple-500",value:h,onChange:t=>E(t.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:Xe,className:"text-xs bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"ì €ì¥"}),e.jsx("button",{onClick:()=>U(!1),className:"text-xs bg-gray-200 text-gray-700 px-3 py-1 rounded hover:bg-gray-300",children:"ì·¨ì†Œ"})]})]}):e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>U(!0),className:"p-1 text-blue-500 hover:bg-blue-50 rounded",title:"ìˆ˜ì •",children:e.jsx(oe,{size:14})}),e.jsx("button",{onClick:Wt,className:"p-1 text-red-500 hover:bg-red-50 rounded",title:"ì‚­ì œ",children:e.jsx(Q,{size:14})})]}),e.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap leading-relaxed pr-10",children:h||e.jsx("span",{className:"text-gray-400",children:"ìš”ì•½ëœ ìƒë‹´ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. í†µí™” íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ê¸°ì¡´ ìƒë‹´ ë‚´ì—­ì„ ë°”íƒ•ìœ¼ë¡œ ìš”ì•½ì„ ì‹¤í–‰í•´ë³´ì„¸ìš”."})})]})}),h&&!te&&e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("button",{onClick:Je,className:"flex items-center gap-1 text-xs bg-indigo-50 text-indigo-700 px-3 py-2 rounded font-bold hover:bg-indigo-100 border border-indigo-200 transition-colors",children:[e.jsx(Nt,{size:14})," ìƒë‹´ ë‚´ìš©ìœ¼ë¡œ ë³´ë‚´ê¸° (íŠ¹ì´ì‚¬í•­ ì¶”ê°€)"]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ê¸°ë³¸ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ê±°ë˜ì²˜ (ë²•ë¥ ì‚¬ë¬´ì†Œ)"}),e.jsx("select",{className:"w-full p-2 border border-gray-300 rounded text-sm bg-gray-50",value:s.partnerId,onChange:t=>r("partnerId",t.target.value),children:C.map(t=>e.jsx("option",{value:t.partnerId,children:t.name},t.partnerId))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ìœ ì… ê²½ë¡œ"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-blue-500 outline-none",value:s.inboundPath,onChange:t=>r("inboundPath",t.target.value),children:[e.jsx("option",{value:"",children:"ì„ íƒí•˜ì„¸ìš”"}),L.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ì‚¬ì „ ê³ ê° ì •ë³´ (ë¦¬ë“œ ìˆ˜ì§‘ ì •ë³´)"}),e.jsx("div",{className:"w-full p-2 border border-gray-200 rounded text-sm bg-gray-50 min-h-[40px] "+(s.preInfo?"text-gray-800":"text-gray-400"),children:s.preInfo?s.preInfo.split(/\s\/\s|\n/).filter(t=>{const a=t.toLowerCase();return!a.includes("[referrer]")&&!a.includes("[marketing_consent]")&&!a.includes("[third_party_consent]")&&!a.includes("[user_agent]")&&t.trim()!==""}).map((t,a)=>e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"*"}),e.jsx("span",{children:t.trim()})]},a)):e.jsx("span",{className:"text-gray-400 italic",children:"ì‚¬ì „ ì •ë³´ ì—†ìŒ"})})]}),Ye.length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 mb-6",children:[e.jsxs("h4",{className:"font-bold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx(yt,{size:16})," ìƒíƒœ ë³€ê²½ ì´ë ¥"]}),e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2",children:Ye.map(t=>e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-blue-100 shadow-sm text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gray-400 line-through text-xs px-2 py-0.5 bg-gray-100 rounded",children:t.fromStatus}),e.jsx("span",{className:"text-gray-400",children:"â†’"}),e.jsx("span",{className:"font-bold text-blue-600 text-xs px-2 py-0.5 bg-blue-50 rounded border border-blue-100",children:t.toStatus})]}),e.jsx("span",{className:"text-[10px] text-gray-400",children:ne(new Date(t.changedAt),"yy.MM.dd HH:mm")})]}),t.memo&&e.jsx("div",{className:"mt-2 text-gray-600 bg-gray-50 p-2 rounded text-xs leading-relaxed",children:t.memo}),e.jsx("div",{className:"mt-1 text-right",children:e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Changed by ",t.changedBy]})})]},t.logId))})]}),e.jsx(b,{label:"ìµœì´ˆ ë“±ë¡ì¼ì‹œ",value:s.createdAt?ne(new Date(s.createdAt),"yyyy-MM-dd HH:mm"):"-",readOnly:!0,onChange:()=>{}}),e.jsx("div",{className:"mb-4",children:e.jsx(I,{label:"ì‚¬ê±´ ìœ í˜•",value:s.caseType,onChange:t=>r("caseType",t),options:is})}),e.jsx(b,{label:"ì´ë¦„",value:s.customerName,onChange:t=>r("customerName",t)}),e.jsx(b,{label:"ì—°ë½ì²˜",value:s.phone,onChange:t=>r("phone",t),placeholder:"010-0000-0000",isPhone:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(b,{label:"ì¶œìƒë…„ë„ (2ìë¦¬)",value:s.birth,onChange:t=>r("birth",t),onBlur:Rt,placeholder:"ì˜ˆ: 77",suffix:((it=s.birth)==null?void 0:it.length)===4?"ë…„ìƒ":""}),e.jsx(I,{label:"ì„±ë³„",value:s.gender,onChange:t=>r("gender",t),options:["ë‚¨","ì—¬"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ì§ì—… / ê°€ì¡±"}),e.jsx(I,{label:"ì§ì—… (ë³µìˆ˜ì„ íƒ ê°€ëŠ¥)",value:s.jobTypes,onChange:_t,options:ds,isMulti:!0}),((dt=s.jobTypes)==null?void 0:dt.includes("ì§ì¥ì¸"))&&e.jsx(b,{label:"ì§ì¥ì¸ ì›”ìˆ˜ì…(ë§Œì›)",type:"number",value:s.incomeDetails.salary,onChange:t=>je("salary",t),isCurrency:!0}),(((ct=s.jobTypes)==null?void 0:ct.includes("ê°œì¸ì‚¬ì—…ì"))||((xt=s.jobTypes)==null?void 0:xt.includes("ë²•ì¸ì‚¬ì—…ì")))&&e.jsx(b,{label:"ì‚¬ì—…ì ì›”ìˆ˜ì…(ë§Œì›)",type:"number",value:s.incomeDetails.business,onChange:t=>je("business",t),isCurrency:!0}),((ut=s.jobTypes)==null?void 0:ut.includes("í”„ë¦¬ëœì„œ"))&&e.jsx(b,{label:"í”„ë¦¬ëœì„œ ì›”ìˆ˜ì…(ë§Œì›)",type:"number",value:s.incomeDetails.freelance,onChange:t=>je("freelance",t),isCurrency:!0}),e.jsx(I,{label:"4ëŒ€ë³´í—˜",value:s.insurance4,onChange:t=>r("insurance4",t),options:["ê°€ì…","ë¯¸ê°€ì…"]}),e.jsx(I,{label:"ê²°í˜¼ì—¬ë¶€",value:s.maritalStatus,onChange:t=>r("maritalStatus",t),options:["ë¯¸í˜¼","ê¸°í˜¼","ì´í˜¼"]}),s.maritalStatus!=="ë¯¸í˜¼"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ë¯¸ì„±ë…„ ìë…€ ìˆ˜"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[0,1,2,3,4,5,6,7].map(t=>e.jsxs("button",{type:"button",onClick:()=>r("childrenCount",t),className:"px-3 py-1.5 text-xs rounded border "+(s.childrenCount===t?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"),children:[t,"ëª…"]},t))})]})]})]}),e.jsx("hr",{className:"border-gray-100"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ì£¼ê±°"}),e.jsx(I,{label:"ê±°ì£¼í˜•íƒœ",value:s.housingType,onChange:t=>r("housingType",t),options:cs}),e.jsx(I,{label:"ì£¼ê±°ìƒì„¸",value:s.housingDetail,onChange:t=>r("housingDetail",t),options:xs}),s.housingType==="ìê°€"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(b,{label:"ì§‘ ì‹œì„¸(ë§Œì›)",type:"number",value:s.ownHousePrice,onChange:t=>r("ownHousePrice",t),isCurrency:!0}),e.jsx(b,{label:"ì§‘ ë‹´ë³´ ëŒ€ì¶œ(ë§Œì›)",type:"number",value:s.ownHouseLoan,onChange:t=>r("ownHouseLoan",t),isCurrency:!0})]}),e.jsx(I,{label:"ì§‘ ëª…ì˜ì",value:s.ownHouseOwner,onChange:t=>r("ownHouseOwner",t),options:["ë³¸ì¸","ë°°ìš°ì","ë°°ìš°ì ê³µë™ëª…ì˜"]})]}):s.housingType==="ë¬´ìƒê±°ì£¼"?e.jsx(e.Fragment,{children:e.jsx(I,{label:"ì§‘ ëª…ì˜ì",value:s.freeHousingOwner,onChange:t=>r("freeHousingOwner",t),options:us})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(b,{label:"ë³´ì¦ê¸ˆ(ë§Œì›)",type:"number",value:s.deposit,onChange:t=>r("deposit",t),isCurrency:!0}),e.jsx(b,{label:"ë³´ì¦ê¸ˆ ëŒ€ì¶œ(ë§Œì›)",type:"number",value:s.depositLoanAmount,onChange:t=>r("depositLoanAmount",t),isCurrency:!0})]}),e.jsx(b,{label:"ì›”ì„¸(ë§Œì›)",type:"number",value:s.rent,onChange:t=>r("rent",t),isCurrency:!0}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ì„ëŒ€ì°¨ ê³„ì•½ì¸"}),e.jsx("div",{className:"flex gap-2",children:ms.map(t=>e.jsx("button",{type:"button",onClick:()=>r("rentContractor",t),className:"flex-1 py-1.5 text-xs rounded border "+(s.rentContractor===t?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"),children:t},t))})]})]}),e.jsx(b,{label:"ê±°ì£¼ì§€ì—­",value:s.region,onChange:t=>r("region",t)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ìì‚° / ë¶€ì±„"}),e.jsxs("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2 text-xs",children:"ìì‚° ëª©ë¡"}),e.jsxs("div",{className:"space-y-2 mb-3",children:[(!s.assets||s.assets.length===0)&&e.jsx("p",{className:"text-xs text-gray-400 text-center py-2",children:"ë“±ë¡ëœ ìì‚°ì´ ì—†ìŠµë‹ˆë‹¤."}),s.assets&&s.assets.map(t=>e.jsxs("div",{className:"bg-white p-2 rounded border flex justify-between items-center text-xs",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"font-bold text-blue-600 mr-2",children:["[",t.owner,"]"]}),e.jsx("span",{className:"font-semibold mr-2",children:t.type}),e.jsxs("span",{className:"text-gray-800 mr-2",children:["ì‹œì„¸ ",t.amount>0?t.amount.toLocaleString()+" ë§Œì›":"0ì›"]}),t.loanAmount>0&&e.jsxs("span",{className:"text-red-500 mr-2",children:["ë‹´ë³´ ",t.loanAmount.toLocaleString(),"ë§Œì›"]}),t.rentDeposit&&t.rentDeposit>0&&e.jsxs("span",{className:"text-green-600 mr-2",children:["ì „ì„¸ ",t.rentDeposit.toLocaleString(),"ë§Œì›"]}),t.desc&&e.jsxs("span",{className:"text-gray-500",children:["(",t.desc,")"]})]}),e.jsx("button",{onClick:()=>Lt(t.id),className:"text-red-500 p-1",children:e.jsx(Q,{size:14})})]},t.id))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx("select",{className:"p-1.5 border rounded text-xs bg-white",value:x.owner,onChange:t=>_({...x,owner:t.target.value}),children:ps.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("select",{className:"p-1.5 border rounded text-xs bg-white",value:x.type,onChange:t=>_({...x,type:t.target.value}),children:hs.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx("input",{type:"text",autoComplete:"off",placeholder:"ì‹œì„¸ (ë§Œì›)",className:"w-full p-1.5 border rounded text-xs",value:x.amount||"",onChange:t=>{const a=t.target.value;(a===""||/^[0-9]+$/.test(a))&&_({...x,amount:a===""?0:Number(a)})}}),e.jsx("input",{type:"text",autoComplete:"off",placeholder:"ë‹´ë³´ëŒ€ì¶œ (ë§Œì›)",className:"w-full p-1.5 border rounded text-xs",value:x.loanAmount||"",onChange:t=>{const a=t.target.value;(a===""||/^[0-9]+$/.test(a))&&_({...x,loanAmount:a===""?0:Number(a)})}})]}),["ë¶€ë™ì‚°","í† ì§€"].includes(x.type||"")&&e.jsx("div",{className:"mb-2",children:e.jsx("input",{type:"text",autoComplete:"off",placeholder:"ì „ì„¸ê¸ˆì•¡ (ë§Œì›)",className:"w-full p-1.5 border rounded text-xs bg-green-50 focus:bg-white",value:x.rentDeposit||"",onChange:t=>{const a=t.target.value;(a===""||/^[0-9]+$/.test(a))&&_({...x,rentDeposit:a===""?0:Number(a)})}})}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",placeholder:"ìƒì„¸ ë‚´ìš© (ì˜ˆ: ì°¨ì¢… ë“±)",className:"flex-1 p-1.5 border rounded text-xs",value:x.desc||"",onChange:t=>_({...x,desc:t.target.value})}),e.jsxs("button",{type:"button",onClick:zt,className:"w-24 bg-blue-600 text-white rounded text-xs font-bold flex justify-center items-center hover:bg-blue-700 flex-shrink-0",children:[e.jsx(Me,{size:14,className:"mr-1"})," ì¶”ê°€"]})]})]}),e.jsxs("div",{className:"mb-6 bg-pink-50 p-4 rounded-lg border border-pink-200",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2 text-xs",children:"ì‹ ìš©ëŒ€ì¶œ ëª©ë¡"}),e.jsxs("div",{className:"space-y-2 mb-3",children:[(!s.creditLoan||s.creditLoan.length===0)&&e.jsx("p",{className:"text-xs text-gray-400 text-center py-2",children:"ë“±ë¡ëœ ì‹ ìš©ëŒ€ì¶œì´ ì—†ìŠµë‹ˆë‹¤."}),(mt=s.creditLoan)==null?void 0:mt.map(t=>e.jsxs("div",{className:"bg-white p-2 rounded border flex justify-between items-center text-xs",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-semibold mr-2",children:t.desc}),e.jsxs("span",{className:"text-gray-800",children:[t.amount.toLocaleString(),"ë§Œì›"]})]}),e.jsx("button",{type:"button",onClick:()=>Pt(t.id),className:"text-red-500 p-1",children:e.jsx(Q,{size:14})})]},t.id))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx("input",{type:"text",placeholder:"ëŒ€ì¶œ ë‚´ìš© (ì˜ˆ: í–‡ì‚´ë¡ )",className:"w-full p-1.5 border rounded text-xs col-span-2",value:T.desc||"",onChange:t=>p({...T,desc:t.target.value})}),e.jsx("input",{type:"text",autoComplete:"off",placeholder:"ê¸ˆì•¡ (ë§Œì›)",className:"w-full p-1.5 border rounded text-xs",value:T.amount||"",onChange:t=>{const a=t.target.value;(a===""||/^[0-9]+$/.test(a))&&p({...T,amount:a===""?0:Number(a)})}}),e.jsxs("button",{type:"button",onClick:Ht,className:"w-full py-1.5 bg-blue-600 text-white rounded text-xs font-bold flex justify-center items-center hover:bg-blue-700",children:[e.jsx(Me,{size:14,className:"mr-1"})," ì‹ ìš©ëŒ€ì¶œ ì¶”ê°€"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ë‹´ë³´ ëŒ€ì¶œ ë‚´ìš© (ìë™ ì§‘ê³„ + ì¶”ê°€)"}),e.jsxs("div",{className:"bg-gray-50 p-2 rounded text-xs text-blue-800 font-medium mb-1",children:["ìë™ ì§‘ê³„: ",Kt()]}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500",value:s.collateralLoanMemo||"",onChange:t=>r("collateralLoanMemo",t.target.value),placeholder:"ì¶”ê°€ë¡œ ì‘ì„±í•  ë‹´ë³´ ëŒ€ì¶œ ë‚´ìš©"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(I,{label:"ì‹ ìš©ì¹´ë“œ ì‚¬ìš©",value:s.creditCardUse,onChange:t=>r("creditCardUse",t),options:["ì‚¬ìš©","ë¯¸ì‚¬ìš©"]}),s.creditCardUse==="ì‚¬ìš©"&&e.jsx(b,{label:"ì‚¬ìš© ê¸ˆì•¡(ë§Œì›)",type:"number",value:s.creditCardAmount,onChange:t=>r("creditCardAmount",t),isCurrency:!0})]}),e.jsx(b,{label:"ì›” ëŒ€ì¶œë‚©ì…(ë§Œì›)",type:"number",value:s.loanMonthlyPay,onChange:t=>r("loanMonthlyPay",t),isCurrency:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-bold text-gray-700 border-b pb-2 mb-4",children:"ê°œì¸íšŒìƒ / íŒŒì‚° ì´ë ¥"}),e.jsx("div",{className:"flex gap-2 mb-2 flex-wrap",children:gs.map(t=>e.jsx("button",{type:"button",onClick:()=>r("historyType",t),className:"px-3 py-1.5 text-xs rounded border "+(s.historyType===t?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"),children:t},t))}),s.historyType&&s.historyType!=="ì—†ìŒ"&&e.jsx("textarea",{className:"w-full p-2 border border-gray-300 rounded text-sm h-24",value:s.historyMemo,onChange:t=>r("historyMemo",t.target.value),placeholder:"ì´ë ¥ ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”."})]})]}),u==="summary"&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 h-full min-h-[400px] md:min-h-[500px]",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"font-bold text-gray-700 flex items-center gap-2",children:[e.jsx(Ss,{size:18})," ê¸°ë³¸ ìš”ì•½ë¬¸"]}),e.jsx("div",{className:"flex gap-2",children:me?e.jsx(e.Fragment,{children:e.jsx("button",{onClick:()=>{Oe(!1)},className:"text-xs bg-gray-200 text-gray-700 px-3 py-1.5 rounded hover:bg-gray-300",children:"ì·¨ì†Œ"})}):e.jsxs("button",{onClick:()=>{Ue(Ae(s,g==null?void 0:g.summaryTemplate)),Oe(!0)},className:"text-xs bg-gray-100 text-gray-600 px-3 py-1.5 rounded hover:bg-gray-200 flex items-center gap-1",children:[e.jsx(oe,{size:12})," ìˆ˜ì •"]})})]}),e.jsx("div",{className:"flex-1 relative h-full",children:me?e.jsx("textarea",{className:"w-full h-full p-4 border rounded-lg text-sm leading-relaxed resize-none focus:ring-2 focus:ring-blue-500 outline-none min-h-[200px] md:min-h-[250px] max-h-[400px] md:max-h-[500px] overflow-y-auto",value:$e,onChange:t=>Ue(t.target.value)}):e.jsx("div",{className:"w-full h-full p-4 bg-gray-50 rounded-lg text-sm whitespace-pre-wrap leading-relaxed border border-gray-100 overflow-y-auto min-h-[200px] md:min-h-[250px] max-h-[400px] md:max-h-[500px]",children:Ae(s,g==null?void 0:g.summaryTemplate)})}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsxs("button",{onClick:()=>{const t=me?$e:Ae(s,g==null?void 0:g.summaryTemplate);navigator.clipboard.writeText(t),n("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")},className:"bg-gray-800 text-white px-6 py-3 rounded-lg font-bold flex items-center hover:bg-gray-900 w-full justify-center",children:[e.jsx(jt,{className:"mr-2",size:16})," ì „ì²´ ë³µì‚¬í•˜ê¸°"]})})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl border border-purple-100 shadow-sm flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"font-bold text-purple-800 flex items-center gap-2",children:[e.jsx(ke,{size:18})," AI ìš”ì•½ë¬¸"]}),e.jsx("div",{className:"flex gap-2",children:te?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Xe,className:"text-xs bg-green-600 text-white px-3 py-1.5 rounded hover:bg-green-700 font-bold",children:"ì €ì¥"}),e.jsx("button",{onClick:()=>U(!1),className:"text-xs bg-gray-200 text-gray-700 px-3 py-1.5 rounded hover:bg-gray-300",children:"ì·¨ì†Œ"})]}):e.jsxs("button",{onClick:()=>{E(le(h||"",s)),U(!0)},className:"text-xs bg-purple-100 text-purple-700 px-3 py-1.5 rounded hover:bg-purple-200 flex items-center gap-1",children:[e.jsx(oe,{size:12})," ìˆ˜ì •"]})})]}),e.jsx("div",{className:"flex-1 relative h-full",children:h?te?e.jsx("textarea",{className:"w-full h-full p-4 border border-purple-200 rounded-lg text-sm leading-relaxed resize-none focus:ring-2 focus:ring-purple-500 outline-none min-h-[200px] md:min-h-[250px] max-h-[400px] md:max-h-[500px] overflow-y-auto",value:h,onChange:t=>E(t.target.value)}):e.jsx("div",{className:"w-full h-full p-4 bg-white rounded-lg text-sm whitespace-pre-wrap leading-relaxed border border-purple-100 overflow-y-auto cursor-text hover:bg-purple-50/50 transition-colors min-h-[200px] md:min-h-[250px] max-h-[400px] md:max-h-[500px]",onClick:()=>{E(le(h,s)),U(!0)},children:h}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 gap-4 min-h-[200px]",children:[e.jsx(ke,{size:48,className:"opacity-20"}),e.jsxs("p",{className:"text-center text-sm",children:["AI ìš”ì•½ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.",e.jsx("br",{}),"'ì •ë³´ ìˆ˜ì •' íƒ­ì—ì„œ ë…¹ìŒ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³ ",e.jsx("br",{}),"AI ìš”ì•½ì„ ì‹¤í–‰í•´ë³´ì„¸ìš”."]}),e.jsx("button",{onClick:()=>D("info"),className:"text-purple-600 underline text-sm",children:"ì •ë³´ ìˆ˜ì • íƒ­ìœ¼ë¡œ ì´ë™"})]})}),h&&e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(h),n("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")},className:"bg-gray-700 text-white px-4 py-3 rounded-lg font-bold flex items-center justify-center hover:bg-gray-800 shadow-sm transition-all active:scale-95 text-xs md:text-sm",children:[e.jsx(jt,{className:"mr-2",size:16})," ì „ì²´ ë³µì‚¬"]}),e.jsxs("button",{onClick:Je,className:"bg-indigo-600 text-white px-4 py-3 rounded-lg font-bold flex items-center justify-center hover:bg-indigo-700 w-full shadow-sm transition-all active:scale-95 text-xs md:text-sm",children:[e.jsx(Nt,{className:"mr-2",size:16})," ìƒë‹´ì´ë ¥ ì „ì†¡"]})]}),e.jsx("p",{className:"text-[10px] text-center text-purple-400",children:"* ì „ì†¡ ì‹œ 'íŠ¹ì´ì‚¬í•­' ë¶€ë¶„ë§Œ ìë™ìœ¼ë¡œ ì¶”ì¶œë˜ì–´ ì €ì¥ë©ë‹ˆë‹¤."})]})]})]}),u==="settlement"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-green-50 p-6 rounded-xl border border-green-100",children:[e.jsx("h3",{className:"font-bold text-green-800 mb-4 text-lg",children:"ê³„ì•½ ë° ìˆ˜ì„ë£Œ"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-green-900 mb-1",children:"ê³„ì•½ì™„ë£Œì¼ (ì •ì‚°ê¸°ì¤€)"}),e.jsx("input",{type:"date",className:"w-full p-2 border border-green-300 rounded",value:s.contractAt||"",onChange:t=>r("contractAt",t.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-green-900 mb-1 flex items-center justify-between",children:["ë¶„ë‚© ê°œì›”",e.jsxs("label",{className:"flex items-center gap-1 cursor-pointer text-blue-600 bg-white px-2 py-0.5 rounded border border-blue-100",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox h-3 w-3",checked:s.useCapital||!1,onChange:t=>r("useCapital",t.target.checked)}),e.jsx("span",{className:"text-xs",children:"ìºí”¼íƒˆ ì‚¬ìš©"})]})]}),e.jsxs("select",{className:"w-full p-2 border border-green-300 rounded bg-white",value:s.installmentMonths||"",onChange:t=>r("installmentMonths",t.target.value),children:[e.jsx("option",{value:"",children:"ì„ íƒ"}),!s.useCapital&&e.jsx("option",{value:"ì™„ë‚©",children:"ì™„ë‚©"}),Array.from({length:8},(t,a)=>a+1).map(t=>s.useCapital||t>=2?e.jsxs("option",{value:`${t} ê°œì›”`,children:[t,"ê°œì›”"]},t):null)]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-green-900 mb-1",children:"ì´ ìˆ˜ì„ë£Œ (ë§Œì›)"}),e.jsx("input",{type:"number",className:"w-full p-2 border border-green-300 rounded text-right font-mono text-lg font-bold",value:s.contractFee||0,onChange:t=>r("contractFee",Number(t.target.value))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-green-200 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"ì˜ˆìƒ ìˆ˜ë‹¹ (Commission):"}),e.jsxs("span",{className:"text-xl font-bold text-green-900",children:[Qt.toLocaleString(),"ë§Œì›"]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-xl border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-gray-700 text-lg",children:"ì…ê¸ˆ ë‚´ì—­"}),e.jsxs("button",{onClick:()=>{const a=[...s.depositHistory&&s.depositHistory.length>0?s.depositHistory:[{date:s.deposit1Date||"",amount:s.deposit1Amount||0},{date:s.deposit2Date||"",amount:s.deposit2Amount||0}],{date:"",amount:0}];r("depositHistory",a)},className:"flex items-center gap-1 bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm font-bold hover:bg-blue-700 shadow-sm",children:[e.jsx(Me,{size:16})," ì¶”ê°€ (",(((pt=s.depositHistory)==null?void 0:pt.length)||2)+1,"ì°¨)"]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:(s.depositHistory&&s.depositHistory.length>0?s.depositHistory:[{date:s.deposit1Date||"",amount:s.deposit1Amount||0},{date:s.deposit2Date||"",amount:s.deposit2Amount||0}]).map((t,a)=>e.jsxs("div",{className:"bg-white p-4 rounded border border-gray-200 shadow-sm relative group",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:"font-bold text-gray-600 text-sm",children:[a+1,"ì°¨ ì…ê¸ˆ"]}),a>=2&&e.jsx("button",{onClick:()=>{const d=(s.depositHistory||[]).filter((m,i)=>i!==a);r("depositHistory",d)},className:"text-gray-400 hover:text-red-500",children:e.jsx(Se,{size:16})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ê¸ˆì•¡ (ë§Œì›)"}),e.jsx("input",{type:"number",className:"w-full p-2 border border-gray-300 rounded text-sm font-bold",value:t.amount||"",onChange:l=>{const d=s.depositHistory&&s.depositHistory.length>0?[...s.depositHistory]:[{date:s.deposit1Date||"",amount:s.deposit1Amount||0},{date:s.deposit2Date||"",amount:s.deposit2Amount||0}];d[a].amount=Number(l.target.value),r("depositHistory",d)}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ì…ê¸ˆì¼"}),e.jsx("input",{type:"date",className:"w-full p-2 border border-gray-300 rounded text-sm",value:t.date||"",onChange:l=>{const d=s.depositHistory&&s.depositHistory.length>0?[...s.depositHistory]:[{date:s.deposit1Date||"",amount:s.deposit1Amount||0},{date:s.deposit2Date||"",amount:s.deposit2Amount||0}];d[a].date=l.target.value,r("depositHistory",d)}})]})]})]},a))}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-gray-700",children:"ì´ ëˆ„ì  ì…ê¸ˆì•¡"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[(s.depositHistory&&s.depositHistory.length>0?s.depositHistory.reduce((t,a)=>t+(a.amount||0),0):(s.deposit1Amount||0)+(s.deposit2Amount||0)).toLocaleString()," ë§Œì›"]})]})]})]})]})]})}export{sa as default};
